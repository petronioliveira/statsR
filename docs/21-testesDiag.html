<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>21&nbsp; Determinação da validade e confiabilidade de testes diagnósticos – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./22-medidasOcorrencia.html" rel="next">
<link href="./20-testes-naoParametricos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21-testesDiag.html">Parte IX - Bioestatística Aplicada à Epidemiologia</a></li><li class="breadcrumb-item"><a href="./21-testesDiag.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I - Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II - Ambiente Computacional com R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-introducaoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introdução ao uso do R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando dados no R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III - Estatística Descritiva</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-medidasResumidoras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Medidas Resumidoras</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tabelas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tabelas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gráficos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV - Probabilidades e Distribuições</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-assimetria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte V - Inferência Estatística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VI - Testes Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VII - Relações entre Variáveis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-correlacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VIII - Métodos Não Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dadoscategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-testes-naoParametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IX - Bioestatística Aplicada à Epidemiologia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-testesDiag.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-medidasOcorrencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sobrevida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-reglogbin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossário</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários-neste-capítulo" id="toc-pacotes-necessários-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-necessários-neste-capítulo"><span class="header-section-number">21.1</span> Pacotes necessários neste capítulo</a></li>
  <li><a href="#sec-diagbayes" id="toc-sec-diagbayes" class="nav-link" data-scroll-target="#sec-diagbayes"><span class="header-section-number">21.2</span> Raciocínio Bayesiano no diagnóstico médico</a></li>
  <li><a href="#sensibilidade-e-especificidade" id="toc-sensibilidade-e-especificidade" class="nav-link" data-scroll-target="#sensibilidade-e-especificidade"><span class="header-section-number">21.3</span> Sensibilidade e Especificidade</a>
  <ul class="collapse">
  <li><a href="#sec-exapendicite" id="toc-sec-exapendicite" class="nav-link" data-scroll-target="#sec-exapendicite"><span class="header-section-number">21.3.1</span> Dados do exemplo</a></li>
  </ul></li>
  <li><a href="#valor-preditivo" id="toc-valor-preditivo" class="nav-link" data-scroll-target="#valor-preditivo"><span class="header-section-number">21.4</span> Valor Preditivo</a></li>
  <li><a href="#razão-de-probabilidade" id="toc-razão-de-probabilidade" class="nav-link" data-scroll-target="#razão-de-probabilidade"><span class="header-section-number">21.5</span> Razão de Probabilidade</a>
  <ul class="collapse">
  <li><a href="#estimando-a-probabilidade-de-doença" id="toc-estimando-a-probabilidade-de-doença" class="nav-link" data-scroll-target="#estimando-a-probabilidade-de-doença"><span class="header-section-number">21.5.1</span> Estimando a probabilidade de doença</a></li>
  </ul></li>
  <li><a href="#sec-rocurve" id="toc-sec-rocurve" class="nav-link" data-scroll-target="#sec-rocurve"><span class="header-section-number">21.6</span> Curva ROC</a>
  <ul class="collapse">
  <li><a href="#sec-exdadosTestes" id="toc-sec-exdadosTestes" class="nav-link" data-scroll-target="#sec-exdadosTestes"><span class="header-section-number">21.6.1</span> Dados do exemplo</a></li>
  <li><a href="#construção-da-curva-roc" id="toc-construção-da-curva-roc" class="nav-link" data-scroll-target="#construção-da-curva-roc"><span class="header-section-number">21.6.2</span> Construção da curva ROC</a></li>
  </ul></li>
  <li><a href="#estatística-kappa" id="toc-estatística-kappa" class="nav-link" data-scroll-target="#estatística-kappa"><span class="header-section-number">21.7</span> Estatística <em>kappa</em></a>
  <ul class="collapse">
  <li><a href="#sec-exkappa" id="toc-sec-exkappa" class="nav-link" data-scroll-target="#sec-exkappa"><span class="header-section-number">21.7.1</span> Dados do exemplo</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21-testesDiag.html">Parte IX - Bioestatística Aplicada à Epidemiologia</a></li><li class="breadcrumb-item"><a href="./21-testesDiag.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários-neste-capítulo" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="pacotes-necessários-neste-capítulo"><span class="header-section-number">21.1</span> Pacotes necessários neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               epiR,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               flextable,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               pROC,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               vcd)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-diagbayes" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sec-diagbayes"><span class="header-section-number">21.2</span> Raciocínio Bayesiano no diagnóstico médico</h2>
<p>O processo diagnóstico é o centro da atenção da atividade médica na busca de reduzir as incertezas e reconhecer a que classe pertence determinado paciente. Portanto, é extremamente importante saber quão bem os testes diagnósticos podem prever que um indivíduo é portador de certa condição ou doença. Entende-se aqui como teste diagnóstico todo o processo diagnótico, desde o exame clínico até o mais sofisticado exame de imagem ou laboratorial. A ideia é saber como o teste diagnóstico se comporta para separar um “doente” e um “não doente”; qual a sua validade neste processo?</p>
<p>Deve-se sempre ter em mente que o estabelecimento do diagnóstico é um processo imperfeito que resulta em uma probabilidade ao invés de uma certeza de estar correto. Ou seja, cada vez mais os médicos têm que aplicar as leis da probabilidade na avaliação de testes diagnósticos e sinais clínicos.</p>
<p>A abordagem Bayesiana denomina de <strong>probabilidade a priori</strong> a probabilidade estabelecida inicialmente, baseada apenas na experiência do médico, em seu conhecimento em relação a doença suspeitada. Diante de uma evidência de doença, pode ser solictado um teste diagnóstico. Quando ele recebe um teste positivo para uma doença, a probabilidade muda, passa a ser uma probabilidade condicional, probabilidade da doença dado que o teste é positivo, denominada <strong>probabilidade a posteriori</strong>.</p>
<p>Um teste que define corretamente quem é doente e quem não é doente é denominado de <strong>padrão-ouro</strong> ou <strong>padrão de referência</strong>. Algumas vezes, o teste padrão de referência é simples e barato. Outras vezes, é caro, difícil de obter, tecnicamente complexo, arriscado ou pouco prático. Inclusive, pode não hver padrão-ouro. Em função dessas limitações, outros testes são usados e, como consequência, podem ocorrer erros. Em outras palavras, no processo diagnóstico podem ocorrer <strong>falsos positivos</strong> e <strong>falsos negativos</strong>. Esta incerteza, na utilização de testes diagnósticos, gera a necessidade de o médico conferir a probabilidade de falsos positivos e falsos negativos na elaboração de um diagnóstico ao receber o resultado positivo ou negativo de um exame. Uma maneira simples de mostrar as relações de um teste diagnóstico e o verdadeiro diagnóstico, é mostrada na tabela de contingência <span class="math inline">\(2\times2\)</span> (<a href="#tbl-fpfn" class="quarto-xref">Tabela&nbsp;<span>21.1</span></a>).</p>
<div class="cell" data-layout-align="center">
<div id="tbl-fpfn" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fpfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;21.1: Falsos positivos e falsos negativos
</figcaption>
<div aria-describedby="tbl-fpfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/udFZ2ek.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sensibilidade-e-especificidade" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="sensibilidade-e-especificidade"><span class="header-section-number">21.3</span> Sensibilidade e Especificidade</h2>
<p>As estatísticas mais utilizadas para descrever a validade dos testes de diagnóstico em contextos clínicos são sensibilidade e a especificidade.</p>
<p><strong>Sensibilidade</strong> é a habilidade do teste em identificar corretamente quem tem a doença. É a taxa de verdadeiros positivos (VP) de um teste e corresponde a probabilidade de um indivíduo com a doença ter um teste positivo.</p>
<p>Um teste sensível raramente deixará passar pessoas que tenham a doença. Testes com sensibilidade alta são úteis para <em>excluir</em> a presença de uma doença. Isto é, um teste negativo exclui virtualmente a possibilidade de o paciente ter a doença de interesse, pois tem pouca probabilidade de produzir resultados falsos negativos. Isto pode ser lembrado pelo mnemônico <em>SnNout</em>, do inglês: <em>High Sensivity, a Negative result rules out the diagnosis</em> <span class="citation" data-cites="straus2019screening">(<a href="referencias.html#ref-straus2019screening" role="doc-biblioref">1</a>)</span>.</p>
<p><strong>Especificidade</strong> é a habilidade do teste em identificar corretamente quem não tem a doença. É a taxa de verdadeiros negativos (VN) de um teste e corresponde a probabilidade de um indivíduo sem a doença ter um teste negativo. Um teste específico raramente classificará de forma errônea indivíduos sendo portadores da doença quando eles não são. Os testes muito específicos são usados para <em>confirmar</em> a presença da doença. Se o teste é altamente específico, um teste positivo sugere fortemente a presença da doença de interesse.</p>
<p>De forma similar que a sensibilidade pode-se usar o mnemônico <em>SpPin</em>, do inglês: <em>High Specificity, a Positive result rules in the diagnosis</em> <span class="citation" data-cites="straus2019screening">(<a href="referencias.html#ref-straus2019screening" role="doc-biblioref">1</a>)</span>.</p>
<p>Estas estatísticas de diagnóstico podem ser calculadas a partir das equações, cujas letras representam as caselas da tabela <span class="math inline">\(2 \times 2\)</span> da <a href="#tbl-fpfn" class="quarto-xref">Tabela&nbsp;<span>21.1</span></a>;</p>
<p><span class="math display">\[
Sensibilidade = \frac {a}{\left (a + c\right )} \quad \quad Especificidade = \frac {d}{\left (b + d\right )}
\]</span></p>
<p>A <strong>taxa de falsos negativos</strong> (TFN) é a proporção de indivíduos que têm a doença e que têm um resultado de teste negativo e a <strong>taxa de falsos positivos</strong> (TFP) é a proporção de pacientes que não possuem a doença e que apresentam resultados positivos. Podem ser expressas pelas equações:</p>
<p><span class="math display">\[
TFN= \frac {c}{\left (a + c\right )} \quad ou \quad \left (1 - sensibilidade\right)
\]</span></p>
<p><span class="math display">\[
TFP= \frac {b}{\left (b + d\right )} \quad ou \quad \left (1 - especifcidade\right)
\]</span></p>
<p>Idealmente, um teste de diagnóstico deveria ter altos níveis de sensibilidade e especificidade. No entanto, isso não é possível, pois existe um balanço entre sensibilidade e especificidade. À medida que a especificidade aumenta, a sensibilidade diminui e vice-versa. As curvas ROC podem ser usadas para identificar um ponto de corte em uma medição contínua que maximize a sensibilidade e a especificidade (veja <a href="#sec-rocurve" class="quarto-xref"><span>Seção 21.6</span></a>).</p>
<p>Quando um clínico tem um paciente cujo teste apresentou resultado positivo, a pergunta mais importante é a seguinte: dado que o teste é positivo, qual é a probabilidade de o paciente ter a doença? A sensibilidade do teste não responde a este questionamento, mas sim a probabilidade de um resultado positivo, dado que o paciente tem a doença <span class="citation" data-cites="altman1994diagnostic">(<a href="referencias.html#ref-altman1994diagnostic" role="doc-biblioref">2</a>)</span>.</p>
<section id="sec-exapendicite" class="level3" data-number="21.3.1">
<h3 data-number="21.3.1" class="anchored" data-anchor-id="sec-exapendicite"><span class="header-section-number">21.3.1</span> Dados do exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Foram avaliados 156 pacientes com diagnóstico clínico de apendicite aguda, submetidos à ultrassonografia abdominal e apendicectomia laparoscópica, acompanhado de estudo anatomopatológico dos apêndices extirpados <span class="citation" data-cites="peixoto2011indices">(<a href="referencias.html#ref-peixoto2011indices" role="doc-biblioref">3</a>)</span>.</p>
</div>
</div>
<p>Os dados estão contidos no conjunto de dados <code>dadosApendicite.xlsx</code> que pode ser obtido <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosApendicite.xlsx"><strong>aqui</strong></a>. Salve o mesmo em seu diretório de trabalho.</p>
<section id="leitura-e-observação-dos-dados" class="level4" data-number="21.3.1.1">
<h4 data-number="21.3.1.1" class="anchored" data-anchor-id="leitura-e-observação-dos-dados"><span class="header-section-number">21.3.1.1</span> Leitura e observação dos dados</h4>
<p>Será usado a função <code>read_excel()</code>do pacote <code>readxl</code> para ler os dados e a função <code>str()</code> para observar a sua estrutura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosApendicite.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [156 × 3] (S3: tbl_df/tbl/data.frame)
 $ id        : num [1:156] 1 2 3 4 5 6 7 8 9 10 ...
 $ apendicite: num [1:156] 1 1 1 1 1 1 1 1 1 1 ...
 $ eco       : num [1:156] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>As variáveis <code>apendicite</code> e <code>eco</code> foram exibidas como variáveis numéricas e serão transformadas em fatores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>apendicite <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>apendicite,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Presente"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ausente"</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>eco <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>eco,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Positivo"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Negativo"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construção-de-uma-tabela-de-contingência-22" class="level4" data-number="21.3.1.2">
<h4 data-number="21.3.1.2" class="anchored" data-anchor-id="construção-de-uma-tabela-de-contingência-22"><span class="header-section-number">21.3.1.2</span> Construção de uma tabela de contingência 2$$2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tab_ap <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(eco, apendicite, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Eco"</span>, <span class="st">"Apendicite"</span>)))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab_ap, <span class="at">FUN =</span> sum)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margins computed over dimensions
in the following order:
1: Eco
2: Apendicite</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          Apendicite
Eco        Presente Ausente sum
  Positivo       85       7  92
  Negativo       46      18  64
  sum           131      25 156</code></pre>
</div>
</div>
</section>
<section id="avaliação-do-teste-diagnóstico-através-da-sensibilidade-e-da-especificidade" class="level4" data-number="21.3.1.3">
<h4 data-number="21.3.1.3" class="anchored" data-anchor-id="avaliação-do-teste-diagnóstico-através-da-sensibilidade-e-da-especificidade"><span class="header-section-number">21.3.1.3</span> Avaliação do teste diagnóstico através da sensibilidade e da especificidade</h4>
<p>Pode-se usar a função <code>epi.tests()</code> do pacote <code>epiR</code> <span class="citation" data-cites="stevenson2022epir">(<a href="referencias.html#ref-stevenson2022epir" role="doc-biblioref">4</a>)</span> que calcula, junto com os intervalos de confiança exatos, a prevalência aparente e verdadeira, sensibilidade, especificidade, valores preditivos positivos e negativos e razões de probabilidade positivas e negativas a partir de dados de contagem fornecidos em uma tabela <span class="math inline">\(2\times2\)</span>. Utiliza os argumentos</p>
<ul>
<li><strong>dat</strong> dados sob a forma de vetor ou matriz<br>
</li>
<li><strong>conf.level</strong> magnitude do intervalode confiança, entre 0 e 1.</li>
</ul>
<p>Os resultados serão atribuídos a um objeto de nome <code>diag</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> epiR<span class="sc">::</span><span class="fu">epi.tests</span>(tab_ap, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diag)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +           85            7         92
Test -           46           18         64
Total           131           25        156

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.59 (0.51, 0.67)
True prevalence *                      0.84 (0.77, 0.89)
Sensitivity *                          0.65 (0.56, 0.73)
Specificity *                          0.72 (0.51, 0.88)
Positive predictive value *            0.92 (0.85, 0.97)
Negative predictive value *            0.28 (0.18, 0.41)
Positive likelihood ratio              2.32 (1.22, 4.40)
Negative likelihood ratio              0.49 (0.35, 0.68)
False T+ proportion for true D- *      0.28 (0.12, 0.49)
False T- proportion for true D+ *      0.35 (0.27, 0.44)
False T+ proportion for T+ *           0.08 (0.03, 0.15)
False T- proportion for T- *           0.72 (0.59, 0.82)
Correctly classified proportion *      0.66 (0.58, 0.73)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>Assim, a sensibilidade é igual a 65% (IC95%: 56 – 73%) e a especificidade é igual a 72% (IC95%: 51 – 88%). Isto significa que um indivíduo com apendicite aguda tem 65% de probabilidade de ter uma ecografia alterada; um indivíduo sem apendicite aguda tem 72% de probabilidade de ter uma ecografia normal. O objetivo do teste de diagnóstico é usá-lo para fazer um diagnóstico, então há necessidade de saber a probabilidade que o teste fornece para um diagnóstico correto. A sensibilidade e a especificidade não fornecem esta informação. Para atingir esse objetivo, usa-se o <strong>valor preditivo</strong> <span class="citation" data-cites="altman1994predictive">(<a href="referencias.html#ref-altman1994predictive" role="doc-biblioref">5</a>)</span>.</p>
</section>
</section>
</section>
<section id="valor-preditivo" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="valor-preditivo"><span class="header-section-number">21.4</span> Valor Preditivo</h2>
<p>O propósito de um teste diagnóstico é usar seus resultados para fazer um diagnóstico, portanto, é necessário conhecer a probabilidade de que o resultado do teste forneça o diagnóstico correto <span class="citation" data-cites="altman1994predictive">(<a href="referencias.html#ref-altman1994predictive" role="doc-biblioref">5</a>)</span>.</p>
<p>Os valores preditivos positivo e negativo descrevem a probabilidade de um paciente ter doença, uma vez que os resultados de seus testes são conhecidos.</p>
<p>O <strong>valor preditivo positivo</strong> (VPP) de um teste é definido como a proporção de pessoas com um resultado de teste positivo que realmente têm a doença.</p>
<p>O <strong>valor preditivo negativo</strong> (VPN) é a proporção de pacientes com resultados de teste negativos que não têm doença.</p>
<p>Como a sensibilidade e a especificidade, estas estatísticas de diagnóstico também podem ser calculadas a partir da tabela <span class="math inline">\(2\times2\)</span>, mostrada no início:</p>
<p><span class="math display">\[
VPP = \frac {a}{\left (a + b\right )} \quad \quad VPN = \frac {d}{\left (c + d\right )}
\]</span></p>
<p>Observando os resultados anteriores da função <code>epi.tests()</code>, verifica-se que 92% (85/92) dos indivíduos que tiveram teste positivo (ultrassonografia alterada) tinham doença (apendicite aguda). Isso significa que seu VPP é igual a 92% (IC95%: 18 – 41%), ou dito de outra forma, uma pessoa com ultrassonografia positiva tem 92% de probabilidade de ter a apendicite aguda. O VPP é também conhecido como <strong>probabilidade pós-teste</strong> de doença dado um teste positivo.</p>
<p>Dos 64 pacientes que tiveram ultrassonografia sem alterações, 18 não apresentaram apendicite aguda, portanto, um VPN de 28% (IC95%: 56 – 73%). Isso significa que uma pessoa quem tem um teste negativo tem 28,1% de probabilidade de não ter apendicite aguda.</p>
<p>Entretanto, essas proporções são de validade limitada. Os valores preditivos de um teste, na prática clínica, dependem criticamente da prevalência da anormalidade nos pacientes testados. No estudo, a prevalência de apendicite aguda é igual a</p>
<p><span class="math display">\[
\frac {total\ de\ casos\ de \ apendicite \ aguda}{total\ de\ casos\ no\ estudo} = \frac {131}{156} = 0,84\ ou\ 84\% \left(IC_{95\%}:77\ a\ 89\%\right)
\]</span></p>
<p>Levando-se em consideração que a prevalência de apendicite aguda na população é de 7% <span class="citation" data-cites="lima2016perfil">(<a href="referencias.html#ref-lima2016perfil" role="doc-biblioref">6</a>)</span>, mantendo a sensibilidade (64%) e a especificidade (72%) da ultrassonografia, entre 156 pacientes, selecionados aleatoriamente, se esperaria encontrar aproximadamente 11 casos (7% de 156) de apendicite aguda. Para facilitar a compreensão, observe a a tabela <span class="math inline">\(2\times2\)</span> (<a href="#tbl-vpp" class="quarto-xref">Tabela&nbsp;<span>21.2</span></a>):</p>
<div class="cell" data-layout-align="center">
<div id="tbl-vpp" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vpp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;21.2: Prevalencia e valor preditivo
</figcaption>
<div aria-describedby="tbl-vpp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/s0tdwod.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>O VPP e o VPN são iguais a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">41</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">104</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>vpp <span class="ot">=</span> a<span class="sc">/</span>(a <span class="sc">+</span> b)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpp, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vpn <span class="ot">=</span> d<span class="sc">/</span>(c <span class="sc">+</span> d)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpn, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96.3</code></pre>
</div>
</div>
<p>Ao se comparar o VPP obtido, agora, com o VPP do estudo, observa-se que o mesmo diminuiu bastante, de 92% para 14,6%. O contrário ocorre com a VPN que aumenta substancialmente de 28% para 96,3%, mostrando claramente a influência da prevalência.</p>
<p>Se a prevalência diminui, o VPP diminui e o VPN aumenta. Portanto, será errado aplicar diretamente os valores preditivos publicados de um teste ao seu pacciente, quando a prevalência da doença em sua população for diferente da prevalência da doença na população em que o estudo publicado foi realizado. Um teste pode ser útil em um lugar e não ter validade em outro onde a prevalência é muito baixa.</p>
<p>Pode-se chegar aos mesmos resultados, usando as equações:</p>
<p><span class="math display">\[
VPP =\frac{sens \times prev}{\left(sens \times prev\right) + \left [\left (1- espec\right) \times \left (1- prev\right)\right ]}
\]</span></p>
<p><span class="math display">\[
VPN =\frac{espec\times \left (1- prev\right)}{\left[\left (1 - sens \right)\times prev\right]+\left[espec\times \left (1 - prev\right)\right]}
\]</span></p>
<p>A prevalência pode ser interpretada como a probabilidade antes da realização do teste, conhecida como <em>probabilidade pré-teste</em>. A diferença entre as probabilidades pré e pós-teste é uma forma de avaliar a utilidade do teste. Esta diferença pode ser mensurada pela <strong>razão de probabilidade</strong> (<strong>likelihood ratio</strong>).</p>
</section>
<section id="razão-de-probabilidade" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="razão-de-probabilidade"><span class="header-section-number">21.5</span> Razão de Probabilidade</h2>
<p>A <strong>Razão de Probabilidades</strong> (<em>likelihood ratio</em>) é uma forma alternativa de descrever o desempenho de um teste diagnóstico. Alguns autores a denominam de razão de verossimilhança <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>A razão de probabilidades para um resultado de teste é definida como a razão entre a probabilidade de observar aquele resultado em indivíduos com a doença em questão e a probabilidade desse resultado em indivíduos sem a doença <span class="citation" data-cites="halkin1998likelihood">(<a href="referencias.html#ref-halkin1998likelihood" role="doc-biblioref">7</a>)</span>.</p>
<p>Razões de probabilidade são, clinicamente, mais úteis do que sensibilidade e especificidade. Fornecem um resumo de quantas vezes mais (ou menos) a probabilidade de os indivíduos com a doença apresentarem aquele resultado específico do que os indivíduos sem a doença, e também podem ser usados para calcular a probabilidade de doença para pacientes individuais <span class="citation" data-cites="deeks2004likelihood">(<a href="referencias.html#ref-deeks2004likelihood" role="doc-biblioref">8</a>)</span>. Cada vez mais as razões de probabilidade estão se tornando populares para relatar a utilidade dos testes de diagnóstico.</p>
<p>Quando os resultados do teste são relatados como sendo positivos ou negativos, dois tipos de razões de probabilidades podem ser descritos, a razão de probabilidades para um teste positivo (denotada LR +) e a razão de probabilidades para um teste negativo (denotada LR−).</p>
<p>A <em>razão de probabilidades para um teste positivo</em> é definida como a probabilidade de um indivíduo com doença ter um teste positivo dividida pela probabilidade de um indivíduo sem doença ter um teste positivo. A fórmula para calcular LR + é</p>
<p>Ou seja,</p>
<p><span class="math display">\[
LR(+)=\frac{sensibilidade}{1 - especificidade}
\]</span></p>
<p>Razão de probabilidades positiva maior que 1 significa que um teste positivo tem mais probabilidade de ocorrer em pessoas com a doença do que em pessoas sem a doença. De um modo geral, para os indivíduos que apresentam um resultado positivo, LR (+) &gt; 10 aumenta significativamente a probabilidade de doença (“confirma” a doença), enquanto LR (+) &lt; 0,1, virtualmente, exclui a probabilidade de uma pessoa ter a doença <span class="citation" data-cites="guyatt2015diagnostic">(<a href="referencias.html#ref-guyatt2015diagnostic" role="doc-biblioref">9</a>)</span>.</p>
<p>Usando os dados incluídos no objeto <code>diag</code>, obtido com a função <code>epi.tests()</code> do pacote <code>epiR</code>, tem-se que a LR (+) da ultrassonografia para o diagnóstico de apendicite aguda é igual 2.32 (IC95%: 1,22 – 4,40). Significa que uma pessoa com apendicite aguda tem cerca de 2,32 vezes mais probabilidade de ter um teste positivo do que uma pessoa que não tem a doença.</p>
<p>A <em>razão de probabilidade negativa</em> é definida como a probabilidade de um indivíduo com doença ter um teste negativo dividido pela probabilidade de um indivíduo sem doença ter um teste negativo. A fórmula para calcular a LR− é:</p>
<p>Ou seja,</p>
<p><span class="math display">\[
LR(-)=\frac{sensibilidade}{1-especificidade}
\]</span></p>
<p>Razão de probabilidade negativa menor que 1 significa que um teste negativo é menos provável de ocorrer em pessoas com a doença do que em pessoas sem a doença. Um LR muito baixo (abaixo de 0,1) praticamente exclui a chance de que uma pessoa tenha a doença <span class="citation" data-cites="guyatt2015diagnostic">(<a href="referencias.html#ref-guyatt2015diagnostic" role="doc-biblioref">9</a>)</span>.</p>
<p>Voltando aos dados anteriores, a LR (-) para a ultrassonografia é igual a 0.49 (IC95%: 0.35 - 0.68). Significa que a probabilidade de ter um teste negativo para indivíduos com doença é 0,49 vezes ou cerca de metade daqueles sem a doença. Dito de outra forma, os indivíduos sem a doença têm cerca o dobro probabilidade de ter um teste negativo do que os indivíduos com a doença.</p>
<section id="estimando-a-probabilidade-de-doença" class="level3" data-number="21.5.1">
<h3 data-number="21.5.1" class="anchored" data-anchor-id="estimando-a-probabilidade-de-doença"><span class="header-section-number">21.5.1</span> Estimando a probabilidade de doença</h3>
<p>Uma grande vantagem das razões de probabilidade é que elas podem ser usadas para ajudar o médico a adaptar a sensibilidade e a especificidade dos testes aos pacientes individuais. Ao se atender um paciente em uma clínica, pode-se decidir realizar um teste específico, após uma anamnese e um exame físico. A decisão de fazer o teste baseia-se nos sintomas e sinais do paciente e na experiência pessoal. Existe suspeita de um determinado diagnóstico e o objetivo é excluir ou confirmar esse diagnóstico. Antes de solicitar o teste, geralmente existe uma estimativa aproximada da probabilidade do paciente de ter essa doença, conhecida como <strong>probabilidade pré-teste</strong> ou <strong>a priori</strong>, que geralmente é estimada com base na experiência pessoal do médico, dados de prevalência local e publicações científicas.</p>
<p>A razão mais importante pela qual um teste é realizado é tentar modificar a probabilidade de doença. Um teste positivo pode aumentar a probabilidade pós-teste e um teste negativo pode reduzir essa probabilidade. A probabilidade pós-teste de doença é o que mais interessa aos médicos e pacientes, pois isso pode ajudar a decidir se devem confirmar, descartar um diagnóstico ou realizar outros testes.</p>
<p>Os resultados dos testes clínicos são geralmente usados não para fazer ou excluir categoricamente um diagnóstico, mas para modificar a probabilidade do pré-teste a fim de gerar a probabilidade do pós-teste. O teorema de Bayes é uma relação matemática que permite estimar a probabilidade pós-teste.</p>
<p>Para se compreender este conceito, é importante entender a diferença entre <strong>probabilidade</strong> e <strong>odds</strong> <span class="citation" data-cites="oliveira2022diagnostico">(<a href="referencias.html#ref-oliveira2022diagnostico" role="doc-biblioref">10</a>)</span>.</p>
<p><strong>Probabilidade</strong> é a proporção de pessoas que apresentam uma determinada característica (teste positivo, sinal clínico).<br>
<strong>Odds</strong> (chance) representa a razão entre duas características complementares, ou seja, a probabilidade de um evento dividido pela probabilidade do não evento (1 – evento). Ambos contêm as mesmas informações de maneiras diferentes. Por exemplo, usando os dados da tabela <code>tab_ap</code> (veja <a href="#sec-exapendicite" class="quarto-xref"><span>Seção 21.3.1</span></a>), verifica-se que a probabilidade (<em>p</em>) de uma ultrassonografia positiva para apendicite aguda é igual</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5897436</code></pre>
</div>
</div>
<p>e que o <em>odds</em> da ultrassonografia positiva<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> é</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> odds <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(c <span class="sc">+</span> d) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> odds</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4375</code></pre>
</div>
</div>
<p>Para transformar a <em>odds</em> em probabilidades e vice-versa, procede-se da seguinte maneira:</p>
<p><span class="math display">\[
p=\frac{odds}{1+odds}
\]</span></p>
<p>Voltando ao exemplo (<a href="#sec-exapendicite" class="quarto-xref"><span>Seção 21.3.1</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> odds<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> odds)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5897436</code></pre>
</div>
</div>
<p>e</p>
<p><span class="math display">\[
odds=\frac{p}{1-p}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">=</span> p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>odds</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4375</code></pre>
</div>
</div>
<p>Pelo teorema de Bayes, sabendo-se a <em>probabilidade a priori</em> ou <em>probabilidade pré-teste</em>, é possível obter a <em>probabilidade pós-teste</em> ou <em>a posteriori</em>, usando a razão de probabilidades.</p>
<p>Para atingir este objetivo, basta, inicialmente, multiplicar o <em>odds pré-teste</em> pela razão de probabilidades:</p>
<p><span class="math display">\[
odds_{pos} = odds_{pre \quad \times \quad LR}
\]</span></p>
<p>Após, para encontrar a probabilidade pós-teste, basta converter o <em>odds</em> pós-teste em probabilidade:</p>
<p><span class="math display">\[
p_{pos} = \frac{odds_{pos}}{1-odds_{pos}}
\]</span></p>
<p>No exemplo (<a href="#sec-exapendicite" class="quarto-xref"><span>Seção 21.3.1</span></a>), foi verificado que o LR (+) é igual a 2,32 e a prevalência de apendicite aguda é em torno de 7% pode-se prever a probabilidade de haver apendicite aguda, diante de uma ultrassonografia alterada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prev <span class="ot">&lt;-</span>  <span class="fl">0.07</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span>  <span class="fl">2.32</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>odds_pre <span class="ot">&lt;-</span>  <span class="fl">0.07</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span><span class="fl">0.07</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>odds_pos <span class="ot">&lt;-</span> odds_pre <span class="sc">*</span> LR</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>p_pos <span class="ot">&lt;-</span> odds_pos<span class="sc">/</span>(odds_pos <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p_pos, <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.149</code></pre>
</div>
</div>
<p>Ou, em outras palavras, diante de um teste positivo, a probabilidade de o paciente ter apendicite aguda passa de 7% antes do teste para praticamente 15%!</p>
<p>Estes cálculos podem ser simplificados, utilizando o nomograma de Fagan <span class="citation" data-cites="fagan1975nomogram">(<a href="referencias.html#ref-fagan1975nomogram" role="doc-biblioref">11</a>)</span>, extremamente fácil de se usar <span class="citation" data-cites="caraguel2013fagan">(<a href="referencias.html#ref-caraguel2013fagan" role="doc-biblioref">12</a>)</span>, pois basta unir a probabilidade pré-teste ao LR que a reta apontará para a probabilidade pós-teste (<a href="#fig-fagan" class="quarto-xref">Figura&nbsp;<span>21.1</span></a>)).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fagan" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fagan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/Qyvlj5q.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fagan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.1: Nomograma de Fagan
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-rocurve" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="sec-rocurve"><span class="header-section-number">21.6</span> Curva ROC</h2>
<p>Nem sempre o resultado de um teste é dicotômico (positivo/negativo). Com frequência, trabalha-se com variáveis contínuas (pressão arterial, glicemia, dosagem do sódio, dosagens hormonais, etc.). Neste caso, não há um resultado “positivo” ou “negativo”. Um “ponto de corte” precisa ser criado, para definir quem será considerado positivo ou negativo.</p>
<p>A escolha do ponto de corte depende das consequências de um resultado falso positivo ou de um falso negativo. Falsos positivos estão associados com custos (emocional ou financeiro) e com a dificuldade de “desrotular” alguém que recebeu o rótulo de “positivo”. Resultados falsos negativos podem “tranquilizar” pessoas doentes que não são seguidas ou tratadas precocemente.</p>
<p>A distribuição dos níveis glicêmicos em diabéticos e não diabéticos não tem um ponto de corte bem nítido. As duas populações se sobrepõem (<a href="#fig-diabetes" class="quarto-xref">Figura&nbsp;<span>21.2</span></a>)), gerando falso positivos ou falso negativos, dependendo do ponto de corte escolhido <span class="citation" data-cites="oliveira2022diagnostico">(<a href="referencias.html#ref-oliveira2022diagnostico" role="doc-biblioref">10</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-diabetes" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diabetes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-testesDiag_files/figure-html/fig-diabetes-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.2: Populações de indivíduos normais (curva em azul) e diabéticos (curva em vermelho)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Suponha que ao se examinar uma população fosse escolhido o ponto de corte de 80mg/dL, haveria um aumento no número de indivíduos com teste positivo com uma taxa de falsos positivos elevada, diminuindo a especificidade do teste. Se, por outro lado, o ponto de corte fosse elevado para 200mg/dL, o número de falsos negativos teria um grande aumento, reduzindo a sensibilidade. Esta oscilação entre a sensibilidade e a especificidade ocorre pelo fato de a localização do ponto de corte ser uma decisão arbitrária num contínuo entre o normal e anormal.</p>
<p>Ao se escolher um ponto de corte deve-se fazer um balanço entre a sensibilidade e a especificidade, levando em conta as consequências da escolha. Por exemplo, a triagem para fenilcetonúria em recém-nascidos valoriza a sensibilidade em vez de especificidade; o custo da perda de um caso é alto, pois existe tratamento eficaz. Uma desvantagem é que ocorre um grande número de testes falso positivos que causam angústia e a realização de mais testes.</p>
<p>Em contraste, a triagem para o câncer de mama deve favorecer a especificidade sobre a sensibilidade, uma vez que uma avaliação mais aprofundada daquelas com teste positivo, implica em biopsias dispendiosas e invasivas.</p>
<p>As <strong>curvas ROC</strong> (<em>Receiver Operating Characteristic</em>) são uma ferramenta inestimável para encontrar o ponto de corte em uma medida com distribuição contínua que melhor prediz se uma condição está presente, por exemplo, se pacientes são positivos ou negativos para a presença de uma doença <span class="citation" data-cites="altman1994roc">(<a href="referencias.html#ref-altman1994roc" role="doc-biblioref">13</a>)</span>. As curvas ROC são usadas para encontrar um ponto de corte que separa um resultado de teste “normal” de um “anormal” quando o resultado do teste é uma medida contínua. As curvas ROC são traçadas calculando a sensibilidade e a especificidade do teste na predição do diagnóstico para cada valor da medida. A curva permite determinar um ponto de corte para a medição que maximiza a taxa de verdadeiros positivos (sensibilidade) e minimiza a taxa de falsos positivos (1 – especificidade) e, portanto, maximiza a razão de probabilidades (<em>likelihood ratio</em>).</p>
<section id="sec-exdadosTestes" class="level3" data-number="21.6.1">
<h3 data-number="21.6.1" class="anchored" data-anchor-id="sec-exdadosTestes"><span class="header-section-number">21.6.1</span> Dados do exemplo</h3>
<p>O conjunto de dados <code>dadosTestes.xlsx</code> contém informações para os resultados hipotéticos de três testes bioquímicos diferentes e uma variável (<code>doença</code>) que indica se foi confirmada a doença (<em>padrão-ouro</em>). Para obter arquivo, clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosTestes.xlsx"><strong>aqui</strong></a> e salve o mesmo em seu diretório de trabalho.</p>
<section id="leitura-e-observação-dos-dados-1" class="level4" data-number="21.6.1.1">
<h4 data-number="21.6.1.1" class="anchored" data-anchor-id="leitura-e-observação-dos-dados-1"><span class="header-section-number">21.6.1.1</span> Leitura e observação dos dados</h4>
<p>Como é um arquivo em Excel, a leitura será realizada pela função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>testes <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTestes.xlsx"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testes)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [145 × 5] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:145] 1 2 3 4 5 6 7 8 9 10 ...
 $ teste1: num [1:145] 25 2.2 46.2 9.9 46.5 36.1 34.8 44.9 36.9 7.1 ...
 $ teste2: num [1:145] 25 2.2 15.6 20.4 15.7 35.7 34.8 55.4 36.9 7.1 ...
 $ teste3: num [1:145] 15 2.2 25 20.4 15.7 36.1 24 55.4 36.9 7.1 ...
 $ doenca: num [1:145] 2 2 1 1 2 2 2 1 2 2 ...</code></pre>
</div>
</div>
<p>A variável <code>doença</code> será transformada em fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>testes<span class="sc">$</span>doenca <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testes<span class="sc">$</span>doenca)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As curvas ROC são usadas para avaliar qual teste é mais útil para prever quais pacientes serão positivos para a doença. A hipótese nula é que a área sob a curva ROC é igual a 0,5, ou seja, a habilidade do teste para identificar casos positivos e negativos é a esperada por acaso.</p>
<p>A <a href="#fig-status123" class="quarto-xref">Figura&nbsp;<span>21.3</span></a> mostra a quantidade de sobreposição na distribuição da medição dos testes bioquímicos contínuos em ambos os grupos doença positiva e doença negativa. No Teste 1, a sobreposição é completa e não haverá um ponto de corte que separe efetivamente os dois grupos. Nos Testes 2 e 3, há uma maior separação das medidas de teste entre os grupos, particularmente para Teste 3.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-status123" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-status123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/bTZ7RuY.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-status123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.3: Resultado do teste vs doença
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="construção-da-curva-roc" class="level3" data-number="21.6.2">
<h3 data-number="21.6.2" class="anchored" data-anchor-id="construção-da-curva-roc"><span class="header-section-number">21.6.2</span> Construção da curva ROC</h3>
<p>A validade dos testes, na distinção entre os grupos doença-positivo e doença-negativo, pode ser quantificada pelas curvas ROC, usando a função <code>roc()</code> do pacote <code>pROC</code> <span class="citation" data-cites="robin2011proc">(<a href="referencias.html#ref-robin2011proc" role="doc-biblioref">14</a>)</span>. Este pacote tem várias funções:</p>
<ul>
<li><strong>auc</strong>: calcula a área da curva ROC;</li>
<li><strong>ci</strong>: calcula o intervalo de confiança da curva ROC;</li>
<li><strong>ci.auc</strong>: calcula o intervalo de confiança da AUC;</li>
<li><strong>ci.se</strong>: calcula o intervalo de confiança de sensibilidades em determinadas especificidades;</li>
<li><strong>ci.sp</strong>: calcula o intervalo de confiança de especificidades em determinadas sensibilidades;</li>
<li><strong>ci.thresholds</strong>: calcula o intervalo de confiança dos limites;</li>
<li><strong>coords</strong>: Retorna as coordenadas (sensibilidades, especificidades, pontos de corte) de uma curva ROC;<br>
</li>
<li><strong>roc</strong>: Constroi uma curva ROC;<br>
</li>
<li><strong>roc.test</strong>: Compara a AUC de duas curvas ROC correlacionadas;<br>
</li>
<li><strong>smooth</strong>: suaviza a curva ROC</li>
</ul>
<p>Usar a função com os argumentos variável resposta (<code>doenca</code>), variável preditora (<code>teste3</code>, <code>teste2</code> e <code>teste1</code>), indicação de que o gráfico deve ser desenhado (<code>plot = TRUE</code>). Como por padrão o gráfico é plotado com a sensibilidade no eixo <em>x</em> e a especificidade no eixo <em>y</em>; deve-se acrescentar o argumento <code>legacy.axes = TRUE</code> para aparecer o seu complemento, os falsos positivos (<span class="math inline">\(1 – especificidade\)</span>).</p>
<p>Além desses, pode-se usar vários outros argumentos como: <code>print.auc = TRUE</code>, que imprime no gráfico a <code>AUC</code> e <code>ci</code> que é o intervalo de confiança da AUC. Para que a sensibilidade e especificidade apareçam como uma percentagem, deve-se usar o argumento <code>percent = TRUE</code>, pois o padrão é <code>FALSE</code>. Os demais argumentos são os rótulos dos eixos, cor da curva, largura da curva (<code>lwd</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste3, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y =</span> <span class="fl">0.2</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="st">"1 - Especificdade"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste2, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.13</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"chartreuse4"</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste1, </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.06</span>,</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"tomato"</span>,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Legendas das curvas ROC</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.73</span>,<span class="fl">0.80</span>,<span class="st">"Teste 3"</span>, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.53</span>,<span class="fl">0.73</span>,<span class="st">"Teste 2"</span>, <span class="at">col=</span><span class="st">"chartreuse4"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.35</span>,<span class="fl">0.65</span>,<span class="st">"Teste 1"</span>, <span class="at">col=</span><span class="st">"tomato"</span>, <span class="at">cex =</span> <span class="dv">1</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-roc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-testesDiag_files/figure-html/fig-roc-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.4: Curvas ROC para os Testes 1, 2 e 3
</figcaption>
</figure>
</div>
</div>
</div>
<section id="interpretação-do-resultado" class="level4" data-number="21.6.2.1">
<h4 data-number="21.6.2.1" class="anchored" data-anchor-id="interpretação-do-resultado"><span class="header-section-number">21.6.2.1</span> Interpretação do resultado</h4>
<p>Em uma curva ROC, a sensibilidade é calculada usando cada valor do teste no conjunto de dados como um ponto de corte e é plotada em relação à (1 – especificidade) correspondente nesse ponto, como mostrado na <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>21.4</span></a>.</p>
<p>Assim, a curva são os <em>Verdadeiros Positivos</em> (VP) plotados em relação aos <em>Falsos Positivos</em> (FP), calculados usando cada valor do teste como ponto de corte. A reta diagonal indica onde o teste cairia se os resultados não fossem melhores do que o acaso para predizer a presença de uma doença. O Teste 1 está próximo desta reta, confirmando que ele tem pouca capacidade de discriminar os pacientes doentes e não doentes.</p>
<p>A área abaixo da reta diagonal é equivalente a 0,5 da área total. Quanto maior a área sob a curva ROC, mais útil é o teste para predizer os pacientes que têm a doença. Uma curva que cai substancialmente abaixo da linha diagonal indica que o teste tem pouca capacidade de diagnosticar a doença. Quando há uma separação perfeita dos valores dos dois grupos, isto é, sem sobreposição das distribuições, a área sob a curva ROC é igual a 1 (a curva ROC alcançará o canto superior esquerdo do gráfico).</p>
<p>A área sob a curva (<em>Area Under the Curve</em> – AUC) e seu intervalo de confiança de 95% podem ser obtidos com os comandos usados na construção da <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>21.4</span></a> ou separadamente usando as funções <code>auc()</code> e <code>ci.auc()</code> do pacote <code>pROC</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc1) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.5891</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span> (roc1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.4883-0.6864 (2000 stratified bootstrap replicates)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc2) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.6735-0.8342 (2000 stratified bootstrap replicates)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc3) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.8349-0.9385 (2000 stratified bootstrap replicates)</code></pre>
</div>
</div>
<p>A acurácia geral de um teste pode ser descrita como a área sob a curva; quanto maior for a área, melhor será o teste. Na <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>21.4</span></a>, o Teste 3 tem uma AUC maior que os outros dois testes.<br>
Usa-se a seguinte estimativa (<a href="#tbl-roc1" class="quarto-xref">Tabela&nbsp;<span>21.3</span></a>) para avaliar a acurácia de um teste ou da capacidade de identificar corretamente uma condição usando curva ROC <span class="citation" data-cites="borges2016accuracy">(<a href="referencias.html#ref-borges2016accuracy" role="doc-biblioref">15</a>)</span>:</p>
<div class="cell">
<div id="tbl-roc1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;21.3: Acurácia do teste diagnóstico
</figcaption>
<div aria-describedby="tbl-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-3a2d80e8{}.cl-3a276ed8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3a276ee2{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3a29f40a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3a2a0b34{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3a2a0b3e{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3a2a0b48{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3a2a0b49{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3a2a0b4a{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3a2a0b52{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-3a2d80e8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-3a2a0b34"><p class="cl-3a29f40a"><span class="cl-3a276ed8">AUC</span></p></th><th class="cl-3a2a0b3e"><p class="cl-3a29f40a"><span class="cl-3a276ed8">Qualidade do Teste</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b48"><p class="cl-3a29f40a"><span class="cl-3a276ee2">&gt;0,90</span></p></td><td class="cl-3a2a0b49"><p class="cl-3a29f40a"><span class="cl-3a276ee2">excelente</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b48"><p class="cl-3a29f40a"><span class="cl-3a276ee2">0,80 a 0,90</span></p></td><td class="cl-3a2a0b49"><p class="cl-3a29f40a"><span class="cl-3a276ee2">muito bom</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b48"><p class="cl-3a29f40a"><span class="cl-3a276ee2">0,70 a 0,80</span></p></td><td class="cl-3a2a0b49"><p class="cl-3a29f40a"><span class="cl-3a276ee2">bom</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b48"><p class="cl-3a29f40a"><span class="cl-3a276ee2">0,60 a 0,70</span></p></td><td class="cl-3a2a0b49"><p class="cl-3a29f40a"><span class="cl-3a276ee2">suficiente</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b48"><p class="cl-3a29f40a"><span class="cl-3a276ee2">0,50 a 0,60</span></p></td><td class="cl-3a2a0b49"><p class="cl-3a29f40a"><span class="cl-3a276ee2">ruim</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3a2a0b4a"><p class="cl-3a29f40a"><span class="cl-3a276ee2">&lt;0,50</span></p></td><td class="cl-3a2a0b52"><p class="cl-3a29f40a"><span class="cl-3a276ee2">ignorar teste</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Desta forma, o Teste 3 pode ser considerado um bom teste e o Teste 1 é um teste ruim.</p>
<p><u>Comparando duas curvas</u></p>
<p>Pode-se comparar duas curvas ROC com a função <code>roc.test()</code>, por exemplo, comparando as curvas dos Teste 3 e 2 <span class="citation" data-cites="delong1988comparing">(<a href="referencias.html#ref-delong1988comparing" role="doc-biblioref">16</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.test</span>(roc3, roc2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bootstrap test for two correlated ROC curves

data:  roc3 and roc2
D = 4.7993, boot.n = 2000, boot.stratified = 1, p-value = 1.592e-06
alternative hypothesis: true difference in AUC is not equal to 0
sample estimates:
Smoothed AUC of roc1 Smoothed AUC of roc2 
           0.8980454            0.7616201 </code></pre>
</div>
</div>
<p>O Teste 3 tem uma AUC que o caracteriza como um bom teste e o teste de DeLong, entregue na saída do <code>roc.test()</code>, resultou que a diferença entre ele o Teste 2 é estatisticamente significativa (<em>P</em> &lt; 0,0001).</p>
</section>
<section id="melhor-ponto-de-corte" class="level4" data-number="21.6.2.2">
<h4 data-number="21.6.2.2" class="anchored" data-anchor-id="melhor-ponto-de-corte"><span class="header-section-number">21.6.2.2</span> Melhor ponto de corte</h4>
<p>O melhor ponto de corte (<em>Best Critical Value</em>), que às vezes é chamado de <em>ponto de diagnóstico ótimo</em> ou <em>de Youden</em>, é o ponto da curva mais próximo da parte superior do eixo <em>y</em> (<a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>21.4</span></a>, Teste 3). Este é o ponto em que a taxa de verdadeiros positivos é otimizada e a taxa de falsos positivos é minimizada. O melhor ponto de corte para o Teste 3 é mostrado na <a href="#fig-roc3" class="quarto-xref">Figura&nbsp;<span>21.5</span></a>. Este melhor ponto de corte pode ser identificado a partir dos pontos de coordenadas da curva, usando a função <code>roc()</code> com os seguintes argumentos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     testes<span class="sc">$</span>teste3,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ci=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">thresholds=</span><span class="st">"best"</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres=</span><span class="st">"best"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">legacy.axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">""</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"1 - Especificidade"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>best</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = testes$doenca, predictor = testes$teste3,     ci = TRUE, plot = TRUE, thresholds = "best", print.thres = "best",     legacy.axes = TRUE, main = "", ylab = "Sensibilidade", xlab = "1 - Especificidade",     col = "steelblue", lwd = 2)

Data: testes$teste3 in 48 controls (testes$doenca 1) &gt; 97 cases (testes$doenca 2).
Area under the curve: 0.8973
95% CI: 0.8444-0.9502 (DeLong)</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-roc3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-testesDiag_files/figure-html/fig-roc3-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.5: Melhor ponte de corte
</figcaption>
</figure>
</div>
</div>
</div>
<p>Assim, para o <em>Teste 3</em>, o ponto de corte ideal é 24,8, onde a especificidade é igual a 0,854 e a sensibilidade é igual 0,845. Estes dados, fornecem um LR para um resultado positivo igual a:</p>
<p><span class="math display">\[
LR \left(+\right) = \frac{0.845}{\left (1-0.854\right)} = 5,79
\]</span></p>
<p>As coordenadas da curva ROC podem ser obtida com a seguinte programação, a partir de uma sensibilidade e especificidade acima de 0 (zero):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>coordenadas <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3) <span class="sc">%&gt;%</span> <span class="fu">coords</span> (<span class="at">transpose =</span> F)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coordenadas, <span class="dv">10</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   threshold specificity sensitivity
1        Inf  0.00000000           1
2      57.50  0.02083333           1
3      54.65  0.04166667           1
4      53.45  0.06250000           1
5      52.80  0.08333333           1
6      51.30  0.10416667           1
7      49.65  0.12500000           1
8      48.65  0.16666667           1
9      47.50  0.18750000           1
10     46.50  0.35416667           1</code></pre>
</div>
</div>
<p>A <em>estatística J de Youden</em> <span class="citation" data-cites="youden1950index">(<a href="referencias.html#ref-youden1950index" role="doc-biblioref">17</a>)</span> é calculada deduzindo 1 a partir da soma de sensibilidade e especificidade do teste e não é expressa como porcentagem, mas como parte de um número inteiro: <span class="math inline">\(\left (sensibilidade + especificidade\right) - 1\)</span>. A estatística J de Youden no melhor ponto de corte do Teste 3 é igual a <span class="math inline">\(\left (0,845+ 0,854\right) - 1 = 0,699\)</span>.</p>
<p>Este é o maior valor de todos os valores das coordenadas (91 valores) usadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>youden <span class="ot">&lt;-</span> <span class="fu">max</span>(coordenadas<span class="sc">$</span>sensitivity <span class="sc">+</span> coordenadas<span class="sc">$</span>specificity) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>youden</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6995275</code></pre>
</div>
</div>
<p>A <a href="#fig-roc3" class="quarto-xref">Figura&nbsp;<span>21.5</span></a> mostra o ponto de corte ideal. Ele também pode ser obtido com a função <code>coords()</code> do pacote <code>pRoc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc3, <span class="at">x =</span> <span class="st">"best"</span>, <span class="at">ret=</span><span class="st">"threshold"</span>, <span class="at">transpose =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">best.method=</span><span class="st">"youden"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  threshold
1      24.8</code></pre>
</div>
</div>
<p>O método para obter o melhor ponto de corte (<code>best.method</code>) pode ser pelo método de <code>youden</code> ou <code>closest.topleft</code>. No exemplo, o resultado é o mesmo. Para maiores detalhes consulte a ajuda da função <code>coord()</code>, do pacote <code>pROC</code>.</p>
</section>
</section>
</section>
<section id="estatística-kappa" class="level2" data-number="21.7">
<h2 data-number="21.7" class="anchored" data-anchor-id="estatística-kappa"><span class="header-section-number">21.7</span> Estatística <em>kappa</em></h2>
<p>A estatística de concordância <em>kappa</em> (<em>k</em>) de Cohen é utilizada para descrever a concordância entre dois ou mais avaliadores quando realizam uma avaliação nominal ou ordinal de uma mesma amostra <span class="citation" data-cites="cohen1960coefficient">(<a href="referencias.html#ref-cohen1960coefficient" role="doc-biblioref">18</a>)</span>. A estatística <em>kappa</em> corrige a chance do acaso nas avaliações e é obtida pela fórmula igual a:</p>
<p><span class="math display">\[
k= \frac{p_{o} - p_{e}}{1 - p_{e}}
\]</span></p>
<p>Onde <span class="math inline">\(p_{o}\)</span> = proporção observada de concordância e <span class="math inline">\(p_{e}\)</span> = proporção esperada de concordância apenas pelo acaso.</p>
<p>Por exemplo, dois radiologistas podem revisar independentemente uma série de radiografias do tórax de pacientes para determinar a presença ou ausência de pneumonia. Para avaliar o grau de concordância entre as classificações dos dois médicos, pode ser relatado o percentual de concordância entre os avaliadores (por exemplo, 50% dos avaliadores responderam “sim” nas duas ocasiões). No entanto, esse percentual pode ser enganoso, pois não leva em conta o nível de concordância entre os dois avaliadores que pode ocorrer por acaso. A estatística <em>kappa</em> pode ser usada para avaliar a concordância das respostas para dois ou mais avaliadores após considerar a concordância casual. Portanto, a estatística <em>kappa</em> é uma estimativa da proporção de concordância entre avaliadores que excede a concordância que ocorreria por acaso.</p>
<p>A interpretação dos valores de <em>kappa</em> é mostrada na <a href="#tbl-kappa" class="quarto-xref">Tabela&nbsp;<span>21.4</span></a> <span class="citation" data-cites="landis1977measurement">(<a href="referencias.html#ref-landis1977measurement" role="doc-biblioref">19</a>)</span>. Quando a proporção observada de concordância é menor que a esperada por acaso, o <em>kappa</em> terá um valor negativo indicando não concordância. Um valor de <em>kappa</em> igual a 0 indica que a concordância observada é igual à concordância casual.</p>
<p>O teste de hipóteses testa a hipótese de que a concordância entre os dois avaliadores seja puramente aleatória. Quando o valor <em>P</em> é menor que 0,05, rejeitamos a hipótese de que a concordância foi puramente aleatória. As premissas para o <em>kappa</em> de Cohen são que os participantes ou itens a serem classificados são independentes e também que os avaliadores e categorias são independentes.</p>
<div class="cell">
<div id="tbl-kappa" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kappa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;21.4: Valor Kappa e nível de concordância
</figcaption>
<div aria-describedby="tbl-kappa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-3ea8cd80{}.cl-3e894528{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3e894532{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3e8c32ce{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3e8c32e2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3e8c4f7a{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f84{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f85{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f8e{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f8f{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f90{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f98{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3e8c4f99{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-3ea8cd80"><thead><tr style="overflow-wrap:break-word;"><th class="cl-3e8c4f7a"><p class="cl-3e8c32ce"><span class="cl-3e894528">Valor kappa</span></p></th><th class="cl-3e8c4f84"><p class="cl-3e8c32ce"><span class="cl-3e894528">Concordância</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f85"><p class="cl-3e8c32e2"><span class="cl-3e894532">&lt;0,00</span></p></td><td class="cl-3e8c4f8e"><p class="cl-3e8c32ce"><span class="cl-3e894532">pobre</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f8f"><p class="cl-3e8c32e2"><span class="cl-3e894532">0,00 - 0,20</span></p></td><td class="cl-3e8c4f90"><p class="cl-3e8c32ce"><span class="cl-3e894532">leve</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f8f"><p class="cl-3e8c32e2"><span class="cl-3e894532">0,21 - 0,40</span></p></td><td class="cl-3e8c4f90"><p class="cl-3e8c32ce"><span class="cl-3e894532">razoável</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f8f"><p class="cl-3e8c32e2"><span class="cl-3e894532">0,41 - 0,60</span></p></td><td class="cl-3e8c4f90"><p class="cl-3e8c32ce"><span class="cl-3e894532">moderada</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f8f"><p class="cl-3e8c32e2"><span class="cl-3e894532">0,61 - 0,80</span></p></td><td class="cl-3e8c4f90"><p class="cl-3e8c32ce"><span class="cl-3e894532">substancial</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3e8c4f98"><p class="cl-3e8c32e2"><span class="cl-3e894532">0,81 - 1,00</span></p></td><td class="cl-3e8c4f99"><p class="cl-3e8c32ce"><span class="cl-3e894532">quase perfeita</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Existem diferentes tipos de estatísticas <em>kappa</em>. Para dados com três ou mais categorias possíveis (por exemplo, concordo, concordo parcialmente, discordo) ou para dados categóricos ordenados, o <em>kappa</em> ponderado deve ser usado para que as respostas que estão mais distantes da concordância tenham maior peso do que aquelas próximas à concordância. No exemplo usado, as categorias possíveis são dicotômicas (sim e não), portanto, o kappa não ponderado (<em>unweighted</em>) e o ponderado (<em>weighted</em>) retornam o mesmo resultado.</p>
<section id="sec-exkappa" class="level3" data-number="21.7.1">
<h3 data-number="21.7.1" class="anchored" data-anchor-id="sec-exkappa"><span class="header-section-number">21.7.1</span> Dados do exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cinquenta e quatro crianças com suspeita de pneumonia realizaram radiografias de tórax para confirmar o diagnóstico. Essas radiografias foram avaliadas por dois radiologistas.</p>
</div>
</div>
<p>O arquivo <code>dadosPneumonia.xlsx</code> contém os dados dos diagnósticos independentes dos dois radiologistas. O objetivo foi medir a concordância diagnóstica dos dois profissionais. Para o cálculo do coeficiente <em>kappa</em>, será usada a função <code>Kappa()</code> do pacote <code>vcd</code> <span class="citation" data-cites="zeileis2007residual">(<a href="referencias.html#ref-zeileis2007residual" role="doc-biblioref">20</a>)</span>. Essa função tem os seguintes argumentos:</p>
<ul>
<li><strong>x</strong> <span class="math inline">\(\longrightarrow\)</span> matriz ou tabela</li>
<li><strong>weights</strong> <span class="math inline">\(\longrightarrow\)</span> matriz especificada pelo usuário com as mesmas dimensões de <em>x</em>, desnecessário para <em>kappa</em> não ponderado.</li>
</ul>
<p>Na impressão do <em>kappa</em> pode-se usar <code>print (k, digits = 3, CI = TRUE, level = 0.95)</code>. Onde <em>k</em> é o coeficiente de <em>kappa</em>, calculado pela função <code>Kappa()</code>, <em>CI</em> é o intervalo de confiança e o nível de confiança padrão é 95%.</p>
<section id="leitura-e-exploração-dos-dados" class="level4" data-number="21.7.1.1">
<h4 data-number="21.7.1.1" class="anchored" data-anchor-id="leitura-e-exploração-dos-dados"><span class="header-section-number">21.7.1.1</span> Leitura e exploração dos dados</h4>
<p>O conjunto de dados <code>dadosPneumonia.xlsx</code> pode ser obtido <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosPneumonia.xlsx"><strong>aqui</strong></a>. Após salvar o arquivo em seu diretório, ele pode ser carregado com a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosPneumonia.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construção-da-tabela" class="level4" data-number="21.7.1.2">
<h4 data-number="21.7.1.2" class="anchored" data-anchor-id="construção-da-tabela"><span class="header-section-number">21.7.1.2</span> Construção da tabela</h4>
<p>O cálculo do <em>kappa</em> com a função <code>Kappa()</code> exige uma tabela, onde os dados dos dois radiologistas são cruzados. As variáveis a serem cruzadas são <code>rx1</code> e <code>rx2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx1,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))                           </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx2,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>tabk <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(rx1, rx2, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Radiologista 1"</span>, <span class="st">"Radiologista 2"</span>)))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tabk, <span class="at">FUN =</span> sum)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margins computed over dimensions
in the following order:
1: Radiologista 1
2: Radiologista 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              Radiologista 2
Radiologista 1 sim não sum
           sim  32   5  37
           não   3  14  17
           sum  35  19  54</code></pre>
</div>
</div>
</section>
<section id="cálculo-do-kappa" class="level4" data-number="21.7.1.3">
<h4 data-number="21.7.1.3" class="anchored" data-anchor-id="cálculo-do-kappa"><span class="header-section-number">21.7.1.3</span> Cálculo do <em>kappa</em></h4>
<p>O <em>kappa</em> é dado pela execução da função:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> vcd<span class="sc">::</span><span class="fu">Kappa</span>(tabk)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (k, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">digits=</span> <span class="dv">3</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">CI=</span><span class="cn">TRUE</span>, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           value   ASE    z Pr(&gt;|z|) lower upper
Unweighted 0.667 0.107 6.21 5.42e-10 0.456 0.878
Weighted   0.667 0.107 6.21 5.42e-10 0.456 0.878</code></pre>
</div>
</div>
<p>A saída exibe o <em>kappa</em> pontual e os intervalos de confiança de 95%, podendo-se concluir, desses resultados, que existe uma boa confiabilidade nos diagnósticos dos radiologistas (k = 0,67, concordância substancial,de acordo com a <a href="#tbl-kappa" class="quarto-xref">Tabela&nbsp;<span>21.4</span></a>).</p>


<!-- -->

<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-straus2019screening" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Straus SE, Glasziou P, et al. Diagnosis and screening. Em: Evidence-Based Medicine: How to Practice and Teach EBM. Fifth Edition. Edinburgh: Elsevier; 2019. p. 185–218. </div>
</div>
<div id="ref-altman1994diagnostic" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests. 1: Sensitivity and specificity. BMJ: British Medical Journal. 1994;308(6943):1552. </div>
</div>
<div id="ref-peixoto2011indices" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Peixoto R de O, Nunes TA, Gomes CA. Indices diagnósticos da ultrassonografia abdominal na apendicite aguda: influência do genero e constituição física, tempo evolutivo da doença e experiencia do radiologista. Revista do Colégio Brasileiro de Cirurgiões. 2011;38:105–11. </div>
</div>
<div id="ref-stevenson2022epir" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Mark, Sergeant E, et al. epiR: Tools for the Analysis of Epidemiological Data [Internet]. 2022. Disponível em: <a href="https://CRAN.R-project.org/package=epiR">https://CRAN.R-project.org/package=epiR</a></div>
</div>
<div id="ref-altman1994predictive" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 2: predictive values. Bmj. 1994;309(6947):102. </div>
</div>
<div id="ref-lima2016perfil" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Pereira Lima A, Vieira FJ, Oliveira GP de M, et al. Perfil clinico-epidemiologico da apendicite aguda: analise retrospectiva de 638 casos. Revista do Colegio Brasileiro de Cirurgiões. 2016;43:248–53. </div>
</div>
<div id="ref-halkin1998likelihood" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Halkin A, Reichman J, Schwaber M, Paltiel O, Brezis M. Likelihood ratios: getting diagnostic testing into perspective. QJM: monthly journal of the Association of Physicians. 1998;91(4):247–58. </div>
</div>
<div id="ref-deeks2004likelihood" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Deeks JJ, Altman DG. Diagnostic tests 4: likelihood ratios. Bmj. 2004;329(7458):168–9. </div>
</div>
<div id="ref-guyatt2015diagnostic" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Guyatt G, Rennie D, et al. Diagnostic Tests. Em: User’s Guides to Medical Literature: A Manual for Evidence-Based Clinical Practice. 3rd Edition. New York: JAMA; 2015. p. 607–31. </div>
</div>
<div id="ref-oliveira2022diagnostico" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Oliveira Filho PF de. Testes Diagnósticos. Em: Epidemiologia e Bioestatística: Fundamentos para a leitura crítica. Segunda Edição. Rio de Janeiro: Editora Rubio; 2022. p. 89–105. </div>
</div>
<div id="ref-fagan1975nomogram" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Fagan T. Nomogram for Bayes’s theorem. New England Journal of Medicine. 1975;293:257. </div>
</div>
<div id="ref-caraguel2013fagan" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Caraguel CG, Vanderstichel R. The two-step Fagan’s nomogram: ad hoc interpretation of a diagnostic test result without calculation. BMJ Evidence-Based Medicine. 2013;18(4):125–8. </div>
</div>
<div id="ref-altman1994roc" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 3: receiver operating characteristic plots. BMJ: British Medical Journal. 1994;309(6948):188. </div>
</div>
<div id="ref-robin2011proc" class="csl-entry" role="listitem">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Robin X, Turck N, Hainard A, et al. pROC: an open-source package for R and S+ to analyze and compare ROC curves. BMC Bioinformatics. 2011;12(1):1–8. </div>
</div>
<div id="ref-borges2016accuracy" class="csl-entry" role="listitem">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Borges LSR. Diagnostic accuracy measures in cardiovascular research. Int J Cardiovasc Sci. 2016;29(3):218–22. </div>
</div>
<div id="ref-delong1988comparing" class="csl-entry" role="listitem">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">DeLong ER, DeLong DM, Clarke-Pearson DL. Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach. Biometrics. 1988;44:837–45. </div>
</div>
<div id="ref-youden1950index" class="csl-entry" role="listitem">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Youden WJ. Index for rating diagnostic tests. Cancer. 1950;3(1):32–5. </div>
</div>
<div id="ref-cohen1960coefficient" class="csl-entry" role="listitem">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Cohen J. A coefficient of agreement for nominal scales. Educational and Psychological Measurement. 1960;20(1):37–46. </div>
</div>
<div id="ref-landis1977measurement" class="csl-entry" role="listitem">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Landis JR, Koch GG. The measurement of observer agreement for categorical data. Biometrics. 1977;159–74. </div>
</div>
<div id="ref-zeileis2007residual" class="csl-entry" role="listitem">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Zeileis A, Meyer D, Hornik K. Residual-based shadings for visualizing (conditional) independence. Journal of Computational and Graphical Statistics. 2007;16(3):507–25. </div>
</div>
</div>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Verossimilhança no sentido de a qualidade de algo que parece verdadeiro ou provável, que não contraria a verdade<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Existem duas maneiras de descrever uma estimativa de odds: ou como um número isolado, por exemplo, 0,25, subentendendo que expressa uma razão, 0,25:1,0, ou de forma clara como uma razão 1:4. Ou seja, para cada indivíduo com o fator existem quatro sem o fator. Tradicional e comumente usados no mundo das apostas em corridas de cavalos.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./20-testes-naoParametricos.html" class="pagination-link" aria-label="Métodos não paramétricos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./22-medidasOcorrencia.html" class="pagination-link" aria-label="Medidas de ocorrência de doença">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb56" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Determinação da validade e confiabilidade de testes diagnósticos</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pacotes necessários neste capítulo</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>               epiR,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>               flextable,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>               pROC,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>               vcd)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Raciocínio Bayesiano no diagnóstico médico  {#sec-diagbayes}</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>O processo diagnóstico é o centro da atenção da atividade médica na busca de reduzir as incertezas e reconhecer a que classe pertence determinado paciente. Portanto, é extremamente importante saber quão bem os testes diagnósticos podem prever que um indivíduo é portador de certa condição ou doença. Entende-se aqui como teste diagnóstico todo o processo diagnótico, desde o exame clínico até o mais sofisticado exame de imagem ou laboratorial. A ideia é saber como o teste diagnóstico se comporta para separar um "doente" e um "não doente"; qual a sua validade neste processo?</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>Deve-se sempre ter em mente que o estabelecimento do diagnóstico é um processo imperfeito que resulta em uma probabilidade ao invés de uma certeza de estar correto. Ou seja, cada vez mais os médicos têm que aplicar as leis da probabilidade na avaliação de testes diagnósticos e sinais clínicos.</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>A abordagem Bayesiana denomina de **probabilidade a priori** a probabilidade estabelecida inicialmente, baseada apenas na experiência do médico, em seu conhecimento em relação a doença suspeitada. Diante de uma evidência de doença, pode ser solictado um teste diagnóstico. Quando ele recebe um teste positivo para uma doença, a probabilidade muda, passa a ser uma probabilidade condicional, probabilidade da doença dado que o teste é positivo, denominada **probabilidade a posteriori**.</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>Um teste que define corretamente quem é doente e quem não é doente é denominado de **padrão-ouro** ou **padrão de referência**. Algumas vezes, o teste padrão de referência é simples e barato. Outras vezes, é caro, difícil de obter, tecnicamente complexo, arriscado ou pouco prático. Inclusive, pode não hver padrão-ouro. Em função dessas limitações, outros testes são usados e, como consequência, podem ocorrer erros. Em outras palavras, no processo diagnóstico podem ocorrer **falsos positivos** e **falsos negativos**. Esta incerteza, na utilização de testes diagnósticos, gera a necessidade de o médico conferir a probabilidade de falsos positivos e falsos negativos na elaboração de um diagnóstico ao receber o resultado positivo ou negativo de um exame. Uma maneira simples de mostrar as relações de um teste diagnóstico e o verdadeiro diagnóstico, é mostrada na tabela de contingência $2\times2$ (@tbl-fpfn).</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fpfn</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Falsos positivos e falsos negativos"</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/udFZ2ek.png"</span>)</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sensibilidade e Especificidade</span></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>As estatísticas mais utilizadas para descrever a validade dos testes de diagnóstico em contextos clínicos são sensibilidade e a especificidade.</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>**Sensibilidade** é a habilidade do teste em identificar corretamente quem tem a doença. É a taxa de verdadeiros positivos (VP) de um teste e corresponde a probabilidade de um indivíduo com a doença ter um teste positivo.</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>Um teste sensível raramente deixará passar pessoas que tenham a doença. Testes com sensibilidade alta são úteis para *excluir* a presença de uma doença. Isto é, um teste negativo exclui virtualmente a possibilidade de o paciente ter a doença de interesse, pois tem pouca probabilidade de produzir resultados falsos negativos. Isto pode ser lembrado pelo mnemônico *SnNout*, do inglês: *High Sensivity, a Negative result rules out the diagnosis* @straus2019screening.</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>**Especificidade** é a habilidade do teste em identificar corretamente quem não tem a doença. É a taxa de verdadeiros negativos (VN) de um teste e corresponde a probabilidade de um indivíduo sem a doença ter um teste negativo. Um teste específico raramente classificará de forma errônea indivíduos sendo portadores da doença quando eles não são. Os testes muito específicos são usados para *confirmar* a presença da doença. Se o teste é altamente específico, um teste positivo sugere fortemente a presença da doença de interesse.</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>De forma similar que a sensibilidade pode-se usar o mnemônico *SpPin*, do inglês: *High Specificity, a Positive result rules in the diagnosis* @straus2019screening.</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>Estas estatísticas de diagnóstico podem ser calculadas a partir das equações, cujas letras representam as caselas da tabela $2 \times 2$ da @tbl-fpfn;</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>Sensibilidade = \frac {a}{\left (a + c\right )} \quad \quad Especificidade = \frac {d}{\left (b + d\right )}</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>A **taxa de falsos negativos** (TFN) é a proporção de indivíduos que têm a doença e que têm um resultado de teste negativo e a **taxa de falsos positivos** (TFP) é a proporção de pacientes que não possuem a doença e que apresentam resultados positivos. Podem ser expressas pelas equações:</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>TFN= \frac {c}{\left (a + c\right )} \quad ou \quad \left (1 - sensibilidade\right)</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>TFP= \frac {b}{\left (b + d\right )} \quad ou \quad \left (1 - especifcidade\right)</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>Idealmente, um teste de diagnóstico deveria ter altos níveis de sensibilidade e especificidade. No entanto, isso não é possível, pois existe um balanço entre sensibilidade e especificidade. À medida que a especificidade aumenta, a sensibilidade diminui e vice-versa. As curvas ROC podem ser usadas para identificar um ponto de corte em uma medição contínua que maximize a sensibilidade e a especificidade (veja @sec-rocurve).</span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>Quando um clínico tem um paciente cujo teste apresentou resultado positivo, a pergunta mais importante é a seguinte: dado que o teste é positivo, qual é a probabilidade de o paciente ter a doença? A sensibilidade do teste não responde a este questionamento, mas sim a probabilidade de um resultado positivo, dado que o paciente tem a doença @altman1994diagnostic.</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados do exemplo {#sec-exapendicite}</span></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>Foram avaliados 156 pacientes com diagnóstico clínico de apendicite aguda, submetidos à ultrassonografia abdominal e apendicectomia laparoscópica, acompanhado de estudo anatomopatológico dos apêndices extirpados @peixoto2011indices.</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>Os dados estão contidos no conjunto de dados <span class="in">`dadosApendicite.xlsx`</span> que pode ser obtido <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosApendicite.xlsx)</span>. Salve o mesmo em seu diretório de trabalho.</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Leitura e observação dos dados</span></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a>Será usado a função <span class="in">`read_excel()`</span>do pacote <span class="in">`readxl`</span> para ler os dados e a função <span class="in">`str()`</span> para observar a sua estrutura:</span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosApendicite.xlsx"</span>)</span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a>As variáveis <span class="in">`apendicite`</span> e <span class="in">`eco`</span> foram exibidas como variáveis numéricas e serão transformadas em fatores:</span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>apendicite <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>apendicite,</span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Presente"</span>, </span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ausente"</span>))</span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>eco <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>eco,</span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Positivo"</span>, </span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Negativo"</span>))</span>
<span id="cb56-109"><a href="#cb56-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-110"><a href="#cb56-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Construção de uma tabela de contingência 2\$\times\$2</span></span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-115"><a href="#cb56-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-116"><a href="#cb56-116" aria-hidden="true" tabindex="-1"></a>tab_ap <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(eco, apendicite, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Eco"</span>, <span class="st">"Apendicite"</span>)))</span>
<span id="cb56-117"><a href="#cb56-117" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab_ap, <span class="at">FUN =</span> sum)</span>
<span id="cb56-118"><a href="#cb56-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-119"><a href="#cb56-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-120"><a href="#cb56-120" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Avaliação do teste diagnóstico através da sensibilidade e da especificidade</span></span>
<span id="cb56-121"><a href="#cb56-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-122"><a href="#cb56-122" aria-hidden="true" tabindex="-1"></a>Pode-se usar a função <span class="in">`epi.tests()`</span> do pacote <span class="in">`epiR`</span> @stevenson2022epir que calcula, junto com os intervalos de confiança exatos, a prevalência aparente e verdadeira, sensibilidade, especificidade, valores preditivos positivos e negativos e razões de probabilidade positivas e negativas a partir de dados de contagem fornecidos em uma tabela $2\times2$. Utiliza os argumentos</span>
<span id="cb56-123"><a href="#cb56-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-124"><a href="#cb56-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**dat** \to dados sob a forma de vetor ou matriz\</span>
<span id="cb56-125"><a href="#cb56-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**conf.level** \to magnitude do intervalode confiança, entre 0 e 1.</span>
<span id="cb56-126"><a href="#cb56-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-127"><a href="#cb56-127" aria-hidden="true" tabindex="-1"></a>Os resultados serão atribuídos a um objeto de nome <span class="in">`diag`</span>:</span>
<span id="cb56-128"><a href="#cb56-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-131"><a href="#cb56-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-132"><a href="#cb56-132" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> epiR<span class="sc">::</span><span class="fu">epi.tests</span>(tab_ap, </span>
<span id="cb56-133"><a href="#cb56-133" aria-hidden="true" tabindex="-1"></a>                        <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb56-134"><a href="#cb56-134" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diag)</span>
<span id="cb56-135"><a href="#cb56-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-136"><a href="#cb56-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-137"><a href="#cb56-137" aria-hidden="true" tabindex="-1"></a>Assim, a sensibilidade é igual a 65% (IC95%: 56 – 73%) e a especificidade é igual a 72% (IC95%: 51 – 88%). Isto significa que um indivíduo com apendicite aguda tem 65% de probabilidade de ter uma ecografia alterada; um indivíduo sem apendicite aguda tem 72% de probabilidade de ter uma ecografia normal. O objetivo do teste de diagnóstico é usá-lo para fazer um diagnóstico, então há necessidade de saber a probabilidade que o teste fornece para um diagnóstico correto. A sensibilidade e a especificidade não fornecem esta informação. Para atingir esse objetivo, usa-se o **valor preditivo** @altman1994predictive.</span>
<span id="cb56-138"><a href="#cb56-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-139"><a href="#cb56-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Valor Preditivo</span></span>
<span id="cb56-140"><a href="#cb56-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-141"><a href="#cb56-141" aria-hidden="true" tabindex="-1"></a>O propósito de um teste diagnóstico é usar seus resultados para fazer um diagnóstico, portanto, é necessário conhecer a probabilidade de que o resultado do teste forneça o diagnóstico correto @altman1994predictive.</span>
<span id="cb56-142"><a href="#cb56-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-143"><a href="#cb56-143" aria-hidden="true" tabindex="-1"></a>Os valores preditivos positivo e negativo descrevem a probabilidade de um paciente ter doença, uma vez que os resultados de seus testes são conhecidos.</span>
<span id="cb56-144"><a href="#cb56-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-145"><a href="#cb56-145" aria-hidden="true" tabindex="-1"></a>O **valor preditivo positivo** (VPP) de um teste é definido como a proporção de pessoas com um resultado de teste positivo que realmente têm a doença.</span>
<span id="cb56-146"><a href="#cb56-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-147"><a href="#cb56-147" aria-hidden="true" tabindex="-1"></a>O **valor preditivo negativo** (VPN) é a proporção de pacientes com resultados de teste negativos que não têm doença.</span>
<span id="cb56-148"><a href="#cb56-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-149"><a href="#cb56-149" aria-hidden="true" tabindex="-1"></a>Como a sensibilidade e a especificidade, estas estatísticas de diagnóstico também podem ser calculadas a partir da tabela $2\times2$, mostrada no início:</span>
<span id="cb56-150"><a href="#cb56-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-151"><a href="#cb56-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-152"><a href="#cb56-152" aria-hidden="true" tabindex="-1"></a>VPP = \frac {a}{\left (a + b\right )} \quad \quad VPN = \frac {d}{\left (c + d\right )}</span>
<span id="cb56-153"><a href="#cb56-153" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-154"><a href="#cb56-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-155"><a href="#cb56-155" aria-hidden="true" tabindex="-1"></a>Observando os resultados anteriores da função <span class="in">`epi.tests()`</span>, verifica-se que 92% (85/92) dos indivíduos que tiveram teste positivo (ultrassonografia alterada) tinham doença (apendicite aguda). Isso significa que seu VPP é igual a 92% (IC95%: 18 – 41%), ou dito de outra forma, uma pessoa com ultrassonografia positiva tem 92% de probabilidade de ter a apendicite aguda. O VPP é também conhecido como **probabilidade pós-teste** de doença dado um teste positivo.</span>
<span id="cb56-156"><a href="#cb56-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-157"><a href="#cb56-157" aria-hidden="true" tabindex="-1"></a>Dos 64 pacientes que tiveram ultrassonografia sem alterações, 18 não apresentaram apendicite aguda, portanto, um VPN de 28% (IC95%: 56 – 73%). Isso significa que uma pessoa quem tem um teste negativo tem 28,1% de probabilidade de não ter apendicite aguda.</span>
<span id="cb56-158"><a href="#cb56-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-159"><a href="#cb56-159" aria-hidden="true" tabindex="-1"></a>Entretanto, essas proporções são de validade limitada. Os valores preditivos de um teste, na prática clínica, dependem criticamente da prevalência da anormalidade nos pacientes testados. No estudo, a prevalência de apendicite aguda é igual a</span>
<span id="cb56-160"><a href="#cb56-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-161"><a href="#cb56-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-162"><a href="#cb56-162" aria-hidden="true" tabindex="-1"></a>\frac {total\ de\ casos\ de \ apendicite \ aguda}{total\ de\ casos\ no\ estudo} = \frac {131}{156} = 0,84\ ou\ 84\% \left(IC_{95\%}:77\ a\ 89\%\right)</span>
<span id="cb56-163"><a href="#cb56-163" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-164"><a href="#cb56-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-165"><a href="#cb56-165" aria-hidden="true" tabindex="-1"></a>Levando-se em consideração que a prevalência de apendicite aguda na população é de 7% @lima2016perfil, mantendo a sensibilidade (64%) e a especificidade (72%) da ultrassonografia, entre 156 pacientes, selecionados aleatoriamente, se esperaria encontrar aproximadamente 11 casos (7% de 156) de apendicite aguda. Para facilitar a compreensão, observe a a tabela $2\times2$ (@tbl-vpp):</span>
<span id="cb56-166"><a href="#cb56-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-169"><a href="#cb56-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-170"><a href="#cb56-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-vpp</span></span>
<span id="cb56-171"><a href="#cb56-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-172"><a href="#cb56-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-173"><a href="#cb56-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: '70%'</span></span>
<span id="cb56-174"><a href="#cb56-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-175"><a href="#cb56-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-176"><a href="#cb56-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Prevalencia e valor preditivo"</span></span>
<span id="cb56-177"><a href="#cb56-177" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/s0tdwod.png"</span>)</span>
<span id="cb56-178"><a href="#cb56-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-179"><a href="#cb56-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-180"><a href="#cb56-180" aria-hidden="true" tabindex="-1"></a>O VPP e o VPN são iguais a:</span>
<span id="cb56-181"><a href="#cb56-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-184"><a href="#cb56-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-185"><a href="#cb56-185" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb56-186"><a href="#cb56-186" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">41</span></span>
<span id="cb56-187"><a href="#cb56-187" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb56-188"><a href="#cb56-188" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">104</span></span>
<span id="cb56-189"><a href="#cb56-189" aria-hidden="true" tabindex="-1"></a>vpp <span class="ot">=</span> a<span class="sc">/</span>(a <span class="sc">+</span> b)</span>
<span id="cb56-190"><a href="#cb56-190" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpp, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb56-191"><a href="#cb56-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-192"><a href="#cb56-192" aria-hidden="true" tabindex="-1"></a>vpn <span class="ot">=</span> d<span class="sc">/</span>(c <span class="sc">+</span> d)</span>
<span id="cb56-193"><a href="#cb56-193" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpn, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb56-194"><a href="#cb56-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-195"><a href="#cb56-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-196"><a href="#cb56-196" aria-hidden="true" tabindex="-1"></a>Ao se comparar o VPP obtido, agora, com o VPP do estudo, observa-se que o mesmo diminuiu bastante, de 92% para 14,6%. O contrário ocorre com a VPN que aumenta substancialmente de 28% para 96,3%, mostrando claramente a influência da prevalência.</span>
<span id="cb56-197"><a href="#cb56-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-198"><a href="#cb56-198" aria-hidden="true" tabindex="-1"></a>Se a prevalência diminui, o VPP diminui e o VPN aumenta. Portanto, será errado aplicar diretamente os valores preditivos publicados de um teste ao seu pacciente, quando a prevalência da doença em sua população for diferente da prevalência da doença na população em que o estudo publicado foi realizado. Um teste pode ser útil em um lugar e não ter validade em outro onde a prevalência é muito baixa.</span>
<span id="cb56-199"><a href="#cb56-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-200"><a href="#cb56-200" aria-hidden="true" tabindex="-1"></a>Pode-se chegar aos mesmos resultados, usando as equações:</span>
<span id="cb56-201"><a href="#cb56-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-202"><a href="#cb56-202" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-203"><a href="#cb56-203" aria-hidden="true" tabindex="-1"></a>VPP =\frac{sens \times prev}{\left(sens \times prev\right) + \left <span class="co">[</span><span class="ot">\left (1- espec\right) \times \left (1- prev\right)\right </span><span class="co">]</span>}</span>
<span id="cb56-204"><a href="#cb56-204" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-205"><a href="#cb56-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-206"><a href="#cb56-206" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-207"><a href="#cb56-207" aria-hidden="true" tabindex="-1"></a>VPN =\frac{espec\times \left (1- prev\right)}{\left<span class="co">[</span><span class="ot">\left (1 - sens \right)\times prev\right</span><span class="co">]</span>+\left<span class="co">[</span><span class="ot">espec\times \left (1 - prev\right)\right</span><span class="co">]</span>}</span>
<span id="cb56-208"><a href="#cb56-208" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-209"><a href="#cb56-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-210"><a href="#cb56-210" aria-hidden="true" tabindex="-1"></a>A prevalência pode ser interpretada como a probabilidade antes da realização do teste, conhecida como *probabilidade pré-teste*. A diferença entre as probabilidades pré e pós-teste é uma forma de avaliar a utilidade do teste. Esta diferença pode ser mensurada pela **razão de probabilidade** (**likelihood ratio**).</span>
<span id="cb56-211"><a href="#cb56-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-212"><a href="#cb56-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Razão de Probabilidade</span></span>
<span id="cb56-213"><a href="#cb56-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-214"><a href="#cb56-214" aria-hidden="true" tabindex="-1"></a>A **Razão de Probabilidades** (*likelihood ratio*) é uma forma alternativa de descrever o desempenho de um teste diagnóstico. Alguns autores a denominam de razão de verossimilhança <span class="ot">[^21-testesdiag-1]</span>.</span>
<span id="cb56-215"><a href="#cb56-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-216"><a href="#cb56-216" aria-hidden="true" tabindex="-1"></a><span class="ot">[^21-testesdiag-1]: </span>Verossimilhança no sentido de a qualidade de algo que parece verdadeiro ou provável, que não contraria a verdade</span>
<span id="cb56-217"><a href="#cb56-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-218"><a href="#cb56-218" aria-hidden="true" tabindex="-1"></a>A razão de probabilidades para um resultado de teste é definida como a razão entre a probabilidade de observar aquele resultado em indivíduos com a doença em questão e a probabilidade desse resultado em indivíduos sem a doença @halkin1998likelihood.</span>
<span id="cb56-219"><a href="#cb56-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-220"><a href="#cb56-220" aria-hidden="true" tabindex="-1"></a>Razões de probabilidade são, clinicamente, mais úteis do que sensibilidade e especificidade. Fornecem um resumo de quantas vezes mais (ou menos) a probabilidade de os indivíduos com a doença apresentarem aquele resultado específico do que os indivíduos sem a doença, e também podem ser usados para calcular a probabilidade de doença para pacientes individuais @deeks2004likelihood. Cada vez mais as razões de probabilidade estão se tornando populares para relatar a utilidade dos testes de diagnóstico.</span>
<span id="cb56-221"><a href="#cb56-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-222"><a href="#cb56-222" aria-hidden="true" tabindex="-1"></a>Quando os resultados do teste são relatados como sendo positivos ou negativos, dois tipos de razões de probabilidades podem ser descritos, a razão de probabilidades para um teste positivo (denotada LR +) e a razão de probabilidades para um teste negativo (denotada LR−).</span>
<span id="cb56-223"><a href="#cb56-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-224"><a href="#cb56-224" aria-hidden="true" tabindex="-1"></a>A *razão de probabilidades para um teste positivo* é definida como a probabilidade de um indivíduo com doença ter um teste positivo dividida pela probabilidade de um indivíduo sem doença ter um teste positivo. A fórmula para calcular LR + é</span>
<span id="cb56-225"><a href="#cb56-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-226"><a href="#cb56-226" aria-hidden="true" tabindex="-1"></a>Ou seja,</span>
<span id="cb56-227"><a href="#cb56-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-228"><a href="#cb56-228" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-229"><a href="#cb56-229" aria-hidden="true" tabindex="-1"></a>LR(+)=\frac{sensibilidade}{1 - especificidade}</span>
<span id="cb56-230"><a href="#cb56-230" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-231"><a href="#cb56-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-232"><a href="#cb56-232" aria-hidden="true" tabindex="-1"></a>Razão de probabilidades positiva maior que 1 significa que um teste positivo tem mais probabilidade de ocorrer em pessoas com a doença do que em pessoas sem a doença. De um modo geral, para os indivíduos que apresentam um resultado positivo, LR (+) <span class="sc">\&gt;</span> 10 aumenta significativamente a probabilidade de doença (“confirma” a doença), enquanto LR (+) <span class="sc">\&lt;</span> 0,1, virtualmente, exclui a probabilidade de uma pessoa ter a doença @guyatt2015diagnostic.</span>
<span id="cb56-233"><a href="#cb56-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-234"><a href="#cb56-234" aria-hidden="true" tabindex="-1"></a>Usando os dados incluídos no objeto <span class="in">`diag`</span>, obtido com a função <span class="in">`epi.tests()`</span> do pacote <span class="in">`epiR`</span>, tem-se que a LR (+) da ultrassonografia para o diagnóstico de apendicite aguda é igual 2.32 (IC95%: 1,22 – 4,40). Significa que uma pessoa com apendicite aguda tem cerca de 2,32 vezes mais probabilidade de ter um teste positivo do que uma pessoa que não tem a doença.</span>
<span id="cb56-235"><a href="#cb56-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-236"><a href="#cb56-236" aria-hidden="true" tabindex="-1"></a>A *razão de probabilidade negativa* é definida como a probabilidade de um indivíduo com doença ter um teste negativo dividido pela probabilidade de um indivíduo sem doença ter um teste negativo. A fórmula para calcular a LR− é:</span>
<span id="cb56-237"><a href="#cb56-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-238"><a href="#cb56-238" aria-hidden="true" tabindex="-1"></a>Ou seja,</span>
<span id="cb56-239"><a href="#cb56-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-240"><a href="#cb56-240" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-241"><a href="#cb56-241" aria-hidden="true" tabindex="-1"></a>LR(-)=\frac{sensibilidade}{1-especificidade}</span>
<span id="cb56-242"><a href="#cb56-242" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-243"><a href="#cb56-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-244"><a href="#cb56-244" aria-hidden="true" tabindex="-1"></a>Razão de probabilidade negativa menor que 1 significa que um teste negativo é menos provável de ocorrer em pessoas com a doença do que em pessoas sem a doença. Um LR muito baixo (abaixo de 0,1) praticamente exclui a chance de que uma pessoa tenha a doença @guyatt2015diagnostic.</span>
<span id="cb56-245"><a href="#cb56-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-246"><a href="#cb56-246" aria-hidden="true" tabindex="-1"></a>Voltando aos dados anteriores, a LR (-) para a ultrassonografia é igual a 0.49 (IC95%: 0.35 - 0.68). Significa que a probabilidade de ter um teste negativo para indivíduos com doença é 0,49 vezes ou cerca de metade daqueles sem a doença. Dito de outra forma, os indivíduos sem a doença têm cerca o dobro probabilidade de ter um teste negativo do que os indivíduos com a doença.</span>
<span id="cb56-247"><a href="#cb56-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-248"><a href="#cb56-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimando a probabilidade de doença</span></span>
<span id="cb56-249"><a href="#cb56-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-250"><a href="#cb56-250" aria-hidden="true" tabindex="-1"></a>Uma grande vantagem das razões de probabilidade é que elas podem ser usadas para ajudar o médico a adaptar a sensibilidade e a especificidade dos testes aos pacientes individuais. Ao se atender um paciente em uma clínica, pode-se decidir realizar um teste específico, após uma anamnese e um exame físico. A decisão de fazer o teste baseia-se nos sintomas e sinais do paciente e na experiência pessoal. Existe suspeita de um determinado diagnóstico e o objetivo é excluir ou confirmar esse diagnóstico. Antes de solicitar o teste, geralmente existe uma estimativa aproximada da probabilidade do paciente de ter essa doença, conhecida como **probabilidade pré-teste** ou **a priori**, que geralmente é estimada com base na experiência pessoal do médico, dados de prevalência local e publicações científicas.</span>
<span id="cb56-251"><a href="#cb56-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-252"><a href="#cb56-252" aria-hidden="true" tabindex="-1"></a>A razão mais importante pela qual um teste é realizado é tentar modificar a probabilidade de doença. Um teste positivo pode aumentar a probabilidade pós-teste e um teste negativo pode reduzir essa probabilidade. A probabilidade pós-teste de doença é o que mais interessa aos médicos e pacientes, pois isso pode ajudar a decidir se devem confirmar, descartar um diagnóstico ou realizar outros testes.</span>
<span id="cb56-253"><a href="#cb56-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-254"><a href="#cb56-254" aria-hidden="true" tabindex="-1"></a>Os resultados dos testes clínicos são geralmente usados não para fazer ou excluir categoricamente um diagnóstico, mas para modificar a probabilidade do pré-teste a fim de gerar a probabilidade do pós-teste. O teorema de Bayes é uma relação matemática que permite estimar a probabilidade pós-teste.</span>
<span id="cb56-255"><a href="#cb56-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-256"><a href="#cb56-256" aria-hidden="true" tabindex="-1"></a>Para se compreender este conceito, é importante entender a diferença entre **probabilidade** e **odds** @oliveira2022diagnostico.</span>
<span id="cb56-257"><a href="#cb56-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-258"><a href="#cb56-258" aria-hidden="true" tabindex="-1"></a>**Probabilidade** é a proporção de pessoas que apresentam uma determinada característica (teste positivo, sinal clínico).\</span>
<span id="cb56-259"><a href="#cb56-259" aria-hidden="true" tabindex="-1"></a>**Odds** (chance) representa a razão entre duas características complementares, ou seja, a probabilidade de um evento dividido pela probabilidade do não evento (1 – evento). Ambos contêm as mesmas informações de maneiras diferentes. Por exemplo, usando os dados da tabela <span class="in">`tab_ap`</span> (veja @sec-exapendicite), verifica-se que a probabilidade (*p*) de uma ultrassonografia positiva para apendicite aguda é igual</span>
<span id="cb56-260"><a href="#cb56-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-263"><a href="#cb56-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-264"><a href="#cb56-264" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb56-265"><a href="#cb56-265" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb56-266"><a href="#cb56-266" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb56-267"><a href="#cb56-267" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb56-268"><a href="#cb56-268" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d)</span>
<span id="cb56-269"><a href="#cb56-269" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb56-270"><a href="#cb56-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-271"><a href="#cb56-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-272"><a href="#cb56-272" aria-hidden="true" tabindex="-1"></a>e que o *odds* da ultrassonografia positiva<span class="ot">[^21-testesdiag-2]</span> é</span>
<span id="cb56-273"><a href="#cb56-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-274"><a href="#cb56-274" aria-hidden="true" tabindex="-1"></a><span class="ot">[^21-testesdiag-2]: </span>Existem duas maneiras de descrever uma estimativa de odds: ou como um número isolado, por exemplo, 0,25, subentendendo que expressa uma razão, 0,25:1,0, ou de forma clara como uma razão 1:4. Ou seja, para cada indivíduo com o fator existem quatro sem o fator. Tradicional e comumente usados no mundo das apostas em corridas de cavalos.</span>
<span id="cb56-275"><a href="#cb56-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-278"><a href="#cb56-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-279"><a href="#cb56-279" aria-hidden="true" tabindex="-1"></a> odds <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(c <span class="sc">+</span> d) </span>
<span id="cb56-280"><a href="#cb56-280" aria-hidden="true" tabindex="-1"></a> odds</span>
<span id="cb56-281"><a href="#cb56-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-282"><a href="#cb56-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-283"><a href="#cb56-283" aria-hidden="true" tabindex="-1"></a>Para transformar a *odds* em probabilidades e vice-versa, procede-se da seguinte maneira:</span>
<span id="cb56-284"><a href="#cb56-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-285"><a href="#cb56-285" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-286"><a href="#cb56-286" aria-hidden="true" tabindex="-1"></a>p=\frac{odds}{1+odds}</span>
<span id="cb56-287"><a href="#cb56-287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-288"><a href="#cb56-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-289"><a href="#cb56-289" aria-hidden="true" tabindex="-1"></a>Voltando ao exemplo (@sec-exapendicite):</span>
<span id="cb56-290"><a href="#cb56-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-293"><a href="#cb56-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-294"><a href="#cb56-294" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> odds<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> odds)</span>
<span id="cb56-295"><a href="#cb56-295" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb56-296"><a href="#cb56-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-297"><a href="#cb56-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-298"><a href="#cb56-298" aria-hidden="true" tabindex="-1"></a>e</span>
<span id="cb56-299"><a href="#cb56-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-300"><a href="#cb56-300" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-301"><a href="#cb56-301" aria-hidden="true" tabindex="-1"></a>odds=\frac{p}{1-p}</span>
<span id="cb56-302"><a href="#cb56-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-303"><a href="#cb56-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-306"><a href="#cb56-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-307"><a href="#cb56-307" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">=</span> p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb56-308"><a href="#cb56-308" aria-hidden="true" tabindex="-1"></a>odds</span>
<span id="cb56-309"><a href="#cb56-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-310"><a href="#cb56-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-311"><a href="#cb56-311" aria-hidden="true" tabindex="-1"></a>Pelo teorema de Bayes, sabendo-se a *probabilidade a priori* ou *probabilidade pré-teste*, é possível obter a *probabilidade pós-teste* ou *a posteriori*, usando a razão de probabilidades.</span>
<span id="cb56-312"><a href="#cb56-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-313"><a href="#cb56-313" aria-hidden="true" tabindex="-1"></a>Para atingir este objetivo, basta, inicialmente, multiplicar o *odds pré-teste* pela razão de probabilidades:</span>
<span id="cb56-314"><a href="#cb56-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-315"><a href="#cb56-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-316"><a href="#cb56-316" aria-hidden="true" tabindex="-1"></a>odds_{pos} = odds_{pre \quad \times \quad LR}</span>
<span id="cb56-317"><a href="#cb56-317" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-318"><a href="#cb56-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-319"><a href="#cb56-319" aria-hidden="true" tabindex="-1"></a>Após, para encontrar a probabilidade pós-teste, basta converter o *odds* pós-teste em probabilidade:</span>
<span id="cb56-320"><a href="#cb56-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-321"><a href="#cb56-321" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-322"><a href="#cb56-322" aria-hidden="true" tabindex="-1"></a>p_{pos} = \frac{odds_{pos}}{1-odds_{pos}}</span>
<span id="cb56-323"><a href="#cb56-323" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-324"><a href="#cb56-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-325"><a href="#cb56-325" aria-hidden="true" tabindex="-1"></a>No exemplo (@sec-exapendicite), foi verificado que o LR (+) é igual a 2,32 e a prevalência de apendicite aguda é em torno de 7% pode-se prever a probabilidade de haver apendicite aguda, diante de uma ultrassonografia alterada:</span>
<span id="cb56-326"><a href="#cb56-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-329"><a href="#cb56-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-330"><a href="#cb56-330" aria-hidden="true" tabindex="-1"></a>prev <span class="ot">&lt;-</span>  <span class="fl">0.07</span></span>
<span id="cb56-331"><a href="#cb56-331" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span>  <span class="fl">2.32</span></span>
<span id="cb56-332"><a href="#cb56-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-333"><a href="#cb56-333" aria-hidden="true" tabindex="-1"></a>odds_pre <span class="ot">&lt;-</span>  <span class="fl">0.07</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span><span class="fl">0.07</span>)</span>
<span id="cb56-334"><a href="#cb56-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-335"><a href="#cb56-335" aria-hidden="true" tabindex="-1"></a>odds_pos <span class="ot">&lt;-</span> odds_pre <span class="sc">*</span> LR</span>
<span id="cb56-336"><a href="#cb56-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-337"><a href="#cb56-337" aria-hidden="true" tabindex="-1"></a>p_pos <span class="ot">&lt;-</span> odds_pos<span class="sc">/</span>(odds_pos <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb56-338"><a href="#cb56-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-339"><a href="#cb56-339" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p_pos, <span class="dv">3</span>)</span>
<span id="cb56-340"><a href="#cb56-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-341"><a href="#cb56-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-342"><a href="#cb56-342" aria-hidden="true" tabindex="-1"></a>Ou, em outras palavras, diante de um teste positivo, a probabilidade de o paciente ter apendicite aguda passa de 7% antes do teste para praticamente 15%!</span>
<span id="cb56-343"><a href="#cb56-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-344"><a href="#cb56-344" aria-hidden="true" tabindex="-1"></a>Estes cálculos podem ser simplificados, utilizando o nomograma de Fagan @fagan1975nomogram, extremamente fácil de se usar @caraguel2013fagan, pois basta unir a probabilidade pré-teste ao LR que a reta apontará para a probabilidade pós-teste (@fig-fagan)).</span>
<span id="cb56-345"><a href="#cb56-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-348"><a href="#cb56-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-349"><a href="#cb56-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fagan</span></span>
<span id="cb56-350"><a href="#cb56-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-351"><a href="#cb56-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-352"><a href="#cb56-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: '60%'</span></span>
<span id="cb56-353"><a href="#cb56-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-354"><a href="#cb56-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-355"><a href="#cb56-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Nomograma de Fagan"</span></span>
<span id="cb56-356"><a href="#cb56-356" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/Qyvlj5q.png"</span>)</span>
<span id="cb56-357"><a href="#cb56-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-358"><a href="#cb56-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-359"><a href="#cb56-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Curva ROC {#sec-rocurve}</span></span>
<span id="cb56-360"><a href="#cb56-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-361"><a href="#cb56-361" aria-hidden="true" tabindex="-1"></a>Nem sempre o resultado de um teste é dicotômico (positivo/negativo). Com frequência, trabalha-se com variáveis contínuas (pressão arterial, glicemia, dosagem do sódio, dosagens hormonais, etc.). Neste caso, não há um resultado “positivo” ou “negativo”. Um “ponto de corte” precisa ser criado, para definir quem será considerado positivo ou negativo.</span>
<span id="cb56-362"><a href="#cb56-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-363"><a href="#cb56-363" aria-hidden="true" tabindex="-1"></a>A escolha do ponto de corte depende das consequências de um resultado falso positivo ou de um falso negativo. Falsos positivos estão associados com custos (emocional ou financeiro) e com a dificuldade de “desrotular” alguém que recebeu o rótulo de “positivo”. Resultados falsos negativos podem “tranquilizar” pessoas doentes que não são seguidas ou tratadas precocemente.</span>
<span id="cb56-364"><a href="#cb56-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-365"><a href="#cb56-365" aria-hidden="true" tabindex="-1"></a>A distribuição dos níveis glicêmicos em diabéticos e não diabéticos não tem um ponto de corte bem nítido. As duas populações se sobrepõem (@fig-diabetes)), gerando falso positivos ou falso negativos, dependendo do ponto de corte escolhido @oliveira2022diagnostico.</span>
<span id="cb56-366"><a href="#cb56-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-369"><a href="#cb56-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-370"><a href="#cb56-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-diabetes</span></span>
<span id="cb56-371"><a href="#cb56-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-372"><a href="#cb56-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-373"><a href="#cb56-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: '80%'</span></span>
<span id="cb56-374"><a href="#cb56-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-375"><a href="#cb56-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-376"><a href="#cb56-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Populações de indivíduos normais (curva em azul) e diabéticos (curva em vermelho)"</span></span>
<span id="cb56-377"><a href="#cb56-377" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">90</span>,<span class="dv">20</span>), </span>
<span id="cb56-378"><a href="#cb56-378" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">300</span>, </span>
<span id="cb56-379"><a href="#cb56-379" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.02</span>),</span>
<span id="cb56-380"><a href="#cb56-380" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"royalblue"</span>, </span>
<span id="cb56-381"><a href="#cb56-381" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span><span class="dv">2</span>, </span>
<span id="cb56-382"><a href="#cb56-382" aria-hidden="true" tabindex="-1"></a>      <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb56-383"><a href="#cb56-383" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Densidade de Probabilidade"</span>,</span>
<span id="cb56-384"><a href="#cb56-384" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Glicemia (mg/dL"</span>)</span>
<span id="cb56-385"><a href="#cb56-385" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">150</span>,<span class="dv">50</span>), </span>
<span id="cb56-386"><a href="#cb56-386" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">300</span>, </span>
<span id="cb56-387"><a href="#cb56-387" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.03</span>),</span>
<span id="cb56-388"><a href="#cb56-388" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"tomato"</span>, </span>
<span id="cb56-389"><a href="#cb56-389" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span><span class="dv">2</span>, </span>
<span id="cb56-390"><a href="#cb56-390" aria-hidden="true" tabindex="-1"></a>      <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb56-391"><a href="#cb56-391" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Densidade de Probabilidade"</span>,</span>
<span id="cb56-392"><a href="#cb56-392" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-393"><a href="#cb56-393" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(<span class="at">bty=</span><span class="st">"L"</span>)</span>
<span id="cb56-394"><a href="#cb56-394" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">80</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"gray40"</span>)</span>
<span id="cb56-395"><a href="#cb56-395" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">200</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"gray40"</span>)</span>
<span id="cb56-396"><a href="#cb56-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-397"><a href="#cb56-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-398"><a href="#cb56-398" aria-hidden="true" tabindex="-1"></a>Suponha que ao se examinar uma população fosse escolhido o ponto de corte de 80mg/dL, haveria um aumento no número de indivíduos com teste positivo com uma taxa de falsos positivos elevada, diminuindo a especificidade do teste. Se, por outro lado, o ponto de corte fosse elevado para 200mg/dL, o número de falsos negativos teria um grande aumento, reduzindo a sensibilidade. Esta oscilação entre a sensibilidade e a especificidade ocorre pelo fato de a localização do ponto de corte ser uma decisão arbitrária num contínuo entre o normal e anormal.</span>
<span id="cb56-399"><a href="#cb56-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-400"><a href="#cb56-400" aria-hidden="true" tabindex="-1"></a>Ao se escolher um ponto de corte deve-se fazer um balanço entre a sensibilidade e a especificidade, levando em conta as consequências da escolha. Por exemplo, a triagem para fenilcetonúria em recém-nascidos valoriza a sensibilidade em vez de especificidade; o custo da perda de um caso é alto, pois existe tratamento eficaz. Uma desvantagem é que ocorre um grande número de testes falso positivos que causam angústia e a realização de mais testes.</span>
<span id="cb56-401"><a href="#cb56-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-402"><a href="#cb56-402" aria-hidden="true" tabindex="-1"></a>Em contraste, a triagem para o câncer de mama deve favorecer a especificidade sobre a sensibilidade, uma vez que uma avaliação mais aprofundada daquelas com teste positivo, implica em biopsias dispendiosas e invasivas.</span>
<span id="cb56-403"><a href="#cb56-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-404"><a href="#cb56-404" aria-hidden="true" tabindex="-1"></a>As **curvas ROC** (*Receiver Operating Characteristic*) são uma ferramenta inestimável para encontrar o ponto de corte em uma medida com distribuição contínua que melhor prediz se uma condição está presente, por exemplo, se pacientes são positivos ou negativos para a presença de uma doença @altman1994roc. As curvas ROC são usadas para encontrar um ponto de corte que separa um resultado de teste "normal" de um "anormal" quando o resultado do teste é uma medida contínua. As curvas ROC são traçadas calculando a sensibilidade e a especificidade do teste na predição do diagnóstico para cada valor da medida. A curva permite determinar um ponto de corte para a medição que maximiza a taxa de verdadeiros positivos (sensibilidade) e minimiza a taxa de falsos positivos (1 – especificidade) e, portanto, maximiza a razão de probabilidades (*likelihood ratio*).</span>
<span id="cb56-405"><a href="#cb56-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-406"><a href="#cb56-406" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados do exemplo {#sec-exdadosTestes}</span></span>
<span id="cb56-407"><a href="#cb56-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-408"><a href="#cb56-408" aria-hidden="true" tabindex="-1"></a>O conjunto de dados <span class="in">`dadosTestes.xlsx`</span> contém informações para os resultados hipotéticos de três testes bioquímicos diferentes e uma variável (<span class="in">`doença`</span>) que indica se foi confirmada a doença (*padrão-ouro*). Para obter arquivo, clique [**aqui**](https://github.com/petronioliveira/Arquivos/blob/main/dadosTestes.xlsx) e salve o mesmo em seu diretório de trabalho.</span>
<span id="cb56-409"><a href="#cb56-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-410"><a href="#cb56-410" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Leitura e observação dos dados</span></span>
<span id="cb56-411"><a href="#cb56-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-412"><a href="#cb56-412" aria-hidden="true" tabindex="-1"></a>Como é um arquivo em Excel, a leitura será realizada pela função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span>:</span>
<span id="cb56-413"><a href="#cb56-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-416"><a href="#cb56-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-417"><a href="#cb56-417" aria-hidden="true" tabindex="-1"></a>testes <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTestes.xlsx"</span>)</span>
<span id="cb56-418"><a href="#cb56-418" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testes)</span>
<span id="cb56-419"><a href="#cb56-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-420"><a href="#cb56-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-421"><a href="#cb56-421" aria-hidden="true" tabindex="-1"></a>A variável <span class="in">`doença`</span> será transformada em fator:</span>
<span id="cb56-422"><a href="#cb56-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-425"><a href="#cb56-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-426"><a href="#cb56-426" aria-hidden="true" tabindex="-1"></a>testes<span class="sc">$</span>doenca <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testes<span class="sc">$</span>doenca)</span>
<span id="cb56-427"><a href="#cb56-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-428"><a href="#cb56-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-429"><a href="#cb56-429" aria-hidden="true" tabindex="-1"></a>As curvas ROC são usadas para avaliar qual teste é mais útil para prever quais pacientes serão positivos para a doença. A hipótese nula é que a área sob a curva ROC é igual a 0,5, ou seja, a habilidade do teste para identificar casos positivos e negativos é a esperada por acaso.</span>
<span id="cb56-430"><a href="#cb56-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-431"><a href="#cb56-431" aria-hidden="true" tabindex="-1"></a>A @fig-status123 mostra a quantidade de sobreposição na distribuição da medição dos testes bioquímicos contínuos em ambos os grupos doença positiva e doença negativa. No Teste 1, a sobreposição é completa e não haverá um ponto de corte que separe efetivamente os dois grupos. Nos Testes 2 e 3, há uma maior separação das medidas de teste entre os grupos, particularmente para Teste 3.</span>
<span id="cb56-432"><a href="#cb56-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-435"><a href="#cb56-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-436"><a href="#cb56-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-status123</span></span>
<span id="cb56-437"><a href="#cb56-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-438"><a href="#cb56-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-439"><a href="#cb56-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: '60%'</span></span>
<span id="cb56-440"><a href="#cb56-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-441"><a href="#cb56-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-442"><a href="#cb56-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Resultado do teste vs doença"</span></span>
<span id="cb56-443"><a href="#cb56-443" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/bTZ7RuY.png"</span>)</span>
<span id="cb56-444"><a href="#cb56-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-445"><a href="#cb56-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-446"><a href="#cb56-446" aria-hidden="true" tabindex="-1"></a><span class="fu">### Construção da curva ROC</span></span>
<span id="cb56-447"><a href="#cb56-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-448"><a href="#cb56-448" aria-hidden="true" tabindex="-1"></a>A validade dos testes, na distinção entre os grupos doença-positivo e doença-negativo, pode ser quantificada pelas curvas ROC, usando a função <span class="in">`roc()`</span> do pacote <span class="in">`pROC`</span> @robin2011proc. Este pacote tem várias funções:</span>
<span id="cb56-449"><a href="#cb56-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-450"><a href="#cb56-450" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**auc**: calcula a área da curva ROC;</span>
<span id="cb56-451"><a href="#cb56-451" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ci**: calcula o intervalo de confiança da curva ROC;</span>
<span id="cb56-452"><a href="#cb56-452" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ci.auc**: calcula o intervalo de confiança da AUC;</span>
<span id="cb56-453"><a href="#cb56-453" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ci.se**: calcula o intervalo de confiança de sensibilidades em determinadas especificidades;</span>
<span id="cb56-454"><a href="#cb56-454" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ci.sp**: calcula o intervalo de confiança de especificidades em determinadas sensibilidades;</span>
<span id="cb56-455"><a href="#cb56-455" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ci.thresholds**: calcula o intervalo de confiança dos limites;</span>
<span id="cb56-456"><a href="#cb56-456" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**coords**: Retorna as coordenadas (sensibilidades, especificidades, pontos de corte) de uma curva ROC;\</span>
<span id="cb56-457"><a href="#cb56-457" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**roc**: Constroi uma curva ROC;\</span>
<span id="cb56-458"><a href="#cb56-458" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**roc.test**: Compara a AUC de duas curvas ROC correlacionadas;\</span>
<span id="cb56-459"><a href="#cb56-459" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**smooth**: suaviza a curva ROC</span>
<span id="cb56-460"><a href="#cb56-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-461"><a href="#cb56-461" aria-hidden="true" tabindex="-1"></a>Usar a função com os argumentos variável resposta (<span class="in">`doenca`</span>), variável preditora (<span class="in">`teste3`</span>, <span class="in">`teste2`</span> e <span class="in">`teste1`</span>), indicação de que o gráfico deve ser desenhado (<span class="in">`plot = TRUE`</span>). Como por padrão o gráfico é plotado com a sensibilidade no eixo *x* e a especificidade no eixo *y*; deve-se acrescentar o argumento <span class="in">`legacy.axes = TRUE`</span> para aparecer o seu complemento, os falsos positivos ($1 – especificidade$).</span>
<span id="cb56-462"><a href="#cb56-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-463"><a href="#cb56-463" aria-hidden="true" tabindex="-1"></a>Além desses, pode-se usar vários outros argumentos como: <span class="in">`print.auc = TRUE`</span>, que imprime no gráfico a <span class="in">`AUC`</span> e <span class="in">`ci`</span> que é o intervalo de confiança da AUC. Para que a sensibilidade e especificidade apareçam como uma percentagem, deve-se usar o argumento <span class="in">`percent = TRUE`</span>, pois o padrão é <span class="in">`FALSE`</span>. Os demais argumentos são os rótulos dos eixos, cor da curva, largura da curva (<span class="in">`lwd`</span>).</span>
<span id="cb56-464"><a href="#cb56-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-467"><a href="#cb56-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-468"><a href="#cb56-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-roc</span></span>
<span id="cb56-469"><a href="#cb56-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb56-470"><a href="#cb56-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-471"><a href="#cb56-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb56-472"><a href="#cb56-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "80%"</span></span>
<span id="cb56-473"><a href="#cb56-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-474"><a href="#cb56-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-475"><a href="#cb56-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Curvas ROC para os Testes 1, 2 e 3"</span></span>
<span id="cb56-476"><a href="#cb56-476" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb56-477"><a href="#cb56-477" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste3, </span>
<span id="cb56-478"><a href="#cb56-478" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-479"><a href="#cb56-479" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-480"><a href="#cb56-480" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb56-481"><a href="#cb56-481" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-482"><a href="#cb56-482" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y =</span> <span class="fl">0.2</span>,</span>
<span id="cb56-483"><a href="#cb56-483" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-484"><a href="#cb56-484" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb56-485"><a href="#cb56-485" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="st">"1 - Especificdade"</span>,</span>
<span id="cb56-486"><a href="#cb56-486" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb56-487"><a href="#cb56-487" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-488"><a href="#cb56-488" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb56-489"><a href="#cb56-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-490"><a href="#cb56-490" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb56-491"><a href="#cb56-491" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste2, </span>
<span id="cb56-492"><a href="#cb56-492" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-493"><a href="#cb56-493" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-494"><a href="#cb56-494" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb56-495"><a href="#cb56-495" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-496"><a href="#cb56-496" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-497"><a href="#cb56-497" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.13</span>,</span>
<span id="cb56-498"><a href="#cb56-498" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"chartreuse4"</span>,</span>
<span id="cb56-499"><a href="#cb56-499" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb56-500"><a href="#cb56-500" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-501"><a href="#cb56-501" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-502"><a href="#cb56-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-503"><a href="#cb56-503" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb56-504"><a href="#cb56-504" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste1, </span>
<span id="cb56-505"><a href="#cb56-505" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-506"><a href="#cb56-506" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-507"><a href="#cb56-507" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb56-508"><a href="#cb56-508" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-509"><a href="#cb56-509" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-510"><a href="#cb56-510" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.06</span>,</span>
<span id="cb56-511"><a href="#cb56-511" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"tomato"</span>,</span>
<span id="cb56-512"><a href="#cb56-512" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb56-513"><a href="#cb56-513" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-514"><a href="#cb56-514" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-515"><a href="#cb56-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-516"><a href="#cb56-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Legendas das curvas ROC</span></span>
<span id="cb56-517"><a href="#cb56-517" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.73</span>,<span class="fl">0.80</span>,<span class="st">"Teste 3"</span>, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb56-518"><a href="#cb56-518" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.53</span>,<span class="fl">0.73</span>,<span class="st">"Teste 2"</span>, <span class="at">col=</span><span class="st">"chartreuse4"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb56-519"><a href="#cb56-519" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.35</span>,<span class="fl">0.65</span>,<span class="st">"Teste 1"</span>, <span class="at">col=</span><span class="st">"tomato"</span>, <span class="at">cex =</span> <span class="dv">1</span>) </span>
<span id="cb56-520"><a href="#cb56-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-521"><a href="#cb56-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-522"><a href="#cb56-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpretação do resultado</span></span>
<span id="cb56-523"><a href="#cb56-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-524"><a href="#cb56-524" aria-hidden="true" tabindex="-1"></a>Em uma curva ROC, a sensibilidade é calculada usando cada valor do teste no conjunto de dados como um ponto de corte e é plotada em relação à (1 – especificidade) correspondente nesse ponto, como mostrado na @fig-roc.</span>
<span id="cb56-525"><a href="#cb56-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-526"><a href="#cb56-526" aria-hidden="true" tabindex="-1"></a>Assim, a curva são os *Verdadeiros Positivos* (VP) plotados em relação aos *Falsos Positivos* (FP), calculados usando cada valor do teste como ponto de corte. A reta diagonal indica onde o teste cairia se os resultados não fossem melhores do que o acaso para predizer a presença de uma doença. O Teste 1 está próximo desta reta, confirmando que ele tem pouca capacidade de discriminar os pacientes doentes e não doentes.</span>
<span id="cb56-527"><a href="#cb56-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-528"><a href="#cb56-528" aria-hidden="true" tabindex="-1"></a>A área abaixo da reta diagonal é equivalente a 0,5 da área total. Quanto maior a área sob a curva ROC, mais útil é o teste para predizer os pacientes que têm a doença. Uma curva que cai substancialmente abaixo da linha diagonal indica que o teste tem pouca capacidade de diagnosticar a doença. Quando há uma separação perfeita dos valores dos dois grupos, isto é, sem sobreposição das distribuições, a área sob a curva ROC é igual a 1 (a curva ROC alcançará o canto superior esquerdo do gráfico).</span>
<span id="cb56-529"><a href="#cb56-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-530"><a href="#cb56-530" aria-hidden="true" tabindex="-1"></a>A área sob a curva (*Area Under the Curve* – AUC) e seu intervalo de confiança de 95% podem ser obtidos com os comandos usados na construção da @fig-roc ou separadamente usando as funções <span class="in">`auc()`</span> e <span class="in">`ci.auc()`</span> do pacote <span class="in">`pROC`</span>.</span>
<span id="cb56-531"><a href="#cb56-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-534"><a href="#cb56-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-535"><a href="#cb56-535" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc1) </span>
<span id="cb56-536"><a href="#cb56-536" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span> (roc1)</span>
<span id="cb56-537"><a href="#cb56-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-538"><a href="#cb56-538" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc2) </span>
<span id="cb56-539"><a href="#cb56-539" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc2)</span>
<span id="cb56-540"><a href="#cb56-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-541"><a href="#cb56-541" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc3) </span>
<span id="cb56-542"><a href="#cb56-542" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc3)</span>
<span id="cb56-543"><a href="#cb56-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-544"><a href="#cb56-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-545"><a href="#cb56-545" aria-hidden="true" tabindex="-1"></a>A acurácia geral de um teste pode ser descrita como a área sob a curva; quanto maior for a área, melhor será o teste. Na @fig-roc, o Teste 3 tem uma AUC maior que os outros dois testes.\</span>
<span id="cb56-546"><a href="#cb56-546" aria-hidden="true" tabindex="-1"></a>Usa-se a seguinte estimativa (@tbl-roc1) para avaliar a acurácia de um teste ou da capacidade de identificar corretamente uma condição usando curva ROC @borges2016accuracy:</span>
<span id="cb56-547"><a href="#cb56-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-550"><a href="#cb56-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-551"><a href="#cb56-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-roc1</span></span>
<span id="cb56-552"><a href="#cb56-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-553"><a href="#cb56-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-554"><a href="#cb56-554" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-555"><a href="#cb56-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Acurácia do teste diagnóstico"</span></span>
<span id="cb56-556"><a href="#cb56-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-557"><a href="#cb56-557" aria-hidden="true" tabindex="-1"></a>qualidade <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"excelente"</span>, <span class="st">"muito bom"</span>, <span class="st">"bom"</span>, <span class="st">"suficiente"</span>, <span class="st">"ruim"</span>, <span class="st">"ignorar teste"</span>)</span>
<span id="cb56-558"><a href="#cb56-558" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;0,90"</span>, <span class="st">"0,80 a 0,90"</span>, <span class="st">"0,70 a 0,80"</span>, <span class="st">"0,60 a 0,70"</span>, <span class="st">"0,50 a 0,60"</span>, <span class="st">"&lt;0,50"</span>)</span>
<span id="cb56-559"><a href="#cb56-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-560"><a href="#cb56-560" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(auc, qualidade)</span>
<span id="cb56-561"><a href="#cb56-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-562"><a href="#cb56-562" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb56-563"><a href="#cb56-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb56-564"><a href="#cb56-564" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc =</span> <span class="st">"AUC"</span>,</span>
<span id="cb56-565"><a href="#cb56-565" aria-hidden="true" tabindex="-1"></a>  <span class="at">qualidade =</span> <span class="st">"Qualidade do Teste"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-566"><a href="#cb56-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-567"><a href="#cb56-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-568"><a href="#cb56-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-569"><a href="#cb56-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb56-570"><a href="#cb56-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb56-571"><a href="#cb56-571" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb56-572"><a href="#cb56-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-573"><a href="#cb56-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-574"><a href="#cb56-574" aria-hidden="true" tabindex="-1"></a>Desta forma, o Teste 3 pode ser considerado um bom teste e o Teste 1 é um teste ruim.</span>
<span id="cb56-575"><a href="#cb56-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-576"><a href="#cb56-576" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Comparando duas curvas</span><span class="co">]</span>{.underline}</span>
<span id="cb56-577"><a href="#cb56-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-578"><a href="#cb56-578" aria-hidden="true" tabindex="-1"></a>Pode-se comparar duas curvas ROC com a função <span class="in">`roc.test()`</span>, por exemplo, comparando as curvas dos Teste 3 e 2 @delong1988comparing:</span>
<span id="cb56-579"><a href="#cb56-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-582"><a href="#cb56-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-583"><a href="#cb56-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-584"><a href="#cb56-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-585"><a href="#cb56-585" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.test</span>(roc3, roc2)</span>
<span id="cb56-586"><a href="#cb56-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-587"><a href="#cb56-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-588"><a href="#cb56-588" aria-hidden="true" tabindex="-1"></a>O Teste 3 tem uma AUC que o caracteriza como um bom teste e o teste de DeLong, entregue na saída do <span class="in">`roc.test()`</span>, resultou que a diferença entre ele o Teste 2 é estatisticamente significativa (*P* <span class="sc">\&lt;</span> 0,0001).</span>
<span id="cb56-589"><a href="#cb56-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-590"><a href="#cb56-590" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Melhor ponto de corte</span></span>
<span id="cb56-591"><a href="#cb56-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-592"><a href="#cb56-592" aria-hidden="true" tabindex="-1"></a>O melhor ponto de corte (*Best Critical Value*), que às vezes é chamado de *ponto de diagnóstico ótimo* ou *de Youden*, é o ponto da curva mais próximo da parte superior do eixo *y* (@fig-roc, Teste 3). Este é o ponto em que a taxa de verdadeiros positivos é otimizada e a taxa de falsos positivos é minimizada. O melhor ponto de corte para o Teste 3 é mostrado na @fig-roc3. Este melhor ponto de corte pode ser identificado a partir dos pontos de coordenadas da curva, usando a função <span class="in">`roc()`</span> com os seguintes argumentos:</span>
<span id="cb56-593"><a href="#cb56-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-596"><a href="#cb56-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-597"><a href="#cb56-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-roc3</span></span>
<span id="cb56-598"><a href="#cb56-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb56-599"><a href="#cb56-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb56-600"><a href="#cb56-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb56-601"><a href="#cb56-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb56-602"><a href="#cb56-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-603"><a href="#cb56-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-604"><a href="#cb56-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Melhor ponte de corte"</span></span>
<span id="cb56-605"><a href="#cb56-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-606"><a href="#cb56-606" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca, </span>
<span id="cb56-607"><a href="#cb56-607" aria-hidden="true" tabindex="-1"></a>     testes<span class="sc">$</span>teste3,</span>
<span id="cb56-608"><a href="#cb56-608" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-609"><a href="#cb56-609" aria-hidden="true" tabindex="-1"></a>     <span class="at">ci=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-610"><a href="#cb56-610" aria-hidden="true" tabindex="-1"></a>     <span class="at">thresholds=</span><span class="st">"best"</span>, </span>
<span id="cb56-611"><a href="#cb56-611" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres=</span><span class="st">"best"</span>,</span>
<span id="cb56-612"><a href="#cb56-612" aria-hidden="true" tabindex="-1"></a>     <span class="at">legacy.axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-613"><a href="#cb56-613" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">""</span>,</span>
<span id="cb56-614"><a href="#cb56-614" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb56-615"><a href="#cb56-615" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"1 - Especificidade"</span>,</span>
<span id="cb56-616"><a href="#cb56-616" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb56-617"><a href="#cb56-617" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb56-618"><a href="#cb56-618" aria-hidden="true" tabindex="-1"></a>best</span>
<span id="cb56-619"><a href="#cb56-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-620"><a href="#cb56-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-621"><a href="#cb56-621" aria-hidden="true" tabindex="-1"></a>Assim, para o *Teste 3*, o ponto de corte ideal é 24,8, onde a especificidade é igual a 0,854 e a sensibilidade é igual 0,845. Estes dados, fornecem um LR para um resultado positivo igual a:</span>
<span id="cb56-622"><a href="#cb56-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-623"><a href="#cb56-623" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-624"><a href="#cb56-624" aria-hidden="true" tabindex="-1"></a>LR \left(+\right) = \frac{0.845}{\left (1-0.854\right)} = 5,79</span>
<span id="cb56-625"><a href="#cb56-625" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-626"><a href="#cb56-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-627"><a href="#cb56-627" aria-hidden="true" tabindex="-1"></a>As coordenadas da curva ROC podem ser obtida com a seguinte programação, a partir de uma sensibilidade e especificidade acima de 0 (zero):</span>
<span id="cb56-628"><a href="#cb56-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-631"><a href="#cb56-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-632"><a href="#cb56-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-633"><a href="#cb56-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-634"><a href="#cb56-634" aria-hidden="true" tabindex="-1"></a>coordenadas <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3) <span class="sc">%&gt;%</span> <span class="fu">coords</span> (<span class="at">transpose =</span> F)</span>
<span id="cb56-635"><a href="#cb56-635" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coordenadas, <span class="dv">10</span>)</span>
<span id="cb56-636"><a href="#cb56-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-637"><a href="#cb56-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-638"><a href="#cb56-638" aria-hidden="true" tabindex="-1"></a>A *estatística J de Youden* @youden1950index é calculada deduzindo 1 a partir da soma de sensibilidade e especificidade do teste e não é expressa como porcentagem, mas como parte de um número inteiro: $\left (sensibilidade + especificidade\right) - 1$. A estatística J de Youden no melhor ponto de corte do Teste 3 é igual a $\left (0,845+ 0,854\right) - 1 = 0,699$.</span>
<span id="cb56-639"><a href="#cb56-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-640"><a href="#cb56-640" aria-hidden="true" tabindex="-1"></a>Este é o maior valor de todos os valores das coordenadas (91 valores) usadas.</span>
<span id="cb56-641"><a href="#cb56-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-644"><a href="#cb56-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-645"><a href="#cb56-645" aria-hidden="true" tabindex="-1"></a>youden <span class="ot">&lt;-</span> <span class="fu">max</span>(coordenadas<span class="sc">$</span>sensitivity <span class="sc">+</span> coordenadas<span class="sc">$</span>specificity) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb56-646"><a href="#cb56-646" aria-hidden="true" tabindex="-1"></a>youden</span>
<span id="cb56-647"><a href="#cb56-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-648"><a href="#cb56-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-649"><a href="#cb56-649" aria-hidden="true" tabindex="-1"></a>A @fig-roc3 mostra o ponto de corte ideal. Ele também pode ser obtido com a função <span class="in">`coords()`</span> do pacote <span class="in">`pRoc`</span>:</span>
<span id="cb56-650"><a href="#cb56-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-653"><a href="#cb56-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-654"><a href="#cb56-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-655"><a href="#cb56-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-656"><a href="#cb56-656" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3)</span>
<span id="cb56-657"><a href="#cb56-657" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc3, <span class="at">x =</span> <span class="st">"best"</span>, <span class="at">ret=</span><span class="st">"threshold"</span>, <span class="at">transpose =</span> <span class="cn">FALSE</span>, </span>
<span id="cb56-658"><a href="#cb56-658" aria-hidden="true" tabindex="-1"></a>       <span class="at">best.method=</span><span class="st">"youden"</span>)</span>
<span id="cb56-659"><a href="#cb56-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-660"><a href="#cb56-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-661"><a href="#cb56-661" aria-hidden="true" tabindex="-1"></a>O método para obter o melhor ponto de corte (<span class="in">`best.method`</span>) pode ser pelo método de <span class="in">`youden`</span> ou <span class="in">`closest.topleft`</span>. No exemplo, o resultado é o mesmo. Para maiores detalhes consulte a ajuda da função <span class="in">`coord()`</span>, do pacote <span class="in">`pROC`</span>.</span>
<span id="cb56-662"><a href="#cb56-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-663"><a href="#cb56-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estatística *kappa*</span></span>
<span id="cb56-664"><a href="#cb56-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-665"><a href="#cb56-665" aria-hidden="true" tabindex="-1"></a>A estatística de concordância *kappa* (*k*) de Cohen é utilizada para descrever a concordância entre dois ou mais avaliadores quando realizam uma avaliação nominal ou ordinal de uma mesma amostra @cohen1960coefficient. A estatística *kappa* corrige a chance do acaso nas avaliações e é obtida pela fórmula igual a:</span>
<span id="cb56-666"><a href="#cb56-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-667"><a href="#cb56-667" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-668"><a href="#cb56-668" aria-hidden="true" tabindex="-1"></a>k= \frac{p_{o} - p_{e}}{1 - p_{e}}</span>
<span id="cb56-669"><a href="#cb56-669" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-670"><a href="#cb56-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-671"><a href="#cb56-671" aria-hidden="true" tabindex="-1"></a>Onde $p_{o}$ = proporção observada de concordância e $p_{e}$ = proporção esperada de concordância apenas pelo acaso.</span>
<span id="cb56-672"><a href="#cb56-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-673"><a href="#cb56-673" aria-hidden="true" tabindex="-1"></a>Por exemplo, dois radiologistas podem revisar independentemente uma série de radiografias do tórax de pacientes para determinar a presença ou ausência de pneumonia. Para avaliar o grau de concordância entre as classificações dos dois médicos, pode ser relatado o percentual de concordância entre os avaliadores (por exemplo, 50% dos avaliadores responderam "sim" nas duas ocasiões). No entanto, esse percentual pode ser enganoso, pois não leva em conta o nível de concordância entre os dois avaliadores que pode ocorrer por acaso. A estatística *kappa* pode ser usada para avaliar a concordância das respostas para dois ou mais avaliadores após considerar a concordância casual. Portanto, a estatística *kappa* é uma estimativa da proporção de concordância entre avaliadores que excede a concordância que ocorreria por acaso.</span>
<span id="cb56-674"><a href="#cb56-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-675"><a href="#cb56-675" aria-hidden="true" tabindex="-1"></a>A interpretação dos valores de *kappa* é mostrada na @tbl-kappa @landis1977measurement. Quando a proporção observada de concordância é menor que a esperada por acaso, o *kappa* terá um valor negativo indicando não concordância. Um valor de *kappa* igual a 0 indica que a concordância observada é igual à concordância casual.</span>
<span id="cb56-676"><a href="#cb56-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-677"><a href="#cb56-677" aria-hidden="true" tabindex="-1"></a>O teste de hipóteses testa a hipótese de que a concordância entre os dois avaliadores seja puramente aleatória. Quando o valor *P* é menor que 0,05, rejeitamos a hipótese de que a concordância foi puramente aleatória. As premissas para o *kappa* de Cohen são que os participantes ou itens a serem classificados são independentes e também que os avaliadores e categorias são independentes.</span>
<span id="cb56-678"><a href="#cb56-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-681"><a href="#cb56-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-682"><a href="#cb56-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-kappa</span></span>
<span id="cb56-683"><a href="#cb56-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb56-684"><a href="#cb56-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: FALSE</span></span>
<span id="cb56-685"><a href="#cb56-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb56-686"><a href="#cb56-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Valor Kappa e nível de concordância"</span></span>
<span id="cb56-687"><a href="#cb56-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-688"><a href="#cb56-688" aria-hidden="true" tabindex="-1"></a>concor <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"pobre"</span>, <span class="st">"leve"</span>, <span class="st">"razoável"</span>, <span class="st">"moderada"</span>, <span class="st">"substancial"</span>, <span class="st">"quase perfeita"</span>)</span>
<span id="cb56-689"><a href="#cb56-689" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&lt;0,00"</span>, <span class="st">"0,00 - 0,20"</span>, <span class="st">"0,21 - 0,40"</span>, <span class="st">"0,41 - 0,60"</span>, <span class="st">"0,61 - 0,80"</span>, <span class="st">"0,81 - 1,00"</span>)</span>
<span id="cb56-690"><a href="#cb56-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-691"><a href="#cb56-691" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(kappa, concor)</span>
<span id="cb56-692"><a href="#cb56-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-693"><a href="#cb56-693" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb56-694"><a href="#cb56-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb56-695"><a href="#cb56-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa =</span> <span class="st">"Valor kappa"</span>,</span>
<span id="cb56-696"><a href="#cb56-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">concor =</span> <span class="st">"Concordância"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-697"><a href="#cb56-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-698"><a href="#cb56-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-699"><a href="#cb56-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-700"><a href="#cb56-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="st">"concor"</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb56-701"><a href="#cb56-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="st">"kappa"</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-702"><a href="#cb56-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb56-703"><a href="#cb56-703" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb56-704"><a href="#cb56-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-705"><a href="#cb56-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-706"><a href="#cb56-706" aria-hidden="true" tabindex="-1"></a>Existem diferentes tipos de estatísticas *kappa*. Para dados com três ou mais categorias possíveis (por exemplo, concordo, concordo parcialmente, discordo) ou para dados categóricos ordenados, o *kappa* ponderado deve ser usado para que as respostas que estão mais distantes da concordância tenham maior peso do que aquelas próximas à concordância. No exemplo usado, as categorias possíveis são dicotômicas (sim e não), portanto, o kappa não ponderado (*unweighted*) e o ponderado (*weighted*) retornam o mesmo resultado.</span>
<span id="cb56-707"><a href="#cb56-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-708"><a href="#cb56-708" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados do exemplo {#sec-exkappa}</span></span>
<span id="cb56-709"><a href="#cb56-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-710"><a href="#cb56-710" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb56-711"><a href="#cb56-711" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb56-712"><a href="#cb56-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-713"><a href="#cb56-713" aria-hidden="true" tabindex="-1"></a>Cinquenta e quatro crianças com suspeita de pneumonia realizaram radiografias de tórax para confirmar o diagnóstico. Essas radiografias foram avaliadas por dois radiologistas.</span>
<span id="cb56-714"><a href="#cb56-714" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-715"><a href="#cb56-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-716"><a href="#cb56-716" aria-hidden="true" tabindex="-1"></a>O arquivo <span class="in">`dadosPneumonia.xlsx`</span> contém os dados dos diagnósticos independentes dos dois radiologistas. O objetivo foi medir a concordância diagnóstica dos dois profissionais. Para o cálculo do coeficiente *kappa*, será usada a função <span class="in">`Kappa()`</span> do pacote <span class="in">`vcd`</span> @zeileis2007residual. Essa função tem os seguintes argumentos:</span>
<span id="cb56-717"><a href="#cb56-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-718"><a href="#cb56-718" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**x** $\longrightarrow$ matriz ou tabela</span>
<span id="cb56-719"><a href="#cb56-719" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**weights** $\longrightarrow$ matriz especificada pelo usuário com as mesmas dimensões de *x*, desnecessário para *kappa* não ponderado.</span>
<span id="cb56-720"><a href="#cb56-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-721"><a href="#cb56-721" aria-hidden="true" tabindex="-1"></a>Na impressão do *kappa* pode-se usar `print (k, digits = 3, CI = TRUE, level = 0.95)`. Onde *k* é o coeficiente de *kappa*, calculado pela função `Kappa()`, *CI* é o intervalo de confiança e o nível de confiança padrão é 95%.</span>
<span id="cb56-722"><a href="#cb56-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-723"><a href="#cb56-723" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Leitura e exploração dos dados</span></span>
<span id="cb56-724"><a href="#cb56-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-725"><a href="#cb56-725" aria-hidden="true" tabindex="-1"></a>O conjunto de dados <span class="in">`dadosPneumonia.xlsx`</span> pode ser obtido <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosPneumonia.xlsx)</span>. Após salvar o arquivo em seu diretório, ele pode ser carregado com a função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span>:</span>
<span id="cb56-726"><a href="#cb56-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-729"><a href="#cb56-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-730"><a href="#cb56-730" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosPneumonia.xlsx"</span>)</span>
<span id="cb56-731"><a href="#cb56-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-732"><a href="#cb56-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-733"><a href="#cb56-733" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Construção da tabela</span></span>
<span id="cb56-734"><a href="#cb56-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-735"><a href="#cb56-735" aria-hidden="true" tabindex="-1"></a>O cálculo do *kappa* com a função <span class="in">`Kappa()`</span> exige uma tabela, onde os dados dos dois radiologistas são cruzados. As variáveis a serem cruzadas são <span class="in">`rx1`</span> e <span class="in">`rx2`</span>:</span>
<span id="cb56-736"><a href="#cb56-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-739"><a href="#cb56-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-740"><a href="#cb56-740" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx1,</span>
<span id="cb56-741"><a href="#cb56-741" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-742"><a href="#cb56-742" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))                           </span>
<span id="cb56-743"><a href="#cb56-743" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx2,</span>
<span id="cb56-744"><a href="#cb56-744" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb56-745"><a href="#cb56-745" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb56-746"><a href="#cb56-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-747"><a href="#cb56-747" aria-hidden="true" tabindex="-1"></a>tabk <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(rx1, rx2, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Radiologista 1"</span>, <span class="st">"Radiologista 2"</span>)))</span>
<span id="cb56-748"><a href="#cb56-748" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tabk, <span class="at">FUN =</span> sum)</span>
<span id="cb56-749"><a href="#cb56-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-750"><a href="#cb56-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-751"><a href="#cb56-751" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo do *kappa*</span></span>
<span id="cb56-752"><a href="#cb56-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-753"><a href="#cb56-753" aria-hidden="true" tabindex="-1"></a>O *kappa* é dado pela execução da função:</span>
<span id="cb56-754"><a href="#cb56-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-757"><a href="#cb56-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-758"><a href="#cb56-758" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> vcd<span class="sc">::</span><span class="fu">Kappa</span>(tabk)</span>
<span id="cb56-759"><a href="#cb56-759" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (k, </span>
<span id="cb56-760"><a href="#cb56-760" aria-hidden="true" tabindex="-1"></a>       <span class="at">digits=</span> <span class="dv">3</span>, </span>
<span id="cb56-761"><a href="#cb56-761" aria-hidden="true" tabindex="-1"></a>       <span class="at">CI=</span><span class="cn">TRUE</span>, </span>
<span id="cb56-762"><a href="#cb56-762" aria-hidden="true" tabindex="-1"></a>       <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb56-763"><a href="#cb56-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-764"><a href="#cb56-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-765"><a href="#cb56-765" aria-hidden="true" tabindex="-1"></a>A saída exibe o *kappa* pontual e os intervalos de confiança de 95%, podendo-se concluir, desses resultados, que existe uma boa confiabilidade nos diagnósticos dos radiologistas (k = 0,67, concordância substancial,de acordo com a @tbl-kappa).</span>
</code><button title="Copiar para a área de transferência" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>