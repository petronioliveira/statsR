<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Anova de Medidas Repetidas – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./17-correlacao.html" rel="next">
<link href="./15-anova.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14-teste-t.html">Parte VI - Testes Paramétricos</a></li><li class="breadcrumb-item"><a href="./16-anovaRep.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I - Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II - Ambiente Computacional com R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-introducaoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introdução ao uso do R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando dados no R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III - Estatística Descritiva</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-medidasResumidoras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Medidas Resumidoras</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tabelas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tabelas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gráficos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV - Probabilidades e Distribuições</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-assimetria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte V - Inferência Estatística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VI - Testes Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-anovaRep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VII - Relações entre Variáveis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-correlacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VIII - Métodos Não Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dadoscategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-testes-naoParametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IX - Bioestatística Aplicada à Epidemiologia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-testesDiag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-medidasOcorrencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sobrevida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-reglogbin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossário</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-usados-neste-capítulo" id="toc-pacotes-usados-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-usados-neste-capítulo"><span class="header-section-number">16.1</span> Pacotes usados neste capítulo</a></li>
  <li><a href="#introdução" id="toc-introdução" class="nav-link" data-scroll-target="#introdução"><span class="header-section-number">16.2</span> Introdução</a></li>
  <li><a href="#anova-de-medidas-repetidas-unifatorial" id="toc-anova-de-medidas-repetidas-unifatorial" class="nav-link" data-scroll-target="#anova-de-medidas-repetidas-unifatorial"><span class="header-section-number">16.3</span> ANOVA de medidas repetidas unifatorial</a>
  <ul class="collapse">
  <li><a href="#sec-dadoscap16" id="toc-sec-dadoscap16" class="nav-link" data-scroll-target="#sec-dadoscap16"><span class="header-section-number">16.3.1</span> Dados usados no exemplo</a></li>
  <li><a href="#sec-anova1model" id="toc-sec-anova1model" class="nav-link" data-scroll-target="#sec-anova1model"><span class="header-section-number">16.3.2</span> Criação do modelo de ajuste</a></li>
  <li><a href="#avaliação-dos-pressupostos" id="toc-avaliação-dos-pressupostos" class="nav-link" data-scroll-target="#avaliação-dos-pressupostos"><span class="header-section-number">16.3.3</span> Avaliação dos pressupostos</a></li>
  <li><a href="#testes-post-hoc" id="toc-testes-post-hoc" class="nav-link" data-scroll-target="#testes-post-hoc"><span class="header-section-number">16.3.4</span> Testes <em>post hoc</em></a></li>
  <li><a href="#tamanho-do-efeito" id="toc-tamanho-do-efeito" class="nav-link" data-scroll-target="#tamanho-do-efeito"><span class="header-section-number">16.3.5</span> Tamanho do Efeito</a></li>
  <li><a href="#conclusão" id="toc-conclusão" class="nav-link" data-scroll-target="#conclusão"><span class="header-section-number">16.3.6</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#anova-de-medidas-repetidas-bifatorial" id="toc-anova-de-medidas-repetidas-bifatorial" class="nav-link" data-scroll-target="#anova-de-medidas-repetidas-bifatorial"><span class="header-section-number">16.4</span> ANOVA de medidas repetidas bifatorial</a>
  <ul class="collapse">
  <li><a href="#dados-usados-no-exemplo" id="toc-dados-usados-no-exemplo" class="nav-link" data-scroll-target="#dados-usados-no-exemplo"><span class="header-section-number">16.4.1</span> Dados usados no exemplo</a></li>
  <li><a href="#sec-anova2model" id="toc-sec-anova2model" class="nav-link" data-scroll-target="#sec-anova2model"><span class="header-section-number">16.4.2</span> Criação do modelo com dois fatores</a></li>
  <li><a href="#avaliação-dos-pressupostos-do-modelo" id="toc-avaliação-dos-pressupostos-do-modelo" class="nav-link" data-scroll-target="#avaliação-dos-pressupostos-do-modelo"><span class="header-section-number">16.4.3</span> Avaliação dos pressupostos do modelo</a></li>
  <li><a href="#testes-post-hoc-1" id="toc-testes-post-hoc-1" class="nav-link" data-scroll-target="#testes-post-hoc-1"><span class="header-section-number">16.4.4</span> Testes post hoc</a></li>
  <li><a href="#relatando-os-resultados-da-anova-de-medidas-repetidas-de-dois-fatores" id="toc-relatando-os-resultados-da-anova-de-medidas-repetidas-de-dois-fatores" class="nav-link" data-scroll-target="#relatando-os-resultados-da-anova-de-medidas-repetidas-de-dois-fatores"><span class="header-section-number">16.4.5</span> Relatando os resultados da ANOVA de medidas repetidas de dois fatores</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14-teste-t.html">Parte VI - Testes Paramétricos</a></li><li class="breadcrumb-item"><a href="./16-anovaRep.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-usados-neste-capítulo" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="pacotes-usados-neste-capítulo"><span class="header-section-number">16.1</span> Pacotes usados neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(afex, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               dplyr, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               effectsize,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               emmeans,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               flextable,  </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               ggplot2, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               ggpubr, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               ggsci, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               knitr, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               lmtest,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>               nlme,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               readxl, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               rstatix, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>               tidyr)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introdução" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="introdução"><span class="header-section-number">16.2</span> Introdução</h2>
<p>A ANOVA de medidas repetidas (<em>Repeated Measures ANOVA</em>) é uma técnica estatística usada quando o mesmo grupo de participantes é medido várias vezes, seja ao longo do tempo ou sob diferentes condições. Ela é ideal para dados longitudinais ou experimentos intra-sujeitos, onde cada sujeito serve como seu próprio controle. São exemplos típicos:</p>
<p>• Medir a qualidade de vida de crianças asmáticas em vários momentos para avaliar o impacto de um programa de atenção ao asmático;</p>
<p>• Testar tempos de reação em um teste em três tempos em um mesmo grupo;</p>
<p>• Testar a autoestima de um mesmo grupo após a introdução de um tipo especial de dieta.</p>
<p>A <a href="#tbl-compare" class="quarto-xref">Tabela&nbsp;<span>16.1</span></a> mostra algumas diferenças importantes entre a ANOVA e a ANOVA de Medidas Repetidas:</p>
<div class="cell">
<div id="tbl-compare" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;16.1: Comparação entre ANOVA e ANOVA de medidas repetidas
</figcaption>
<div aria-describedby="tbl-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e8394d9c{}.cl-e82e3268{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e82e327c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e833dd9e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e833fdf6{width:2.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e833fe00{width:2.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e833fe01{width:2.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e8394d9c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-e833fdf6"><p class="cl-e833dd9e"><span class="cl-e82e3268">Característica</span></p></th><th class="cl-e833fdf6"><p class="cl-e833dd9e"><span class="cl-e82e3268">ANOVA (entre sujeitos)</span></p></th><th class="cl-e833fdf6"><p class="cl-e833dd9e"><span class="cl-e82e3268">ANOVA de Medidas Repetidas (intra-sujeitos)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Tipo de Amostra</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Grupos independentes</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Mesmos sujeitos em diferentes condições</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Controle da variabilidade individual</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Não controla</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Controla (cada sujeito é seu próprio controle)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Sensibilidade estatística</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Menor</span></p></td><td class="cl-e833fe00"><p class="cl-e833dd9e"><span class="cl-e82e327c">Maior (reduz o erro residual)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e833fe01"><p class="cl-e833dd9e"><span class="cl-e82e327c">Suposição de esfericidade</span></p></td><td class="cl-e833fe01"><p class="cl-e833dd9e"><span class="cl-e82e327c">Não se aplica</span></p></td><td class="cl-e833fe01"><p class="cl-e833dd9e"><span class="cl-e82e327c">Necessária (testada com o teste de Mauchly)</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>A ANOVA de medidas repetidas é mais poderosa estatisticamente porque reduz a variabilidade entre sujeitos, focando nas mudanças dentro de cada indivíduo. A ANOVA de medidas repetidas pode ser entendida como uma expansão da ANOVA (<span class="citation" data-cites="anunciacao2021anovarep">(<a href="referencias.html#ref-anunciacao2021anovarep" role="doc-biblioref">1</a>)</span>).</p>
</section>
<section id="anova-de-medidas-repetidas-unifatorial" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="anova-de-medidas-repetidas-unifatorial"><span class="header-section-number">16.3</span> ANOVA de medidas repetidas unifatorial</h2>
<p>A ANOVA de medidas repetidas de um fator é um teste estatístico que compara as médias de três ou mais grupos relacionados, onde os mesmos participantes são medidos repetidamente em diferentes momentos ou condições para avaliar a mudança em uma variável dependente. É uma extensão do teste t pareado para mais de dois grupos e, por avaliar o mesmo grupo ao longo do tempo, controla diferenças individuais.</p>
<section id="sec-dadoscap16" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="sec-dadoscap16"><span class="header-section-number">16.3.1</span> Dados usados no exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário do exemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um estudo, realizado em um ambulatório de Doenças Respiratórias Pediátricas, avaliou a função pulmonar de um grupo de crianças por um período de 3 meses (0, 45 dias, 90 dias) usando um novo corticoide inalatório. Todas as crianças tinham idade entre 7 e 15 anos e a medida avaliadora foi PFE (Pico de Fluxo Expiratório) ou <em>Peak Flow Meter</em> (PFM), taxa máxima de ar expelida pelos pulmões durante uma expiração forçada), indicador importante da função pulmonar, especialmente no monitoramento de asma.</p>
</div>
</div>
<p>Os dados podem ser obtidos <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosAsma.xlsx">aqui</a>. Baixe no seu diretório de trabalho e carregue com a função <code>read_excel()</code> do pacote <code>readxl</code>. Na ANOVA de medidas repetidas de um fator, será usado apenas o grupo, denominado de <code>caso</code>, que usou o medicamento testado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dados_uni <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosAsma.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grupo <span class="sc">==</span> <span class="st">"caso"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_uni)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [41 × 5] (S3: tbl_df/tbl/data.frame)
 $ id   : num [1:41] 1 2 3 4 5 6 7 8 9 10 ...
 $ grupo: chr [1:41] "caso" "caso" "caso" "caso" ...
 $ t0   : num [1:41] 170 100 160 180 250 180 170 180 240 200 ...
 $ t1   : num [1:41] 180 140 180 180 300 200 180 200 320 200 ...
 $ t2   : num [1:41] 220 100 220 250 240 280 220 250 350 250 ...</code></pre>
</div>
</div>
<section id="exploração-e-transformação-dos-dados" class="level4" data-number="16.3.1.1">
<h4 data-number="16.3.1.1" class="anchored" data-anchor-id="exploração-e-transformação-dos-dados"><span class="header-section-number">16.3.1.1</span> Exploração e transformação dos dados</h4>
<p>Observando a saída da função <code>str()</code>, verifica-se os dados se encontram no formato amplo (a variável tempo está colocada em três colunas, t<sub>0</sub>, t<sub>1</sub>, t<sub>2</sub>) e a ANOVA de medidas repetidas necessita de que os dados estejam no formato longo. Isso significa que, ao invés de ter cada medida repetida em uma coluna separada, haverá uma coluna para o identificador (<code>id</code>) do indivíduo, uma coluna para o <code>tempo/condição</code> (fator de medidas repetidas), e uma coluna para o valor da variável dependente (<code>VD = escores</code>).</p>
<p>Para fazer esta transformação será realizada pela função <code>pivot_longer()</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>do pacote <code>tidyr</code> <span class="citation" data-cites="wickham2022tidyr">(<a href="referencias.html#ref-wickham2022tidyr" role="doc-biblioref">2</a>)</span>. Nesta função, no argumento <code>data</code>, coloca-se o nome do conjunto de dados; em <code>cols</code>, há necessidade informar as colunas do formato amplo que serão reunidas. No argumento <code>names_to</code>, nomear a coluna que conterá as colunas unificadas e em <code>values_to</code>, especificar o nome da variável no formato longo que conterá os valores. A variável <code>id</code> e a nova variável <code>tempo</code> devem ser convertida para fatores e o novo conjunto de dados será atribuído a um objeto nomeado <code>dadosL_uni</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="ot">&lt;-</span> dados_uni <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(t0, t1, t2),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"tempo"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"escores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert_as_factor</span>(id, tempo)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_uni)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [123 × 4] (S3: tbl_df/tbl/data.frame)
 $ id     : Factor w/ 41 levels "1","2","3","4",..: 1 1 1 2 2 2 3 3 3 4 ...
 $ grupo  : chr [1:123] "caso" "caso" "caso" "caso" ...
 $ tempo  : Factor w/ 3 levels "t0","t1","t2": 1 2 3 1 2 3 1 2 3 1 ...
 $ escores: num [1:123] 170 180 220 100 140 100 160 180 220 180 ...</code></pre>
</div>
</div>
</section>
<section id="sumarização-dos-dados" class="level4" data-number="16.3.1.2">
<h4 data-number="16.3.1.2" class="anchored" data-anchor-id="sumarização-dos-dados"><span class="header-section-number">16.3.1.2</span> Sumarização dos dados</h4>
<p>Serão calculadas algumas estatísticas resumidas dos escores espirométricos por grupos (<code>tempo</code>): média e desvio padrão, usando a funções <code>group_by()</code> e <code>summarise()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                   média <span class="ot">=</span> <span class="fu">mean</span>(escores, <span class="at">na.rm =</span><span class="cn">TRUE</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dp =</span> <span class="fu">sd</span>(escores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  tempo     n média    dp
  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 t0       41  174.  42.8
2 t1       41  205.  53.2
3 t2       41  229.  56.1</code></pre>
</div>
</div>
<p>O resumo mostra que a média aumenta do momento inícial (t<sub>0</sub>) para o final (t<sub>2</sub>).</p>
</section>
<section id="visualização-dos-dados" class="level4" data-number="16.3.1.3">
<h4 data-number="16.3.1.3" class="anchored" data-anchor-id="visualização-dos-dados"><span class="header-section-number">16.3.1.3</span> Visualização dos dados</h4>
<p>A visualização pode ser obtida com um conjunto de boxplots (<a href="#fig-bxppfe" class="quarto-xref">Figura&nbsp;<span>16.1</span></a>), usando o pacote <code>ggpubr</code> com a função <code>ggboxplot()</code>. Este gráfico permite visualizar a variação dos escores com o tempo e a variabilidade em cada um dos momentos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_uni,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"escores"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bxppfe" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bxppfe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-bxppfe-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bxppfe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.1: Boxplots mostrando o impacto de uma medicação através do tempo
</figcaption>
</figure>
</div>
</div>
</div>
<p>Outra maneira de obter praticamente as mesmas informações visuais é através de um gráfico de linha (<a href="#fig-linepfe" class="quarto-xref">Figura&nbsp;<span>16.2</span></a>) que mostra bem o comportamento dos escores com o tempo e em cada momento:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_uni, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_ci"</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="fl">1.5</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>()) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Pico de Fluxo Expiratório (l/min)"</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tempo"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-linepfe" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linepfe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-linepfe-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linepfe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.2: Boxplots mostrando o impacto de uma medicação através do tempo
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ambas as figuras exibem uma modificação dos escores espirométricos (melhora nitidamente!) à medida que o tempo passa, utilizando a medicação.</p>
</section>
</section>
<section id="sec-anova1model" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="sec-anova1model"><span class="header-section-number">16.3.2</span> Criação do modelo de ajuste</h3>
<p>Para criar o modelo da ANOVA de medidas repetidas pode-se usar a função <code>aov_car()</code> pacote <code>afex</code> que fornece uma abordagem de alta robustez estatística e libera o teste de Mauchly com as correções de esfericidade.</p>
<div id="aov_car" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estrutura do modelo aov_car
</div>
</div>
<div class="callout-body-container callout-body">
<pre><code>aov_car(valor ~ fator + Error(sujeito/fator), data = dados)</code></pre>
<p>Onde,</p>
<ul>
<li><p><strong>data</strong>: dataframe no fornato longo</p></li>
<li><p><strong>fórmula</strong>: que deve incluir</p>
<ul>
<li><p>valor = variável dependente;</p></li>
<li><p>fator = variável independente (fator de medidas repetidas);</p></li>
<li><p>sujeito = variável que identifique o indivíduo, para um modelo de medidas repetidas de um fator - Error(id/tempo)</p></li>
</ul></li>
<li><p>O termo <code>Error(id/tempo)</code> é a chave para a análise de variância de medidas repetidas. É para o R entender que se usará um delineamento de medidas repetidas. Ele não é uma função, mas sim um <strong>símbolo de estrutura</strong> dentro da fórmula do <code>aov()</code> . Lê-se: “Erro aninhado em <code>id</code> dentro do tempo”. Este termo instrui ao R para decompor a variabilidade total do modelo em partes específicas, isolando a variância que é realmente do <strong>efeito do tratamento</strong> (<code>tempo</code>) que é apenas devida às <strong>diferenças individuais</strong> (<code>id</code>).</p></li>
</ul>
</div>
</div>
<p>Portanto, no exemplo em estudo, a sintaxe para o ajuste do modelo é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>modelo_aov <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(escores <span class="sc">~</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), <span class="at">data =</span> dadosL_uni)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esse comando cria um objeto <code>modelo.aov</code> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> que contém os resultados da ANOVA de medidas repetidas (tabela da ANOVA do tipo III) e outras informações, como o teste de Mauchly.<br>
Para ver a partição da variância e o teste F, usa-se a função <code>summary()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_aov)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.Anova.mlm(object$Anova, multivariate = FALSE): HF eps &gt; 1
treated as 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

             Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept) 5052075      1   250720     40 806.011 &lt; 2.2e-16 ***
tempo         61417      2    61853     80  39.718 1.047e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

      Test statistic p-value
tempo        0.97503  0.6107


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

       GG eps Pr(&gt;F[GG])    
tempo 0.97564  1.879e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

        HF eps   Pr(&gt;F[HF])
tempo 1.025029 1.047466e-12</code></pre>
</div>
</div>
<p>A saída do modelo mostra a Tabela da ANOVA de Medidas repetidas de um fator (tempo) e resume os resultados do teste de esfericidade de Mauchly e as correções de Greenhouse-Geisser (GG) e Huynh-Feldt (HF).</p>
<p>O <strong>teste de Mauchly</strong> avalia a suposição de esfericidade, que é o pressuposto de que as variâncias das diferenças entre todos os pares de níveis de repetição (os três momentos de medição) são iguais. Como o valor <em>p</em> = 0,6107 não se rejeita a H<sub>0</sub> e se conclui que a esfericidade é válida e podemos confiar nos resultados da ANOVA univariada tipo III sem necessidade de correção. As correções de Greenhouse-Geisser e Huynh-Feldt confirmam a forte significância do efeito de tempo , entretanto, embora apresentadas, não são estritamente necessárias neste caso (veja mais sobre esfericidade na <a href="#sec-esphericity" class="quarto-xref"><span>Seção 16.3.3.4</span></a>).</p>
<p>A tabela principal da ANOVA univariada Tipo III, assumindo esfericidade, testa a hipótese nula de que não há diferença entre as médias das medições do PFE nos três momentos de tempo.</p>
<ul>
<li><p>O intercepto doi significativo (<em>p</em><span class="math inline">\(&lt; 2,2 \times 10^-16\)</span>), indicando que média geral é significativamente diferente de zero. Este resultado não é importante para o efeito do tratamento.</p></li>
<li><p>O efeito do <strong>tempo</strong> foi significativo (F = 39,72; <em>p</em> <span class="math inline">\(= 1,047 \times 10^-12\)</span>), o que significa rejeitar a H<sub>0</sub> de igualdade das médias através do tempo. O F é igual QM<sub>tempo</sub>/QM~residuo ou erro~.</p></li>
<li><p>O Quadrado Médio(QM) é obtido dividindo a Soma dos Quadrados(SQ) pelos respectivos graus de liberdade (gl) e F pela razão entre os quadrados médios(variâncias):</p></li>
</ul>
<p><span class="math display">\[QM_{tempo} = \frac{SQ_{tempo}}{gl_{tempo}}\]</span></p>
<p><span class="math display">\[QM_{erro} = \frac{SQ_{erro}}{gl_{erro}}\]</span></p>
<p><span class="math display">\[F = \frac{QM_{tempo}}{QM_{erro}}\]</span></p>
<p>A Tabela da ANOVA pode ser resumida coma a <a href="#tbl-tabAnovaRep" class="quarto-xref">Tabela&nbsp;<span>16.2</span></a>.</p>
<div class="cell">
<div id="tbl-tabAnovaRep" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabAnovaRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;16.2: Tabela da ANOVA de Medidas repetidas tipo III, assumindo a esfericidade
</figcaption>
<div aria-describedby="tbl-tabAnovaRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e934d0d6{}.cl-e9231e5e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e9231e72{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e92c0924{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e92c58fc{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c5910{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c591a{width:0.8in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c591b{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c5924{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c5925{width:0.8in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c592e{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c5938{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e92c5942{width:0.8in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e934d0d6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-e92c58fc"><p class="cl-e92c0924"><span class="cl-e9231e5e">Fonte de Variação</span></p></th><th class="cl-e92c58fc"><p class="cl-e92c0924"><span class="cl-e9231e5e">Soma dos Quadrados</span></p></th><th class="cl-e92c5910"><p class="cl-e92c0924"><span class="cl-e9231e5e">gl</span></p></th><th class="cl-e92c58fc"><p class="cl-e92c0924"><span class="cl-e9231e5e">Quadrado Médio</span></p></th><th class="cl-e92c591a"><p class="cl-e92c0924"><span class="cl-e9231e5e">F</span></p></th><th class="cl-e92c58fc"><p class="cl-e92c0924"><span class="cl-e9231e5e">Valor p</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e92c591b"><p class="cl-e92c0924"><span class="cl-e9231e72">tempo</span></p></td><td class="cl-e92c591b"><p class="cl-e92c0924"><span class="cl-e9231e72">61.417</span></p></td><td class="cl-e92c5924"><p class="cl-e92c0924"><span class="cl-e9231e72">2</span></p></td><td class="cl-e92c591b"><p class="cl-e92c0924"><span class="cl-e9231e72">30.708,500</span></p></td><td class="cl-e92c5925"><p class="cl-e92c0924"><span class="cl-e9231e72">39,718</span></p></td><td class="cl-e92c591b"><p class="cl-e92c0924"><span class="cl-e9231e72">&lt; 0.0001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e92c592e"><p class="cl-e92c0924"><span class="cl-e9231e72">resíduo</span></p></td><td class="cl-e92c592e"><p class="cl-e92c0924"><span class="cl-e9231e72">61.853</span></p></td><td class="cl-e92c5938"><p class="cl-e92c0924"><span class="cl-e9231e72">80</span></p></td><td class="cl-e92c592e"><p class="cl-e92c0924"><span class="cl-e9231e72">773,162</span></p></td><td class="cl-e92c5942"><p class="cl-e92c0924"><span class="cl-e9231e72"></span></p></td><td class="cl-e92c592e"><p class="cl-e92c0924"><span class="cl-e9231e72"></span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p><strong>Existe uma diferença estatisticamente significativa</strong> nas medições de <em>Peak Flow Meter</em> das crianças asmáticas ao longo dos três momentos distintos (0, 45 e 90 dias). Isto apenas indica que <em>pelo menos dois</em> momentos são diferentes, haverá necessidade de realizar testes <em>post hoc</em>.</p>
</section>
<section id="avaliação-dos-pressupostos" class="level3" data-number="16.3.3">
<h3 data-number="16.3.3" class="anchored" data-anchor-id="avaliação-dos-pressupostos"><span class="header-section-number">16.3.3</span> Avaliação dos pressupostos</h3>
<p>A ANOVA de Medidas Repetidas Unifatorial possui três pressupostos importantes e dois deles são avaliados diretamente a partir dos resíduos do modelo:</p>
<ol type="1">
<li>Normalidade dos Resíduos<br>
</li>
<li>Ausência de valores atípicos<br>
</li>
<li>Esfericidade (pressuposto exclusivo para medidas repetidas e é avaliado nas diferenças entre as medidas, não diretamente nos resíduos do modelo, mas é fundamental).</li>
</ol>
<section id="obtenção-dos-resíduos-e-valores-ajustados" class="level4" data-number="16.3.3.1">
<h4 data-number="16.3.3.1" class="anchored" data-anchor-id="obtenção-dos-resíduos-e-valores-ajustados"><span class="header-section-number">16.3.3.1</span> Obtenção dos resíduos e valores ajustados</h4>
<p>Para a avaliação dos pressupostos há necessidade de obter os resíduos do modelo. Os resíduos correspondem a diferença entre os valores observados e os valores ajustados (<em>fitted values</em>) pelo modelo. Esses valores podem ser extraídos com a função <code>residuals()</code> e a função <code>fitted()</code> a partir do modelo. Para a avaliação dos pressupostos sera ajustado um modelo com a função <code>lme()</code> do pacote <code>nlme</code>, pois ele fornece resíduos menos dispersos, mais realistas e considera a estrutura de correlação entre medidas <span class="citation" data-cites="matsubara2019anova">(<a href="referencias.html#ref-matsubara2019anova" role="doc-biblioref">3</a>)</span> <span class="citation" data-cites="pinheiro2000mixed">(<a href="referencias.html#ref-pinheiro2000mixed" role="doc-biblioref">4</a>)</span>.</p>
<div id="modelo_lme" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estrutura do modelo lme
</div>
</div>
<div class="callout-body-container callout-body">
<p>O <code>modelo_lme</code> deve incluir o seguinte:</p>
<pre><code>modelo_lme &lt;- lme(
  resposta ~ efeitos fixos,
  random = ~ estrutura_aleatoria | unidade_agrgadora,
  correlation = estrutura_correlacao,
  data = dataframe)</code></pre>
<ol type="1">
<li><strong>Parte fixa</strong>, representada pela fórmula: No exemplo, <code>escores ~ grupo * tempo</code>. Esta fórmula modela os escores como função dos efeitos principais de <code>grupo</code> e <code>tempo</code>, mais a <strong>interação entre eles</strong>. Isso responde como os escores variam entre grupos, ao longo do tempo, e se essa variação depende do grupo. Na ANOVA de medidas repetidas unifatorial, o fator grupo não existe porque há apenas um grupo. Nesse caso, a fórmula fica simplificada para apenas <code>escores ~ tempo</code>.</li>
<li><strong>Parte aleatória</strong>: <code>ramdom = ~1| id</code>. Aqui se afirma que cada <code>id</code> (sujeito) tem um intercepto próprio, ou seja cada indivíduo começa de um ponto diferente. Isso captura a variabilidade individual entre sujeitos.</li>
<li><strong>Estrutura de correlação composta simétrica</strong>: <code>correlation = corCompSymm(form = ~1 | id)</code>. Isso significa que todas as observações dentro de um mesmo sujeito (<code>id</code>) são igualmente correlacionadas entre si, independentemente do tempo. É uma forma simples de modelar a dependência entre medidas repetidas. Este argumento não é obrigatório, mas pode melhorar o ajuste e a interpretação do modelo. Deve ser considerado se:
<ul>
<li>Os tempos são equidistantes (ex; dias, semanas);</li>
<li>Há suspeita que há correlação entre as medidas dentro de cada sujeito.</li>
<li>O modelo sem ele apresenta resíduos autocorrelacionados ou ajuste ruim.</li>
</ul></li>
<li><strong>Fonte dos dados</strong>: <code>data  = dataframe</code> . Dados sobre o qual o modelo será ajustado. Devem estar no <strong>formato longo</strong> (cada linha é uma observação de um sujeito em um tempo).</li>
</ol>
</div>
</div>
<p>Após o ajuste do modelo, <code>modelo_lme</code>, os valores residuais bem como os ajustados, serão incorporados ao dataframe <code>dadosL_uni</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>modelo_lme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> tempo,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>dadosL_uni<span class="sc">$</span>residuos <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_lme)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>dadosL_uni<span class="sc">$</span>ajustados <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelo_lme)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_uni)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [123 × 6] (S3: tbl_df/tbl/data.frame)
 $ id       : Factor w/ 41 levels "1","2","3","4",..: 1 1 1 2 2 2 3 3 3 4 ...
 $ grupo    : chr [1:123] "caso" "caso" "caso" "caso" ...
 $ tempo    : Factor w/ 3 levels "t0","t1","t2": 1 2 3 1 2 3 1 2 3 1 ...
 $ escores  : num [1:123] 170 180 220 100 140 100 160 180 220 180 ...
 $ residuos : Named num [1:123] 6.71 -13.48 2.08 3.92 13.73 ...
  ..- attr(*, "names")= chr [1:123] "1" "1" "1" "2" ...
  ..- attr(*, "label")= chr "Residuals"
 $ ajustados: Named num [1:123] 163.3 193.5 217.9 96.1 126.3 ...
  ..- attr(*, "names")= chr [1:123] "1" "1" "1" "2" ...
  ..- attr(*, "label")= chr "Fitted values"</code></pre>
</div>
</div>
</section>
<section id="normalidade-dos-resíduos" class="level4" data-number="16.3.3.2">
<h4 data-number="16.3.3.2" class="anchored" data-anchor-id="normalidade-dos-resíduos"><span class="header-section-number">16.3.3.2</span> Normalidade dos resíduos</h4>
<p>A suposição de normalidade dos resíduos é fundamental para a validade dos testes estatísticos em modelos lineares. Em modelos com medidas repetidas, essa suposição pode variar ao longo dos diferentes momentos de avaliação. Para verificar essa condição, será aplicado o teste de Shapiro-Wilk, usando a função <code>shapiro_test()</code> do pacote <code>rstatix</code> e gerados gráficos QQ dos resíduos por tempo (t<sub>0</sub>, t<sub>1</sub>, t<sub>2</sub>), com o <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(residuos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  tempo variable statistic       p
  &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1 t0    residuos     0.895 0.00118
2 t1    residuos     0.962 0.186  
3 t2    residuos     0.982 0.740  </code></pre>
</div>
</div>
<p>É interessante complementar essa avaliação formal com a construção, de um gráfico QQ:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_uni, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> residuos, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tempo)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> tempo) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"QQ Plot dos Resíduos por Tempo"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantis Teóricos"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Quantis dos Resíduos"</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qqpef" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqpef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-qqpef-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qqpef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.3: Gráfico QQ para verificar a normalidade
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os gráficos QQ (<a href="#fig-qqpef" class="quarto-xref">Figura&nbsp;<span>16.3</span></a>) revelaram que os resíduos nos tempos t<sub>1</sub> e t<sub>2</sub> estão bem alinhados à linha teórica, indicando distribuição aproximadamente normal. Já no tempo t<sub>0</sub>, observou-se maior dispersão nas extremidades, sugerindo violação da normalidade. Essa observação foi confirmada pelo teste de Shapiro-Wilk.<br>
Os resíduos do tempo t<sub>0</sub> apresentaram distribuição significativamente diferente da normal (<em>p</em> &lt; 0,05), enquanto os tempos t<sub>1</sub> e t<sub>2</sub> não rejeitaram a hipótese de normalidade. Essa variação pode refletir maior heterogeneidade basal ou instabilidade clínica inicial. Recomenda-se, portanto, que a avaliação da normalidade dos resíduos em modelos com medidas repetidas seja feita por tempo, e não de forma agregada, para garantir maior precisão na interpretação dos pressupostos.<br>
Mesmo com resíduos não normalmente distribuídos em t<sub>0</sub>, o modelo permanece válido desde que a esfericidade seja assumida; que o modelo tenha sido ajustado com <code>lme()</code> ou <code>aov_car()</code> com estrutura de erro adequada e que os resíduos nos demais tempos estejam dentro dos padrões esperados <span class="citation" data-cites="pinheiro2000mixed">(<a href="referencias.html#ref-pinheiro2000mixed" role="doc-biblioref">4</a>)</span> <span class="citation" data-cites="copilot2025">(<a href="referencias.html#ref-copilot2025" role="doc-biblioref">5</a>)</span>.</p>
</section>
<section id="identificação-de-valores-atípicos" class="level4" data-number="16.3.3.3">
<h4 data-number="16.3.3.3" class="anchored" data-anchor-id="identificação-de-valores-atípicos"><span class="header-section-number">16.3.3.3</span> Identificação de valores atípicos</h4>
<p>Não deve haver valores atípicos extremos nos resíduos. Pode-se verificar a presença de valores atípicos, usando a função <code>identify_outliers()</code> do pacote <code>rstatix</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(residuos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  tempo id    grupo escores residuos ajustados is.outlier is.extreme
  &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
1 t0    13    caso      150    -54.2      204. TRUE       FALSE     
2 t0    26    caso      110    -56.2      166. TRUE       FALSE     
3 t0    30    caso      200    -38.7      239. TRUE       FALSE     </code></pre>
</div>
</div>
<p>A saída mostra a presença de três de valores atípicos, todos no momento t<sub>0</sub>. Nenhum é outlier extremo. Isso também pode ser verificado na <a href="#fig-bxppef2" class="quarto-xref">Figura&nbsp;<span>16.4</span></a> dos boxplots.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_uni,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"residuos"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bxppef2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bxppef2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-bxppef2-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bxppef2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.4: Boxplots dos resíduos de acordo com o tempo
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-esphericity" class="level4" data-number="16.3.3.4">
<h4 data-number="16.3.3.4" class="anchored" data-anchor-id="sec-esphericity"><span class="header-section-number">16.3.3.4</span> Teste de esfericidade</h4>
<p>A esfericidade é a versão da homocedasticidade para medidas repetidas, é avaliada como foi visto (<a href="#sec-anova1model" class="quarto-xref"><span>Seção 16.3.2</span></a>) pelo teste de Mauchly. O teste de Mauchly é uma avaliação da matriz de covariância das diferenças entre os níveis do fator. A matriz de covariância é a ferramenta que avalia se a variação nas mudanças ao longo do tempo é consistente. O teste de Mauchly podes ser obtido ajustando o modelo unifatorial de medidas repetidas (tempo), usando a função <code>aov_car()</code> do pacote <code>afex</code> . A saída do teste de Mauchly exibiu um valor <em>p</em>$ &gt; 0,05$, indicando que o pressuposto da esfericidade não foi violado, não havendo necessidade de recorrer às correções da esfericidade, que seriam obtidas da seguinte maneira:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lógica do teste de Mauchly
</div>
</div>
<div class="callout-body-container callout-body">
<p>O teste de Mauchly é uma avaliação da matriz de covariância das diferenças entre os níveis do fator. O que isto significa?</p>
<p>O exemplo usado na ANOVA de medidas repetidas corresponde a medida de Pico de Fluxo Expiratório (PFE) em três momentos (t<sub>0</sub>, t<sub>1</sub> e t<sub>3</sub>, respectivamente, basal, 45 dias e 90 dias).</p>
<p>Para saber se o tratamento funciona, não se está interessado apenas na medida do PFE em cada tempo, mas sim na <strong>mudança</strong> que o tratamento causou. Se quer saber se a PFE no tempo 1 é diferente da PFE no tempo 0, e se o PFE no tempo 2 é diferente do PFE nos tempos anteriores.</p>
<p>As “mudanças” são as <strong>diferenças</strong> entre os níveis do fator, ou seja:</p>
<ul>
<li>Dif 1: (t1−t0)</li>
<li>Dif 2: (t2−t0)</li>
<li>Dif 3: (t2−t1)</li>
</ul>
<p>A ANOVA de medidas repetidas assume que essas diferenças têm uma relação especial entre si. Ela assume que a <strong>variância de cada uma dessas diferenças é aproximadamente a mesma</strong> e que a <strong>correlação (ou covariância) entre elas também é a mesma</strong>.</p>
<p><u>Matriz de Covariância das Diferenças</u></p>
<p>Imagine-se que se calculou a variância de cada uma dessas diferenças. A matriz de covariância das diferenças é uma tabela que organiza esses resultados em uma matriz quadrada (3 x 3) e simétrica:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/Wxd1KUZ.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A suposição de <strong>esfericidade</strong> (que o teste de Mauchly avalia) é que todos os valores nessa matriz devem ser aproximadamente <strong>iguais</strong>. • As variâncias diagonais devem ser iguais; • As covariâncias fora da diagonal também devem ser <strong>iguais</strong>.</p>
<p><u>Importância do Teste de Mauchly</u></p>
<p>O teste de Mauchly verifica se essa suposição de esfericidade é verdadeira. • Se o <strong>teste de Mauchly for não significativo</strong> (<em>p</em> &gt; 0,05): Significa que a matriz das diferenças é “esférica” e a suposição de esfericidade foi mantida. Se pode confiar no resultado da ANOVA. • Se o <strong>teste de Mauchly for significativo</strong> (<em>p</em> &lt; 0,05): Significa que a suposição de esfericidade foi violada. As variâncias das diferenças não são iguais, e isso pode inflar a taxa de erro do Tipo I (a chance de encontrar um resultado significativo quando não existe um de verdade).</p>
<p>Quando a esfericidade é violada, é calculada as correções de <strong>Greenhouse-Geisser (GGe)</strong> ou <strong>Huynh-Feldt (HFe)</strong>, que ajustam os graus de liberdade e tornam o teste mais conservador, garantindo que o seu resultado final seja confiável. Huynh e Feldt <span class="citation" data-cites="huynh1976epsilon">(<a href="referencias.html#ref-huynh1976epsilon" role="doc-biblioref">6</a>)</span> relataram que quando a correção <span class="math inline">\(\epsilon\)</span> de Greenhouse-Geisser é &gt; 0,75 muitas hipóteses nulas falsas deixam de ser rejeitadas, isto é, o teste é muito conservador, propondo outra correção dos graus de liberdade. É recomendado o uso da correção de Greenhouse-Geisser para o ajuste dos graus de liberdade quando <span class="math inline">\(\epsilon\)</span> &lt; 0,75 ou nada se sabe a respeito da esfericidade <span class="citation" data-cites="girden1992epsilon">(<a href="referencias.html#ref-girden1992epsilon" role="doc-biblioref">7</a>)</span>. Avaliando o poder destes testes, Muller <span class="citation" data-cites="muller1989sphericity">(<a href="referencias.html#ref-muller1989sphericity" role="doc-biblioref">8</a>)</span> verificou que a correção de Greenhouse-Geisser fornece um controle adicional do erro Tipo I, enquanto o poder é maximizado.</p>
</div>
</div>
</section>
</section>
<section id="testes-post-hoc" class="level3" data-number="16.3.4">
<h3 data-number="16.3.4" class="anchored" data-anchor-id="testes-post-hoc"><span class="header-section-number">16.3.4</span> Testes <em>post hoc</em></h3>
<p>A ANOVA de medidas repetidas indicou uma modificação significativa nos escores de PEF ao longo do tempo com o uso da medicação. No entanto, esse teste apenas revela que há diferenças entre os tempos, sem especificar entre quais pares de momentos essas diferenças ocorrem. Para identificar onde essas diferenças são estatisticamente significativas, é necessário realizar uma análise <em>post hoc</em>. Utilizou-se a função <code>pairwise_t_test()</code> do pacote <code>rstatix</code>, que realiza comparações múltiplas entre pares de níveis do fator tempo, aplicando testes t pareados com correção para o erro Tipo I. Optou-se pelo método de Bonferroni (<code>p.adjust.method = "bonferroni"</code>), por ser mais conservador e reduzir o risco de falsos positivos, mesmo que sacrifique o poder estatístico. Em contextos com muitos grupos, métodos como Holm ou Benjamini-Hochberg (BH) podem ser preferidos por sua maior sensibilidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> <span class="fu">pairwise_t_test</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> escores <span class="sc">~</span> tempo, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
  .y.     group1 group2    n1    n2          p p.signif     p.adj p.adj.signif
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;       
1 escores t0     t1        41    41 0.00843    **       0.0253    *           
2 escores t0     t2        41    41 0.00000379 ****     0.0000114 ****        
3 escores t1     t2        41    41 0.0321     *        0.0964    ns          </code></pre>
</div>
</div>
<p>A saída mostra os pares comparados (<strong>group1</strong> vs <strong>group2</strong>) e os respectivos valores de <em>p</em> e <em>p</em> ajustado: • <strong>t0 vs.&nbsp;t1 (0 vs.&nbsp;45 dias)</strong>: <em>p</em> = 0,00843; <em>p</em> ajustado = 0,0253 → diferença significativa. • <strong>t0 vs.&nbsp;t2 (0 vs.&nbsp;90 dias)</strong>: <em>p</em> = 0,00000379; <em>p</em> ajustado = 0,0000114 → diferença altamente significativa. • <strong>t1 vs.&nbsp;t2 (45 vs.&nbsp;90 dias)</strong>: <em>p</em> = 0,0321; <em>p</em> ajustado = 0,0964 → diferença não significativa após correção. Esse último resultado sugere que, embora haja uma tendência de melhora entre os dias 45 e 90, ela não é estatisticamente robusta após correção de Bonferroni.</p>
</section>
<section id="tamanho-do-efeito" class="level3" data-number="16.3.5">
<h3 data-number="16.3.5" class="anchored" data-anchor-id="tamanho-do-efeito"><span class="header-section-number">16.3.5</span> Tamanho do Efeito</h3>
<p>O tamanho do efeito é uma medida da magnitude da diferença entre grupos, independente do tamanho da amostra. O tamanho do efeito na ANOVA pode ser obtido usando o parâmetro <span class="math inline">\(\eta^2\)</span> (eta ao quadrado), parcial ou generalizado, que está disponível no pacote <code>afex</code>, usado para ajustar o modelo (<a href="#sec-anova1model" class="quarto-xref"><span>Seção 16.3.2</span></a>). Na ANOVA de medidas repetidas, é calculado o eta ao quadrado generalizado, pois o parcial pode superestimar o efeito. O eta ao quadrado generalizado mede a proporção da variância explicada por um fator em relação a variância total, incluindo a variância entre sujeitos e outros efeitos, enquanto o eta ao quadrado parcial exclui outros fatores e interações. Usando o <code>mod_aov</code>, o tamanho do efeito pode ser obtido da seguinte forma usando a função <code>eta_squared()</code> do pacote <code>effetcsize</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">eta_squared</span> (modelo_aov, <span class="at">generalized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type III)

Parameter | Eta2 (generalized) |       95% CI
---------------------------------------------
tempo     |               0.16 | [0.05, 1.00]

- Observed variables: All
- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>De acordo com a <a href="15-anova.html#tbl-effectsize" class="quarto-xref">Tabela&nbsp;<span>15.2</span></a>, um eta ao quadrado igual a 0,16 pode ser considerado um grande efeito.</p>
</section>
<section id="conclusão" class="level3" data-number="16.3.6">
<h3 data-number="16.3.6" class="anchored" data-anchor-id="conclusão"><span class="header-section-number">16.3.6</span> Conclusão</h3>
<section id="análise-do-impacto-do-novo-corticoide" class="level4" data-number="16.3.6.1">
<h4 data-number="16.3.6.1" class="anchored" data-anchor-id="análise-do-impacto-do-novo-corticoide"><span class="header-section-number">16.3.6.1</span> Análise do Impacto do Novo Corticoide</h4>
<p>Uma ANOVA de medidas repetidas foi conduzida para avaliar o impacto do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório (PFE) em pacientes de 7 a 15 anos ao longo do tempo.</p>
<p>O teste revelou um efeito estatisticamente significativo do tempo sobre os escores de PFE, F(2,80) = 39.7, p &lt; 0.0001.</p>
<p>Para investigar onde as diferenças ocorreram, foi realizada uma análise <em>post hoc</em> com correção de Bonferroni. Os resultados indicaram que os escores de PFE melhoraram significativamente entre o início do estudo (t<sub>0</sub>) e o marco de 45 dias (t<sub>1</sub>), e também entre o início (t<sub>0</sub>) e o marco de 90 dias (t<sub>2</sub>). Embora tenha havido uma melhora contínua entre 45 e 90 dias, essa diferença não foi estatisticamente significativa após a correção para múltiplas comparações (<em>p</em> = 0.096). Esses resultados sugerem que o tratamento com o novo corticoide inalatório teve um impacto significativo na melhora dos escores de PFE, com a maior parte da mudança ocorrendo nos primeiros 45 dias.</p>
</section>
<section id="apresentação-visual" class="level4" data-number="16.3.6.2">
<h4 data-number="16.3.6.2" class="anchored" data-anchor-id="apresentação-visual"><span class="header-section-number">16.3.6.2</span> Apresentação Visual</h4>
<p>A <a href="#fig-linepfe1" class="quarto-xref">Figura&nbsp;<span>16.5</span></a> ilustra a mudança nos escores de PFE ao longo do tempo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>analise_anova <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> escores, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wid =</span> id, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> tempo)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_uni,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">linewidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">point.size =</span> <span class="dv">1</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">point.color =</span> <span class="st">"black"</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>gl <span class="sc">+</span> </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span>(pwc, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="st">"p.adj"</span>, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tip.length =</span> <span class="fl">0.00</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">245</span>, <span class="dv">250</span>, <span class="dv">255</span>)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (analise_anova, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-linepfe1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linepfe1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-linepfe1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linepfe1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.5: Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo. As barras de erro representam o intervalo de confiança de 95%. Os asteriscos indicam a significância estatística das comparações entre os tempos (*** p &lt; 0.001).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="anova-de-medidas-repetidas-bifatorial" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="anova-de-medidas-repetidas-bifatorial"><span class="header-section-number">16.4</span> ANOVA de medidas repetidas bifatorial</h2>
<p>A ANOVA de medidas repetidas de dois fatores é um&nbsp;teste estatístico usado para comparar as médias de uma variável dependente entre diferentes grupos (divididos por dois fatores) onde as mesmas amostras são medidas múltiplas vezes, seja ao longo do tempo ou sob diferentes condições. Ela avalia se há diferenças significativas entre os níveis de cada fator (os dois fatores) e, principalmente, se existe uma <strong>interação</strong> entre os dois fatores.</p>
<p>O estudo é organizado em torno de dois fatores (variáveis independentes). Um pode ser um fator entre sujeitos (ex: grupo de tratamento vs.&nbsp;grupo de controle) e outro pode ser um fator de medidas repetidas (intra-sujeitos). O principal objetivo é entender se a combinação dos dois fatores tem um efeito na variável dependente. Se uma interação for significativa, ela deve ser a prioridade na análise, pois os efeitos dos fatores isolados podem não ser tão relevantes.</p>
<section id="dados-usados-no-exemplo" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="dados-usados-no-exemplo"><span class="header-section-number">16.4.1</span> Dados usados no exemplo</h3>
<p>Os dados que servirão de exemplo são os mesmos da <a href="#sec-dadoscap16" class="quarto-xref"><span>Seção 16.3.1</span></a> sem usar o filtro para os 41 casos que correspondem as crianças de 5 a 15 anos que receberam um novo corticoide inalatório. Os controle são 41 crianças da mesma idade que receberam o tratamento habitual (<a href="#fig-trialAsma" class="quarto-xref">Figura&nbsp;<span>16.6</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-trialAsma" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trialAsma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/2iDzs2R.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trialAsma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.6: Ensaio Clínico
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dados_bi <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosAsma.xlsx"</span>) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_bi)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [82 × 5] (S3: tbl_df/tbl/data.frame)
 $ id   : num [1:82] 1 2 3 4 5 6 7 8 9 10 ...
 $ grupo: chr [1:82] "caso" "caso" "caso" "caso" ...
 $ t0   : num [1:82] 170 100 160 180 250 180 170 180 240 200 ...
 $ t1   : num [1:82] 180 140 180 180 300 200 180 200 320 200 ...
 $ t2   : num [1:82] 220 100 220 250 240 280 220 250 350 250 ...</code></pre>
</div>
</div>
<p>Assim, como realizado com a ANOVA de medidas repetidas de um fator, os dados serão transformados para o formato longo e atribuídos a um objeto denominado <code>dadosL_bi</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="ot">&lt;-</span> dados_bi <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(t0, t1, t2),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"tempo"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"escores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert_as_factor</span>(id, tempo)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span> <span class="fu">sample_n_by</span>(grupo, tempo, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  id    grupo    tempo escores
  &lt;fct&gt; &lt;chr&gt;    &lt;fct&gt;   &lt;dbl&gt;
1 26    caso     t0        110
2 33    caso     t1        150
3 31    caso     t2        190
4 60    controle t0        140
5 42    controle t1        250
6 59    controle t2        180</code></pre>
</div>
</div>
<section id="sumarização-dos-dados-1" class="level4" data-number="16.4.1.1">
<h4 data-number="16.4.1.1" class="anchored" data-anchor-id="sumarização-dos-dados-1"><span class="header-section-number">16.4.1.1</span> Sumarização dos dados</h4>
<p>Os dados serão sumarizados por grupo e tempo e, em seguida, serão calculadas algumas estatísticas resumidas da variável de escore: média e sd (desvio padrão). Isso será realizado através das funções <code>group_by()</code> e <code>get_summary_stats()</code> do pacote <code>rstatix</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(escores, <span class="at">type =</span> <span class="st">"mean_sd"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  grupo    tempo variable     n  mean    sd
  &lt;chr&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 caso     t0    escores     41  174.  42.8
2 caso     t1    escores     41  205.  53.2
3 caso     t2    escores     41  229.  56.1
4 controle t0    escores     41  184.  43.6
5 controle t1    escores     41  192.  37.5
6 controle t2    escores     41  212.  40.9</code></pre>
</div>
</div>
</section>
<section id="visualização-dos-dados-1" class="level4" data-number="16.4.1.2">
<h4 data-number="16.4.1.2" class="anchored" data-anchor-id="visualização-dos-dados-1"><span class="header-section-number">16.4.1.2</span> Visualização dos dados</h4>
<p>Pode-se observar os dados de diversas maneias. Para ANOVA medidas repetidas de dois fatores, o gráfico de linha com barra de erro é bastante útil, pois além de permitir a visualização dos dados através do tempo, pode-se ver a existência ou não de interação entre os fatores. Para criar a (<a href="#fig-pfe2" class="quarto-xref">Figura&nbsp;<span>16.7</span></a>) serão usadas as funções <code>ggline()</code> do pacote <code>ggpubr</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_bi, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grupo"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">palette =</span> <span class="st">"d3"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">error.plot =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.3</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="fl">1.5</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Pico de Fluxo Expiratório (l/min)"</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tempo"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pfe2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfe2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-pfe2-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfe2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.7: Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo nos grupos casos e controles
</figcaption>
</figure>
</div>
</div>
</div>
<p>A observação da <a href="#fig-pfe2" class="quarto-xref">Figura&nbsp;<span>16.7</span></a> mostra que ambos os grupos melhoraram a função respiratória com o tempo. O grupo caso teve uma melhora mais acentuada, o que pode indicar que a intervenção foi eficaz. O grupo controle manteve uma evolução positiva estável. A análise estatística (como ANOVA de medidas repetidas) poderia confirmar se essas diferenças são significativas ou apenas tendências visuais.</p>
</section>
</section>
<section id="sec-anova2model" class="level3" data-number="16.4.2">
<h3 data-number="16.4.2" class="anchored" data-anchor-id="sec-anova2model"><span class="header-section-number">16.4.2</span> Criação do modelo com dois fatores</h3>
<p>Este modelo permite testar se há diferença no tempo, independentemente do grupo; testar se há diferença entre os grupos, independentemente do tempo e verificar se há interação entre tempo e grupo, ou seja, se a mudança ao longo do tempo difere entre os grupos (por ex., se o tratamento teve efeito). Usando o formato longo, pode-se fazer o ajuste do modelo com a função <code>aov_car()</code> do pacote <code>afex</code> (<span class="citation" data-cites="aov_car">(<a href="referencias.html#ref-aov_car" role="doc-biblioref"><strong>aov_car?</strong></a>)</span>). Essa função também é apropriada para delineamentos com mais de um fatores: um fator intra-sujeitos (tempo); um fator entre sujeitos (grupo) e, principalmente, se houver interação, desbalanceamento e se deseja realizar uma ANOVA tipo III. Além disso, a <code>aov_car()</code> já calcula automaticamente o teste de esfericidade de Mauchly e as correções (Greenhouse-Geisser e Huynh-Feldt).</p>
<p>Veja a sintaxe da função em <span class="citation" data-cites="aov_car">(<a href="referencias.html#ref-aov_car" role="doc-biblioref"><strong>aov_car?</strong></a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>modelo_aov2 <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dadosL_bi, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">factorize =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: grupo</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_aov2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

             Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)    
(Intercept) 9763350      1   430255     80 1815.3608 &lt; 2.2e-16 ***
grupo          2923      1   430255     80    0.5435  0.463132    
tempo         69803      2    81254    160   68.7251 &lt; 2.2e-16 ***
grupo:tempo    8479      2    81254    160    8.3482  0.000356 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

            Test statistic p-value
tempo              0.95941 0.19459
grupo:tempo        0.95941 0.19459


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

             GG eps Pr(&gt;F[GG])    
tempo       0.96099  &lt; 2.2e-16 ***
grupo:tempo 0.96099  0.0004365 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

              HF eps   Pr(&gt;F[HF])
tempo       0.984147 5.875378e-22
grupo:tempo 0.984147 3.867194e-04</code></pre>
</div>
</div>
<p>Embora os grupos não tenham diferenças nos escores , independente do temo (<em>p</em> = 0,463), a forma como os escores mudam ao longo do tempo é diferente (<em>p</em> &lt; 0,0001). Além disso, a evolução dos escores ao longo do tempo depende do grupo. Ou seja, existe uma interação significativa entre grupo e tempo (<em>p</em> = 000356).</p>
<p>A esfericidade é assumida, pois o Teste de Mauchly, tanto para o <code>tempo</code> como para o <code>grupo:tempo</code> têm valores p &gt; 0,05. Portanto, mesmo que as correções de Greenhouse-Geisser e Huynh-Feldt tenham sido fornecidas, elas são desnecessárias. Isso significa, na prática, que o grupo <code>caso</code> teve um aumento mais acentuado nos escores ao longo do tempo do que o grupo controle. Sugere que a intervenção associada ao grupo caso teve um efeito positivo crescente. Serão necessárias comparações <em>post hoc</em> para ver onde estão as diferenças entre <code>tempo</code> e <code>grupo</code>.</p>
</section>
<section id="avaliação-dos-pressupostos-do-modelo" class="level3" data-number="16.4.3">
<h3 data-number="16.4.3" class="anchored" data-anchor-id="avaliação-dos-pressupostos-do-modelo"><span class="header-section-number">16.4.3</span> Avaliação dos pressupostos do modelo</h3>
<section id="esfericidade" class="level4" data-number="16.4.3.1">
<h4 data-number="16.4.3.1" class="anchored" data-anchor-id="esfericidade"><span class="header-section-number">16.4.3.1</span> Esfericidade</h4>
<p>O Teste de Mauchly, obtido junto com o modelo, mostrou que tanto o <code>tempo</code> como a interação <code>grupo:tempo</code> têm valores <em>p</em> &gt; 0,05. Não houve violação da esfericidade. Não há necessidade das correções de GG e HF.</p>
</section>
<section id="obtenção-dos-resíduos-e-valores-ajustados-1" class="level4" data-number="16.4.3.2">
<h4 data-number="16.4.3.2" class="anchored" data-anchor-id="obtenção-dos-resíduos-e-valores-ajustados-1"><span class="header-section-number">16.4.3.2</span> Obtenção dos resíduos e valores ajustados</h4>
<p>Da mesma forma como realizado para a ANOVA de medidas repetidas unifatorial, para avaliar os pressupostos, há necessidade de obter os resíduos do modelo.</p>
<p>A função <code>aov_car()</code> ajusta a ANOVA com estrutura para medidas repetidas, mas não expõe resíduos diretamente e, portanto, eles necessitam ser extraídos a partir de outro modelo de ajuste como o modelo linear de efeitos mistos (<em>Linear mixed-effects model</em>) através da função <code>lme()</code> do pacote <code>nlme</code>. (veja <span class="citation" data-cites="modelo_lme">(<a href="referencias.html#ref-modelo_lme" role="doc-biblioref"><strong>modelo_lme?</strong></a>)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>modelo_lme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_bi)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir desse modelo, pode-se extrair os resíduos e valores ajustados e incorporá-los aos <code>dadosL_bi</code>, facilitando a análise do modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>residuos <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_lme)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>ajustados <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelo_lme)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_bi)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [246 × 6] (S3: tbl_df/tbl/data.frame)
 $ id       : Factor w/ 82 levels "1","2","3","4",..: 1 1 1 2 2 2 3 3 3 4 ...
 $ grupo    : chr [1:246] "caso" "caso" "caso" "caso" ...
 $ tempo    : Factor w/ 3 levels "t0","t1","t2": 1 2 3 1 2 3 1 2 3 1 ...
 $ escores  : num [1:246] 170 180 220 100 140 100 160 180 220 180 ...
 $ residuos : Named num [1:246] 7.08 -13.11 2.45 6.51 16.31 ...
  ..- attr(*, "names")= chr [1:246] "1" "1" "1" "2" ...
  ..- attr(*, "label")= chr "Residuals"
 $ ajustados: Named num [1:246] 162.9 193.1 217.6 93.5 123.7 ...
  ..- attr(*, "names")= chr [1:246] "1" "1" "1" "2" ...
  ..- attr(*, "label")= chr "Fitted values"</code></pre>
</div>
</div>
</section>
<section id="normalidade-dos-resíduos-1" class="level4" data-number="16.4.3.3">
<h4 data-number="16.4.3.3" class="anchored" data-anchor-id="normalidade-dos-resíduos-1"><span class="header-section-number">16.4.3.3</span> Normalidade dos resíduos</h4>
<p>A normalidade dos resíduos é realizada dentro de cada tempo e grupo por ser mais rigorosa. Para realizar essa ação se fará uso da função <code>shapiro_test()</code> do pacote <code>rstatix</code> e de gráficos QQ (<a href="#fig-qqaov2" class="quarto-xref">Figura&nbsp;<span>16.8</span></a>) com o <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(residuos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  grupo    tempo variable statistic        p
  &lt;chr&gt;    &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 caso     t0    residuos     0.892 0.000961
2 caso     t1    residuos     0.967 0.274   
3 caso     t2    residuos     0.980 0.674   
4 controle t0    residuos     0.973 0.441   
5 controle t1    residuos     0.968 0.292   
6 controle t2    residuos     0.928 0.0126  </code></pre>
</div>
</div>
<p><u>Gráfico QQ</u></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> residuos,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tempo)) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(grupo <span class="sc">~</span> tempo) <span class="sc">+</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"QQ Plot dos Resíduos por Grupo e Tempo"</span>, </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Quantis Teóricos"</span>, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Quantis dos Resíduos"</span> ) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qqaov2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqaov2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-qqaov2-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qqaov2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.8: QQ plot dos resíduos por grupo e tempo
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os resultados indicam que, embora a maioria dos subgrupos apresente distribuição aproximadamente normal dos resíduos (p &gt; 0,05), foram observadas violações pontuais nos tempos t<sub>0</sub> do grupo “caso” (<em>p</em> = 0,00096) e t<sub>2</sub> do grupo “controle” (<em>p</em> = 0,0126). Os Q-Q plots confirmaram essas distorções com leve curvatura nas caudas. Apesar dessas exceções, os resíduos apresentaram comportamento adequado na maioria das condições avaliadas. Considerando o tamanho amostral (n = 41, por grupo) e a robustez dos modelos mistos frente a desvios moderados da normalidade, entende-se que os pressupostos foram suficientemente atendidos para a validade da análise.</p>
</section>
<section id="pesquisa-de-outliers-nos-residuos" class="level4" data-number="16.4.3.4">
<h4 data-number="16.4.3.4" class="anchored" data-anchor-id="pesquisa-de-outliers-nos-residuos"><span class="header-section-number">16.4.3.4</span> Pesquisa de outliers nos residuos</h4>
<p>A presença de <em>outliers</em> serão analisados, usando função <code>identify_outliers()</code> do pacote <code>rstatix</code> e através de boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(residuos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  grupo    tempo id    escores residuos ajustados is.outlier is.extreme
  &lt;chr&gt;    &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
1 caso     t0    13        150    -55.2      205. TRUE       FALSE     
2 caso     t0    20        120    -33.9      154. TRUE       FALSE     
3 caso     t0    26        110    -55.9      166. TRUE       FALSE     
4 caso     t0    30        200    -40.8      241. TRUE       FALSE     
5 controle t2    47        300     24.1      276. TRUE       FALSE     
6 controle t2    48        300     24.1      276. TRUE       FALSE     
7 controle t2    77        280     40.3      240. TRUE       FALSE     
8 controle t2    78        300     48.2      252. TRUE       TRUE      </code></pre>
</div>
</div>
<p><u>Boxplots</u></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_bi,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"residuos"</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"grupo"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bxppef" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bxppef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-bxppef-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bxppef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.9: Boxplots mostrando o efeito de um corticoide inalatório
</figcaption>
</figure>
</div>
</div>
</div>
<p>A análise dos resíduos do modelo ajustado por efeitos mistos (lme) identificou 8 observações como outliers (<a href="#fig-bxppef" class="quarto-xref">Figura&nbsp;<span>16.9</span></a>), sendo uma classificada como outlier extremo (id = 78). Essas observações não comprometem os pressupostos da homocedasticidade e normalidade dos resíduos. Assim, não foi indicada a exclusão de dados, mantendo-se a integridade da amostra para fins analíticos.</p>
<section id="sec-lmModel" class="level5" data-number="16.4.3.4.1">
<h5 data-number="16.4.3.4.1" class="anchored" data-anchor-id="sec-lmModel"><span class="header-section-number">16.4.3.4.1</span> Análise da influência dos outliers</h5>
<p>Para análise de influência em modelos de efeitos mistos (<code>lme</code>), usa-se abordagens adaptadas, já que funções como <code>cooks.distance()</code> não são aplicáveis diretamente e necessitam de um modelo equivalente mais simples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de modelo linear simples para o teste (sem efeitos aleatórios)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>modelo_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo, <span class="at">data =</span> dadosL_bi)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distância de Cook</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>cooksD <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo_lm)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Alavancagem</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_lm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adicionar a distância de Cook e os valores da leverage (alavancagem) nos <code>dadosL_bi</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>cooksD <span class="ot">&lt;-</span> cooksD</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>leverage <span class="ot">&lt;-</span> leverage</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Criar uma variável com observações influentes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>is.influential <span class="ot">&lt;-</span> dadosL_bi<span class="sc">$</span>cooksD <span class="sc">&gt;</span> (<span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(dadosL_bi))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizar em um gráfico , construído com o <code>ggplot</code>2:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq_along</span>(cooksD), <span class="at">y =</span> cooksD)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(dadosL_bi), </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance"</span>, </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observação"</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Distância de Cook"</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cook" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-cook-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.10: Boxplots mostrando o efeito de um corticoide inalatório
</figcaption>
</figure>
</div>
</div>
</div>
<p>O gráfico da distância de Cook (<a href="#fig-cook" class="quarto-xref">Figura&nbsp;<span>16.10</span></a>) mostra que a maioria das observações tem baixa influência (valores próximos de zero). Algumas observações ultrapassam a linha de corte (em vermelho), definida como 4/n (n = número de observações). No exemplo, o ponto de corte é <span class="math inline">\(4/246 \approx 0,016\)</span>, isto indica possível influência desproporcional no modelo. Entretanto, não há muitos pontos extremos, o que é um bom sinal. Após esse passo, deve-se identificar esses valores influentes e avaliá-los:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is.influential) <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, grupo, tempo, escores, cooksD, leverage)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   id    grupo tempo escores cooksD leverage
   &lt;fct&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 2     caso  t2        100 0.0334   0.0244
 2 5     caso  t1        300 0.0182   0.0244
 3 9     caso  t1        320 0.0267   0.0244
 4 9     caso  t2        350 0.0293   0.0244
 5 16    caso  t1        300 0.0182   0.0244
 6 21    caso  t1        110 0.0179   0.0244
 7 30    caso  t1        308 0.0214   0.0244
 8 30    caso  t2        320 0.0166   0.0244
 9 35    caso  t2        320 0.0166   0.0244
10 40    caso  t0        270 0.0183   0.0244
11 40    caso  t1        300 0.0182   0.0244</code></pre>
</div>
</div>
<p>Foram identificados 11 observações influentes segundo a Distância de Cook, todas no grupo caso e com escores extremos (muito baixos ou muito altos). Os valores de Cook’s D estão acima do limiar (~0.016), mas ainda não são alarmantes (valores &gt; 1 seriam muito preocupantes). Os leverage values (~0.0244) também são baixos, indicando que essas observações não têm posição incomum nos preditores, mas o valor da variável dependente (escore) é que impacta mais. Como esses valores não se constituem em um erro de digitação ou inconsistência nos escores de PEF, os valores serão mantidos. Essa abordagem não será demonstrada, pois já foi realizada pelo autor e as conclusões não mudam.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Script completo para para comparar os modelos.
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Remover observações influentes</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>dadosL_sem_inf <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is.influential)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ajustar modelo com todos os dados</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>modelo_completo <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_bi,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Ajustar modelo sem observações influentes</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>modelo_sem_inf <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_sem_inf,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Comparar os resultados</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_completo)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_sem_inf)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="homoscedasticidade" class="level4" data-number="16.4.3.5">
<h4 data-number="16.4.3.5" class="anchored" data-anchor-id="homoscedasticidade"><span class="header-section-number">16.4.3.5</span> Homoscedasticidade</h4>
<p>A homoscedasticidade será avaliada por um gráfico de dispersão dos resíduos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, <span class="fu">aes</span>(<span class="at">x =</span> ajustados, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Resíduos vs. Valores Ajustados"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Resíduos"</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resajust" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resajust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-resajust-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resajust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.11: Gráfico de dispersão resíduos vs valores ajustados
</figcaption>
</figure>
</div>
</div>
</div>
<p>Observando a <a href="#fig-resajust" class="quarto-xref">Figura&nbsp;<span>16.11</span></a> , verifica-se uma boa dispersão dos pontos ao redor da linha zero,&nbsp; sem padrão claro (como funil ou curva) e variação aproximadamente constante ao longo dos ajustados.</p>
<p>Portanto, não há evidências visuais fortes de violação da homocedasticidade. O pressuposto de variâncias constantes entre as combinações de grupo e tempo parece razoavelmente atendido.</p>
<p>O gráfico já atende o requisito para avaliar a homoscedasticidade, mas também é possível aplicar o teste de Breusch-Pagan, que precisa de um modelo ajustado com <code>lm()</code> (veja <a href="#sec-lmModel" class="quarto-xref"><span>Seção 16.4.3.4.1</span></a>). Como o modelo foi ajustado com a <code>lme()</code>, há necessidade de ajustar um modelo equivalente sem efeitos aleatórios, apenas para o teste:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_lm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_lm
BP = 12.822, df = 5, p-value = 0.02511</code></pre>
</div>
</div>
<p>O valor <em>p</em> &lt; 0.05 indica que há evidência de heteroscedasticidade — ou seja, a variância dos resíduos não é constante entre os grupos ou tempos. Isso viola o pressuposto de homoscedasticidade, que é importante para testes F na ANOVA clássica.</p>
<p>Como o modelo principal é uma &nbsp;ANOVA de medidas repetidas via <code>aov_car()</code> ou <code>lme()</code>, esses modelos já são mais robustos à heteroscedasticidade do que o <code>lm()</code> usado no teste.</p>
<p>Apesar da significância estatística, o efeito observado foi pequeno, e o uso de um modelo misto (<code>lme</code>), que acomoda estruturas de variância flexíveis, reduz a influência dessa violação sobre os resultados inferenciais.</p>
</section>
<section id="resumo-da-avaliação-dos-pressupostos" class="level4" data-number="16.4.3.6">
<h4 data-number="16.4.3.6" class="anchored" data-anchor-id="resumo-da-avaliação-dos-pressupostos"><span class="header-section-number">16.4.3.6</span> Resumo da avaliação dos pressupostos</h4>
<p>A adequação dos pressupostos foi avaliada para o modelo de ANOVA de medidas repetidas de dois fatores ajustado com a função <code>aov_car()</code> do pacote <code>afex</code>, considerando as variáveis <code>grupo</code> (caso, controle) e <code>tempo</code> (t<sub>0</sub>, t<sub>1</sub>, t<sub>2</sub>), com medidas repetidas por sujeito (<code>id</code>).</p>
<p>1. <u>Normalidade dos resíduos</u>:</p>
<p>A normalidade foi verificada por meio do teste de Shapiro-Wilk para os resíduos intra-sujeitos em cada combinação de grupo e tempo. Alguns desvios foram observados, com valores <em>p</em> &lt; 0.05 para casos em t<sub>0</sub> e controles em t<sub><span class="smallcaps">2</span></sub>, sugerindo violação da normalidade em partes dos dados. Ainda assim, os resíduos em geral apresentaram distribuição aproximadamente simétrica nos gráficos Q-Q , sendo a violação considerada moderada. Como a ANOVA é relativamente robusta a desvios da normalidade, especialmente em amostras maiores, o modelo foi mantido.</p>
<p>2. <u>Outliers</u>:</p>
<p>Foram detectadas 8 observações <em>outliers</em> com base nos resíduos do modelo ajustado com <code>lme()</code>. Uma dessas foi classificada como extremo, e todas associadas a valores de escores distantes da média esperada. Adicionalmente, a análise de influência (Cook’s Distance) identificou 11 observações influentes, principalmente no grupo caso, indicando possível impacto em estimativas do modelo.</p>
<p>A comparação entre os modelos com e sem essas observações revelou que a exclusão dos influentes não alterou as conclusões principais: o efeito de tempo permaneceu altamente significativo (p &lt; 0.001), o efeito de grupo não foi significativo (p &gt; 0.46), e a interação grupo × tempo continuou significativa (p &lt; 0.001), embora com leve redução no F. Isso sugere que o modelo é estável e robusto, mesmo na presença de influências pontuais.</p>
<p>3. <u>Esfericidade</u>:</p>
<p>A esfericidade, pressuposto fundamental em ANOVA com medidas repetidas, foi avaliada com o teste de Mauchly, que não indicou violação para tempo nem para a interação grupo × tempo (p &gt; 0.19). As correções de Greenhouse-Geisser e Huynh-Feldt foram consistentes, mantendo a significância dos efeitos, o que reforça a confiabilidade da análise.</p>
<p>4. <u>Homoscedasticidade</u>:</p>
<p>A homogeneidade de variâncias foi avaliada graficamente e formalmente via teste de Breusch-Pagan em modelo lm paralelo, retornando p = 0.025, o que indica heterocedasticidade leve. Essa violação reforça a importância de validar os resultados com modelos mistos (<code>lme</code>), que lidam melhor com esse tipo de estrutura de erro.</p>
<p><strong>Conclusão</strong>:</p>
<p>Apesar de desvios pontuais nos pressupostos (normalidade, homoscedasticidade), o modelo demonstrou consistência estatística e robustez analítica. A remoção de observações influentes não alterou os resultados principais, fortalecendo a confiança nas conclusões. A abordagem adotada, que incluiu modelos alternativos e verificação cuidadosa de resíduos, garante a validade da inferência realizada com a ANOVA de medidas repetidas.</p>
</section>
</section>
<section id="testes-post-hoc-1" class="level3" data-number="16.4.4">
<h3 data-number="16.4.4" class="anchored" data-anchor-id="testes-post-hoc-1"><span class="header-section-number">16.4.4</span> Testes post hoc</h3>
<p>Considerando que a interação <code>grupo:tempo</code> foi significativa (ver @sec-anova2model), se justifica explorar as diferenças dentro e entre grupos ao longo do tempo.</p>
<p>Embora de tanto o modelo construído com <code>aov_car()</code>, do pacote <code>afex</code>, quanto o modelo com <code>lme()</code>, do pacote <code>nlme</code>, possam ser utilizados para ajustar modelos de ANOVA de medidas repetidas, a opção para os pós testes, será será pelo uso do <code>lme()</code>, assim como realizado com os resíduos. Existem alguns motivos para isso:</p>
<ol type="1">
<li><p>Nos pós-testes, será usado o pacote <code>emmeans</code> e ele funciona melhor com o <code>lme()</code>, pois reconhece muito bem o modelo misto e permite pós-testes com estrutura correta (por exemplo, comparações dentro de sujeitos);</p></li>
<li><p>Facilidade para extrair resíduos, valores ajustados, influências etc. A <code>aov_car()</code> encapsula o modelo de forma menos transparente (resultado mais voltado ao relatório da ANOVA – tipo III, teste de Mauchly, GG/HF, etc.). Com <code>lme()</code>, se tem acesso direto ao modelo e seus componentes.</p></li>
<li><p>Mais controle da estrutura de correlação (caso se precise modelar estruturas mais complexas de medidas repetidas).</p></li>
</ol>
<section id="comparações-entre-níveis-de-tempo-dentro-de-cada-grupo" class="level4" data-number="16.4.4.1">
<h4 data-number="16.4.4.1" class="anchored" data-anchor-id="comparações-entre-níveis-de-tempo-dentro-de-cada-grupo"><span class="header-section-number">16.4.4.1</span> Comparações entre níveis de tempo dentro de cada grupo</h4>
<p>Para entender como os escores mudam ao longo do tempo em casos e controles separadamente, recomenda-se:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>emmeans_tempo_dentro_grupo <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo_lme, <span class="sc">~</span> tempo <span class="sc">|</span> grupo)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>contrastes_tempo_dentro <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emmeans_tempo_dentro_grupo, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span> <span class="st">"pairwise"</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrastes_tempo_dentro)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grupo = caso:
 contrast estimate   SE  df t.ratio p.value
 t0 - t1     -30.2 4.98 160  -6.067  &lt;.0001
 t0 - t2     -54.6 4.98 160 -10.977  &lt;.0001
 t1 - t2     -24.4 4.98 160  -4.910  &lt;.0001

grupo = controle:
 contrast estimate   SE  df t.ratio p.value
 t0 - t1      -7.8 4.98 160  -1.568  0.2625
 t0 - t2     -27.8 4.98 160  -5.586  &lt;.0001
 t1 - t2     -20.0 4.98 160  -4.018  0.0003

Degrees-of-freedom method: containment 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>A saída mostra que, no grupo caso, houve diferenças significativas entre todos os tempos. Isso sugere que o PFE aumentou progressivamente ao longo do tempo no grupo que recebeu o novo corticoide inalatório. No grupo controle , o padrão indica que a melhora foi mais tardia (apenas entre t<sub>1</sub> e t~2), possivelmente refletindo um efeito menor ou mais lento do medicamento.</p>
</section>
<section id="comparações-entre-os-grupos-dentro-de-cada-tempo" class="level4" data-number="16.4.4.2">
<h4 data-number="16.4.4.2" class="anchored" data-anchor-id="comparações-entre-os-grupos-dentro-de-cada-tempo"><span class="header-section-number">16.4.4.2</span> Comparações entre os grupos dentro de cada tempo</h4>
<p>Para entender se há diferença entre casos e controles em t<sub>0</sub>, t<sub>1</sub>, t<sub>2</sub>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>emmeans_grupo_dentro_tempo <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo_lme, <span class="sc">~</span> grupo <span class="sc">|</span> tempo)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>contrastes_grupo_dentro <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emmeans_grupo_dentro_tempo, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span> <span class="st">"pairwise"</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrastes_grupo_dentro)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tempo = t0:
 contrast        estimate   SE df t.ratio p.value
 caso - controle    -9.51 10.2 80  -0.933  0.3537

tempo = t1:
 contrast        estimate   SE df t.ratio p.value
 caso - controle    12.88 10.2 80   1.263  0.2103

tempo = t2:
 contrast        estimate   SE df t.ratio p.value
 caso - controle    17.32 10.2 80   1.698  0.0933

Degrees-of-freedom method: containment </code></pre>
</div>
</div>
<p>Em nenhum dos tempos a diferença entre os grupos foi estatisticamente significativa. Apesar de t<sub>2</sub> mostrar tendência de diferença (p = 0.0933), não alcança significância convencional estabelecida de 0,05. Ainda assim, pode ter relevância clínica, dependendo do contexto.</p>
<p>Os resultados reforçam o achado da interação significativa entre grupo e tempo na ANOVA. O grupo “caso” apresentou evolução mais consistente ao longo das avaliações, enquanto o grupo “controle” teve melhora mais discreta e tardia. A ausência de diferenças entre os grupos em cada tempo sugere que os efeitos se acumulam ao longo do tempo, mais visivelmente nos tratados (casos).</p>
</section>
</section>
<section id="relatando-os-resultados-da-anova-de-medidas-repetidas-de-dois-fatores" class="level3" data-number="16.4.5">
<h3 data-number="16.4.5" class="anchored" data-anchor-id="relatando-os-resultados-da-anova-de-medidas-repetidas-de-dois-fatores"><span class="header-section-number">16.4.5</span> Relatando os resultados da ANOVA de medidas repetidas de dois fatores</h3>
<p>O resultado pode ser relatado da seguinte forma:</p>
<ol type="1">
<li>Uma ANOVA de medidas repetidas de dois fatores foi conduzida para avaliar o efeito de um novo corticosteroide inalatório em crianças asmáticas, com idades entre 7 e 15 anos, sobre os escores de Pico de Fluxo Expiratório (PFE), ao longo de três momentos (t<sub>0</sub>, t<sub>1</sub>, t<sub>2</sub>).</li>
<li>Observou-se uma interação estatisticamente significativa entre grupo e tempo no escore de PFE, F(2, 160) = 8,34, p &lt; 0,00036. Em função dessa interação, as comparações foram realizadas separadamente dentro de cada grupo. Os valores de <em>p</em> foram ajustados pelo método de Bonferroni
<ul>
<li><u>Grupo caso</u>: houve diferenças significativas entre todos os tempos (t<sub>0</sub> vs.&nbsp;t<sub>1</sub>: <em>p</em> &lt; 0,0001; t<sub>0</sub> vs.&nbsp;t<sub>2</sub>: <em>p</em> &lt; 0,0001; t<sub>1</sub> vs.&nbsp;t<sub>2</sub>: <em>p</em> &lt; 0,0001), indicando melhora progressiva.</li>
<li><u>Grupo controle</u>: não houve diferença significativa entre t<sub>0</sub> e t<sub>1</sub> (<em>p</em> = 0,265), mas houve entre t<sub>0</sub> e t<sub>2</sub> (<em>p</em> &lt; 0,0001) e entre t<sub>1</sub> e t<sub>2</sub> (<em>p</em> = 0,0003), sugerindo um efeito mais tardio.</li>
</ul></li>
<li>As comparações entre grupos dentro de cada tempo não revelaram diferenças estatisticamente significativas (<em>p</em> &gt; 0,05 em todos os casos), embora uma tendência tenha sido observada em t<sub>2</sub> (<em>p</em> = 0,0933), sem atingir significância convencional.</li>
</ol>
<p>Recomenda-se acompanhar as conclusões com um gráfico (<a href="#fig-lineFinal" class="quarto-xref">Figura&nbsp;<span>16.12</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de um modelo com rstatix::anova_test()</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">anova_test</span>(<span class="at">dv =</span> escores, </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">wid =</span> id, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">within =</span> tempo,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">between =</span> grupo,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="dv">3</span>) </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(mod) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

       Effect DFn DFd      F        p p&lt;.05   ges
1       grupo   1  80  0.544 4.63e-01       0.006
2       tempo   2 160 68.725 2.86e-22     * 0.120
3 grupo:tempo   2 160  8.348 3.56e-04     * 0.016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparações por pares (pwc)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(escores <span class="sc">~</span> grupo, </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 11
  tempo .y.   group1 group2    n1    n2 statistic    df     p p.adj p.adj.signif
* &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       
1 t0    esco… caso   contr…    41    41     -1.04    40 0.305 0.305 ns          
2 t1    esco… caso   contr…    41    41      1.27    40 0.212 0.212 ns          
3 t2    esco… caso   contr…    41    41      1.68    40 0.101 0.101 ns          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores p e posição no eixo y</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>pvalores <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(escores <span class="sc">~</span> grupo, </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> <span class="dv">250</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico final</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tempo, </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> escores, </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> grupo, </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> grupo)) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.8</span>, </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, </span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>, </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, </span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> pvalores, </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> tempo, </span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y.position, </span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">signif</span>(p, <span class="dv">3</span>))),</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tempo"</span>, </span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>, </span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Evolução dos escores por grupo"</span>,</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">get_test_label</span>(mod, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc)) <span class="sc">+</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lineFinal" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lineFinal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="16-anovaRep_files/figure-html/fig-lineFinal-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lineFinal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16.12: Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo nos em crianças asmáticas de 7 a 15 anos
</figcaption>
</figure>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-anunciacao2021anovarep" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Anunciação L. Conceitos e análises estatisticas com R e jasp [Internet]. ANOVA de medidas repetidas. 2021. Disponível em: <a href="https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html">https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html</a></div>
</div>
<div id="ref-wickham2022tidyr" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Wickham H, Girlich M. tidyr: Tidy Messy Data [Internet]. 2022. Disponível em: <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a></div>
</div>
<div id="ref-matsubara2019anova" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Matsubara L, Araujo LFC. Cap. 13 ANOVA de medidas repetidas [Internet]. <a href="https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html" class="uri">https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html</a>; Bookdown; 2019. Disponível em: <a href="https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html">https://bookdown.org/luisfca/docs/anova-de-medidas-repetidas.html</a></div>
</div>
<div id="ref-pinheiro2000mixed" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Pinheiro JC, Bates DM. Fitting Linear Mixed-Effects Models. Em: Mixed-Effects Models in S and S-PLUS. New York, NY: Springer New York; 2000. p. 133–99. </div>
</div>
<div id="ref-copilot2025" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Microsoft Copilot. Assistente de Inteligência Artificial utilizado para apoio estatístico e redação técnica. <a href="https://copilot.microsoft.com" class="uri">https://copilot.microsoft.com</a>; 2025. </div>
</div>
<div id="ref-huynh1976epsilon" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Huynh H, Feldt LS. Estimation of the Box correction for degrees of freedom from sample data in randomized block and split-plot designs. Journal of Educational Statistics. 1976;1(1):69–82. </div>
</div>
<div id="ref-girden1992epsilon" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Girden ER. Two-Factor Studies with Repeated Measures on Both Factors. Em: ANOVA: repeated measures. Sage; 1992. p. 31–40. (QASS Series; vol. 84). </div>
</div>
<div id="ref-muller1989sphericity" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Muller KE, Barton CN. Approximate power for repeated-measures ANOVA lacking sphericity. Journal of the American Statistical Association. 1989;84(406):549–55. </div>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Veja a <a href="14-teste-t.html#sec-pivot" class="quarto-xref"><span>Seção 14.3.1.1</span></a> para mais detalhes da função<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Objeto da classe “afex_aov”.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./15-anova.html" class="pagination-link" aria-label="Análise de Variância">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./17-correlacao.html" class="pagination-link" aria-label="Correlação">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Anova de Medidas Repetidas</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pacotes usados neste capítulo</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(afex, </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>               dplyr, </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>               effectsize,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>               emmeans,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>               flextable,  </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>               ggplot2, </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>               ggpubr, </span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>               ggsci, </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>               knitr, </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>               lmtest,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>               nlme,</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>               readxl, </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>               rstatix, </span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>               tidyr)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introdução</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas (*Repeated Measures ANOVA*) é uma técnica estatística usada quando o mesmo grupo de participantes é medido várias vezes, seja ao longo do tempo ou sob diferentes condições. Ela é ideal para dados longitudinais ou experimentos intra-sujeitos, onde cada sujeito serve como seu próprio controle. São exemplos típicos:</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>• Medir a qualidade de vida de crianças asmáticas em vários momentos para avaliar o impacto de um programa de atenção ao asmático;</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>• Testar tempos de reação em um teste em três tempos em um mesmo grupo;</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>• Testar a autoestima de um mesmo grupo após a introdução de um tipo especial de dieta.</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>A @tbl-compare mostra algumas diferenças importantes entre a ANOVA e a ANOVA de Medidas Repetidas:</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-compare</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Comparação entre ANOVA e ANOVA de medidas repetidas"</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="at">caracteristica =</span> <span class="fu">c</span>(<span class="st">"Tipo de Amostra"</span>, <span class="st">"Controle da variabilidade individual"</span>, <span class="st">"Sensibilidade estatística"</span>, <span class="st">"Suposição de esfericidade"</span>),</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="at">ANOVA =</span> <span class="fu">c</span>(<span class="st">"Grupos independentes"</span>, <span class="st">"Não controla"</span>, <span class="st">"Menor"</span>, <span class="st">"Não se aplica"</span>),</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="at">ANOVA_rep =</span> <span class="fu">c</span>(<span class="st">"Mesmos sujeitos em diferentes condições"</span>,<span class="st">"Controla (cada sujeito é seu próprio controle)"</span>, <span class="st">"Maior (reduz o erro residual)"</span>, <span class="st">"Necessária (testada com o teste de Mauchly)"</span>))</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">caracteristica =</span> <span class="st">"Característica"</span>,</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANOVA =</span> <span class="st">"ANOVA (entre sujeitos)"</span>,</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANOVA_rep =</span> <span class="st">"ANOVA de Medidas Repetidas (intra-sujeitos)"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">width =</span> <span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">2.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) </span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas é mais poderosa estatisticamente porque reduz a variabilidade entre sujeitos, focando nas mudanças dentro de cada indivíduo. A ANOVA de medidas repetidas pode ser entendida como uma expansão da ANOVA (@anunciacao2021anovarep).</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA de medidas repetidas unifatorial</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas de um fator é um teste estatístico que compara as médias de três ou mais grupos relacionados, onde os mesmos participantes são medidos repetidamente em diferentes momentos ou condições para avaliar a mudança em uma variável dependente. É uma extensão do teste t pareado para mais de dois grupos e, por avaliar o mesmo grupo ao longo do tempo, controla diferenças individuais.</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados no exemplo {#sec-dadoscap16}</span></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cenário do exemplo</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>Um estudo, realizado em um ambulatório de Doenças Respiratórias Pediátricas, avaliou a função pulmonar de um grupo de crianças por um período de 3 meses (0, 45 dias, 90 dias) usando um novo corticoide inalatório. Todas as crianças tinham idade entre 7 e 15 anos e a medida avaliadora foi PFE (Pico de Fluxo Expiratório) ou *Peak Flow Meter* (PFM), taxa máxima de ar expelida pelos pulmões durante uma expiração forçada), indicador importante da função pulmonar, especialmente no monitoramento de asma.</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>Os dados podem ser obtidos <span class="co">[</span><span class="ot">aqui</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosAsma.xlsx)</span>. Baixe no seu diretório de trabalho e carregue com a função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span>. Na ANOVA de medidas repetidas de um fator, será usado apenas o grupo, denominado de <span class="in">`caso`</span>, que usou o medicamento testado.</span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>dados_uni <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosAsma.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grupo <span class="sc">==</span> <span class="st">"caso"</span>)</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_uni)</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exploração e transformação dos dados</span></span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>Observando a saída da função <span class="in">`str()`</span>, verifica-se os dados se encontram no formato amplo (a variável tempo está colocada em três colunas, t~0~, t~1~, t~2~) e a ANOVA de medidas repetidas necessita de que os dados estejam no formato longo. Isso significa que, ao invés de ter cada medida repetida em uma coluna separada, haverá uma coluna para o identificador (<span class="in">`id`</span>) do indivíduo, uma coluna para o <span class="in">`tempo/condição`</span> (fator de medidas repetidas), e uma coluna para o valor da variável dependente (<span class="in">`VD = escores`</span>).</span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>Para fazer esta transformação será realizada pela função <span class="in">`pivot_longer()`</span><span class="ot">[^16-anovarep-1]</span>do pacote <span class="in">`tidyr`</span> @wickham2022tidyr. Nesta função, no argumento <span class="in">`data`</span>, coloca-se o nome do conjunto de dados; em <span class="in">`cols`</span>, há necessidade informar as colunas do formato amplo que serão reunidas. No argumento <span class="in">`names_to`</span>, nomear a coluna que conterá as colunas unificadas e em <span class="in">`values_to`</span>, especificar o nome da variável no formato longo que conterá os valores. A variável <span class="in">`id`</span> e a nova variável <span class="in">`tempo`</span> devem ser convertida para fatores e o novo conjunto de dados será atribuído a um objeto nomeado <span class="in">`dadosL_uni`</span>:</span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a><span class="ot">[^16-anovarep-1]: </span>Veja a @sec-pivot para mais detalhes da função</span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="ot">&lt;-</span> dados_uni <span class="sc">%&gt;%</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(t0, t1, t2),</span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"tempo"</span>,</span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"escores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert_as_factor</span>(id, tempo)</span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_uni)</span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sumarização dos dados</span></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a>Serão calculadas algumas estatísticas resumidas dos escores espirométricos por grupos (<span class="in">`tempo`</span>): média e desvio padrão, usando a funções <span class="in">`group_by()`</span> e <span class="in">`summarise()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span> </span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a>                   média <span class="ot">=</span> <span class="fu">mean</span>(escores, <span class="at">na.rm =</span><span class="cn">TRUE</span>),</span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dp =</span> <span class="fu">sd</span>(escores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a>resumo</span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a>O resumo mostra que a média aumenta do momento inícial (t~0~) para o final (t~2~).</span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualização dos dados</span></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a>A visualização pode ser obtida com um conjunto de boxplots (@fig-bxppfe), usando o pacote <span class="in">`ggpubr`</span> com a função <span class="in">`ggboxplot()`</span>. Este gráfico permite visualizar a variação dos escores com o tempo e a variabilidade em cada um dos momentos.</span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bxppfe</span></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Boxplots mostrando o impacto de uma medicação através do tempo"</span></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_uni,</span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"escores"</span>, </span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a>Outra maneira de obter praticamente as mesmas informações visuais é através de um gráfico de linha (@fig-linepfe) que mostra bem o comportamento dos escores com o tempo e em cada momento:</span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-linepfe</span></span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Boxplots mostrando o impacto de uma medicação através do tempo"</span></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_uni, </span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a>               <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>),</span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_ci"</span>),</span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="fl">1.5</span>,</span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>()) <span class="sc">+</span></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Pico de Fluxo Expiratório (l/min)"</span>) <span class="sc">+</span></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tempo"</span>)</span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a>Ambas as figuras exibem uma modificação dos escores espirométricos (melhora nitidamente!) à medida que o tempo passa, utilizando a medicação.</span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a><span class="fu">### Criação do modelo de ajuste {#sec-anova1model}</span></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>Para criar o modelo da ANOVA de medidas repetidas pode-se usar a função <span class="in">`aov_car()`</span> pacote <span class="in">`afex`</span> que fornece uma abordagem de alta robustez estatística e libera o teste de Mauchly com as correções de esfericidade.</span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a>::: {#aov_car .callout-note}</span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estrutura do modelo aov_car</span></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a><span class="in">aov_car(valor ~ fator + Error(sujeito/fator), data = dados)</span></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a>Onde,</span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**data**: dataframe no fornato longo</span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**fórmula**: que deve incluir</span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>valor = variável dependente;</span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>fator = variável independente (fator de medidas repetidas);</span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>sujeito = variável que identifique o indivíduo, para um modelo de medidas repetidas de um fator - Error(id/tempo)</span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O termo <span class="in">`Error(id/tempo)`</span> é a chave para a análise de variância de medidas repetidas. É para o R entender que se usará um delineamento de medidas repetidas. Ele não é uma função, mas sim um **símbolo de estrutura** dentro da fórmula do `aov()` . Lê-se: “Erro aninhado em `id` dentro do tempo”. Este termo instrui ao R para decompor a variabilidade total do modelo em partes específicas, isolando a variância que é realmente do **efeito do tratamento** (`tempo`) que é apenas devida às **diferenças individuais** (<span class="in">`id`</span>).</span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a>Portanto, no exemplo em estudo, a sintaxe para o ajuste do modelo é:</span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>modelo_aov <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(escores <span class="sc">~</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), <span class="at">data =</span> dadosL_uni)</span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a>Esse comando cria um objeto <span class="in">`modelo.aov`</span> <span class="ot">[^16-anovarep-2]</span> que contém os resultados da ANOVA de medidas repetidas (tabela da ANOVA do tipo III) e outras informações, como o teste de Mauchly.\</span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>Para ver a partição da variância e o teste F, usa-se a função <span class="in">`summary()`</span>:</span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a><span class="ot">[^16-anovarep-2]: </span>Objeto da classe "afex_aov".</span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_aov)</span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a>A saída do modelo mostra a Tabela da ANOVA de Medidas repetidas de um fator (tempo) e resume os resultados do teste de esfericidade de Mauchly e as correções de Greenhouse-Geisser (GG) e Huynh-Feldt (HF).</span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a>O **teste de Mauchly** avalia a suposição de esfericidade, que é o pressuposto de que as variâncias das diferenças entre todos os pares de níveis de repetição (os três momentos de medição) são iguais. Como o valor *p* = 0,6107 não se rejeita a H~0~ e se conclui que a esfericidade é válida e podemos confiar nos resultados da ANOVA univariada tipo III sem necessidade de correção. As correções de Greenhouse-Geisser e Huynh-Feldt confirmam a forte significância do efeito de tempo , entretanto, embora apresentadas, não são estritamente necessárias neste caso (veja mais sobre esfericidade na @sec-esphericity).</span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a>A tabela principal da ANOVA univariada Tipo III, assumindo esfericidade, testa a hipótese nula de que não há diferença entre as médias das medições do PFE nos três momentos de tempo.</span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O intercepto doi significativo (*p*$&lt; 2,2 \times 10^-16$), indicando que média geral é significativamente diferente de zero. Este resultado não é importante para o efeito do tratamento.</span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O efeito do **tempo** foi significativo (F = 39,72; *p* $= 1,047 \times 10^-12$), o que significa rejeitar a H~0~ de igualdade das médias através do tempo. O F é igual QM~tempo~/QM\~residuo ou erro\~.</span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O Quadrado Médio(QM) é obtido dividindo a Soma dos Quadrados(SQ) pelos respectivos graus de liberdade (gl) e F pela razão entre os quadrados médios(variâncias):</span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a>$$QM_{tempo} = \frac{SQ_{tempo}}{gl_{tempo}}$$</span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a>$$QM_{erro} = \frac{SQ_{erro}}{gl_{erro}}$$</span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a>$$F = \frac{QM_{tempo}}{QM_{erro}}$$</span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a>A Tabela da ANOVA pode ser resumida coma a @tbl-tabAnovaRep.</span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tabAnovaRep</span></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabela da ANOVA de Medidas repetidas tipo III, assumindo a esfericidade"</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a>  <span class="at">fonte =</span> <span class="fu">c</span>(<span class="st">"tempo"</span>, <span class="st">"resíduo"</span>),</span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a>  <span class="at">sq =</span> <span class="fu">c</span>(<span class="dv">61417</span>, <span class="dv">61853</span>),</span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a>  <span class="at">gl =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">80</span>),</span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">qm =</span> <span class="fu">c</span>(<span class="fl">30708.5</span>, <span class="fl">773.162</span>),</span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> <span class="fu">c</span>(<span class="fl">39.718</span>, <span class="cn">NA</span>),</span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">c</span>(<span class="st">"&lt; 0.0001"</span>, <span class="cn">NA</span>))</span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">fonte =</span> <span class="st">"Fonte de Variação"</span>,</span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">sq =</span> <span class="st">"Soma dos Quadrados"</span>,</span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">gl =</span> <span class="st">"gl"</span>,</span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">qm =</span> <span class="st">"Quadrado Médio"</span>,</span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">f =</span> <span class="st">"F"</span>,</span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="st">"Valor p"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">width =</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">1.2</span>,<span class="fl">0.8</span>,<span class="fl">1.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span><span class="dv">1</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span><span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colformat_num</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="st">"sq"</span>, <span class="st">"gl"</span>, <span class="st">"qm"</span>, <span class="st">"f"</span>),</span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a>                <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a>                <span class="at">decimal.mark =</span> <span class="st">","</span>,</span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a>                <span class="at">big.mark =</span> <span class="st">"."</span>)</span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a>**Existe uma diferença estatisticamente significativa** nas medições de *Peak Flow Meter* das crianças asmáticas ao longo dos três momentos distintos (0, 45 e 90 dias). Isto apenas indica que *pelo menos dois* momentos são diferentes, haverá necessidade de realizar testes *post hoc*.</span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a><span class="fu">### Avaliação dos pressupostos</span></span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a>A ANOVA de Medidas Repetidas Unifatorial possui três pressupostos importantes e dois deles são avaliados diretamente a partir dos resíduos do modelo:</span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Normalidade dos Resíduos\</span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Ausência de valores atípicos\</span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Esfericidade (pressuposto exclusivo para medidas repetidas e é avaliado nas diferenças entre as medidas, não diretamente nos resíduos do modelo, mas é fundamental).</span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Obtenção dos resíduos e valores ajustados</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a>Para a avaliação dos pressupostos há necessidade de obter os resíduos do modelo. Os resíduos correspondem a diferença entre os valores observados e os valores ajustados (*fitted values*) pelo modelo. Esses valores podem ser extraídos com a função <span class="in">`residuals()`</span> e a função <span class="in">`fitted()`</span> a partir do modelo. Para a avaliação dos pressupostos sera ajustado um modelo com a função <span class="in">`lme()`</span> do pacote <span class="in">`nlme`</span>, pois ele fornece resíduos menos dispersos, mais realistas e considera a estrutura de correlação entre medidas @matsubara2019anova @pinheiro2000mixed.</span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a>::: {#modelo_lme .callout-note}</span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estrutura do modelo lme</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a>O <span class="in">`modelo_lme`</span> deve incluir o seguinte:</span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a><span class="in">modelo_lme &lt;- lme(</span></span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a><span class="in">  resposta ~ efeitos fixos,</span></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a><span class="in">  random = ~ estrutura_aleatoria | unidade_agrgadora,</span></span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a><span class="in">  correlation = estrutura_correlacao,</span></span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="in">  data = dataframe)</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Parte fixa**, representada pela fórmula: No exemplo, `escores ~ grupo * tempo`. Esta fórmula modela os escores como função dos efeitos principais de `grupo` e `tempo`, mais a **interação entre eles**. Isso responde como os escores variam entre grupos, ao longo do tempo, e se essa variação depende do grupo. Na ANOVA de medidas repetidas unifatorial, o fator grupo não existe porque há apenas um grupo. Nesse caso, a fórmula fica simplificada para apenas <span class="in">`escores ~ tempo`</span>.</span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Parte aleatória**: <span class="in">`ramdom = ~1| id`</span>. Aqui se afirma que cada <span class="in">`id`</span> (sujeito) tem um intercepto próprio, ou seja cada indivíduo começa de um ponto diferente. Isso captura a variabilidade individual entre sujeitos.</span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Estrutura de correlação composta simétrica**: <span class="in">`correlation = corCompSymm(form = ~1 | id)`</span>. Isso significa que todas as observações dentro de um mesmo sujeito (<span class="in">`id`</span>) são igualmente correlacionadas entre si, independentemente do tempo. É uma forma simples de modelar a dependência entre medidas repetidas. Este argumento não é obrigatório, mas pode melhorar o ajuste e a interpretação do modelo. Deve ser considerado se:</span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Os tempos são equidistantes (ex; dias, semanas);</span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Há suspeita que há correlação entre as medidas dentro de cada sujeito.</span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>O modelo sem ele apresenta resíduos autocorrelacionados ou ajuste ruim.</span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Fonte dos dados**: `data  = dataframe` . Dados sobre o qual o modelo será ajustado. Devem estar no **formato longo** (cada linha é uma observação de um sujeito em um tempo).</span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>Após o ajuste do modelo, <span class="in">`modelo_lme`</span>, os valores residuais bem como os ajustados, serão incorporados ao dataframe <span class="in">`dadosL_uni`</span>:</span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a>modelo_lme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> tempo,</span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id,</span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni)</span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a>dadosL_uni<span class="sc">$</span>residuos <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_lme)</span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a>dadosL_uni<span class="sc">$</span>ajustados <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelo_lme)</span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_uni)</span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normalidade dos resíduos</span></span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a>A suposição de normalidade dos resíduos é fundamental para a validade dos testes estatísticos em modelos lineares. Em modelos com medidas repetidas, essa suposição pode variar ao longo dos diferentes momentos de avaliação. Para verificar essa condição, será aplicado o teste de Shapiro-Wilk, usando a função <span class="in">`shapiro_test()`</span> do pacote <span class="in">`rstatix`</span> e gerados gráficos QQ dos resíduos por tempo (t~0~, t~1~, t~2~), com o <span class="in">`ggplot2`</span>.</span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(residuos)</span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a>É interessante complementar essa avaliação formal com a construção, de um gráfico QQ:</span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-qqpef</span></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Gráfico QQ para verificar a normalidade"</span></span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_uni, </span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> residuos, </span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tempo)) <span class="sc">+</span></span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> tempo) <span class="sc">+</span></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"QQ Plot dos Resíduos por Tempo"</span>,</span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantis Teóricos"</span>,</span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Quantis dos Resíduos"</span></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a>Os gráficos QQ (@fig-qqpef) revelaram que os resíduos nos tempos t~1~ e t~2~ estão bem alinhados à linha teórica, indicando distribuição aproximadamente normal. Já no tempo t~0~, observou-se maior dispersão nas extremidades, sugerindo violação da normalidade. Essa observação foi confirmada pelo teste de Shapiro-Wilk.\</span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a>Os resíduos do tempo t~0~ apresentaram distribuição significativamente diferente da normal (*p* <span class="sc">\&lt;</span> 0,05), enquanto os tempos t~1~ e t~2~ não rejeitaram a hipótese de normalidade. Essa variação pode refletir maior heterogeneidade basal ou instabilidade clínica inicial. Recomenda-se, portanto, que a avaliação da normalidade dos resíduos em modelos com medidas repetidas seja feita por tempo, e não de forma agregada, para garantir maior precisão na interpretação dos pressupostos.\</span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a>Mesmo com resíduos não normalmente distribuídos em t~0~, o modelo permanece válido desde que a esfericidade seja assumida; que o modelo tenha sido ajustado com <span class="in">`lme()`</span> ou <span class="in">`aov_car()`</span> com estrutura de erro adequada e que os resíduos nos demais tempos estejam dentro dos padrões esperados @pinheiro2000mixed @copilot2025.</span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Identificação de valores atípicos</span></span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>Não deve haver valores atípicos extremos nos resíduos. Pode-se verificar a presença de valores atípicos, usando a função <span class="in">`identify_outliers()`</span> do pacote <span class="in">`rstatix`</span>.</span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a>dadosL_uni <span class="sc">%&gt;%</span></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(residuos)</span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a>A saída mostra a presença de três de valores atípicos, todos no momento t~0~. Nenhum é outlier extremo. Isso também pode ser verificado na @fig-bxppef2 dos boxplots.</span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bxppef2</span></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Boxplots dos resíduos de acordo com o tempo"</span></span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_uni,</span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"residuos"</span>, </span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Teste de esfericidade {#sec-esphericity}</span></span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a>A esfericidade é a versão da homocedasticidade para medidas repetidas, é avaliada como foi visto (@sec-anova1model) pelo teste de Mauchly. O teste de Mauchly é uma avaliação da matriz de covariância das diferenças entre os níveis do fator. A matriz de covariância é a ferramenta que avalia se a variação nas mudanças ao longo do tempo é consistente. O teste de Mauchly podes ser obtido ajustando o modelo unifatorial de medidas repetidas (tempo), usando a função <span class="in">`aov_car()`</span> do pacote <span class="in">`afex`</span> . A saída do teste de Mauchly exibiu um valor *p*\$ <span class="sc">\&gt;</span> 0,05\$, indicando que o pressuposto da esfericidade não foi violado, não havendo necessidade de recorrer às correções da esfericidade, que seriam obtidas da seguinte maneira:</span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lógica do teste de Mauchly</span></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a>O teste de Mauchly é uma avaliação da matriz de covariância das diferenças entre os níveis do fator. O que isto significa?</span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a>O exemplo usado na ANOVA de medidas repetidas corresponde a medida de Pico de Fluxo Expiratório (PFE) em três momentos (t~0~, t~1~ e t~3~, respectivamente, basal, 45 dias e 90 dias).</span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a>Para saber se o tratamento funciona, não se está interessado apenas na medida do PFE em cada tempo, mas sim na **mudança** que o tratamento causou. Se quer saber se a PFE no tempo 1 é diferente da PFE no tempo 0, e se o PFE no tempo 2 é diferente do PFE nos tempos anteriores.</span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a>As "mudanças" são as **diferenças** entre os níveis do fator, ou seja:</span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dif 1: (t1−t0)</span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dif 2: (t2−t0)</span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dif 3: (t2−t1)</span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas assume que essas diferenças têm uma relação especial entre si. Ela assume que a **variância de cada uma dessas diferenças é aproximadamente a mesma** e que a **correlação (ou covariância) entre elas também é a mesma**.</span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Matriz de Covariância das Diferenças</span><span class="co">]</span>{.underline}</span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a>Imagine-se que se calculou a variância de cada uma dessas diferenças. A matriz de covariância das diferenças é uma tabela que organiza esses resultados em uma matriz quadrada (3 x 3) e simétrica:</span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/Wxd1KUZ.png"</span>)</span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a>A suposição de **esfericidade** (que o teste de Mauchly avalia) é que todos os valores nessa matriz devem ser aproximadamente **iguais**. • As variâncias diagonais devem ser iguais; • As covariâncias fora da diagonal também devem ser **iguais**.</span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Importância do Teste de Mauchly</span><span class="co">]</span>{.underline}</span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a>O teste de Mauchly verifica se essa suposição de esfericidade é verdadeira. • Se o **teste de Mauchly for não significativo** (*p* \&gt; 0,05): Significa que a matriz das diferenças é "esférica" e a suposição de esfericidade foi mantida. Se pode confiar no resultado da ANOVA. • Se o **teste de Mauchly for significativo** (*p* <span class="sc">\&lt;</span> 0,05): Significa que a suposição de esfericidade foi violada. As variâncias das diferenças não são iguais, e isso pode inflar a taxa de erro do Tipo I (a chance de encontrar um resultado significativo quando não existe um de verdade).</span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a>Quando a esfericidade é violada, é calculada as correções de **Greenhouse-Geisser (GGe)** ou **Huynh-Feldt (HFe)**, que ajustam os graus de liberdade e tornam o teste mais conservador, garantindo que o seu resultado final seja confiável. Huynh e Feldt @huynh1976epsilon relataram que quando a correção $\epsilon$ de Greenhouse-Geisser é <span class="sc">\&gt;</span> 0,75 muitas hipóteses nulas falsas deixam de ser rejeitadas, isto é, o teste é muito conservador, propondo outra correção dos graus de liberdade. É recomendado o uso da correção de Greenhouse-Geisser para o ajuste dos graus de liberdade quando $\epsilon$ <span class="sc">\&lt;</span> 0,75 ou nada se sabe a respeito da esfericidade @girden1992epsilon. Avaliando o poder destes testes, Muller @muller1989sphericity verificou que a correção de Greenhouse-Geisser fornece um controle adicional do erro Tipo I, enquanto o poder é maximizado.</span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testes *post hoc*</span></span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas indicou uma modificação significativa nos escores de PEF ao longo do tempo com o uso da medicação. No entanto, esse teste apenas revela que há diferenças entre os tempos, sem especificar entre quais pares de momentos essas diferenças ocorrem. Para identificar onde essas diferenças são estatisticamente significativas, é necessário realizar uma análise *post hoc*. Utilizou-se a função <span class="in">`pairwise_t_test()`</span> do pacote <span class="in">`rstatix`</span>, que realiza comparações múltiplas entre pares de níveis do fator tempo, aplicando testes t pareados com correção para o erro Tipo I. Optou-se pelo método de Bonferroni (<span class="in">`p.adjust.method = "bonferroni"`</span>), por ser mais conservador e reduzir o risco de falsos positivos, mesmo que sacrifique o poder estatístico. Em contextos com muitos grupos, métodos como Holm ou Benjamini-Hochberg (BH) podem ser preferidos por sua maior sensibilidade.</span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> <span class="fu">pairwise_t_test</span>(</span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni, </span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> escores <span class="sc">~</span> tempo, </span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a>pwc</span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a>A saída mostra os pares comparados (**group1** vs **group2**) e os respectivos valores de *p* e *p* ajustado: • **t0 vs. t1 (0 vs. 45 dias)**: *p* = 0,00843; *p* ajustado = 0,0253 → diferença significativa. • **t0 vs. t2 (0 vs. 90 dias)**: *p* = 0,00000379; *p* ajustado = 0,0000114 → diferença altamente significativa. • **t1 vs. t2 (45 vs. 90 dias)**: *p* = 0,0321; *p* ajustado = 0,0964 → diferença não significativa após correção. Esse último resultado sugere que, embora haja uma tendência de melhora entre os dias 45 e 90, ela não é estatisticamente robusta após correção de Bonferroni.</span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tamanho do Efeito</span></span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a>O tamanho do efeito é uma medida da magnitude da diferença entre grupos, independente do tamanho da amostra. O tamanho do efeito na ANOVA pode ser obtido usando o parâmetro $\eta^2$ (eta ao quadrado), parcial ou generalizado, que está disponível no pacote <span class="in">`afex`</span>, usado para ajustar o modelo (@sec-anova1model). Na ANOVA de medidas repetidas, é calculado o eta ao quadrado generalizado, pois o parcial pode superestimar o efeito. O eta ao quadrado generalizado mede a proporção da variância explicada por um fator em relação a variância total, incluindo a variância entre sujeitos e outros efeitos, enquanto o eta ao quadrado parcial exclui outros fatores e interações. Usando o <span class="in">`mod_aov`</span>, o tamanho do efeito pode ser obtido da seguinte forma usando a função <span class="in">`eta_squared()`</span> do pacote <span class="in">`effetcsize`</span>:</span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">eta_squared</span> (modelo_aov, <span class="at">generalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a>De acordo com a @tbl-effectsize, um eta ao quadrado igual a 0,16 pode ser considerado um grande efeito.</span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Análise do Impacto do Novo Corticoide</span></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a>Uma ANOVA de medidas repetidas foi conduzida para avaliar o impacto do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório (PFE) em pacientes de 7 a 15 anos ao longo do tempo.</span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a>O teste revelou um efeito estatisticamente significativo do tempo sobre os escores de PFE, F(2,80) = 39.7, p <span class="sc">\&lt;</span> 0.0001.</span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a>Para investigar onde as diferenças ocorreram, foi realizada uma análise *post hoc* com correção de Bonferroni. Os resultados indicaram que os escores de PFE melhoraram significativamente entre o início do estudo (t~0~) e o marco de 45 dias (t~1~), e também entre o início (t~0~) e o marco de 90 dias (t~2~). Embora tenha havido uma melhora contínua entre 45 e 90 dias, essa diferença não foi estatisticamente significativa após a correção para múltiplas comparações (*p* = 0.096). Esses resultados sugerem que o tratamento com o novo corticoide inalatório teve um impacto significativo na melhora dos escores de PFE, com a maior parte da mudança ocorrendo nos primeiros 45 dias.</span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Apresentação Visual</span></span>
<span id="cb68-508"><a href="#cb68-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a>A @fig-linepfe1 ilustra a mudança nos escores de PFE ao longo do tempo.</span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-linepfe1</span></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: " Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo. As barras de erro representam o intervalo de confiança de 95%. Os asteriscos indicam a significância estatística das comparações entre os tempos (*** p &lt; 0.001)."</span></span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a>analise_anova <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(</span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_uni, </span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> escores, </span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">wid =</span> id, </span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> tempo)</span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_uni,</span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a>                     <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a>                     <span class="at">linewidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a>                     <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a>                     <span class="at">point.size =</span> <span class="dv">1</span>,</span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a>                     <span class="at">point.color =</span> <span class="st">"black"</span>)</span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a>gl <span class="sc">+</span> </span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span>(pwc, </span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="st">"p.adj"</span>, </span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tip.length =</span> <span class="fl">0.00</span>,</span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">245</span>, <span class="dv">250</span>, <span class="dv">255</span>)) <span class="sc">+</span></span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (analise_anova, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc))</span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA de medidas repetidas bifatorial</span></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a>A ANOVA de medidas repetidas de dois fatores é um&nbsp;teste estatístico usado para comparar as médias de uma variável dependente entre diferentes grupos (divididos por dois fatores) onde as mesmas amostras são medidas múltiplas vezes, seja ao longo do tempo ou sob diferentes condições. Ela avalia se há diferenças significativas entre os níveis de cada fator (os dois fatores) e, principalmente, se existe uma **interação** entre os dois fatores.</span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a>O estudo é organizado em torno de dois fatores (variáveis independentes). Um pode ser um fator entre sujeitos (ex: grupo de tratamento vs. grupo de controle) e outro pode ser um fator de medidas repetidas (intra-sujeitos). O principal objetivo é entender se a combinação dos dois fatores tem um efeito na variável dependente. Se uma interação for significativa, ela deve ser a prioridade na análise, pois os efeitos dos fatores isolados podem não ser tão relevantes.</span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados no exemplo</span></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a>Os dados que servirão de exemplo são os mesmos da @sec-dadoscap16 sem usar o filtro para os 41 casos que correspondem as crianças de 5 a 15 anos que receberam um novo corticoide inalatório. Os controle são 41 crianças da mesma idade que receberam o tratamento habitual (@fig-trialAsma).</span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-trialAsma</span></span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb68-565"><a href="#cb68-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-566"><a href="#cb68-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-567"><a href="#cb68-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-568"><a href="#cb68-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-569"><a href="#cb68-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Ensaio Clínico"</span></span>
<span id="cb68-570"><a href="#cb68-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-571"><a href="#cb68-571" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/2iDzs2R.png"</span>)</span>
<span id="cb68-572"><a href="#cb68-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-573"><a href="#cb68-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-576"><a href="#cb68-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-577"><a href="#cb68-577" aria-hidden="true" tabindex="-1"></a>dados_bi <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosAsma.xlsx"</span>) </span>
<span id="cb68-578"><a href="#cb68-578" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_bi)</span>
<span id="cb68-579"><a href="#cb68-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-580"><a href="#cb68-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-581"><a href="#cb68-581" aria-hidden="true" tabindex="-1"></a>Assim, como realizado com a ANOVA de medidas repetidas de um fator, os dados serão transformados para o formato longo e atribuídos a um objeto denominado <span class="in">`dadosL_bi`</span>:</span>
<span id="cb68-582"><a href="#cb68-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-585"><a href="#cb68-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-586"><a href="#cb68-586" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="ot">&lt;-</span> dados_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-587"><a href="#cb68-587" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(t0, t1, t2),</span>
<span id="cb68-588"><a href="#cb68-588" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"tempo"</span>,</span>
<span id="cb68-589"><a href="#cb68-589" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"escores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-590"><a href="#cb68-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert_as_factor</span>(id, tempo)</span>
<span id="cb68-591"><a href="#cb68-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-592"><a href="#cb68-592" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span> <span class="fu">sample_n_by</span>(grupo, tempo, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb68-593"><a href="#cb68-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-594"><a href="#cb68-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-595"><a href="#cb68-595" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sumarização dos dados</span></span>
<span id="cb68-596"><a href="#cb68-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-597"><a href="#cb68-597" aria-hidden="true" tabindex="-1"></a>Os dados serão sumarizados por grupo e tempo e, em seguida, serão calculadas algumas estatísticas resumidas da variável de escore: média e sd (desvio padrão). Isso será realizado através das funções <span class="in">`group_by()`</span> e <span class="in">`get_summary_stats()`</span> do pacote <span class="in">`rstatix`</span>.</span>
<span id="cb68-598"><a href="#cb68-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-601"><a href="#cb68-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-602"><a href="#cb68-602" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-603"><a href="#cb68-603" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span> </span>
<span id="cb68-604"><a href="#cb68-604" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(escores, <span class="at">type =</span> <span class="st">"mean_sd"</span>)</span>
<span id="cb68-605"><a href="#cb68-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-606"><a href="#cb68-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-607"><a href="#cb68-607" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualização dos dados</span></span>
<span id="cb68-608"><a href="#cb68-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-609"><a href="#cb68-609" aria-hidden="true" tabindex="-1"></a>Pode-se observar os dados de diversas maneias. Para ANOVA medidas repetidas de dois fatores, o gráfico de linha com barra de erro é bastante útil, pois além de permitir a visualização dos dados através do tempo, pode-se ver a existência ou não de interação entre os fatores. Para criar a (@fig-pfe2) serão usadas as funções <span class="in">`ggline()`</span> do pacote <span class="in">`ggpubr`</span>.</span>
<span id="cb68-610"><a href="#cb68-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-613"><a href="#cb68-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-614"><a href="#cb68-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pfe2</span></span>
<span id="cb68-615"><a href="#cb68-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-616"><a href="#cb68-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-617"><a href="#cb68-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-618"><a href="#cb68-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-619"><a href="#cb68-619" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-620"><a href="#cb68-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo nos grupos casos e controles"</span></span>
<span id="cb68-621"><a href="#cb68-621" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL_bi, </span>
<span id="cb68-622"><a href="#cb68-622" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"tempo"</span>,</span>
<span id="cb68-623"><a href="#cb68-623" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"escores"</span>,</span>
<span id="cb68-624"><a href="#cb68-624" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grupo"</span>,</span>
<span id="cb68-625"><a href="#cb68-625" aria-hidden="true" tabindex="-1"></a>               <span class="at">palette =</span> <span class="st">"d3"</span>,</span>
<span id="cb68-626"><a href="#cb68-626" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb68-627"><a href="#cb68-627" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb68-628"><a href="#cb68-628" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb68-629"><a href="#cb68-629" aria-hidden="true" tabindex="-1"></a>               <span class="at">error.plot =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb68-630"><a href="#cb68-630" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.3</span>),</span>
<span id="cb68-631"><a href="#cb68-631" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="fl">1.5</span>,</span>
<span id="cb68-632"><a href="#cb68-632" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb68-633"><a href="#cb68-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Pico de Fluxo Expiratório (l/min)"</span>) <span class="sc">+</span></span>
<span id="cb68-634"><a href="#cb68-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tempo"</span>)</span>
<span id="cb68-635"><a href="#cb68-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-636"><a href="#cb68-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-637"><a href="#cb68-637" aria-hidden="true" tabindex="-1"></a>A observação da @fig-pfe2 mostra que ambos os grupos melhoraram a função respiratória com o tempo. O grupo caso teve uma melhora mais acentuada, o que pode indicar que a intervenção foi eficaz. O grupo controle manteve uma evolução positiva estável. A análise estatística (como ANOVA de medidas repetidas) poderia confirmar se essas diferenças são significativas ou apenas tendências visuais.</span>
<span id="cb68-638"><a href="#cb68-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-639"><a href="#cb68-639" aria-hidden="true" tabindex="-1"></a><span class="fu">### Criação do modelo com dois fatores {#sec-anova2model}</span></span>
<span id="cb68-640"><a href="#cb68-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-641"><a href="#cb68-641" aria-hidden="true" tabindex="-1"></a>Este modelo permite testar se há diferença no tempo, independentemente do grupo; testar se há diferença entre os grupos, independentemente do tempo e verificar se há interação entre tempo e grupo, ou seja, se a mudança ao longo do tempo difere entre os grupos (por ex., se o tratamento teve efeito). Usando o formato longo, pode-se fazer o ajuste do modelo com a função <span class="in">`aov_car()`</span> do pacote <span class="in">`afex`</span> (@aov_car). Essa função também é apropriada para delineamentos com mais de um fatores: um fator intra-sujeitos (tempo); um fator entre sujeitos (grupo) e, principalmente, se houver interação, desbalanceamento e se deseja realizar uma ANOVA tipo III. Além disso, a <span class="in">`aov_car()`</span> já calcula automaticamente o teste de esfericidade de Mauchly e as correções (Greenhouse-Geisser e Huynh-Feldt).</span>
<span id="cb68-642"><a href="#cb68-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-643"><a href="#cb68-643" aria-hidden="true" tabindex="-1"></a>Veja a sintaxe da função em @aov_car.</span>
<span id="cb68-644"><a href="#cb68-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-647"><a href="#cb68-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-648"><a href="#cb68-648" aria-hidden="true" tabindex="-1"></a>modelo_aov2 <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb68-649"><a href="#cb68-649" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dadosL_bi, </span>
<span id="cb68-650"><a href="#cb68-650" aria-hidden="true" tabindex="-1"></a>                  <span class="at">factorize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-651"><a href="#cb68-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-652"><a href="#cb68-652" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_aov2)</span>
<span id="cb68-653"><a href="#cb68-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-654"><a href="#cb68-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-655"><a href="#cb68-655" aria-hidden="true" tabindex="-1"></a>Embora os grupos não tenham diferenças nos escores , independente do temo (*p* = 0,463), a forma como os escores mudam ao longo do tempo é diferente (*p* \&lt; 0,0001). Além disso, a evolução dos escores ao longo do tempo depende do grupo. Ou seja, existe uma interação significativa entre grupo e tempo (*p* = 000356).</span>
<span id="cb68-656"><a href="#cb68-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-657"><a href="#cb68-657" aria-hidden="true" tabindex="-1"></a>A esfericidade é assumida, pois o Teste de Mauchly, tanto para o <span class="in">`tempo`</span> como para o <span class="in">`grupo:tempo`</span> têm valores p <span class="sc">\&gt;</span> 0,05. Portanto, mesmo que as correções de Greenhouse-Geisser e Huynh-Feldt tenham sido fornecidas, elas são desnecessárias. Isso significa, na prática, que o grupo <span class="in">`caso`</span> teve um aumento mais acentuado nos escores ao longo do tempo do que o grupo controle. Sugere que a intervenção associada ao grupo caso teve um efeito positivo crescente. Serão necessárias comparações *post hoc* para ver onde estão as diferenças entre <span class="in">`tempo`</span> e <span class="in">`grupo`</span>.</span>
<span id="cb68-658"><a href="#cb68-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-659"><a href="#cb68-659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Avaliação dos pressupostos do modelo</span></span>
<span id="cb68-660"><a href="#cb68-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-661"><a href="#cb68-661" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Esfericidade</span></span>
<span id="cb68-662"><a href="#cb68-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-663"><a href="#cb68-663" aria-hidden="true" tabindex="-1"></a>O Teste de Mauchly, obtido junto com o modelo, mostrou que tanto o <span class="in">`tempo`</span> como a interação <span class="in">`grupo:tempo`</span> têm valores *p* <span class="sc">\&gt;</span> 0,05. Não houve violação da esfericidade. Não há necessidade das correções de GG e HF.</span>
<span id="cb68-664"><a href="#cb68-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-665"><a href="#cb68-665" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Obtenção dos resíduos e valores ajustados</span></span>
<span id="cb68-666"><a href="#cb68-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-667"><a href="#cb68-667" aria-hidden="true" tabindex="-1"></a>Da mesma forma como realizado para a ANOVA de medidas repetidas unifatorial, para avaliar os pressupostos, há necessidade de obter os resíduos do modelo.</span>
<span id="cb68-668"><a href="#cb68-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-669"><a href="#cb68-669" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`aov_car()`</span> ajusta a ANOVA com estrutura para medidas repetidas, mas não expõe resíduos diretamente e, portanto, eles necessitam ser extraídos a partir de outro modelo de ajuste como o modelo linear de efeitos mistos (*Linear mixed-effects model*) através da função <span class="in">`lme()`</span> do pacote <span class="in">`nlme`</span>. (veja @modelo_lme).</span>
<span id="cb68-670"><a href="#cb68-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-673"><a href="#cb68-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-674"><a href="#cb68-674" aria-hidden="true" tabindex="-1"></a>modelo_lme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb68-675"><a href="#cb68-675" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo,</span>
<span id="cb68-676"><a href="#cb68-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id,</span>
<span id="cb68-677"><a href="#cb68-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb68-678"><a href="#cb68-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_bi)</span>
<span id="cb68-679"><a href="#cb68-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-680"><a href="#cb68-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-681"><a href="#cb68-681" aria-hidden="true" tabindex="-1"></a>A partir desse modelo, pode-se extrair os resíduos e valores ajustados e incorporá-los aos <span class="in">`dadosL_bi`</span>, facilitando a análise do modelo.</span>
<span id="cb68-682"><a href="#cb68-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-685"><a href="#cb68-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-686"><a href="#cb68-686" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>residuos <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_lme)</span>
<span id="cb68-687"><a href="#cb68-687" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>ajustados <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelo_lme)</span>
<span id="cb68-688"><a href="#cb68-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-689"><a href="#cb68-689" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL_bi)</span>
<span id="cb68-690"><a href="#cb68-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-691"><a href="#cb68-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-692"><a href="#cb68-692" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normalidade dos resíduos</span></span>
<span id="cb68-693"><a href="#cb68-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-694"><a href="#cb68-694" aria-hidden="true" tabindex="-1"></a>A normalidade dos resíduos é realizada dentro de cada tempo e grupo por ser mais rigorosa. Para realizar essa ação se fará uso da função <span class="in">`shapiro_test()`</span> do pacote <span class="in">`rstatix`</span> e de gráficos QQ (@fig-qqaov2) com o <span class="in">`ggplot2`</span>.</span>
<span id="cb68-695"><a href="#cb68-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-698"><a href="#cb68-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-699"><a href="#cb68-699" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-700"><a href="#cb68-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-701"><a href="#cb68-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(residuos)</span>
<span id="cb68-702"><a href="#cb68-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-703"><a href="#cb68-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-704"><a href="#cb68-704" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Gráfico QQ</span><span class="co">]</span>{.underline}</span>
<span id="cb68-705"><a href="#cb68-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-708"><a href="#cb68-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-709"><a href="#cb68-709" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-qqaov2</span></span>
<span id="cb68-710"><a href="#cb68-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-711"><a href="#cb68-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-712"><a href="#cb68-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-713"><a href="#cb68-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb68-714"><a href="#cb68-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb68-715"><a href="#cb68-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "QQ plot dos resíduos por grupo e tempo"</span></span>
<span id="cb68-716"><a href="#cb68-716" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb68-717"><a href="#cb68-717" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> residuos,</span>
<span id="cb68-718"><a href="#cb68-718" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tempo)) <span class="sc">+</span> </span>
<span id="cb68-719"><a href="#cb68-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb68-720"><a href="#cb68-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span> </span>
<span id="cb68-721"><a href="#cb68-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(grupo <span class="sc">~</span> tempo) <span class="sc">+</span> </span>
<span id="cb68-722"><a href="#cb68-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"QQ Plot dos Resíduos por Grupo e Tempo"</span>, </span>
<span id="cb68-723"><a href="#cb68-723" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Quantis Teóricos"</span>, </span>
<span id="cb68-724"><a href="#cb68-724" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Quantis dos Resíduos"</span> ) <span class="sc">+</span> </span>
<span id="cb68-725"><a href="#cb68-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb68-726"><a href="#cb68-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-727"><a href="#cb68-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-728"><a href="#cb68-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-729"><a href="#cb68-729" aria-hidden="true" tabindex="-1"></a>Os resultados indicam que, embora a maioria dos subgrupos apresente distribuição aproximadamente normal dos resíduos (p <span class="sc">\&gt;</span> 0,05), foram observadas violações pontuais nos tempos t~0~ do grupo "caso" (*p* = 0,00096) e t~2~ do grupo "controle" (*p* = 0,0126). Os Q-Q plots confirmaram essas distorções com leve curvatura nas caudas. Apesar dessas exceções, os resíduos apresentaram comportamento adequado na maioria das condições avaliadas. Considerando o tamanho amostral (n = 41, por grupo) e a robustez dos modelos mistos frente a desvios moderados da normalidade, entende-se que os pressupostos foram suficientemente atendidos para a validade da análise.</span>
<span id="cb68-730"><a href="#cb68-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-731"><a href="#cb68-731" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pesquisa de outliers nos residuos</span></span>
<span id="cb68-732"><a href="#cb68-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-733"><a href="#cb68-733" aria-hidden="true" tabindex="-1"></a>A presença de *outliers* serão analisados, usando função <span class="in">`identify_outliers()`</span> do pacote <span class="in">`rstatix`</span> e através de boxplots.</span>
<span id="cb68-734"><a href="#cb68-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-737"><a href="#cb68-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-738"><a href="#cb68-738" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-739"><a href="#cb68-739" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grupo, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-740"><a href="#cb68-740" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(residuos)</span>
<span id="cb68-741"><a href="#cb68-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-742"><a href="#cb68-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-743"><a href="#cb68-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-744"><a href="#cb68-744" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Boxplots</span><span class="co">]</span>{.underline}</span>
<span id="cb68-745"><a href="#cb68-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-748"><a href="#cb68-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-749"><a href="#cb68-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bxppef</span></span>
<span id="cb68-750"><a href="#cb68-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-751"><a href="#cb68-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-752"><a href="#cb68-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-753"><a href="#cb68-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "80%"</span></span>
<span id="cb68-754"><a href="#cb68-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-755"><a href="#cb68-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Boxplots mostrando o efeito de um corticoide inalatório"</span></span>
<span id="cb68-756"><a href="#cb68-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-757"><a href="#cb68-757" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span> (dadosL_bi,</span>
<span id="cb68-758"><a href="#cb68-758" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-759"><a href="#cb68-759" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>, </span>
<span id="cb68-760"><a href="#cb68-760" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"tempo"</span>, </span>
<span id="cb68-761"><a href="#cb68-761" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"residuos"</span>, </span>
<span id="cb68-762"><a href="#cb68-762" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-763"><a href="#cb68-763" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"grupo"</span>,</span>
<span id="cb68-764"><a href="#cb68-764" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>,</span>
<span id="cb68-765"><a href="#cb68-765" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tempo"</span>,</span>
<span id="cb68-766"><a href="#cb68-766" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outliers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-767"><a href="#cb68-767" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb68-768"><a href="#cb68-768" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb68-769"><a href="#cb68-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb68-770"><a href="#cb68-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-771"><a href="#cb68-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-772"><a href="#cb68-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-773"><a href="#cb68-773" aria-hidden="true" tabindex="-1"></a>A análise dos resíduos do modelo ajustado por efeitos mistos (lme) identificou 8 observações como outliers (@fig-bxppef), sendo uma classificada como outlier extremo (id = 78). Essas observações não comprometem os pressupostos da homocedasticidade e normalidade dos resíduos. Assim, não foi indicada a exclusão de dados, mantendo-se a integridade da amostra para fins analíticos.</span>
<span id="cb68-774"><a href="#cb68-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-775"><a href="#cb68-775" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Análise da influência dos outliers {#sec-lmModel}</span></span>
<span id="cb68-776"><a href="#cb68-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-777"><a href="#cb68-777" aria-hidden="true" tabindex="-1"></a>Para análise de influência em modelos de efeitos mistos (<span class="in">`lme`</span>), usa-se abordagens adaptadas, já que funções como <span class="in">`cooks.distance()`</span> não são aplicáveis diretamente e necessitam de um modelo equivalente mais simples:</span>
<span id="cb68-778"><a href="#cb68-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-781"><a href="#cb68-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-782"><a href="#cb68-782" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de modelo linear simples para o teste (sem efeitos aleatórios)</span></span>
<span id="cb68-783"><a href="#cb68-783" aria-hidden="true" tabindex="-1"></a>modelo_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo, <span class="at">data =</span> dadosL_bi)</span>
<span id="cb68-784"><a href="#cb68-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-785"><a href="#cb68-785" aria-hidden="true" tabindex="-1"></a><span class="co"># Distância de Cook</span></span>
<span id="cb68-786"><a href="#cb68-786" aria-hidden="true" tabindex="-1"></a>cooksD <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo_lm)</span>
<span id="cb68-787"><a href="#cb68-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-788"><a href="#cb68-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Alavancagem</span></span>
<span id="cb68-789"><a href="#cb68-789" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_lm)</span>
<span id="cb68-790"><a href="#cb68-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-791"><a href="#cb68-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-792"><a href="#cb68-792" aria-hidden="true" tabindex="-1"></a>Adicionar a distância de Cook e os valores da leverage (alavancagem) nos <span class="in">`dadosL_bi`</span>:</span>
<span id="cb68-793"><a href="#cb68-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-796"><a href="#cb68-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-797"><a href="#cb68-797" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>cooksD <span class="ot">&lt;-</span> cooksD</span>
<span id="cb68-798"><a href="#cb68-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-799"><a href="#cb68-799" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>leverage <span class="ot">&lt;-</span> leverage</span>
<span id="cb68-800"><a href="#cb68-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-801"><a href="#cb68-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-802"><a href="#cb68-802" aria-hidden="true" tabindex="-1"></a>Criar uma variável com observações influentes:</span>
<span id="cb68-803"><a href="#cb68-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-806"><a href="#cb68-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-807"><a href="#cb68-807" aria-hidden="true" tabindex="-1"></a>dadosL_bi<span class="sc">$</span>is.influential <span class="ot">&lt;-</span> dadosL_bi<span class="sc">$</span>cooksD <span class="sc">&gt;</span> (<span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(dadosL_bi))</span>
<span id="cb68-808"><a href="#cb68-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-809"><a href="#cb68-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-810"><a href="#cb68-810" aria-hidden="true" tabindex="-1"></a>Visualizar em um gráfico , construído com o <span class="in">`ggplot`</span>2:</span>
<span id="cb68-811"><a href="#cb68-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-814"><a href="#cb68-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-815"><a href="#cb68-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cook</span></span>
<span id="cb68-816"><a href="#cb68-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-817"><a href="#cb68-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-818"><a href="#cb68-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-819"><a href="#cb68-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "80%"</span></span>
<span id="cb68-820"><a href="#cb68-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-821"><a href="#cb68-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Boxplots mostrando o efeito de um corticoide inalatório"</span></span>
<span id="cb68-822"><a href="#cb68-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-823"><a href="#cb68-823" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb68-824"><a href="#cb68-824" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq_along</span>(cooksD), <span class="at">y =</span> cooksD)) <span class="sc">+</span></span>
<span id="cb68-825"><a href="#cb68-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb68-826"><a href="#cb68-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(dadosL_bi), </span>
<span id="cb68-827"><a href="#cb68-827" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb68-828"><a href="#cb68-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance"</span>, </span>
<span id="cb68-829"><a href="#cb68-829" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observação"</span>, </span>
<span id="cb68-830"><a href="#cb68-830" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Distância de Cook"</span>) <span class="sc">+</span></span>
<span id="cb68-831"><a href="#cb68-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb68-832"><a href="#cb68-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-833"><a href="#cb68-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-834"><a href="#cb68-834" aria-hidden="true" tabindex="-1"></a>O gráfico da distância de Cook (@fig-cook) mostra que a maioria das observações tem baixa influência (valores próximos de zero). Algumas observações ultrapassam a linha de corte (em vermelho), definida como 4/n (n = número de observações). No exemplo, o ponto de corte é $4/246 \approx 0,016$, isto indica possível influência desproporcional no modelo. Entretanto, não há muitos pontos extremos, o que é um bom sinal. Após esse passo, deve-se identificar esses valores influentes e avaliá-los:</span>
<span id="cb68-835"><a href="#cb68-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-838"><a href="#cb68-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-839"><a href="#cb68-839" aria-hidden="true" tabindex="-1"></a>dadosL_bi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is.influential) <span class="sc">%&gt;%</span> </span>
<span id="cb68-840"><a href="#cb68-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, grupo, tempo, escores, cooksD, leverage)</span>
<span id="cb68-841"><a href="#cb68-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-842"><a href="#cb68-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-843"><a href="#cb68-843" aria-hidden="true" tabindex="-1"></a>Foram identificados 11 observações influentes segundo a Distância de Cook, todas no grupo caso e com escores extremos (muito baixos ou muito altos). Os valores de Cook's D estão acima do limiar (\~0.016), mas ainda não são alarmantes (valores <span class="sc">\&gt;</span> 1 seriam muito preocupantes). Os leverage values (\~0.0244) também são baixos, indicando que essas observações não têm posição incomum nos preditores, mas o valor da variável dependente (escore) é que impacta mais. Como esses valores não se constituem em um erro de digitação ou inconsistência nos escores de PEF, os valores serão mantidos. Essa abordagem não será demonstrada, pois já foi realizada pelo autor e as conclusões não mudam.</span>
<span id="cb68-844"><a href="#cb68-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-845"><a href="#cb68-845" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb68-846"><a href="#cb68-846" aria-hidden="true" tabindex="-1"></a><span class="fu">## Script completo para para comparar os modelos.</span></span>
<span id="cb68-847"><a href="#cb68-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-848"><a href="#cb68-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r curioso, eval = FALSE}</span></span>
<span id="cb68-849"><a href="#cb68-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-850"><a href="#cb68-850" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Remover observações influentes</span></span>
<span id="cb68-851"><a href="#cb68-851" aria-hidden="true" tabindex="-1"></a>dadosL_sem_inf <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span> </span>
<span id="cb68-852"><a href="#cb68-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is.influential)</span>
<span id="cb68-853"><a href="#cb68-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-854"><a href="#cb68-854" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ajustar modelo com todos os dados</span></span>
<span id="cb68-855"><a href="#cb68-855" aria-hidden="true" tabindex="-1"></a>modelo_completo <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(</span>
<span id="cb68-856"><a href="#cb68-856" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb68-857"><a href="#cb68-857" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_bi,</span>
<span id="cb68-858"><a href="#cb68-858" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-859"><a href="#cb68-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-860"><a href="#cb68-860" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Ajustar modelo sem observações influentes</span></span>
<span id="cb68-861"><a href="#cb68-861" aria-hidden="true" tabindex="-1"></a>modelo_sem_inf <span class="ot">&lt;-</span> <span class="fu">aov_car</span>(</span>
<span id="cb68-862"><a href="#cb68-862" aria-hidden="true" tabindex="-1"></a>  escores <span class="sc">~</span> grupo <span class="sc">*</span> tempo <span class="sc">+</span> <span class="fu">Error</span>(id<span class="sc">/</span>tempo), </span>
<span id="cb68-863"><a href="#cb68-863" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dadosL_sem_inf,</span>
<span id="cb68-864"><a href="#cb68-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-865"><a href="#cb68-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-866"><a href="#cb68-866" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Comparar os resultados</span></span>
<span id="cb68-867"><a href="#cb68-867" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_completo)</span>
<span id="cb68-868"><a href="#cb68-868" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_sem_inf)</span>
<span id="cb68-869"><a href="#cb68-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-870"><a href="#cb68-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-871"><a href="#cb68-871" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-872"><a href="#cb68-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-873"><a href="#cb68-873" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Homoscedasticidade</span></span>
<span id="cb68-874"><a href="#cb68-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-875"><a href="#cb68-875" aria-hidden="true" tabindex="-1"></a>A homoscedasticidade será avaliada por um gráfico de dispersão dos resíduos:</span>
<span id="cb68-876"><a href="#cb68-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-879"><a href="#cb68-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-880"><a href="#cb68-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-resajust</span></span>
<span id="cb68-881"><a href="#cb68-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-882"><a href="#cb68-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-883"><a href="#cb68-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-884"><a href="#cb68-884" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "80%"</span></span>
<span id="cb68-885"><a href="#cb68-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-886"><a href="#cb68-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Gráfico de dispersão resíduos vs valores ajustados"</span></span>
<span id="cb68-887"><a href="#cb68-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-888"><a href="#cb68-888" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, <span class="fu">aes</span>(<span class="at">x =</span> ajustados, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb68-889"><a href="#cb68-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb68-890"><a href="#cb68-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb68-891"><a href="#cb68-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-892"><a href="#cb68-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Resíduos vs. Valores Ajustados"</span>,</span>
<span id="cb68-893"><a href="#cb68-893" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb68-894"><a href="#cb68-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Resíduos"</span></span>
<span id="cb68-895"><a href="#cb68-895" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-896"><a href="#cb68-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb68-897"><a href="#cb68-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-898"><a href="#cb68-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-899"><a href="#cb68-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-900"><a href="#cb68-900" aria-hidden="true" tabindex="-1"></a>Observando a @fig-resajust , verifica-se uma boa dispersão dos pontos ao redor da linha zero,&nbsp; sem padrão claro (como funil ou curva) e variação aproximadamente constante ao longo dos ajustados.</span>
<span id="cb68-901"><a href="#cb68-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-902"><a href="#cb68-902" aria-hidden="true" tabindex="-1"></a>Portanto, não há evidências visuais fortes de violação da homocedasticidade. O pressuposto de variâncias constantes entre as combinações de grupo e tempo parece razoavelmente atendido.</span>
<span id="cb68-903"><a href="#cb68-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-904"><a href="#cb68-904" aria-hidden="true" tabindex="-1"></a>O gráfico já atende o requisito para avaliar a homoscedasticidade, mas também é possível aplicar o teste de Breusch-Pagan, que precisa de um modelo ajustado com <span class="in">`lm()`</span> (veja @sec-lmModel). Como o modelo foi ajustado com a <span class="in">`lme()`</span>, há necessidade de ajustar um modelo equivalente sem efeitos aleatórios, apenas para o teste:</span>
<span id="cb68-905"><a href="#cb68-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-908"><a href="#cb68-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-909"><a href="#cb68-909" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_lm)</span>
<span id="cb68-910"><a href="#cb68-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-911"><a href="#cb68-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-912"><a href="#cb68-912" aria-hidden="true" tabindex="-1"></a>O valor *p* <span class="sc">\&lt;</span> 0.05 indica que há evidência de heteroscedasticidade — ou seja, a variância dos resíduos não é constante entre os grupos ou tempos. Isso viola o pressuposto de homoscedasticidade, que é importante para testes F na ANOVA clássica.</span>
<span id="cb68-913"><a href="#cb68-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-914"><a href="#cb68-914" aria-hidden="true" tabindex="-1"></a>Como o modelo principal é uma &nbsp;ANOVA de medidas repetidas via <span class="in">`aov_car()`</span> ou <span class="in">`lme()`</span>, esses modelos já são mais robustos à heteroscedasticidade do que o <span class="in">`lm()`</span> usado no teste.</span>
<span id="cb68-915"><a href="#cb68-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-916"><a href="#cb68-916" aria-hidden="true" tabindex="-1"></a>Apesar da significância estatística, o efeito observado foi pequeno, e o uso de um modelo misto (<span class="in">`lme`</span>), que acomoda estruturas de variância flexíveis, reduz a influência dessa violação sobre os resultados inferenciais.</span>
<span id="cb68-917"><a href="#cb68-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-918"><a href="#cb68-918" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Resumo da avaliação dos pressupostos</span></span>
<span id="cb68-919"><a href="#cb68-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-920"><a href="#cb68-920" aria-hidden="true" tabindex="-1"></a>A adequação dos pressupostos foi avaliada para o modelo de ANOVA de medidas repetidas de dois fatores ajustado com a função <span class="in">`aov_car()`</span> do pacote <span class="in">`afex`</span>, considerando as variáveis <span class="in">`grupo`</span> (caso, controle) e <span class="in">`tempo`</span> (t~0~, t~1~, t~2~), com medidas repetidas por sujeito (<span class="in">`id`</span>).</span>
<span id="cb68-921"><a href="#cb68-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-922"><a href="#cb68-922" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> <span class="co">[</span><span class="ot">Normalidade dos resíduos</span><span class="co">]</span>{.underline}:</span>
<span id="cb68-923"><a href="#cb68-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-924"><a href="#cb68-924" aria-hidden="true" tabindex="-1"></a>A normalidade foi verificada por meio do teste de Shapiro-Wilk para os resíduos intra-sujeitos em cada combinação de grupo e tempo. Alguns desvios foram observados, com valores *p* <span class="sc">\&lt;</span> 0.05 para casos em t~0~ e controles em t~<span class="co">[</span><span class="ot">2</span><span class="co">]</span>{.smallcaps}~, sugerindo violação da normalidade em partes dos dados. Ainda assim, os resíduos em geral apresentaram distribuição aproximadamente simétrica nos gráficos Q-Q , sendo a violação considerada moderada. Como a ANOVA é relativamente robusta a desvios da normalidade, especialmente em amostras maiores, o modelo foi mantido.</span>
<span id="cb68-925"><a href="#cb68-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-926"><a href="#cb68-926" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> <span class="co">[</span><span class="ot">Outliers</span><span class="co">]</span>{.underline}:</span>
<span id="cb68-927"><a href="#cb68-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-928"><a href="#cb68-928" aria-hidden="true" tabindex="-1"></a>Foram detectadas 8 observações *outliers* com base nos resíduos do modelo ajustado com <span class="in">`lme()`</span>. Uma dessas foi classificada como extremo, e todas associadas a valores de escores distantes da média esperada. Adicionalmente, a análise de influência (Cook’s Distance) identificou 11 observações influentes, principalmente no grupo caso, indicando possível impacto em estimativas do modelo.</span>
<span id="cb68-929"><a href="#cb68-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-930"><a href="#cb68-930" aria-hidden="true" tabindex="-1"></a>A comparação entre os modelos com e sem essas observações revelou que a exclusão dos influentes não alterou as conclusões principais: o efeito de tempo permaneceu altamente significativo (p <span class="sc">\&lt;</span> 0.001), o efeito de grupo não foi significativo (p <span class="sc">\&gt;</span> 0.46), e a interação grupo × tempo continuou significativa (p <span class="sc">\&lt;</span> 0.001), embora com leve redução no F. Isso sugere que o modelo é estável e robusto, mesmo na presença de influências pontuais.</span>
<span id="cb68-931"><a href="#cb68-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-932"><a href="#cb68-932" aria-hidden="true" tabindex="-1"></a>3<span class="sc">\.</span> <span class="co">[</span><span class="ot">Esfericidade</span><span class="co">]</span>{.underline}:</span>
<span id="cb68-933"><a href="#cb68-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-934"><a href="#cb68-934" aria-hidden="true" tabindex="-1"></a>A esfericidade, pressuposto fundamental em ANOVA com medidas repetidas, foi avaliada com o teste de Mauchly, que não indicou violação para tempo nem para a interação grupo × tempo (p <span class="sc">\&gt;</span> 0.19). As correções de Greenhouse-Geisser e Huynh-Feldt foram consistentes, mantendo a significância dos efeitos, o que reforça a confiabilidade da análise.</span>
<span id="cb68-935"><a href="#cb68-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-936"><a href="#cb68-936" aria-hidden="true" tabindex="-1"></a>4<span class="sc">\.</span> <span class="co">[</span><span class="ot">Homoscedasticidade</span><span class="co">]</span>{.underline}:</span>
<span id="cb68-937"><a href="#cb68-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-938"><a href="#cb68-938" aria-hidden="true" tabindex="-1"></a>A homogeneidade de variâncias foi avaliada graficamente e formalmente via teste de Breusch-Pagan em modelo lm paralelo, retornando p = 0.025, o que indica heterocedasticidade leve. Essa violação reforça a importância de validar os resultados com modelos mistos (<span class="in">`lme`</span>), que lidam melhor com esse tipo de estrutura de erro.</span>
<span id="cb68-939"><a href="#cb68-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-940"><a href="#cb68-940" aria-hidden="true" tabindex="-1"></a>**Conclusão**:</span>
<span id="cb68-941"><a href="#cb68-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-942"><a href="#cb68-942" aria-hidden="true" tabindex="-1"></a>Apesar de desvios pontuais nos pressupostos (normalidade, homoscedasticidade), o modelo demonstrou consistência estatística e robustez analítica. A remoção de observações influentes não alterou os resultados principais, fortalecendo a confiança nas conclusões. A abordagem adotada, que incluiu modelos alternativos e verificação cuidadosa de resíduos, garante a validade da inferência realizada com a ANOVA de medidas repetidas.</span>
<span id="cb68-943"><a href="#cb68-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-944"><a href="#cb68-944" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testes post hoc</span></span>
<span id="cb68-945"><a href="#cb68-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-946"><a href="#cb68-946" aria-hidden="true" tabindex="-1"></a>Considerando que a interação <span class="in">`grupo:tempo`</span> foi significativa (ver \@sec-anova2model), se justifica explorar as diferenças dentro e entre grupos ao longo do tempo.</span>
<span id="cb68-947"><a href="#cb68-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-948"><a href="#cb68-948" aria-hidden="true" tabindex="-1"></a>Embora de tanto o modelo construído com <span class="in">`aov_car()`</span>, do pacote <span class="in">`afex`</span>, quanto o modelo com <span class="in">`lme()`</span>, do pacote <span class="in">`nlme`</span>, possam ser utilizados para ajustar modelos de ANOVA de medidas repetidas, a opção para os pós testes, será será pelo uso do <span class="in">`lme()`</span>, assim como realizado com os resíduos. Existem alguns motivos para isso:</span>
<span id="cb68-949"><a href="#cb68-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-950"><a href="#cb68-950" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Nos pós-testes, será usado o pacote <span class="in">`emmeans`</span> e ele funciona melhor com o <span class="in">`lme()`</span>, pois reconhece muito bem o modelo misto e permite pós-testes com estrutura correta (por exemplo, comparações dentro de sujeitos);</span>
<span id="cb68-951"><a href="#cb68-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-952"><a href="#cb68-952" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Facilidade para extrair resíduos, valores ajustados, influências etc. A <span class="in">`aov_car()`</span> encapsula o modelo de forma menos transparente (resultado mais voltado ao relatório da ANOVA – tipo III, teste de Mauchly, GG/HF, etc.). Com <span class="in">`lme()`</span>, se tem acesso direto ao modelo e seus componentes.</span>
<span id="cb68-953"><a href="#cb68-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-954"><a href="#cb68-954" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Mais controle da estrutura de correlação (caso se precise modelar estruturas mais complexas de medidas repetidas).</span>
<span id="cb68-955"><a href="#cb68-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-956"><a href="#cb68-956" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparações entre níveis de tempo dentro de cada grupo</span></span>
<span id="cb68-957"><a href="#cb68-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-958"><a href="#cb68-958" aria-hidden="true" tabindex="-1"></a>Para entender como os escores mudam ao longo do tempo em casos e controles separadamente, recomenda-se:</span>
<span id="cb68-959"><a href="#cb68-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-962"><a href="#cb68-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-963"><a href="#cb68-963" aria-hidden="true" tabindex="-1"></a>emmeans_tempo_dentro_grupo <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo_lme, <span class="sc">~</span> tempo <span class="sc">|</span> grupo)</span>
<span id="cb68-964"><a href="#cb68-964" aria-hidden="true" tabindex="-1"></a>contrastes_tempo_dentro <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emmeans_tempo_dentro_grupo, </span>
<span id="cb68-965"><a href="#cb68-965" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span> <span class="st">"pairwise"</span>, </span>
<span id="cb68-966"><a href="#cb68-966" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb68-967"><a href="#cb68-967" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrastes_tempo_dentro)</span>
<span id="cb68-968"><a href="#cb68-968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-969"><a href="#cb68-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-970"><a href="#cb68-970" aria-hidden="true" tabindex="-1"></a>A saída mostra que, no grupo caso, houve diferenças significativas entre todos os tempos. Isso sugere que o PFE aumentou progressivamente ao longo do tempo no grupo que recebeu o novo corticoide inalatório. No grupo controle , o padrão indica que a melhora foi mais tardia (apenas entre t~1~ e t\~2), possivelmente refletindo um efeito menor ou mais lento do medicamento.</span>
<span id="cb68-971"><a href="#cb68-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-972"><a href="#cb68-972" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparações entre os grupos dentro de cada tempo</span></span>
<span id="cb68-973"><a href="#cb68-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-974"><a href="#cb68-974" aria-hidden="true" tabindex="-1"></a>Para entender se há diferença entre casos e controles em t~0~, t~1~, t~2~:</span>
<span id="cb68-975"><a href="#cb68-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-978"><a href="#cb68-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-979"><a href="#cb68-979" aria-hidden="true" tabindex="-1"></a>emmeans_grupo_dentro_tempo <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo_lme, <span class="sc">~</span> grupo <span class="sc">|</span> tempo)</span>
<span id="cb68-980"><a href="#cb68-980" aria-hidden="true" tabindex="-1"></a>contrastes_grupo_dentro <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emmeans_grupo_dentro_tempo, </span>
<span id="cb68-981"><a href="#cb68-981" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span> <span class="st">"pairwise"</span>, </span>
<span id="cb68-982"><a href="#cb68-982" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb68-983"><a href="#cb68-983" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrastes_grupo_dentro)</span>
<span id="cb68-984"><a href="#cb68-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-985"><a href="#cb68-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-986"><a href="#cb68-986" aria-hidden="true" tabindex="-1"></a>Em nenhum dos tempos a diferença entre os grupos foi estatisticamente significativa. Apesar de t~2~ mostrar tendência de diferença (p = 0.0933), não alcança significância convencional estabelecida de 0,05. Ainda assim, pode ter relevância clínica, dependendo do contexto.</span>
<span id="cb68-987"><a href="#cb68-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-988"><a href="#cb68-988" aria-hidden="true" tabindex="-1"></a>Os resultados reforçam o achado da interação significativa entre grupo e tempo na ANOVA. O grupo "caso" apresentou evolução mais consistente ao longo das avaliações, enquanto o grupo "controle" teve melhora mais discreta e tardia. A ausência de diferenças entre os grupos em cada tempo sugere que os efeitos se acumulam ao longo do tempo, mais visivelmente nos tratados (casos).</span>
<span id="cb68-989"><a href="#cb68-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-990"><a href="#cb68-990" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relatando os resultados da ANOVA de medidas repetidas de dois fatores</span></span>
<span id="cb68-991"><a href="#cb68-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-992"><a href="#cb68-992" aria-hidden="true" tabindex="-1"></a>O resultado pode ser relatado da seguinte forma:</span>
<span id="cb68-993"><a href="#cb68-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-994"><a href="#cb68-994" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Uma ANOVA de medidas repetidas de dois fatores foi conduzida para avaliar o efeito de um novo corticosteroide inalatório em crianças asmáticas, com idades entre 7 e 15 anos, sobre os escores de Pico de Fluxo Expiratório (PFE), ao longo de três momentos (t~0~, t~1~, t~2~).</span>
<span id="cb68-995"><a href="#cb68-995" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Observou-se uma interação estatisticamente significativa entre grupo e tempo no escore de PFE, F(2, 160) = 8,34, p <span class="sc">\&lt;</span> 0,00036. Em função dessa interação, as comparações foram realizadas separadamente dentro de cada grupo. Os valores de *p* foram ajustados pelo método de Bonferroni</span>
<span id="cb68-996"><a href="#cb68-996" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">Grupo caso</span><span class="co">]</span>{.underline}: houve diferenças significativas entre todos os tempos (t~0~ vs. t~1~: *p* \&lt; 0,0001; t~0~ vs. t~2~: *p* \&lt; 0,0001; t~1~ vs. t~2~: *p* <span class="sc">\&lt;</span> 0,0001), indicando melhora progressiva.</span>
<span id="cb68-997"><a href="#cb68-997" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">Grupo controle</span><span class="co">]</span>{.underline}: não houve diferença significativa entre t~0~ e t~1~ (*p* = 0,265), mas houve entre t~0~ e t~2~ (*p* \&lt; 0,0001) e entre t~1~ e t~2~ (*p* = 0,0003), sugerindo um efeito mais tardio.</span>
<span id="cb68-998"><a href="#cb68-998" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>As comparações entre grupos dentro de cada tempo não revelaram diferenças estatisticamente significativas (*p* \&gt; 0,05 em todos os casos), embora uma tendência tenha sido observada em t~2~ (*p* = 0,0933), sem atingir significância convencional.</span>
<span id="cb68-999"><a href="#cb68-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1000"><a href="#cb68-1000" aria-hidden="true" tabindex="-1"></a>Recomenda-se acompanhar as conclusões com um gráfico (@fig-lineFinal).</span>
<span id="cb68-1001"><a href="#cb68-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1004"><a href="#cb68-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1005"><a href="#cb68-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lineFinal</span></span>
<span id="cb68-1006"><a href="#cb68-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1007"><a href="#cb68-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1008"><a href="#cb68-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb68-1009"><a href="#cb68-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "80%"</span></span>
<span id="cb68-1010"><a href="#cb68-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb68-1011"><a href="#cb68-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Efeito do novo corticoide inalatório nos escores de Pico de Fluxo Expiratório ao longo do tempo nos em crianças asmáticas de 7 a 15 anos"</span></span>
<span id="cb68-1012"><a href="#cb68-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1013"><a href="#cb68-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de um modelo com rstatix::anova_test()</span></span>
<span id="cb68-1014"><a href="#cb68-1014" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span> </span>
<span id="cb68-1015"><a href="#cb68-1015" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">anova_test</span>(<span class="at">dv =</span> escores, </span>
<span id="cb68-1016"><a href="#cb68-1016" aria-hidden="true" tabindex="-1"></a>             <span class="at">wid =</span> id, </span>
<span id="cb68-1017"><a href="#cb68-1017" aria-hidden="true" tabindex="-1"></a>             <span class="at">within =</span> tempo,</span>
<span id="cb68-1018"><a href="#cb68-1018" aria-hidden="true" tabindex="-1"></a>             <span class="at">between =</span> grupo,</span>
<span id="cb68-1019"><a href="#cb68-1019" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="dv">3</span>) </span>
<span id="cb68-1020"><a href="#cb68-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1021"><a href="#cb68-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(mod) </span>
<span id="cb68-1022"><a href="#cb68-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1023"><a href="#cb68-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparações por pares (pwc)</span></span>
<span id="cb68-1024"><a href="#cb68-1024" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-1025"><a href="#cb68-1025" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-1026"><a href="#cb68-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(escores <span class="sc">~</span> grupo, </span>
<span id="cb68-1027"><a href="#cb68-1027" aria-hidden="true" tabindex="-1"></a>                  <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-1028"><a href="#cb68-1028" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb68-1029"><a href="#cb68-1029" aria-hidden="true" tabindex="-1"></a>pwc</span>
<span id="cb68-1030"><a href="#cb68-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1031"><a href="#cb68-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores p e posição no eixo y</span></span>
<span id="cb68-1032"><a href="#cb68-1032" aria-hidden="true" tabindex="-1"></a>pvalores <span class="ot">&lt;-</span> dadosL_bi <span class="sc">%&gt;%</span></span>
<span id="cb68-1033"><a href="#cb68-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tempo) <span class="sc">%&gt;%</span></span>
<span id="cb68-1034"><a href="#cb68-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(escores <span class="sc">~</span> grupo, </span>
<span id="cb68-1035"><a href="#cb68-1035" aria-hidden="true" tabindex="-1"></a>                  <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-1036"><a href="#cb68-1036" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-1037"><a href="#cb68-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> <span class="dv">250</span>)</span>
<span id="cb68-1038"><a href="#cb68-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1039"><a href="#cb68-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico final</span></span>
<span id="cb68-1040"><a href="#cb68-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosL_bi, </span>
<span id="cb68-1041"><a href="#cb68-1041" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tempo, </span>
<span id="cb68-1042"><a href="#cb68-1042" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> escores, </span>
<span id="cb68-1043"><a href="#cb68-1043" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> grupo, </span>
<span id="cb68-1044"><a href="#cb68-1044" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> grupo)) <span class="sc">+</span></span>
<span id="cb68-1045"><a href="#cb68-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, </span>
<span id="cb68-1046"><a href="#cb68-1046" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb68-1047"><a href="#cb68-1047" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.8</span>, </span>
<span id="cb68-1048"><a href="#cb68-1048" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb68-1049"><a href="#cb68-1049" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb68-1050"><a href="#cb68-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, </span>
<span id="cb68-1051"><a href="#cb68-1051" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>, </span>
<span id="cb68-1052"><a href="#cb68-1052" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb68-1053"><a href="#cb68-1053" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb68-1054"><a href="#cb68-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, </span>
<span id="cb68-1055"><a href="#cb68-1055" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb68-1056"><a href="#cb68-1056" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, </span>
<span id="cb68-1057"><a href="#cb68-1057" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb68-1058"><a href="#cb68-1058" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb68-1059"><a href="#cb68-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> pvalores, </span>
<span id="cb68-1060"><a href="#cb68-1060" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> tempo, </span>
<span id="cb68-1061"><a href="#cb68-1061" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y.position, </span>
<span id="cb68-1062"><a href="#cb68-1062" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">signif</span>(p, <span class="dv">3</span>))),</span>
<span id="cb68-1063"><a href="#cb68-1063" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb68-1064"><a href="#cb68-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tempo"</span>, </span>
<span id="cb68-1065"><a href="#cb68-1065" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Pico de Fluxo Expiratório (l/min)"</span>, </span>
<span id="cb68-1066"><a href="#cb68-1066" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Evolução dos escores por grupo"</span>,</span>
<span id="cb68-1067"><a href="#cb68-1067" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">get_test_label</span>(mod, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-1068"><a href="#cb68-1068" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc)) <span class="sc">+</span></span>
<span id="cb68-1069"><a href="#cb68-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb68-1070"><a href="#cb68-1070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb68-1071"><a href="#cb68-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1072"><a href="#cb68-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar para a área de transferência" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>