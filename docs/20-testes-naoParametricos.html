<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Métodos não paramétricos – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./21-testesDiag.html" rel="next">
<link href="./19-dadoscategoricos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html">Parte VIII - Métodos Não Paramétricos</a></li><li class="breadcrumb-item"><a href="./20-testes-naoParametricos.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I - Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II - Ambiente Computacional com R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-introducaoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introdução ao uso do R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando dados no R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III - Estatística Descritiva</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-medidasResumidoras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Medidas Resumidoras</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tabelas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tabelas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gráficos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV - Probabilidades e Distribuições</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-assimetria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte V - Inferência Estatística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VI - Testes Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VII - Relações entre Variáveis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-correlacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VIII - Métodos Não Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dadoscategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-testes-naoParametricos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IX - Bioestatística Aplicada à Epidemiologia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-testesDiag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-medidasOcorrencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sobrevida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-reglogbin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários-neste-capítulo" id="toc-pacotes-necessários-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-necessários-neste-capítulo"><span class="header-section-number">20.1</span> Pacotes necessários neste capítulo</a></li>
  <li><a href="#sec-distlivre" id="toc-sec-distlivre" class="nav-link" data-scroll-target="#sec-distlivre"><span class="header-section-number">20.2</span> Distribuição livre</a></li>
  <li><a href="#sec-postos" id="toc-sec-postos" class="nav-link" data-scroll-target="#sec-postos"><span class="header-section-number">20.3</span> Postos</a></li>
  <li><a href="#teste-de-mann-whitney" id="toc-teste-de-mann-whitney" class="nav-link" data-scroll-target="#teste-de-mann-whitney"><span class="header-section-number">20.4</span> Teste de Mann-Whitney</a>
  <ul class="collapse">
  <li><a href="#dados-usados-no-exemplo" id="toc-dados-usados-no-exemplo" class="nav-link" data-scroll-target="#dados-usados-no-exemplo"><span class="header-section-number">20.4.1</span> Dados usados no exemplo</a></li>
  <li><a href="#hipóteses-estatísticas" id="toc-hipóteses-estatísticas" class="nav-link" data-scroll-target="#hipóteses-estatísticas"><span class="header-section-number">20.4.2</span> Hipóteses estatísticas</a></li>
  <li><a href="#pressupostos-do-teste-de-mann_whitney" id="toc-pressupostos-do-teste-de-mann_whitney" class="nav-link" data-scroll-target="#pressupostos-do-teste-de-mann_whitney"><span class="header-section-number">20.4.3</span> Pressupostos do teste de Mann_Whitney</a></li>
  <li><a href="#cálculo-da-estatística-de-teste" id="toc-cálculo-da-estatística-de-teste" class="nav-link" data-scroll-target="#cálculo-da-estatística-de-teste"><span class="header-section-number">20.4.4</span> Cálculo da estatística de teste</a></li>
  <li><a href="#sec-tefMW" id="toc-sec-tefMW" class="nav-link" data-scroll-target="#sec-tefMW"><span class="header-section-number">20.4.5</span> Tamanho do efeito</a></li>
  <li><a href="#conclusão" id="toc-conclusão" class="nav-link" data-scroll-target="#conclusão"><span class="header-section-number">20.4.6</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#teste-de-wilcoxon" id="toc-teste-de-wilcoxon" class="nav-link" data-scroll-target="#teste-de-wilcoxon"><span class="header-section-number">20.5</span> Teste de Wilcoxon</a>
  <ul class="collapse">
  <li><a href="#dados-usados-como-exemplo" id="toc-dados-usados-como-exemplo" class="nav-link" data-scroll-target="#dados-usados-como-exemplo"><span class="header-section-number">20.5.1</span> Dados usados como exemplo</a></li>
  <li><a href="#definição-das-hipóteses-estatísticas" id="toc-definição-das-hipóteses-estatísticas" class="nav-link" data-scroll-target="#definição-das-hipóteses-estatísticas"><span class="header-section-number">20.5.2</span> Definição das hipóteses estatísticas</a></li>
  <li><a href="#execução-do-teste-estatístico" id="toc-execução-do-teste-estatístico" class="nav-link" data-scroll-target="#execução-do-teste-estatístico"><span class="header-section-number">20.5.3</span> Execução do teste estatístico</a></li>
  <li><a href="#tamanho-do-efeito" id="toc-tamanho-do-efeito" class="nav-link" data-scroll-target="#tamanho-do-efeito"><span class="header-section-number">20.5.4</span> Tamanho do efeito</a></li>
  <li><a href="#conclusão-1" id="toc-conclusão-1" class="nav-link" data-scroll-target="#conclusão-1"><span class="header-section-number">20.5.5</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#sec-kruskalwallis" id="toc-sec-kruskalwallis" class="nav-link" data-scroll-target="#sec-kruskalwallis"><span class="header-section-number">20.6</span> Teste de Kruskal-Wallis</a>
  <ul class="collapse">
  <li><a href="#dados-usados-no-exemplo-1" id="toc-dados-usados-no-exemplo-1" class="nav-link" data-scroll-target="#dados-usados-no-exemplo-1"><span class="header-section-number">20.6.1</span> Dados usados no exemplo</a></li>
  <li><a href="#hipóteses-estatísticas-1" id="toc-hipóteses-estatísticas-1" class="nav-link" data-scroll-target="#hipóteses-estatísticas-1"><span class="header-section-number">20.6.2</span> Hipóteses estatísticas</a></li>
  <li><a href="#pressupostos-do-teste" id="toc-pressupostos-do-teste" class="nav-link" data-scroll-target="#pressupostos-do-teste"><span class="header-section-number">20.6.3</span> Pressupostos do teste</a></li>
  <li><a href="#execução-do-teste-estatístico-1" id="toc-execução-do-teste-estatístico-1" class="nav-link" data-scroll-target="#execução-do-teste-estatístico-1"><span class="header-section-number">20.6.4</span> Execução do teste estatístico</a></li>
  <li><a href="#tamanho-do-efeito-1" id="toc-tamanho-do-efeito-1" class="nav-link" data-scroll-target="#tamanho-do-efeito-1"><span class="header-section-number">20.6.5</span> Tamanho do efeito</a></li>
  <li><a href="#testes-post-hoc" id="toc-testes-post-hoc" class="nav-link" data-scroll-target="#testes-post-hoc"><span class="header-section-number">20.6.6</span> Testes post hoc</a></li>
  <li><a href="#conclusão-2" id="toc-conclusão-2" class="nav-link" data-scroll-target="#conclusão-2"><span class="header-section-number">20.6.7</span> Conclusão</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html">Parte VIII - Métodos Não Paramétricos</a></li><li class="breadcrumb-item"><a href="./20-testes-naoParametricos.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários-neste-capítulo" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="pacotes-necessários-neste-capítulo"><span class="header-section-number">20.1</span> Pacotes necessários neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span> (coin,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                confintr,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                flextable,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                ggpubr,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                ggsci,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                kableExtra,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                knitr,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                readxl,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                rstatix,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                tidyverse)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-distlivre" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sec-distlivre"><span class="header-section-number">20.2</span> Distribuição livre</h2>
<p>A maioria dos testes estatísticos, discutidos neste livro, são testes paramétricos. Nestes, o interesse estava focado em estimar ou testar uma hipótese sobre um ou mais parâmetros populacionais e ,por isso, são denominados de paramétricos. Além disso, o aspecto central desses procedimentos era o conhecimento da forma funcional da população da qual foram retiradas as amostras que forneceram a base para a inferência. Por exemplo, o teste <em>t</em> de Student para amostras independentes e a ANOVA são baseados no pressuposto de que os dados foram amostrados de populações que têm distribuição normal.</p>
<p>Os <strong>testes não paramétricos</strong> não fazem suposições em relação à distribuição da população. Não têm, portanto, os pressupostos restritivos, comuns nos testes paramétricos. Têm <em>distribuição livre</em>. São baseados em uma ideia simples de ordenação por postos, do valor mais baixo ao mais alto. Analisam somente os postos, ignorando os valores. Podem ser usados tanto com variáveis ordinais como quantitativas numéricas.</p>
</section>
<section id="sec-postos" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="sec-postos"><span class="header-section-number">20.3</span> Postos</h2>
<p>Os métodos estatísticos não paramétricos não lidam diretamente com os valores observados. Em função disso, para poder usar a informação fornecida pelas observações, sem trabalhar diretamente com os valores observados, utiliza-se os postos das observações. Posto (<em>rank</em>) de uma observação é a sua posição em relação aos demais valores.</p>
<p>A atribuição dos postos de uma variável é realizada da seguinte maneira:</p>
<ol type="1">
<li>Colocam-se as observações em ordem crescente;</li>
<li>Associam-se valores, correspondendo às suas posições relativas na amostra. O primeiro elemento recebe o valor 1, o segundo o valor 2 e, assim por diante, até que a maior observação receba o valor <em>n</em>;</li>
<li>Se todas as observações são distintas, os postos são iguais aos valores associados às observações no passo anterior.</li>
<li>Para observações iguais (empates), associam-se postos iguais à média das suas posições relativas na amostra.</li>
</ol>
<p>Por exemplo, suponha uma amostra contendo os escores de Apgar no primeiro minuto de 10 recém-nascidos a termo (<a href="#tbl-apgar1" class="quarto-xref">Tabela&nbsp;<span>20.1</span></a>)). Em primeiro lugar, os valores são colocados em ordem crescente e, após, atribui-se postos aos valores. Observe que os postos atribuídos aos valores das posições 4, 5 e 6 são iguais e correspondentes a média de 4, 5 e 6, que é igual a 5. O mesmo ocorreu com os outros valores onde houve empate. A soma dos postos, no exemplo, é igual a 55. Para verificar a correção do cálculo, haja ou não empates, a soma dos postos será sempre <span class="math inline">\(\frac {n\ \times \ (n+1)}{2}\)</span>. No exemplo, <em>n</em> = 10, logo <span class="math inline">\(\frac {10\ \times \ (10+1)}{2}=55\)</span>.</p>
<div class="cell">
<div id="tbl-apgar1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-apgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;20.1: Construção dos postos
</figcaption>
<div aria-describedby="tbl-apgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-7bde89e4{}.cl-7bcaa154{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7bcaa186{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7bd1a29c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7bd1e93c{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e950{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e95a{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e95b{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e95c{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e95d{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e964{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e965{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e96e{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e96f{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e970{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7bd1e978{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7bde89e4"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7bd1e93c"><p class="cl-7bd1a29c"><span class="cl-7bcaa154">apgar1</span></p></th><th class="cl-7bd1e950"><p class="cl-7bd1a29c"><span class="cl-7bcaa154">ordem</span></p></th><th class="cl-7bd1e95a"><p class="cl-7bd1a29c"><span class="cl-7bcaa154">posto</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">4</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">1</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">1.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">5</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">2</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">2.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e964"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">7</span></p></td><td class="cl-7bd1e965"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">3</span></p></td><td class="cl-7bd1e96e"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">3.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">4</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">5</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">6</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">9</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">7</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">9</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">8.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e95b"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">10</span></p></td><td class="cl-7bd1e95c"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">9</span></p></td><td class="cl-7bd1e95d"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">9.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7bd1e96f"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">10</span></p></td><td class="cl-7bd1e970"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">10</span></p></td><td class="cl-7bd1e978"><p class="cl-7bd1a29c"><span class="cl-7bcaa186">9.5</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="teste-de-mann-whitney" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="teste-de-mann-whitney"><span class="header-section-number">20.4</span> Teste de Mann-Whitney</h2>
<p>O <em>teste de Mann-Whitney</em> é usado para analisar a diferença na variável dependente (desfecho) para dois grupos independentes. O teste classifica todos os valores dependentes, ou seja, o valor mais baixo obtém o posto um e, em seguida, usa a soma dos postos de cada grupo no cálculo da estatística de teste.</p>
<p>É o substituto do teste <em>t</em> para amostras independentes quando os pressupostos deste teste são violados. Para a aplicação do teste de Mann-Whitney a variável de interesse deve ser ordinal ou numérica. Este teste é equivalente ao desenvolvido por Frank Wilcoxon (1892 – 1965), assim algumas vezes é denominado de <em>Wilcoxon Rank Sum Test</em> ou teste de Wilcoxon-Mann-Whitney. O R usa esta denominação e é importante não confundir com o teste não paramétrico para amostra pareadas, discutido mais adiante.</p>
<section id="dados-usados-no-exemplo" class="level3" data-number="20.4.1">
<h3 data-number="20.4.1" class="anchored" data-anchor-id="dados-usados-no-exemplo"><span class="header-section-number">20.4.1</span> Dados usados no exemplo</h3>
<p>Os dados do exemplo são do arquivo <code>dadosCirurgia.xlsx</code>, já usado na Seção <a href="19-dadoscategoricos.html#sec-dadosCirurgia" class="quarto-xref"><span>Seção 19.2.5.1</span></a>. Ele contém 144 recém-nascidos que foram submetidos a diferentes procedimentos cirúrgicos. A questão de pesquisa a ser respondida é:</p>
<blockquote class="blockquote">
<p>Existe diferença no tempo de hospitalização (<code>tempohosp</code>) dos recém-nascidos de acordo com a presença ou não de infecção (<code>infec</code>)?</p>
</blockquote>
<p>Essa pergunta foi respondida de outra maneira, na Seção <a href="19-dadoscategoricos.html#sec-tabextensas" class="quarto-xref"><span>Seção 19.2.5</span></a>. Agora, será respondida pelo teste de Mann-Whitney.</p>
<section id="leitura-exploração-e-visualização-dos-dados" class="level4" data-number="20.4.1.1">
<h4 data-number="20.4.1.1" class="anchored" data-anchor-id="leitura-exploração-e-visualização-dos-dados"><span class="header-section-number">20.4.1.1</span> Leitura, exploração e visualização dos dados</h4>
<p>Os dados serão lidos com a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosCirurgia.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cirurgia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [144 × 7] (S3: tbl_df/tbl/data.frame)
 $ id       : num [1:144] 1 2 3 4 5 6 7 8 9 10 ...
 $ sexo     : chr [1:144] "masc" "masc" "masc" "masc" ...
 $ peso     : num [1:144] 2020 1850 2540 1150 2900 ...
 $ ig       : num [1:144] 36 30 38 31 36 37 38 39 38 39 ...
 $ tempohosp: num [1:144] 37 37 37 46 37 36 30 18 25 14 ...
 $ infec    : chr [1:144] "não" "não" "sim" "sim" ...
 $ cirurgia : chr [1:144] "abdominal" "abdominal" "abdominal" "outra" ...</code></pre>
</div>
</div>
<p>A variável <code>infec</code> aparece como caractere e será transformada como fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>infec <span class="ot">&lt;-</span> <span class="fu">factor</span>(cirurgia<span class="sc">$</span>infec, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os boxplots (<a href="#fig-bpapgar1" class="quarto-xref">Figura&nbsp;<span>20.1</span></a>), construídos com a função <code>ggboxplot()</code> do pacote <code>ggpubr</code> com as cores da paleta do <em>New England Journal of Medicine (NEJM)</em>, são uma boa maneira de visualizar os dados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>)   </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bpapgar1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bpapgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-bpapgar1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bpapgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.1: Impacto da infecção no pós-operatório no tempo de hopsitalização
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os boxplots exibem uma série de valores atípicos, indicando que existe uma assimetria em ambos os grupos. Essa assimetria também pode ser verificada usando o teste de Shapiro-Wilk, que mostrando valores <em>p</em> &lt; 0,05, confirma que os dados não seguem a distribuição normal. Este teste não é pré-requisito para o teste. Foi realizado como uma demonstração.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span>(tempohosp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  infec variable  statistic        p
  &lt;fct&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 sim   tempohosp     0.692 1.47e- 9
2 não   tempohosp     0.565 9.87e-15</code></pre>
</div>
</div>
</section>
<section id="sumarização-dos-dados" class="level4" data-number="20.4.1.2">
<h4 data-number="20.4.1.2" class="anchored" data-anchor-id="sumarização-dos-dados"><span class="header-section-number">20.4.1.2</span> Sumarização dos dados</h4>
<p>Como a variável <code>tempohosp</code> é assimétrica conforme mostrado acima, onde ambos os valores <em>p</em> são menores do que 0,05, será realizado um sumário numérico com a obtenção da mediana e IIQ. Isto será feito através da função <code>group_by()</code> e <code>summarise()</code>, incluídas no pacote <code>dplyr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempohosp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  infec     n mediana   p25   p75
  &lt;fct&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 sim      56      37  22.8    49
2 não      88      23  18      37</code></pre>
</div>
</div>
<p>Os dados mostram que a mediana de tempo de internação dos neonatos infectados é bem maior do que a mediana dos não infectados.</p>
</section>
</section>
<section id="hipóteses-estatísticas" class="level3" data-number="20.4.2">
<h3 data-number="20.4.2" class="anchored" data-anchor-id="hipóteses-estatísticas"><span class="header-section-number">20.4.2</span> Hipóteses estatísticas</h3>
<p>Da mesma maneira que o teste <em>t</em>, as hipóteses estabelecidas comparam dois grupos independentes. Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: As duas populações são iguais.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: As duas populações não são iguais.</p>
</blockquote>
<p>Não foi escrita a hipótese nula como sendo que as médias (ou as medianas) são iguais, pois o teste não usa as medidas de posição tradicionais e sim os postos.</p>
</section>
<section id="pressupostos-do-teste-de-mann_whitney" class="level3" data-number="20.4.3">
<h3 data-number="20.4.3" class="anchored" data-anchor-id="pressupostos-do-teste-de-mann_whitney"><span class="header-section-number">20.4.3</span> Pressupostos do teste de Mann_Whitney</h3>
<p>O teste de Mann-Whitney é baseado nos seguintes pressupostos:</p>
<ol type="1">
<li>Os dados são aleatórios;</li>
<li>As amostras são de dois grupos independentes;</li>
<li>Um dos grupos é denominado de 1 e o outro de 2;</li>
<li>A variável a ser comparada nos grupos deve ser ordenável;</li>
<li>O grupo 1 será o grupo de menor tamanho e, se tiverem o mesmo tamanho, o grupo 1 é aquele cuja soma dos postos é a menor.</li>
</ol>
</section>
<section id="cálculo-da-estatística-de-teste" class="level3" data-number="20.4.4">
<h3 data-number="20.4.4" class="anchored" data-anchor-id="cálculo-da-estatística-de-teste"><span class="header-section-number">20.4.4</span> Cálculo da estatística de teste</h3>
<section id="lógica-do-teste-u-de-mann-whitney" class="level4" data-number="20.4.4.1">
<h4 data-number="20.4.4.1" class="anchored" data-anchor-id="lógica-do-teste-u-de-mann-whitney"><span class="header-section-number">20.4.4.1</span> Lógica do teste U de Mann-Whitney</h4>
<p>De acordo com as hipóteses estabelecidas, o teste é bicaudal. Se as observações nos dois grupos forem provenientes da mesma população, a soma dos postos em cada grupo devem ficar próximas.</p>
<p>Para calcular o teste, procede-se da seguinte maneira:</p>
<ol type="1">
<li><p>Deve haver uma variável que identifique o grupo a que pertence cada uma das observações. No exemplo proposto, a variável desfecho é <code>tempohosp</code> e a variável agrupadora é <code>infec</code>, categorizada como <code>sim</code> e <code>não</code>.</p></li>
<li><p>Ordenar de forma crescente todos os valores da variável <code>tempohosp</code>, sem levar em consideração a que grupo pertence. Para realizar este procedimento, será usada a função <code>rank()</code> do R base com o método para empates igual à média dos valores empatados (<code>ties.method="average</code>). Ao executar a função, será criada uma nova variável, denotada <code>postos</code>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">ties.method =</span> <span class="st">"average"</span>) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cirurgia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     id sexo   peso    ig tempohosp infec cirurgia  postos
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt;      &lt;dbl&gt;
1     1 masc   2020    36        37 não   abdominal   94.5
2     2 masc   1850    30        37 não   abdominal   94.5
3     3 masc   2540    38        37 sim   abdominal   94.5
4     4 masc   1150    31        46 sim   outra      120  
5     5 masc   2900    36        37 não   abdominal   94.5
6     6 fem    2480    37        36 sim   abdominal   91  </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Verificar o tamanho (<em>n</em>) de cada grupo (presença ou não de infecção) e somar os postos em cada um dos grupos, usando a função <code>group_by()</code> junto com a função <code>summarise()</code>,</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(postos))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  infec     n  soma
  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
1 sim      56 4876.
2 não      88 5564.</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Denominar de <em>grupo_1</em> o grupo com menor soma:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>grupo_1 <span class="ot">&lt;-</span> <span class="fu">min</span>(resumo<span class="sc">$</span>soma)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>grupo_1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4875.5</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Denotar o <em>grupo_1</em> como T</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> grupo_1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Consequentemente,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">2</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 88</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Calcular a estística do teste, usando a fórmula preconizada por Altman <span class="citation" data-cites="altman1991mannwhitney">(<a href="referencias.html#ref-altman1991mannwhitney" role="doc-biblioref">Altman 1991</a>)</span>:</li>
</ol>
<p><span class="math display">\[
U =n_{1} \times n_{2} \ +\left [\frac{n_{1} \times \left (n_{1} + 1  \right )}{2}  \right ] - T
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>n2 <span class="sc">+</span> ((n1<span class="sc">*</span>(n1 <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">-</span> T</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1648.5</code></pre>
</div>
</div>
<p><strong>Obs</strong>.: O U de Mann-Whitney aparece no teste de Wilcoxon como W, eles representam o mesmo.</p>
<ol start="7" type="1">
<li>Se <span class="math inline">\(n_{1}\)</span>, <span class="math inline">\(n_{2}\)</span> <span class="math inline">\(\ge\)</span> 10, a distribuição da estatística do teste pode ser aproximada por uma distribuição normal com média igual a</li>
</ol>
<p><span class="math display">\[
\mu_{U} =\left [\frac{n_{S} \times \left (n_{L} + 1  \right )}{2}  \right ]
\]</span></p>
<p>onde <span class="math inline">\(n_{S}\)</span> e <span class="math inline">\(n_{L}\)</span>, são, respectivamente, o grupo de menor e maior tamanho. No exemplo, <span class="math inline">\(n_{1}\)</span> e <span class="math inline">\(n_{2}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>(n1<span class="sc">+</span>n2<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m_U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4060</code></pre>
</div>
</div>
<p>E desvio padrão igual a</p>
<p><span class="math display">\[
\sigma_{U}= \sqrt {\frac{n_{L}\times \sigma_{U}}{6}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dp_U <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n2<span class="sc">*</span>m_U)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dp_U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 244.0219</code></pre>
</div>
</div>
<p>Os resultados fornecem os dados para calcular a estatística <span class="math inline">\(Z_{U}\)</span> com correção de continuidade e, a partir dela, calcular o valor <em>P</em>.</p>
<p><span class="math display">\[
Z_{U}= \frac{(T -0,5) - \mu_{U}}{\sigma_{U}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Z_U <span class="ot">&lt;-</span> ((T <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">-</span> m_U)<span class="sc">/</span>dp_U</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Z_U, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.34</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Finalmente, calcula-se o valor <em>p</em>, usando a função <code>pnorm()</code>, multiplicada por 2, pois o teste é bicaudal.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>valor_p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(Z_U, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(valor_p, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8e-04</code></pre>
</div>
</div>
<p>Na prática, não há necessidade de fazer todos esses cálculos, pois o R calcula facilmente o teste. Os cálculos foram mostrados para melhorar o entendimento de como o teste de Mann-Whitney funciona.</p>
</section>
<section id="cálculo-do-u-de-mann-whitney-no-r" class="level4" data-number="20.4.4.2">
<h4 data-number="20.4.4.2" class="anchored" data-anchor-id="cálculo-do-u-de-mann-whitney-no-r"><span class="header-section-number">20.4.4.2</span> Cálculo do U de Mann-Whitney no R</h4>
<p>O teste pode ser realizado com a função <code>wilcox_test()</code> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> do pacote <code>rstatix</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(<span class="at">formula =</span> tempohosp <span class="sc">~</span> infec, <span class="at">data =</span> cirurgia)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>teste</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.       group1 group2    n1    n2 statistic       p
* &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 tempohosp sim    não       56    88     3280. 0.00083</code></pre>
</div>
</div>
<p>Assim como no cálculo manual, o teste com a função do <code>rstatix</code>, mostra uma diferença estatisticamente significativa (<em>p</em> &lt; 0,001) entre os tempos de hospitalização dos recém-nascidos que realizaram cirurgia no período neonatal que se infectaram ou não.</p>
</section>
</section>
<section id="sec-tefMW" class="level3" data-number="20.4.5">
<h3 data-number="20.4.5" class="anchored" data-anchor-id="sec-tefMW"><span class="header-section-number">20.4.5</span> Tamanho do efeito</h3>
<p>É interessante calcular o tamanho do efeito, a magnitude do efeito. O tamanho do efeito <em>r</em> é calculado como a estatística <span class="math inline">\(Z_{U}\)</span> dividida pela raiz quadrada do tamanho da amostra (<span class="math inline">\(n = n_{1} + n_{2}\)</span>).</p>
<p><span class="math display">\[
r = \frac {Z_{U}}{\sqrt{n}}
\]</span></p>
<p>O valor de <span class="math inline">\(Z_{U}\)</span> é igual a 3.3398648, logo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Z_U<span class="sc">/</span><span class="fu">sqrt</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.278</code></pre>
</div>
</div>
<p>O R possui a função <code>wilcox_effsize()</code> incluída no pacote <code>rstatix</code>. Necessita também do pacote <code>coin</code> <span class="citation" data-cites="hothorn2006lego">(<a href="referencias.html#ref-hothorn2006lego" role="doc-biblioref">Hothorn et al. 2006</a>)</span> instalado para calcular a estatística <em>r</em>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> A saída exibirá junto a magnitude o efeito, que no caso é pequena (veja <a href="#tbl-wilcoxef" class="quarto-xref">Tabela&nbsp;<span>20.2</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_effsize</span>(cirurgia, tempohosp<span class="sc">~</span>infec)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.       group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 tempohosp sim    não      0.279    56    88 small    </code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-wilcoxef" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wilcoxef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;20.2: Interpretação do valor r
</figcaption>
<div aria-describedby="tbl-wilcoxef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-7d8834a2{}.cl-7d7b37de{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7d7b37f2{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7d7b37f3{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7d80188a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7d80189e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7d804af8{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d804b02{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d804b0c{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d804b16{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7d8834a2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7d804af8"><p class="cl-7d80188a"><span class="cl-7d7b37de">r</span></p></th><th class="cl-7d804af8"><p class="cl-7d80188a"><span class="cl-7d7b37de">magnitude</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7d804b02"><p class="cl-7d80188a"><span class="cl-7d7b37f2">0,10 &lt; 0,30</span></p></td><td class="cl-7d804b02"><p class="cl-7d80188a"><span class="cl-7d7b37f2">pequeno</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7d804b02"><p class="cl-7d80188a"><span class="cl-7d7b37f2">0,30 &lt; 0,50</span></p></td><td class="cl-7d804b02"><p class="cl-7d80188a"><span class="cl-7d7b37f2">médio</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7d804b0c"><p class="cl-7d80188a"><span class="cl-7d7b37f2">&gt;= 0,50</span></p></td><td class="cl-7d804b0c"><p class="cl-7d80188a"><span class="cl-7d7b37f2">grande</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="2" class="cl-7d804b16"><p class="cl-7d80189e"><span class="cl-7d7b37f3">Sem considerar o sinal</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="conclusão" class="level3" data-number="20.4.6">
<h3 data-number="20.4.6" class="anchored" data-anchor-id="conclusão"><span class="header-section-number">20.4.6</span> Conclusão</h3>
<p>O valor <span class="math inline">\(p &lt; 0,0001\)</span> está bem abaixo do nível de significância estabelecido (<span class="math inline">\(\alpha = 0,05)\)</span>. Pode-se concluir que o tempo de hospitalização nos dois grupos é estatisticamente diferente. Entretanto, a magnitude dessa diferença é pequena.</p>
<p>Isto pode ser visualizado no gráfico (<a href="#fig-bpres" class="quarto-xref">Figura&nbsp;<span>20.2</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> rstatix<span class="sc">::</span><span class="fu">get_test_label</span>(teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bpres" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bpres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-bpres-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bpres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.2: Impacto da infecção no pós-operatório no tempo de hopsitalização
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="teste-de-wilcoxon" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="teste-de-wilcoxon"><span class="header-section-number">20.5</span> Teste de Wilcoxon</h2>
<p>O <em>teste de Wilcoxon</em>, também conhecido como teste dos postos com sinais de Wilcoxon (<em>Wilcoxon Signed-Rank Test</em>), é um teste não paramétrico utilizado em situações em que existem dois conjuntos de dados emparelhados, ou seja, dados provenientes do mesmo participante. O teste não examina os dois grupos individualmente; em vez disso, ele se concentra na diferença existente entre cada par de observações. É um equivalente não paramétrico do teste <em>t</em> pareado.</p>
<section id="dados-usados-como-exemplo" class="level3" data-number="20.5.1">
<h3 data-number="20.5.1" class="anchored" data-anchor-id="dados-usados-como-exemplo"><span class="header-section-number">20.5.1</span> Dados usados como exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para verificar se a realização de exercícios aeróbicos modifica a função respiratória de 10 escolares asmáticos, foi medido o Pico de Fluxo Expiratório Máximo (<em>Peak Flow Meter</em>) no início e no final do programa, após 120 dias. O Pico de Fluxo Expiratório Máximo (PFE), medido em L/min, serve como uma forma simples de avaliar a força e a velocidade de saída do ar de dentro dos pulmões.</p>
</div>
</div>
<p>Os dados têm apenas três variáveis, <code>id</code>(identificação), <code>basal</code> (PFE basal) e <code>final</code>(PFE final).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>basal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">200</span>, <span class="dv">140</span>, <span class="dv">200</span>, <span class="dv">110</span>, <span class="dv">240</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">250</span>, <span class="dv">190</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">300</span>, <span class="dv">230</span>, <span class="dv">180</span>, <span class="dv">300</span>, <span class="dv">330</span>, <span class="dv">230</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">200</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">tibble</span>(id, basal, final)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [10 × 3] (S3: tbl_df/tbl/data.frame)
 $ id   : int [1:10] 1 2 3 4 5 6 7 8 9 10
 $ basal: num [1:10] 120 200 140 200 110 240 150 120 250 190
 $ final: num [1:10] 220 300 230 180 300 330 230 250 300 200</code></pre>
</div>
</div>
<p>A questão de pesquisa a ser respondida, portanto, é:</p>
<blockquote class="blockquote">
<p>Existe diferença entre as medidas iniciais e finais do PFE dos escolares asmáticos que entraram em um programa de exercícios aeróbicos?</p>
</blockquote>
<section id="exploração-e-transformação-dos-dados" class="level4" data-number="20.5.1.1">
<h4 data-number="20.5.1.1" class="anchored" data-anchor-id="exploração-e-transformação-dos-dados"><span class="header-section-number">20.5.1.1</span> Exploração e transformação dos dados</h4>
<p>Os dados estão no formato amplo com as variáveis basal e final classificadas como númericas. Serão transformados para o formato longo, usando a função <code>pivot_longer()</code> do pacote <code>tidyr</code>. Este processo é opcional, mas, como foi feito com o teste <em>t</em> pareado, será repetido aqui, por questões didáticas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dadosL <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(basal, final), </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"momento"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"medidas"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20 × 3] (S3: tbl_df/tbl/data.frame)
 $ id     : int [1:20] 1 1 2 2 3 3 4 4 5 5 ...
 $ momento: chr [1:20] "basal" "final" "basal" "final" ...
 $ medidas: num [1:20] 120 220 200 300 140 230 200 180 110 300 ...</code></pre>
</div>
</div>
</section>
<section id="medidas-resumidoras" class="level4" data-number="20.5.1.2">
<h4 data-number="20.5.1.2" class="anchored" data-anchor-id="medidas-resumidoras"><span class="header-section-number">20.5.1.2</span> Medidas resumidoras</h4>
<p>Como o número de participantes é de apenas 10, a medida de posição mais adequada para resumir os dados é mediana e a medida de dispersão é o intervalo interquartil (IIQ). Para isso, se fará uso das funções <code>group_by()</code> e <code>summarise()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(momento) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">media =</span> <span class="fu">mean</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dp =</span> <span class="fu">sd</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ep =</span> dp<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">me =</span> ep <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
  momento     n mediana   p25   p75 media    dp    ep    me
  &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 basal      10     170  125    200   172  50.9  16.1  36.4
2 final      10     240  222.   300   254  50.4  15.9  36.0</code></pre>
</div>
</div>
</section>
<section id="visualização-dos-dados" class="level4" data-number="20.5.1.3">
<h4 data-number="20.5.1.3" class="anchored" data-anchor-id="visualização-dos-dados"><span class="header-section-number">20.5.1.3</span> Visualização dos dados</h4>
<p>Pode-se fazer visualização gráfica dos dados usando um boxplot (<a href="#fig-aero" class="quarto-xref">Figura&nbsp;<span>20.3</span></a>) ou um gráfico de linha (<a href="#fig-aero1" class="quarto-xref">Figura&nbsp;<span>20.4</span></a>).</p>
<section id="boxplot" class="level5" data-number="20.5.1.3.1">
<h5 data-number="20.5.1.3.1" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">20.5.1.3.1</span> Boxplot</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>)<span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-aero-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.3: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-linha" class="level5" data-number="20.5.1.3.2">
<h5 data-number="20.5.1.3.2" class="anchored" data-anchor-id="gráfico-de-linha"><span class="header-section-number">20.5.1.3.2</span> Gráfico de linha</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"cyan4"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.7</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="dv">2</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-aero1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.4: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="criação-de-uma-variável-que-represente-a-diferença-entre-os-momentos" class="level4" data-number="20.5.1.4">
<h4 data-number="20.5.1.4" class="anchored" data-anchor-id="criação-de-uma-variável-que-represente-a-diferença-entre-os-momentos"><span class="header-section-number">20.5.1.4</span> Criação de uma variável que represente a diferença entre os momentos</h4>
<p>A diferença entre as média basal e final será atribuída ao nome <code>D</code>. Esta ação será realizada, utilizando o banco de dados amplo (<code>dados</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D <span class="ot">&lt;-</span> dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
     id basal final     D
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1   120   220  -100
2     2   200   300  -100
3     3   140   230   -90
4     4   200   180    20
5     5   110   300  -190
6     6   240   330   -90</code></pre>
</div>
</div>
<p><u>Resumo da variável D</u></p>
<p>Ao resumo será atribuído ao nome <code>resumo2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>resumo2 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span> (),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (D, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>resumo2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
      n mediana   p25   p75
  &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    10     -90  -100 -57.5</code></pre>
</div>
</div>
<p>O sinal negativo demonstra que houve um aumento do PFE do momento basal para o final.</p>
</section>
</section>
<section id="definição-das-hipóteses-estatísticas" class="level3" data-number="20.5.2">
<h3 data-number="20.5.2" class="anchored" data-anchor-id="definição-das-hipóteses-estatísticas"><span class="header-section-number">20.5.2</span> Definição das hipóteses estatísticas</h3>
<p>Da mesma maneira que o teste <em>t</em> pareado, as hipóteses estabelecidas comparam dois grupos dependentes. O teste de Wilcoxon é usado para avaliar a hipótese nula de que a distribuição das diferenças entre os grupos tem uma diferença mediana igual a 0.</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}: D_{i} = 0\)</span></p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{A}: D_{i} \ne 0\)</span></p>
</blockquote>
<p>Note que a <span class="math inline">\(H_{A}\)</span> estabelece que a diferença pode aumentar ou diminuir. Logo, o teste é bicaudal.</p>
</section>
<section id="execução-do-teste-estatístico" class="level3" data-number="20.5.3">
<h3 data-number="20.5.3" class="anchored" data-anchor-id="execução-do-teste-estatístico"><span class="header-section-number">20.5.3</span> Execução do teste estatístico</h3>
<section id="lógica-do-teste-de-wilcoxon" class="level4" data-number="20.5.3.1">
<h4 data-number="20.5.3.1" class="anchored" data-anchor-id="lógica-do-teste-de-wilcoxon"><span class="header-section-number">20.5.3.1</span> Lógica do teste de Wilcoxon</h4>
<ol type="1">
<li>A ideia do teste é verificar se as diferenças positivas são maiores ou menores, em grandeza absoluta, que as diferenças negativas. Para isso, foi criada, anteriormente, a variável <code>D</code>. Agora, será criada outra variável, iguala a variável <code>D</code>, apenas ignorando o sinal, denominada <code>D_abs</code>, diferença absoluta entre as variáveis <code>final</code> e <code>basal</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D_abs <span class="ot">&lt;-</span> <span class="fu">abs</span>(dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Excluir os casos com diferença igual a 0 (zero). Para isso, uma maneira possível é extrair um subconjunto de dados do conjunto principal (<code>dados</code>), criando um conjunto de dados com a função <code>filter()</code> do pacote <code>dplyr</code>, que receberá o nome de <code>dados1</code>. O argumento <code>D_absbs != 0</code> significa todas as diferenças absolutas diferentes de 0:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D_abs <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observe que como não há diferenças zeradas. Ou seja, o novo conjunto de dados continua o mesmo. O que pode ser confirmado, executando a função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [10 × 5] (S3: tbl_df/tbl/data.frame)
 $ id   : int [1:10] 1 2 3 4 5 6 7 8 9 10
 $ basal: num [1:10] 120 200 140 200 110 240 150 120 250 190
 $ final: num [1:10] 220 300 230 180 300 330 230 250 300 200
 $ D    : num [1:10] -100 -100 -90 20 -190 -90 -80 -130 -50 -10
 $ D_abs: num [1:10] 100 100 90 20 190 90 80 130 50 10</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Ordenar de forma crescente todos os valores da variável <code>D_abs</code> do banco de dados <code>dados1</code>, usando a função <code>arrange()</code> do pacote <code>dplyr</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dados1<span class="sc">$</span>D_abs)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Estabelecer postos para os valores ordenados da variável <code>D_abs</code>, do conjunto de dados <code>dados1</code>, fazendo a média das ordens quando houver empate. A execução deste comando cria uma nova variável, chamada <code>postos</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dados1<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados1<span class="sc">$</span>D_abs)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Estabelecer sinais para os postos, criando dois subconjuntos de dados do conjuntos dados1, um com os escolares com postos positivos (<code>pos</code>) e outros com postos negativos(<code>neg</code>):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>neg <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Somar todos os postos (variável <code>posto</code>) em cada um dos subconjuntos criados (<code>neg</code> e <code>pos</code>):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>soma_neg <span class="ot">&lt;-</span> <span class="fu">sum</span>(neg<span class="sc">$</span>postos)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>soma_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(pos<span class="sc">$</span>postos)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (<span class="fu">c</span>(soma_neg, soma_pos))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53  2</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Atribuir a menor soma à estatística do teste, denotada <em>T</em>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">min</span> (soma_neg <span class="sc">:</span> soma_pos)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Para dados com tamanhos grandes (&gt; 20 pares), a significância de <em>T</em> pode ser determinada <span class="citation" data-cites="zar2014wilcoxon">(<a href="referencias.html#ref-zar2014wilcoxon" role="doc-biblioref">Zar 2014b</a>)</span>, considerando que a distribuição de <em>T</em> tem aproximadamente distribuição normal com média igual a</li>
</ol>
<p><span class="math display">\[
\mu_{T} =\frac{n \times \left (n + 1  \right )}{4}
\]</span></p>
<p>onde <em>n</em> é o tamanho da amostra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(dados<span class="sc">$</span>D)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mu_T <span class="ot">&lt;-</span> (n <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mu_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27.5</code></pre>
</div>
</div>
<p>E desvio padrão igual a:</p>
<p><span class="math display">\[
\sigma_{T}= \sqrt {\frac{n\left (n + 1  \right )\times \left (2n + 1  \right )}{24}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dp_T <span class="ot">&lt;-</span> <span class="fu">sqrt</span> ((n<span class="sc">*</span>(n <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span><span class="dv">24</span>) </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>dp_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.810708</code></pre>
</div>
</div>
<p>Os resultados da execução das equações fornecem os dados para calcular a estatística <code>Z_T</code> com correção de continuidade e, a partir dela, calcular o valor <em>p</em>.</p>
<p><span class="math display">\[
Z_{T}= \frac{\left |T - \mu_{T}  \right | - 0,5}{\sigma_{T}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>Z_T <span class="ot">&lt;-</span> (<span class="fu">abs</span>(T <span class="sc">-</span> mu_T)<span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span>dp_T</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Z_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.548236</code></pre>
</div>
</div>
<ol start="9" type="1">
<li><p>Concluindo, o valor da estatística de teste <em>T</em> é superior ao <span class="math inline">\(Z_{crítico} = 1,96\)</span>, para um <span class="math inline">\(\alpha = 0,05\)</span>. Dessa forma, a <span class="math inline">\(H_{0}\)</span> é rejeitada. Existe uma diferença significativa entre o PFE basal e o PFE final, neste grupo de escolares asmáticos.</p></li>
<li><p>O valor <em>p</em> pode ser obtido com a função <code>pnorm()</code> e multiplicando o resultado por 2, pois o teste é bilateral.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>valor_p <span class="ot">&lt;-</span> <span class="fu">pnorm</span> (Z_T, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>valor_p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01082692</code></pre>
</div>
</div>
<p>Como já dito anteriormente, na prática, não há necessidade de fazer todos esses cálculos, pois o R calcula facilmente o teste. Eles são apenas uma demonstração de como o teste funciona.</p>
</section>
<section id="cálculo-do-teste-de-wilcoxon-no-r" class="level4" data-number="20.5.3.2">
<h4 data-number="20.5.3.2" class="anchored" data-anchor-id="cálculo-do-teste-de-wilcoxon-no-r"><span class="header-section-number">20.5.3.2</span> Cálculo do teste de Wilcoxon no R</h4>
<p>Usando o conjunto de dados no formato longo (<code>dadosL</code>), calcula-se o teste com a função <code>wilcox_test()</code> do pacote <code>rstatix</code>. É a mesma função utilizada para o teste de U de Mann-Whitney, mudando apenas o argumento <code>paired=FALSE</code> para <code>paired=TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>teste1 <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span>()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>teste1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.     group1 group2    n1    n2 statistic      p p.signif
  &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   
1 medidas basal  final     10    10         2 0.0107 *       </code></pre>
</div>
</div>
<p>Observe que o resultado é o mesmo calculado manualmente.</p>
</section>
</section>
<section id="tamanho-do-efeito" class="level3" data-number="20.5.4">
<h3 data-number="20.5.4" class="anchored" data-anchor-id="tamanho-do-efeito"><span class="header-section-number">20.5.4</span> Tamanho do efeito</h3>
<p>O tamanho do efeito pode ser calculado da mesma forma que para o teste de Mann-Whitney (<a href="#sec-tefMW" class="quarto-xref"><span>Seção 20.4.5</span></a>), usando a mesma equação e os dados obtidos acima, onde 2.548236 e <em>n</em> = 10 tem-se</p>
<p><span class="math display">\[
r = \frac {Z_{T}}{\sqrt{n}}
\]</span></p>
<p>Pode-se usar também a função <code>wilcox_effsize()</code> para calcular a estatística <em>r</em>. A Saída exibe junto a magnitude o efeito, que no caso é grande (&gt; 0,5 como mostra a <a href="#tbl-wilcoxef" class="quarto-xref">Tabela&nbsp;<span>20.2</span></a> do teste de Mann-Whitney).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.     group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 medidas basal  final    0.823    10    10 large    </code></pre>
</div>
</div>
</section>
<section id="conclusão-1" class="level3" data-number="20.5.5">
<h3 data-number="20.5.5" class="anchored" data-anchor-id="conclusão-1"><span class="header-section-number">20.5.5</span> Conclusão</h3>
<p>Assumindo um <span class="math inline">\(\alpha = 0,05\)</span>, se o valor <em>p</em>, obtido pelo teste, for menor do que 0,05, rejeita-se a hipótese nula (V = 2, <em>p</em> = 0,01, <em>n</em> = 10).</p>
<p>Pode-se concluir que existe diferença nas medidas do pico de fluxo expiratório máximo no início e no fim do programa de exercícios aeróbicos realizados pelos escolares asmáticos e a magnitude do efeito foi grande (<em>r</em> = 0,82).</p>
<p>Isto pode ser visualizado na <a href="#fig-aero2" class="quarto-xref">Figura&nbsp;<span>20.5</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span> (medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span> ()</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> teste <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span> ()</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>bxp <span class="sc">+</span> </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span> (teste, </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">subtitle =</span> <span class="fu">get_test_label</span> (<span class="at">stat.test =</span> teste, </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-aero2-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.5: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-kruskalwallis" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="sec-kruskalwallis"><span class="header-section-number">20.6</span> Teste de Kruskal-Wallis</h2>
<p>Quando os pressupostos subjacentes à ANOVA não são atendidos, é possível usar o teste não paramétrico de Kruskal-Wallis (KW) para testar a hipótese de que os parâmetros de localização são iguais. Pode ser considerado uma extensão do teste de Wilcoxon-Mann-Whitney.</p>
<p>Enquanto a ANOVA depende da hipótese de que todas as populações são independentes e com resíduos normalmente distribuídos, o teste de Kruskal-Wallis exige apenas amostras aleatórias independentes provenientes de suas respectivas populações. Entretanto, este teste somente deve ser aplicado se a amostra for pequena e/ou os pressupostos para a ANOVA forem seriamente violados.</p>
<p>O teste não usa diretamente medições de quantidade conhecida, utiliza, como outros testes não paramétricos, os postos dos valores analisados. Em função disso, é também conhecido como <em>análise de variância de um fator em postos</em>.</p>
<section id="dados-usados-no-exemplo-1" class="level3" data-number="20.6.1">
<h3 data-number="20.6.1" class="anchored" data-anchor-id="dados-usados-no-exemplo-1"><span class="header-section-number">20.6.1</span> Dados usados no exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um experimento foi realizado para verificar se o álcool ou o café afetam os tempos de reação ao dirigir <span class="citation" data-cites="karadimitriou2020kruskal">(<a href="referencias.html#ref-karadimitriou2020kruskal" role="doc-biblioref">Karadimitriou e Marshall 2020</a>)</span>. O estudo tem três grupos diferentes de participantes: 10 bebendo água (controle), 10 bebendo cerveja contendo duas unidades de álcool<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> e 10 bebendo café. O tempo de reação em uma simulação de direção foi medido para cada participante.</p>
</div>
</div>
<p>Os dados encontram-se no arquivo <code>dadosResposta.xlsx</code>. Clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosResposta.xlsx"><strong>aqui</strong></a> para baixar e, após, salve o mesmo no seu diretório de trabalho.</p>
<p>As variáveis são:</p>
<ul>
<li><strong>id</strong> <span class="math inline">\(\to\)</span> identificação do participante;</li>
<li><strong>tempo</strong> <span class="math inline">\(\to\)</span> tempo de reação na simulação de direção em segundos;</li>
<li><strong>bebida</strong> <span class="math inline">\(\to\)</span> três grupo: água, álcool e café.</li>
</ul>
<p>O estudo pretende verificar se existe diferença no tempo de reação dos participantes em um teste de direção com a ingesta de água, café e álcool.</p>
<section id="leitura-e-exploração-dos-dados" class="level4" data-number="20.6.1.1">
<h4 data-number="20.6.1.1" class="anchored" data-anchor-id="leitura-e-exploração-dos-dados"><span class="header-section-number">20.6.1.1</span> Leitura e exploração dos dados</h4>
<p>Como o dados estão contidos em um arquivo Excel (<em>.xlsx</em>), serão lidos com a função <code>read_excel()</code> do pacote <code>readxl</code> e a sua estrutura será observada com função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosResposta.xlsx"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [30 × 3] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:30] 1 2 3 4 5 6 7 8 9 10 ...
 $ tempo : num [1:30] 0.37 0.38 0.61 0.78 0.83 0.86 0.9 0.95 1.63 1.97 ...
 $ bebida: chr [1:30] "agua" "agua" "agua" "agua" ...</code></pre>
</div>
</div>
<p>O formato do arquivo é o longo. A variável bebida encontra-se como caracter e deve ser transformada em fator e as categorias na sequência: <code>agua</code>, <code>cafe</code> e <code>alcool</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>bebida <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>bebida, </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"agua"</span>, <span class="st">"cafe"</span>, <span class="st">"alcool"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os dados serão observados visualmente através de boxplots (<a href="#fig-bebida" class="quarto-xref">Figura&nbsp;<span>20.6</span></a>), usando a função <code>ggplot()</code> do pacote <code>ggplot2</code>, com cores do <code>nejm</code> (<em>New England Journal of Medicine</em>) o pacote <code>ggsci</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> T,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tipo de bebida"</span> ,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de reação (seg)"</span>) <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bebida" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bebida-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-bebida-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bebida-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.6: Impacto do tipo de bebida no tempo de reação ao dirigir
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os boxplots exibem dados com medianas visualmente diferentes, bigodes diferentes e grupos com presença de <em>outliers</em>. Para verificar o impacto desses achados, pode-se usar a função <code>identify_outliers()</code>, do pacote <code>rstatix</code> que confirma, na sua Saída, a presença de <em>outliers</em> no grupo <code>agua</code> e <code>cafe</code>, sendo dois extremos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(tempo)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  bebida    id tempo is.outlier is.extreme
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
1 agua       9  1.63 TRUE       FALSE     
2 agua      10  1.97 TRUE       TRUE      
3 cafe      19  2.56 TRUE       FALSE     
4 cafe      20  3.07 TRUE       TRUE      </code></pre>
</div>
</div>
<p>Para avaliar a normalidade será usado o teste de Shapiro-Wilk, com a função <code>shapiro_test()</code> e a função <code>group_by()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span> (bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span> (tempo) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  bebida variable statistic      p
  &lt;fct&gt;  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 agua   tempo        0.863 0.0837
2 cafe   tempo        0.815 0.0220
3 alcool tempo        0.875 0.114 </code></pre>
</div>
</div>
<p>A variável <code>cafe</code> tem uma distribuição que não se ajusta a distribuição normal.</p>
<p>Para completar a exploração dos dados, será solicitado, usando as funções <code>group_by ()</code> e <code>summarise</code>, do pacote <code>dplyr</code>, medidas de localização e dispersão adquadas para variáveis bem assimétricas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  bebida     n mediana   p25   p75
  &lt;fct&gt;  &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 agua      10   0.845 0.653 0.937
2 cafe      10   1.44  1.28  1.68 
3 alcool    10   2.25  1.77  2.85 </code></pre>
</div>
</div>
</section>
</section>
<section id="hipóteses-estatísticas-1" class="level3" data-number="20.6.2">
<h3 data-number="20.6.2" class="anchored" data-anchor-id="hipóteses-estatísticas-1"><span class="header-section-number">20.6.2</span> Hipóteses estatísticas</h3>
<p>Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: As populações são iguais.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: Pelo menos uma das populações tende a exibir valores diferentes do que as outras populações.</p>
</blockquote>
</section>
<section id="pressupostos-do-teste" class="level3" data-number="20.6.3">
<h3 data-number="20.6.3" class="anchored" data-anchor-id="pressupostos-do-teste"><span class="header-section-number">20.6.3</span> Pressupostos do teste</h3>
<p>O teste de Kruskal-Wallis pressupõe as seguintes condições para o seu adequado uso:</p>
<ol type="1">
<li>As amostras são amostras aleatórias independentes de suas respectivas populações;</li>
<li>A escala de medição utilizada é pelo menos ordinal e, se houver apenas três grupos, deve haver pelo menos 5 casos em cada grupo;</li>
<li>As distribuições dos valores nas populações amostradas são idênticas, exceto pela possibilidade de que uma ou mais das populações sejam compostas por valores que tendem a ser maiores do que os das outras populações.</li>
</ol>
</section>
<section id="execução-do-teste-estatístico-1" class="level3" data-number="20.6.4">
<h3 data-number="20.6.4" class="anchored" data-anchor-id="execução-do-teste-estatístico-1"><span class="header-section-number">20.6.4</span> Execução do teste estatístico</h3>
<section id="lógica-do-teste-de-kruskall-wallis" class="level4" data-number="20.6.4.1">
<h4 data-number="20.6.4.1" class="anchored" data-anchor-id="lógica-do-teste-de-kruskall-wallis"><span class="header-section-number">20.6.4.1</span> Lógica do teste de Kruskall-Wallis</h4>
<p>A teoria do teste Kruskal-Wallis é semelhante à do teste de Mann-Whitney, ou seja, tem como base a soma dos postos. Em primeiro lugar, os escores são ordenados do menor para o maior, independentemente do grupo que pertençam.</p>
<p>O menor recebe o posto 1 e assim por diante. Após a atribuição dos postos, soma-se os postos por grupo. A soma dos postos de cada grupo é representada por <span class="math inline">\(R_{1}\)</span>, <span class="math inline">\(R_{2}\)</span>, <span class="math inline">\(R_{3}\)</span>, …, <span class="math inline">\(R_{i}\)</span>. A estatística do teste, <em>H</em>, é calculada com a equação <span class="citation" data-cites="zar2014kruskal">(<a href="referencias.html#ref-zar2014kruskal" role="doc-biblioref">Zar 2014a</a>)</span>:</p>
<p><span class="math display">\[
H =\frac {12}{N \times \left (N + 1  \right )} \sum_{i=1}^{k} \frac {R_{i}^{2}}{n_{{i}}}-3 \times\left (N + 1\right)
\]</span></p>
<p>onde <span class="math inline">\(n_{i}\)</span> é o número de observações no grupo <em>i</em>, <span class="math inline">\(N = \sum_{i=1}^{k}\times n_{i}\)</span> (o número total de observações em todos os <em>k</em> grupos) e <span class="math inline">\(R_{i}\)</span> é a soma dos postos das <span class="math inline">\(n_{i}\)</span> observações no grupo <em>i</em>.</p>
<p>Uma boa verificação (mas não uma garantia) de que os postos foram atribuídos corretamente é ver se a soma de todos os postos é igual a <span class="math inline">\(\frac {N \times \left (N + 1\right )}{2}\)</span>.</p>
<ol type="1">
<li>Criar a variável <code>posto</code> com os postos ordenados de forma crescente, independente do grupo, como realizado no teste de Mann-Whitney:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>posto <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados<span class="sc">$</span>tempo, <span class="at">ties.method =</span> <span class="st">"average"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [30 × 4] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:30] 1 2 3 4 5 6 7 8 9 10 ...
 $ tempo : num [1:30] 0.37 0.38 0.61 0.78 0.83 0.86 0.9 0.95 1.63 1.97 ...
 $ bebida: Factor w/ 3 levels "agua","cafe",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ posto : num [1:30] 1 2 3 4 5 6 7 8 16 22.5 ...</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Somar os postos de cada grupo separadamente:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>resumo1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(posto))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>resumo1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  bebida     n  soma
  &lt;fct&gt;  &lt;int&gt; &lt;dbl&gt;
1 agua      10  74.5
2 cafe      10 157  
3 alcool    10 234. </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Cálculo da estatística do teste <em>H</em></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>R_agua <span class="ot">&lt;-</span> resumo1[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>R_alcool <span class="ot">&lt;-</span> resumo1[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>R_cafe <span class="ot">&lt;-</span> resumo1[<span class="dv">3</span>,<span class="dv">3</span>]</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> (<span class="dv">12</span><span class="sc">/</span>(N<span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">*</span> ((R_agua<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_alcool<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_cafe<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n)) <span class="sc">-</span> (<span class="dv">3</span><span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>H</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      soma
1 16.31806</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Cálculo do Valor <em>p</em></li>
</ol>
<p>Se existir três grupos, com cinco ou menos participantes em cada grupo, há necessidade de usar a tabela especial para tamanhos de amostra pequenos <span class="citation" data-cites="gopal2006table">(<a href="referencias.html#ref-gopal2006table" role="doc-biblioref">Kanji 2006</a>)</span>. Se você tiver mais de cinco participantes por grupo, trate <em>H</em> como qui-quadrado. A estatística <em>H</em> é estatisticamente significativo se for igual ou maior que o valor crítico qui-quadrado para o grau de liberdade específico, igual a <span class="math inline">\(k - 1\)</span>. Aqui, tem-se 10 participantes por grupo e, assumindo um <span class="math inline">\(\alpha = 0,05\)</span>, o <span class="math inline">\(H_{crítico}\)</span> é igual a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>H_critico <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, gl)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>H_critico</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.991465</code></pre>
</div>
</div>
<p>Uma vez que o <span class="math inline">\(H_{calculado} = 16,3\)</span> é maior que <span class="math inline">\(H_{crítico} = 6,0\)</span> , rejeita-se a <span class="math inline">\(H_{0}\)</span>. O valor <em>P</em> é obtido através da função <code>pchisq()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fl">16.32</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(H, <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002858624</code></pre>
</div>
</div>
<p>O R tem funções que fazem facilmente esses cálculos enfadonhos. Eles são colocados aqui apenas para ilustrar o raciocínio de como o teste de Kruskal-Wallis funciona. Sempre existem curiosos lendo o livro!</p>
</section>
<section id="teste-de-kruskal-wallis-no-r" class="level4" data-number="20.6.4.2">
<h4 data-number="20.6.4.2" class="anchored" data-anchor-id="teste-de-kruskal-wallis-no-r"><span class="header-section-number">20.6.4.2</span> Teste de Kruskal-Wallis no R</h4>
<p>No R, pode-se calcular o teste, usando a função <code>kruskal_test()</code> do pacote <code>rstatix</code>, cujos argumentos podem ser consultados na ajuda do <em>RStudio</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">kruskal_test</span> (<span class="at">data =</span> dados, <span class="at">formula =</span> tempo <span class="sc">~</span> bebida)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>teste</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.       n statistic    df        p method        
* &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;         
1 tempo    30      16.3     2 0.000286 Kruskal-Wallis</code></pre>
</div>
</div>
</section>
</section>
<section id="tamanho-do-efeito-1" class="level3" data-number="20.6.5">
<h3 data-number="20.6.5" class="anchored" data-anchor-id="tamanho-do-efeito-1"><span class="header-section-number">20.6.5</span> Tamanho do efeito</h3>
<p>O eta quadrado (<span class="math inline">\(\eta^{2}\)</span>), com base na estatística <em>H</em>, pode ser usado como a medida do tamanho do efeito do teste de Kruskal-Wallis. É calculado pela equação:</p>
<p><span class="math display">\[
\eta_{H}^{2} = \frac {\left (H - k + 1 \right)}{\left (N - k\right)}
\]</span></p>
<p>onde <em>H</em> é a estatística obtida no teste de Kruskal-Wallis; <em>k</em> é o número de grupos; N é o número total de observações <span class="citation" data-cites="tomczak2014need">(<a href="referencias.html#ref-tomczak2014need" role="doc-biblioref">Tomczak e Tomczak 2014</a>)</span>.</p>
<p>A estimativa eta ao quadrado assume valores de 0 a 1 e, multiplicada por 100, indica a porcentagem de variância na variável dependente explicada pela variável independente. Pode ser obtido no R com a função <code>kruskal_effsize()</code> do pacote <code>rstatix:</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> <span class="fu">kruskal_effsize</span> (tempo<span class="sc">~</span>bebida)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  .y.       n effsize method  magnitude
* &lt;chr&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;ord&gt;    
1 tempo    30   0.530 eta2[H] large    </code></pre>
</div>
</div>
<p>Um efeito <span class="math inline">\(\ge 0,14\)</span> é considerado grande e <span class="math inline">\(&lt;0,06\)</span> é pequeno <span class="citation" data-cites="watson2021effectsize">(<a href="referencias.html#ref-watson2021effectsize" role="doc-biblioref">Watson 2021</a>)</span>.</p>
</section>
<section id="testes-post-hoc" class="level3" data-number="20.6.6">
<h3 data-number="20.6.6" class="anchored" data-anchor-id="testes-post-hoc"><span class="header-section-number">20.6.6</span> Testes post hoc</h3>
<p>A partir do resultado do teste de Kruskal-Wallis, sabe-se que há uma diferença significativa entre os grupos, mas não se sabe quais pares de grupos são diferentes.</p>
<p>Um teste de Kruskal-Wallis significativo é geralmente seguido pelo teste de Dunn <span class="citation" data-cites="dunn1964multiple">(<a href="referencias.html#ref-dunn1964multiple" role="doc-biblioref">Dunn 1964</a>)</span> para identificar quais grupos são diferentes.</p>
<p>Para realizar as múltiplas comparações, no R, pode ser usada a função <code>dunn_test()</code>, incluído no pacote <code>rstatix</code>. O ajuste de <em>P</em> é feito pelo método de Bonferroni:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunn_test</span> (tempo <span class="sc">~</span> bebida, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
  .y.   group1 group2    n1    n2 statistic         p    p.adj p.adj.signif
* &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
1 tempo agua   cafe      10    10      2.10 0.0361    0.108    ns          
2 tempo agua   alcool    10    10      4.04 0.0000537 0.000161 ***         
3 tempo cafe   alcool    10    10      1.94 0.0520    0.156    ns          </code></pre>
</div>
</div>
<p>A saída do teste de Dunn, mostra que existe uma diferença estatisticamente significativa apenas entre a água e o álcool, valor <em>p</em> ajustado igual a 1.61^{-4}.</p>
</section>
<section id="conclusão-2" class="level3" data-number="20.6.7">
<h3 data-number="20.6.7" class="anchored" data-anchor-id="conclusão-2"><span class="header-section-number">20.6.7</span> Conclusão</h3>
<p>Um teste de Kruskal-Wallis foi realizado para comparar os tempos de reação em uma simulação de direção após beber água, café ou álcool. Houve evidência de uma diferença (<em>p</em> = 0,00029) de pelo menos um par de grupos (<a href="#fig-bebida1" class="quarto-xref">Figura&nbsp;<span>20.7</span></a>).</p>
<p>O teste de comparações de pares, usando o teste de Dunn, foi realizado para os três pares de grupos. Houve evidencia de diferença entre o grupo que consumiu duas unidades de álcool e o grupo que ingeriu água (<em>p</em> ajustado (Bonferroni) = 0,00016). Entre os demais pares não houve diferença significativa. O tempo mediano de reação para o grupo que recebeu água foi de 0,84 (0,65 – 0,94) segundos, em comparação com 2,25(1,77 – 2,85) segundos no grupo que bebeu cerveja equivalente a duas unidades de álcool, enquanto para o café foi de 1,45(1,28 – 1,69) segundos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> pwc <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span>(<span class="at">x=</span> <span class="st">"bebida"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())<span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span> (pwc,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label =</span> <span class="st">"p = {scales::pvalue(p.adj)}"</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label.size =</span> <span class="fl">3.2</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hide.ns =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tipo de bebida"</span>, </span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Tempo de reação (seg)"</span>,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bebida1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bebida1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="20-testes-naoParametricos_files/figure-html/fig-bebida1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bebida1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.7: Impacto do tipo de bebida no tempo de reação ao dirigir
</figcaption>
</figure>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-altman1991mannwhitney" class="csl-entry" role="listitem">
Altman, Douglas G. 1991. <span>«Comparing groups: continuos data»</span>. Em <em>Practical Statistics for Medical Research</em>, 194–97. London: Chapman &amp; Hall/CRC.
</div>
<div id="ref-dunn1964multiple" class="csl-entry" role="listitem">
Dunn, Olive Jean. 1964. <span>«Multiple comparisons using rank sums»</span>. <em>Technometrics</em> 6 (3). Taylor &amp; Francis: 241–52.
</div>
<div id="ref-hothorn2006lego" class="csl-entry" role="listitem">
Hothorn, Torsten, Kurt Hornik, Mark A Van De Wiel, e Achim Zeileis. 2006. <span>«A lego system for conditional inference»</span>. <em>The American Statistician</em> 60 (3). Taylor &amp; Francis: 257–63.
</div>
<div id="ref-gopal2006table" class="csl-entry" role="listitem">
Kanji, Gopal K. 2006. <span>«The Kruskal–Wallis test»</span>. Em <em>100 Statiscal Tests</em>, 3rd Edition, 220. London: Sage publications.
</div>
<div id="ref-karadimitriou2020kruskal" class="csl-entry" role="listitem">
Karadimitriou, Sofia Maria, e Ellen Marshall. 2020. <span>«Kruskal-Wallis in R»</span>. <em>Statistics Support for Students</em>. Loughborough; Coventry Universities. <a href="https://www.statstutor.ac.uk/">https://www.statstutor.ac.uk/</a>.
</div>
<div id="ref-tomczak2014need" class="csl-entry" role="listitem">
Tomczak, Maciej, e Ewa Tomczak. 2014. <span>«The need to report effect size estimates revisited. An overview of some recommended measures of effect size»</span>. <em>Trends in sport sciences</em> 1 (21): 19–25.
</div>
<div id="ref-watson2021effectsize" class="csl-entry" role="listitem">
Watson, Peter. 2021. <span>«Rules of thumb on magnitudes of effect sizes»</span>. <em>MRC Cognition and Brain Sciences Unit</em>. Cambridge University. <a href="https://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize">https://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize</a>.
</div>
<div id="ref-zar2014kruskal" class="csl-entry" role="listitem">
Zar, Jerrold H. 2014a. <span>«Nonparametric Analysis of Variance»</span>. Em <em>Biostatistical Analysis</em>, 226–30. Edinburgh: Pearson.
</div>
<div id="ref-zar2014wilcoxon" class="csl-entry" role="listitem">
———. 2014b. <span>«Paired-Sample Hypotheses»</span>. Em <em>Biostatistical Analysis</em>, 189–98. Edinburgh: Pearson.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>O cálculo pode também ser realizado, usando a função <code>wilcox.test()</code> do pacote <code>stats</code>, incluído no R base.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Para maiores detalhes consulte a ajuda da função.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Para calcular as unidades de álcool, multiplique o volume da bebida (em mililitros) pelo teor alcoólico (ABV, do inglês <em>Alcohol by Volume</em>) e divida o resultado por 1000.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./19-dadoscategoricos.html" class="pagination-link" aria-label="Análise de Dados Categóricos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./21-testesDiag.html" class="pagination-link" aria-label="Determinação da validade e confiabilidade de testes diagnósticos">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb101" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Métodos não paramétricos</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pacotes necessários neste capítulo</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span> (coin,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>                confintr,</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>                flextable,</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>                ggpubr,</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>                ggsci,</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>                kableExtra,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>                knitr,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>                readxl,</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>                rstatix,</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>                tidyverse)</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuição livre {#sec-distlivre}</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>A maioria dos testes estatísticos, discutidos neste livro, são testes paramétricos. Nestes, o interesse estava focado em estimar ou testar uma hipótese sobre um ou mais parâmetros populacionais e ,por isso, são denominados de paramétricos. Além disso, o aspecto central desses procedimentos era o conhecimento da forma funcional da população da qual foram retiradas as amostras que forneceram a base para a inferência. Por exemplo, o teste *t* de Student para amostras independentes e a ANOVA são baseados no pressuposto de que os dados foram amostrados de populações que têm distribuição normal.</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>Os **testes não paramétricos** não fazem suposições em relação à distribuição da população. Não têm, portanto, os pressupostos restritivos, comuns nos testes paramétricos. Têm *distribuição livre*. São baseados em uma ideia simples de ordenação por postos, do valor mais baixo ao mais alto. Analisam somente os postos, ignorando os valores. Podem ser usados tanto com variáveis ordinais como quantitativas numéricas.</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Postos {#sec-postos}</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>Os métodos estatísticos não paramétricos não lidam diretamente com os valores observados. Em função disso, para poder usar a informação fornecida pelas observações, sem trabalhar diretamente com os valores observados, utiliza-se os postos das observações. Posto (*rank*) de uma observação é a sua posição em relação aos demais valores.</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>A atribuição dos postos de uma variável é realizada da seguinte maneira:</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Colocam-se as observações em ordem crescente;</span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Associam-se valores, correspondendo às suas posições relativas na amostra. O primeiro elemento recebe o valor 1, o segundo o valor 2 e, assim por diante, até que a maior observação receba o valor *n*;</span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Se todas as observações são distintas, os postos são iguais aos valores associados às observações no passo anterior.</span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Para observações iguais (empates), associam-se postos iguais à média das suas posições relativas na amostra.</span>
<span id="cb101-38"><a href="#cb101-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-39"><a href="#cb101-39" aria-hidden="true" tabindex="-1"></a>Por exemplo, suponha uma amostra contendo os escores de Apgar no primeiro minuto de 10 recém-nascidos a termo (@tbl-apgar1)). Em primeiro lugar, os valores são colocados em ordem crescente e, após, atribui-se postos aos valores. Observe que os postos atribuídos aos valores das posições 4, 5 e 6 são iguais e correspondentes a média de 4, 5 e 6, que é igual a 5. O mesmo ocorreu com os outros valores onde houve empate. A soma dos postos, no exemplo, é igual a 55. Para verificar a correção do cálculo, haja ou não empates, a soma dos postos será sempre $\frac {n\ \times \ (n+1)}{2}$. No exemplo, *n* = 10, logo $\frac {10\ \times \ (10+1)}{2}=55$.</span>
<span id="cb101-40"><a href="#cb101-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-43"><a href="#cb101-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-44"><a href="#cb101-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-apgar1</span></span>
<span id="cb101-45"><a href="#cb101-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb101-46"><a href="#cb101-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-47"><a href="#cb101-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-48"><a href="#cb101-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Construção dos postos"</span></span>
<span id="cb101-49"><a href="#cb101-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-50"><a href="#cb101-50" aria-hidden="true" tabindex="-1"></a>apgar1 <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb101-51"><a href="#cb101-51" aria-hidden="true" tabindex="-1"></a>ordem <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb101-52"><a href="#cb101-52" aria-hidden="true" tabindex="-1"></a>posto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="fl">9.5</span>, <span class="fl">9.5</span>)</span>
<span id="cb101-53"><a href="#cb101-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-54"><a href="#cb101-54" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(apgar1, ordem, posto)</span>
<span id="cb101-55"><a href="#cb101-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-56"><a href="#cb101-56" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb101-57"><a href="#cb101-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-58"><a href="#cb101-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-59"><a href="#cb101-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-60"><a href="#cb101-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb101-61"><a href="#cb101-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb101-62"><a href="#cb101-62" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb101-63"><a href="#cb101-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-64"><a href="#cb101-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-65"><a href="#cb101-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teste de Mann-Whitney</span></span>
<span id="cb101-66"><a href="#cb101-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-67"><a href="#cb101-67" aria-hidden="true" tabindex="-1"></a>O *teste de Mann-Whitney* é usado para analisar a diferença na variável dependente (desfecho) para dois grupos independentes. O teste classifica todos os valores dependentes, ou seja, o valor mais baixo obtém o posto um e, em seguida, usa a soma dos postos de cada grupo no cálculo da estatística de teste.</span>
<span id="cb101-68"><a href="#cb101-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-69"><a href="#cb101-69" aria-hidden="true" tabindex="-1"></a>É o substituto do teste *t* para amostras independentes quando os pressupostos deste teste são violados. Para a aplicação do teste de Mann-Whitney a variável de interesse deve ser ordinal ou numérica. Este teste é equivalente ao desenvolvido por Frank Wilcoxon (1892 – 1965), assim algumas vezes é denominado de *Wilcoxon Rank Sum Test* ou teste de Wilcoxon-Mann-Whitney. O R usa esta denominação e é importante não confundir com o teste não paramétrico para amostra pareadas, discutido mais adiante.</span>
<span id="cb101-70"><a href="#cb101-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-71"><a href="#cb101-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados no exemplo</span></span>
<span id="cb101-72"><a href="#cb101-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-73"><a href="#cb101-73" aria-hidden="true" tabindex="-1"></a>Os dados do exemplo são do arquivo <span class="in">`dadosCirurgia.xlsx`</span>, já usado na Seção @sec-dadosCirurgia. Ele contém 144 recém-nascidos que foram submetidos a diferentes procedimentos cirúrgicos. A questão de pesquisa a ser respondida é:</span>
<span id="cb101-74"><a href="#cb101-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-75"><a href="#cb101-75" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Existe diferença no tempo de hospitalização (</span><span class="in">`tempohosp`</span><span class="at">) dos recém-nascidos de acordo com a presença ou não de infecção (</span><span class="in">`infec`</span><span class="at">)?</span></span>
<span id="cb101-76"><a href="#cb101-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-77"><a href="#cb101-77" aria-hidden="true" tabindex="-1"></a>Essa pergunta foi respondida de outra maneira, na Seção @sec-tabextensas. Agora, será respondida pelo teste de Mann-Whitney.</span>
<span id="cb101-78"><a href="#cb101-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-79"><a href="#cb101-79" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Leitura, exploração e visualização dos dados</span></span>
<span id="cb101-80"><a href="#cb101-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-81"><a href="#cb101-81" aria-hidden="true" tabindex="-1"></a>Os dados serão lidos com a função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span>:</span>
<span id="cb101-82"><a href="#cb101-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-85"><a href="#cb101-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-86"><a href="#cb101-86" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosCirurgia.xlsx"</span>)</span>
<span id="cb101-87"><a href="#cb101-87" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cirurgia)</span>
<span id="cb101-88"><a href="#cb101-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-89"><a href="#cb101-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-90"><a href="#cb101-90" aria-hidden="true" tabindex="-1"></a>A variável <span class="in">`infec`</span> aparece como caractere e será transformada como fator:</span>
<span id="cb101-91"><a href="#cb101-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-94"><a href="#cb101-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-95"><a href="#cb101-95" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>infec <span class="ot">&lt;-</span> <span class="fu">factor</span>(cirurgia<span class="sc">$</span>infec, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb101-96"><a href="#cb101-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-97"><a href="#cb101-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-98"><a href="#cb101-98" aria-hidden="true" tabindex="-1"></a>Os boxplots (@fig-bpapgar1), construídos com a função <span class="in">`ggboxplot()`</span> do pacote <span class="in">`ggpubr`</span> com as cores da paleta do *New England Journal of Medicine (NEJM)*, são uma boa maneira de visualizar os dados:</span>
<span id="cb101-99"><a href="#cb101-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-102"><a href="#cb101-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-103"><a href="#cb101-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bpapgar1</span></span>
<span id="cb101-104"><a href="#cb101-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-105"><a href="#cb101-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-106"><a href="#cb101-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-107"><a href="#cb101-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-108"><a href="#cb101-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-109"><a href="#cb101-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto da infecção no pós-operatório no tempo de hopsitalização"</span></span>
<span id="cb101-110"><a href="#cb101-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-111"><a href="#cb101-111" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb101-112"><a href="#cb101-112" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb101-113"><a href="#cb101-113" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb101-114"><a href="#cb101-114" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-115"><a href="#cb101-115" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-116"><a href="#cb101-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb101-117"><a href="#cb101-117" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb101-118"><a href="#cb101-118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-119"><a href="#cb101-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb101-120"><a href="#cb101-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb101-121"><a href="#cb101-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>)   </span>
<span id="cb101-122"><a href="#cb101-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-123"><a href="#cb101-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-124"><a href="#cb101-124" aria-hidden="true" tabindex="-1"></a>Os boxplots exibem uma série de valores atípicos, indicando que existe uma assimetria em ambos os grupos. Essa assimetria também pode ser verificada usando o teste de Shapiro-Wilk, que mostrando valores *p* <span class="sc">\&lt;</span> 0,05, confirma que os dados não seguem a distribuição normal. Este teste não é pré-requisito para o teste. Foi realizado como uma demonstração.</span>
<span id="cb101-125"><a href="#cb101-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-128"><a href="#cb101-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-129"><a href="#cb101-129" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb101-130"><a href="#cb101-130" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb101-131"><a href="#cb101-131" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span>(tempohosp)</span>
<span id="cb101-132"><a href="#cb101-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-133"><a href="#cb101-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-134"><a href="#cb101-134" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sumarização dos dados</span></span>
<span id="cb101-135"><a href="#cb101-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-136"><a href="#cb101-136" aria-hidden="true" tabindex="-1"></a>Como a variável <span class="in">`tempohosp`</span> é assimétrica conforme mostrado acima, onde ambos os valores *p* são menores do que 0,05, será realizado um sumário numérico com a obtenção da mediana e IIQ. Isto será feito através da função <span class="in">`group_by()`</span> e <span class="in">`summarise()`</span>, incluídas no pacote <span class="in">`dplyr`</span>.</span>
<span id="cb101-137"><a href="#cb101-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-140"><a href="#cb101-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-141"><a href="#cb101-141" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb101-142"><a href="#cb101-142" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb101-143"><a href="#cb101-143" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb101-144"><a href="#cb101-144" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempohosp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-145"><a href="#cb101-145" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-146"><a href="#cb101-146" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb101-147"><a href="#cb101-147" aria-hidden="true" tabindex="-1"></a>resumo</span>
<span id="cb101-148"><a href="#cb101-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-149"><a href="#cb101-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-150"><a href="#cb101-150" aria-hidden="true" tabindex="-1"></a>Os dados mostram que a mediana de tempo de internação dos neonatos infectados é bem maior do que a mediana dos não infectados.</span>
<span id="cb101-151"><a href="#cb101-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-152"><a href="#cb101-152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hipóteses estatísticas</span></span>
<span id="cb101-153"><a href="#cb101-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-154"><a href="#cb101-154" aria-hidden="true" tabindex="-1"></a>Da mesma maneira que o teste *t*, as hipóteses estabelecidas comparam dois grupos independentes. Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</span>
<span id="cb101-155"><a href="#cb101-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-156"><a href="#cb101-156" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: As duas populações são iguais.</span></span>
<span id="cb101-157"><a href="#cb101-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-158"><a href="#cb101-158" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: As duas populações não são iguais.</span></span>
<span id="cb101-159"><a href="#cb101-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-160"><a href="#cb101-160" aria-hidden="true" tabindex="-1"></a>Não foi escrita a hipótese nula como sendo que as médias (ou as medianas) são iguais, pois o teste não usa as medidas de posição tradicionais e sim os postos.</span>
<span id="cb101-161"><a href="#cb101-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-162"><a href="#cb101-162" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pressupostos do teste de Mann_Whitney</span></span>
<span id="cb101-163"><a href="#cb101-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-164"><a href="#cb101-164" aria-hidden="true" tabindex="-1"></a>O teste de Mann-Whitney é baseado nos seguintes pressupostos:</span>
<span id="cb101-165"><a href="#cb101-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-166"><a href="#cb101-166" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Os dados são aleatórios;</span>
<span id="cb101-167"><a href="#cb101-167" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>As amostras são de dois grupos independentes;</span>
<span id="cb101-168"><a href="#cb101-168" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Um dos grupos é denominado de 1 e o outro de 2;</span>
<span id="cb101-169"><a href="#cb101-169" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>A variável a ser comparada nos grupos deve ser ordenável;</span>
<span id="cb101-170"><a href="#cb101-170" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>O grupo 1 será o grupo de menor tamanho e, se tiverem o mesmo tamanho, o grupo 1 é aquele cuja soma dos postos é a menor.</span>
<span id="cb101-171"><a href="#cb101-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-172"><a href="#cb101-172" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cálculo da estatística de teste</span></span>
<span id="cb101-173"><a href="#cb101-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-174"><a href="#cb101-174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lógica do teste U de Mann-Whitney</span></span>
<span id="cb101-175"><a href="#cb101-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-176"><a href="#cb101-176" aria-hidden="true" tabindex="-1"></a>De acordo com as hipóteses estabelecidas, o teste é bicaudal. Se as observações nos dois grupos forem provenientes da mesma população, a soma dos postos em cada grupo devem ficar próximas.</span>
<span id="cb101-177"><a href="#cb101-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-178"><a href="#cb101-178" aria-hidden="true" tabindex="-1"></a>Para calcular o teste, procede-se da seguinte maneira:</span>
<span id="cb101-179"><a href="#cb101-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-180"><a href="#cb101-180" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Deve haver uma variável que identifique o grupo a que pertence cada uma das observações. No exemplo proposto, a variável desfecho é <span class="in">`tempohosp`</span> e a variável agrupadora é <span class="in">`infec`</span>, categorizada como <span class="in">`sim`</span> e <span class="in">`não`</span>.</span>
<span id="cb101-181"><a href="#cb101-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-182"><a href="#cb101-182" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Ordenar de forma crescente todos os valores da variável <span class="in">`tempohosp`</span>, sem levar em consideração a que grupo pertence. Para realizar este procedimento, será usada a função <span class="in">`rank()`</span> do R base com o método para empates igual à média dos valores empatados (<span class="in">`ties.method="average`</span>). Ao executar a função, será criada uma nova variável, denotada <span class="in">`postos`</span>.</span>
<span id="cb101-183"><a href="#cb101-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-186"><a href="#cb101-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-187"><a href="#cb101-187" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">ties.method =</span> <span class="st">"average"</span>) </span>
<span id="cb101-188"><a href="#cb101-188" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cirurgia)</span>
<span id="cb101-189"><a href="#cb101-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-190"><a href="#cb101-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-191"><a href="#cb101-191" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Verificar o tamanho (*n*) de cada grupo (presença ou não de infecção) e somar os postos em cada um dos grupos, usando a função <span class="in">`group_by()`</span> junto com a função <span class="in">`summarise()`</span>,</span>
<span id="cb101-192"><a href="#cb101-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-195"><a href="#cb101-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-196"><a href="#cb101-196" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb101-197"><a href="#cb101-197" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb101-198"><a href="#cb101-198" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb101-199"><a href="#cb101-199" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(postos))</span>
<span id="cb101-200"><a href="#cb101-200" aria-hidden="true" tabindex="-1"></a>resumo</span>
<span id="cb101-201"><a href="#cb101-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-202"><a href="#cb101-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-203"><a href="#cb101-203" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Denominar de *grupo_1* o grupo com menor soma:</span>
<span id="cb101-204"><a href="#cb101-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-207"><a href="#cb101-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-208"><a href="#cb101-208" aria-hidden="true" tabindex="-1"></a>grupo_1 <span class="ot">&lt;-</span> <span class="fu">min</span>(resumo<span class="sc">$</span>soma)</span>
<span id="cb101-209"><a href="#cb101-209" aria-hidden="true" tabindex="-1"></a>grupo_1</span>
<span id="cb101-210"><a href="#cb101-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-211"><a href="#cb101-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-212"><a href="#cb101-212" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Denotar o *grupo_1* como T</span>
<span id="cb101-213"><a href="#cb101-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-216"><a href="#cb101-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-217"><a href="#cb101-217" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> grupo_1</span>
<span id="cb101-218"><a href="#cb101-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-219"><a href="#cb101-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-220"><a href="#cb101-220" aria-hidden="true" tabindex="-1"></a>Consequentemente,</span>
<span id="cb101-221"><a href="#cb101-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-224"><a href="#cb101-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-225"><a href="#cb101-225" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb101-226"><a href="#cb101-226" aria-hidden="true" tabindex="-1"></a>n1</span>
<span id="cb101-227"><a href="#cb101-227" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">2</span>]</span>
<span id="cb101-228"><a href="#cb101-228" aria-hidden="true" tabindex="-1"></a>n2</span>
<span id="cb101-229"><a href="#cb101-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-230"><a href="#cb101-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-231"><a href="#cb101-231" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Calcular a estística do teste, usando a fórmula preconizada por Altman <span class="co">[</span><span class="ot">@altman1991mannwhitney</span><span class="co">]</span>:</span>
<span id="cb101-232"><a href="#cb101-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-233"><a href="#cb101-233" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-234"><a href="#cb101-234" aria-hidden="true" tabindex="-1"></a>U =n_{1} \times n_{2} \ +\left <span class="co">[</span><span class="ot">\frac{n_{1} \times \left (n_{1} + 1  \right )}{2}  \right </span><span class="co">]</span> - T</span>
<span id="cb101-235"><a href="#cb101-235" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-236"><a href="#cb101-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-239"><a href="#cb101-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-240"><a href="#cb101-240" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>n2 <span class="sc">+</span> ((n1<span class="sc">*</span>(n1 <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">-</span> T</span>
<span id="cb101-241"><a href="#cb101-241" aria-hidden="true" tabindex="-1"></a>U</span>
<span id="cb101-242"><a href="#cb101-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-243"><a href="#cb101-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-244"><a href="#cb101-244" aria-hidden="true" tabindex="-1"></a>**Obs**.: O U de Mann-Whitney aparece no teste de Wilcoxon como W, eles representam o mesmo.</span>
<span id="cb101-245"><a href="#cb101-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-246"><a href="#cb101-246" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Se $n_{1}$, $n_{2}$ $\ge$ 10, a distribuição da estatística do teste pode ser aproximada por uma distribuição normal com média igual a</span>
<span id="cb101-247"><a href="#cb101-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-248"><a href="#cb101-248" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-249"><a href="#cb101-249" aria-hidden="true" tabindex="-1"></a>\mu_{U} =\left <span class="co">[</span><span class="ot">\frac{n_{S} \times \left (n_{L} + 1  \right )}{2}  \right </span><span class="co">]</span></span>
<span id="cb101-250"><a href="#cb101-250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-251"><a href="#cb101-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-252"><a href="#cb101-252" aria-hidden="true" tabindex="-1"></a>onde $n_{S}$ e $n_{L}$, são, respectivamente, o grupo de menor e maior tamanho. No exemplo, $n_{1}$ e $n_{2}$.</span>
<span id="cb101-253"><a href="#cb101-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-256"><a href="#cb101-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-257"><a href="#cb101-257" aria-hidden="true" tabindex="-1"></a>m_U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>(n1<span class="sc">+</span>n2<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb101-258"><a href="#cb101-258" aria-hidden="true" tabindex="-1"></a>m_U</span>
<span id="cb101-259"><a href="#cb101-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-260"><a href="#cb101-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-261"><a href="#cb101-261" aria-hidden="true" tabindex="-1"></a>E desvio padrão igual a</span>
<span id="cb101-262"><a href="#cb101-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-263"><a href="#cb101-263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-264"><a href="#cb101-264" aria-hidden="true" tabindex="-1"></a>\sigma_{U}= \sqrt {\frac{n_{L}\times \sigma_{U}}{6}}</span>
<span id="cb101-265"><a href="#cb101-265" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-266"><a href="#cb101-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-269"><a href="#cb101-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-270"><a href="#cb101-270" aria-hidden="true" tabindex="-1"></a>dp_U <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n2<span class="sc">*</span>m_U)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb101-271"><a href="#cb101-271" aria-hidden="true" tabindex="-1"></a>dp_U</span>
<span id="cb101-272"><a href="#cb101-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-273"><a href="#cb101-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-274"><a href="#cb101-274" aria-hidden="true" tabindex="-1"></a>Os resultados fornecem os dados para calcular a estatística $Z_{U}$ com correção de continuidade e, a partir dela, calcular o valor *P*.</span>
<span id="cb101-275"><a href="#cb101-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-276"><a href="#cb101-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-277"><a href="#cb101-277" aria-hidden="true" tabindex="-1"></a>Z_{U}= \frac{(T -0,5) - \mu_{U}}{\sigma_{U}}</span>
<span id="cb101-278"><a href="#cb101-278" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-279"><a href="#cb101-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-282"><a href="#cb101-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-283"><a href="#cb101-283" aria-hidden="true" tabindex="-1"></a>Z_U <span class="ot">&lt;-</span> ((T <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">-</span> m_U)<span class="sc">/</span>dp_U</span>
<span id="cb101-284"><a href="#cb101-284" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Z_U, <span class="dv">2</span>)</span>
<span id="cb101-285"><a href="#cb101-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-286"><a href="#cb101-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-287"><a href="#cb101-287" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Finalmente, calcula-se o valor *p*, usando a função <span class="in">`pnorm()`</span>, multiplicada por 2, pois o teste é bicaudal.</span>
<span id="cb101-288"><a href="#cb101-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-291"><a href="#cb101-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-292"><a href="#cb101-292" aria-hidden="true" tabindex="-1"></a>valor_p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(Z_U, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb101-293"><a href="#cb101-293" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(valor_p, <span class="dv">4</span>)</span>
<span id="cb101-294"><a href="#cb101-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-295"><a href="#cb101-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-296"><a href="#cb101-296" aria-hidden="true" tabindex="-1"></a>Na prática, não há necessidade de fazer todos esses cálculos, pois o R calcula facilmente o teste. Os cálculos foram mostrados para melhorar o entendimento de como o teste de Mann-Whitney funciona.</span>
<span id="cb101-297"><a href="#cb101-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-298"><a href="#cb101-298" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo do U de Mann-Whitney no R</span></span>
<span id="cb101-299"><a href="#cb101-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-300"><a href="#cb101-300" aria-hidden="true" tabindex="-1"></a>O teste pode ser realizado com a função <span class="in">`wilcox_test()`</span> <span class="ot">[^20-testes-naoparametricos-1]</span> do pacote <span class="in">`rstatix`</span>:</span>
<span id="cb101-301"><a href="#cb101-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-302"><a href="#cb101-302" aria-hidden="true" tabindex="-1"></a><span class="ot">[^20-testes-naoparametricos-1]: </span>O cálculo pode também ser realizado, usando a função <span class="in">`wilcox.test()`</span> do pacote <span class="in">`stats`</span>, incluído no R base.</span>
<span id="cb101-303"><a href="#cb101-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-306"><a href="#cb101-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-307"><a href="#cb101-307" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(<span class="at">formula =</span> tempohosp <span class="sc">~</span> infec, <span class="at">data =</span> cirurgia)</span>
<span id="cb101-308"><a href="#cb101-308" aria-hidden="true" tabindex="-1"></a>teste</span>
<span id="cb101-309"><a href="#cb101-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-310"><a href="#cb101-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-311"><a href="#cb101-311" aria-hidden="true" tabindex="-1"></a>Assim como no cálculo manual, o teste com a função do <span class="in">`rstatix`</span>, mostra uma diferença estatisticamente significativa (*p* <span class="sc">\&lt;</span> 0,001) entre os tempos de hospitalização dos recém-nascidos que realizaram cirurgia no período neonatal que se infectaram ou não.</span>
<span id="cb101-312"><a href="#cb101-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-313"><a href="#cb101-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tamanho do efeito {#sec-tefMW}</span></span>
<span id="cb101-314"><a href="#cb101-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-315"><a href="#cb101-315" aria-hidden="true" tabindex="-1"></a>É interessante calcular o tamanho do efeito, a magnitude do efeito. O tamanho do efeito *r* é calculado como a estatística $Z_{U}$ dividida pela raiz quadrada do tamanho da amostra ($n = n_{1} + n_{2}$).</span>
<span id="cb101-316"><a href="#cb101-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-317"><a href="#cb101-317" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-318"><a href="#cb101-318" aria-hidden="true" tabindex="-1"></a>r = \frac {Z_{U}}{\sqrt{n}}</span>
<span id="cb101-319"><a href="#cb101-319" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-320"><a href="#cb101-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-321"><a href="#cb101-321" aria-hidden="true" tabindex="-1"></a>O valor de $Z_{U}$ é igual a <span class="in">`r Z_U`</span>, logo</span>
<span id="cb101-322"><a href="#cb101-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-325"><a href="#cb101-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-326"><a href="#cb101-326" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Z_U<span class="sc">/</span><span class="fu">sqrt</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb101-327"><a href="#cb101-327" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">3</span>)</span>
<span id="cb101-328"><a href="#cb101-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-329"><a href="#cb101-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-330"><a href="#cb101-330" aria-hidden="true" tabindex="-1"></a>O R possui a função <span class="in">`wilcox_effsize()`</span> incluída no pacote <span class="in">`rstatix`</span>. Necessita também do pacote <span class="in">`coin`</span> <span class="co">[</span><span class="ot">@hothorn2006lego</span><span class="co">]</span> instalado para calcular a estatística *r*.<span class="ot">[^20-testes-naoparametricos-2]</span> A saída exibirá junto a magnitude o efeito, que no caso é pequena (veja @tbl-wilcoxef).</span>
<span id="cb101-331"><a href="#cb101-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-332"><a href="#cb101-332" aria-hidden="true" tabindex="-1"></a><span class="ot">[^20-testes-naoparametricos-2]: </span>Para maiores detalhes consulte a ajuda da função.</span>
<span id="cb101-333"><a href="#cb101-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-336"><a href="#cb101-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-337"><a href="#cb101-337" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_effsize</span>(cirurgia, tempohosp<span class="sc">~</span>infec)</span>
<span id="cb101-338"><a href="#cb101-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-339"><a href="#cb101-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-342"><a href="#cb101-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-343"><a href="#cb101-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wilcoxef</span></span>
<span id="cb101-344"><a href="#cb101-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb101-345"><a href="#cb101-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-346"><a href="#cb101-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-347"><a href="#cb101-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Interpretação do valor r"</span></span>
<span id="cb101-348"><a href="#cb101-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-349"><a href="#cb101-349" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"pequeno"</span>, <span class="st">"médio"</span>, <span class="st">"grande"</span>)</span>
<span id="cb101-350"><a href="#cb101-350" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0,10 &lt; 0,30"</span>, <span class="st">"0,30 &lt; 0,50"</span>, <span class="st">"&gt;= 0,50"</span>)</span>
<span id="cb101-351"><a href="#cb101-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-352"><a href="#cb101-352" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r, magnitude)</span>
<span id="cb101-353"><a href="#cb101-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-354"><a href="#cb101-354" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb101-355"><a href="#cb101-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-356"><a href="#cb101-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">value =</span> <span class="st">"Sem considerar o sinal"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-357"><a href="#cb101-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-358"><a href="#cb101-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-359"><a href="#cb101-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-360"><a href="#cb101-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-361"><a href="#cb101-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-362"><a href="#cb101-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb101-363"><a href="#cb101-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb101-364"><a href="#cb101-364" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb101-365"><a href="#cb101-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-366"><a href="#cb101-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-367"><a href="#cb101-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb101-368"><a href="#cb101-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-369"><a href="#cb101-369" aria-hidden="true" tabindex="-1"></a>O valor $p &lt; 0,0001$ está bem abaixo do nível de significância estabelecido ($\alpha = 0,05)$. Pode-se concluir que o tempo de hospitalização nos dois grupos é estatisticamente diferente. Entretanto, a magnitude dessa diferença é pequena.</span>
<span id="cb101-370"><a href="#cb101-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-371"><a href="#cb101-371" aria-hidden="true" tabindex="-1"></a>Isto pode ser visualizado no gráfico (@fig-bpres):</span>
<span id="cb101-372"><a href="#cb101-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-375"><a href="#cb101-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-376"><a href="#cb101-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bpres</span></span>
<span id="cb101-377"><a href="#cb101-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-378"><a href="#cb101-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-379"><a href="#cb101-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-380"><a href="#cb101-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-381"><a href="#cb101-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-382"><a href="#cb101-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto da infecção no pós-operatório no tempo de hopsitalização"</span></span>
<span id="cb101-383"><a href="#cb101-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-384"><a href="#cb101-384" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb101-385"><a href="#cb101-385" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb101-386"><a href="#cb101-386" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb101-387"><a href="#cb101-387" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-388"><a href="#cb101-388" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-389"><a href="#cb101-389" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb101-390"><a href="#cb101-390" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb101-391"><a href="#cb101-391" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-392"><a href="#cb101-392" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb101-393"><a href="#cb101-393" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb101-394"><a href="#cb101-394" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>) <span class="sc">+</span></span>
<span id="cb101-395"><a href="#cb101-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> rstatix<span class="sc">::</span><span class="fu">get_test_label</span>(teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb101-396"><a href="#cb101-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-397"><a href="#cb101-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-398"><a href="#cb101-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teste de Wilcoxon</span></span>
<span id="cb101-399"><a href="#cb101-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-400"><a href="#cb101-400" aria-hidden="true" tabindex="-1"></a>O *teste de Wilcoxon*, também conhecido como teste dos postos com sinais de Wilcoxon (*Wilcoxon Signed-Rank Test*), é um teste não paramétrico utilizado em situações em que existem dois conjuntos de dados emparelhados, ou seja, dados provenientes do mesmo participante. O teste não examina os dois grupos individualmente; em vez disso, ele se concentra na diferença existente entre cada par de observações. É um equivalente não paramétrico do teste *t* pareado.</span>
<span id="cb101-401"><a href="#cb101-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-402"><a href="#cb101-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados como exemplo</span></span>
<span id="cb101-403"><a href="#cb101-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-404"><a href="#cb101-404" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb101-405"><a href="#cb101-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb101-406"><a href="#cb101-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-407"><a href="#cb101-407" aria-hidden="true" tabindex="-1"></a>Para verificar se a realização de exercícios aeróbicos modifica a função respiratória de 10 escolares asmáticos, foi medido o Pico de Fluxo Expiratório Máximo (*Peak Flow Meter*) no início e no final do programa, após 120 dias. O Pico de Fluxo Expiratório Máximo (PFE), medido em L/min, serve como uma forma simples de avaliar a força e a velocidade de saída do ar de dentro dos pulmões.</span>
<span id="cb101-408"><a href="#cb101-408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb101-409"><a href="#cb101-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-410"><a href="#cb101-410" aria-hidden="true" tabindex="-1"></a>Os dados têm apenas três variáveis, <span class="in">`id`</span>(identificação), <span class="in">`basal`</span> (PFE basal) e <span class="in">`final`</span>(PFE final).</span>
<span id="cb101-411"><a href="#cb101-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-414"><a href="#cb101-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-415"><a href="#cb101-415" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb101-416"><a href="#cb101-416" aria-hidden="true" tabindex="-1"></a>basal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">200</span>, <span class="dv">140</span>, <span class="dv">200</span>, <span class="dv">110</span>, <span class="dv">240</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">250</span>, <span class="dv">190</span>)</span>
<span id="cb101-417"><a href="#cb101-417" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">300</span>, <span class="dv">230</span>, <span class="dv">180</span>, <span class="dv">300</span>, <span class="dv">330</span>, <span class="dv">230</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">200</span>)</span>
<span id="cb101-418"><a href="#cb101-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-419"><a href="#cb101-419" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">tibble</span>(id, basal, final)</span>
<span id="cb101-420"><a href="#cb101-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-421"><a href="#cb101-421" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados)</span>
<span id="cb101-422"><a href="#cb101-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-423"><a href="#cb101-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-424"><a href="#cb101-424" aria-hidden="true" tabindex="-1"></a>A questão de pesquisa a ser respondida, portanto, é:</span>
<span id="cb101-425"><a href="#cb101-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-426"><a href="#cb101-426" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Existe diferença entre as medidas iniciais e finais do PFE dos escolares asmáticos que entraram em um programa de exercícios aeróbicos?</span></span>
<span id="cb101-427"><a href="#cb101-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-428"><a href="#cb101-428" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exploração e transformação dos dados</span></span>
<span id="cb101-429"><a href="#cb101-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-430"><a href="#cb101-430" aria-hidden="true" tabindex="-1"></a>Os dados estão no formato amplo com as variáveis basal e final classificadas como númericas. Serão transformados para o formato longo, usando a função <span class="in">`pivot_longer()`</span> do pacote <span class="in">`tidyr`</span>. Este processo é opcional, mas, como foi feito com o teste *t* pareado, será repetido aqui, por questões didáticas:</span>
<span id="cb101-431"><a href="#cb101-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-434"><a href="#cb101-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-435"><a href="#cb101-435" aria-hidden="true" tabindex="-1"></a>dadosL <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-436"><a href="#cb101-436" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(basal, final), </span>
<span id="cb101-437"><a href="#cb101-437" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"momento"</span>, </span>
<span id="cb101-438"><a href="#cb101-438" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"medidas"</span>)</span>
<span id="cb101-439"><a href="#cb101-439" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL)</span>
<span id="cb101-440"><a href="#cb101-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-441"><a href="#cb101-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-442"><a href="#cb101-442" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Medidas resumidoras</span></span>
<span id="cb101-443"><a href="#cb101-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-444"><a href="#cb101-444" aria-hidden="true" tabindex="-1"></a>Como o número de participantes é de apenas 10, a medida de posição mais adequada para resumir os dados é mediana e a medida de dispersão é o intervalo interquartil (IIQ). Para isso, se fará uso das funções <span class="in">`group_by()`</span> e <span class="in">`summarise()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb101-445"><a href="#cb101-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-448"><a href="#cb101-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-449"><a href="#cb101-449" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb101-450"><a href="#cb101-450" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(momento) <span class="sc">%&gt;%</span> </span>
<span id="cb101-451"><a href="#cb101-451" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb101-452"><a href="#cb101-452" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-453"><a href="#cb101-453" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-454"><a href="#cb101-454" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-455"><a href="#cb101-455" aria-hidden="true" tabindex="-1"></a>                   <span class="at">media =</span> <span class="fu">mean</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-456"><a href="#cb101-456" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dp =</span> <span class="fu">sd</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-457"><a href="#cb101-457" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ep =</span> dp<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb101-458"><a href="#cb101-458" aria-hidden="true" tabindex="-1"></a>                   <span class="at">me =</span> ep <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb101-459"><a href="#cb101-459" aria-hidden="true" tabindex="-1"></a>resumo</span>
<span id="cb101-460"><a href="#cb101-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-461"><a href="#cb101-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-462"><a href="#cb101-462" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualização dos dados</span></span>
<span id="cb101-463"><a href="#cb101-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-464"><a href="#cb101-464" aria-hidden="true" tabindex="-1"></a>Pode-se fazer visualização gráfica dos dados usando um boxplot (@fig-aero) ou um gráfico de linha (@fig-aero1).</span>
<span id="cb101-465"><a href="#cb101-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-466"><a href="#cb101-466" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Boxplot</span></span>
<span id="cb101-467"><a href="#cb101-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-470"><a href="#cb101-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-471"><a href="#cb101-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-aero</span></span>
<span id="cb101-472"><a href="#cb101-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-473"><a href="#cb101-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-474"><a href="#cb101-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-475"><a href="#cb101-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-476"><a href="#cb101-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-477"><a href="#cb101-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos"</span></span>
<span id="cb101-478"><a href="#cb101-478" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb101-479"><a href="#cb101-479" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb101-480"><a href="#cb101-480" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb101-481"><a href="#cb101-481" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb101-482"><a href="#cb101-482" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-483"><a href="#cb101-483" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-484"><a href="#cb101-484" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb101-485"><a href="#cb101-485" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb101-486"><a href="#cb101-486" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-487"><a href="#cb101-487" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb101-488"><a href="#cb101-488" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb101-489"><a href="#cb101-489" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>)<span class="sc">+</span></span>
<span id="cb101-490"><a href="#cb101-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb101-491"><a href="#cb101-491" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span>
<span id="cb101-492"><a href="#cb101-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-493"><a href="#cb101-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-494"><a href="#cb101-494" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gráfico de linha</span></span>
<span id="cb101-495"><a href="#cb101-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-498"><a href="#cb101-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-499"><a href="#cb101-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-aero1</span></span>
<span id="cb101-500"><a href="#cb101-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-501"><a href="#cb101-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-502"><a href="#cb101-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-503"><a href="#cb101-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-504"><a href="#cb101-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-505"><a href="#cb101-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos"</span></span>
<span id="cb101-506"><a href="#cb101-506" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb101-507"><a href="#cb101-507" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL,</span>
<span id="cb101-508"><a href="#cb101-508" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb101-509"><a href="#cb101-509" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb101-510"><a href="#cb101-510" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"cyan4"</span>,</span>
<span id="cb101-511"><a href="#cb101-511" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb101-512"><a href="#cb101-512" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.7</span>,</span>
<span id="cb101-513"><a href="#cb101-513" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb101-514"><a href="#cb101-514" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="dv">2</span>,</span>
<span id="cb101-515"><a href="#cb101-515" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb101-516"><a href="#cb101-516" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>,</span>
<span id="cb101-517"><a href="#cb101-517" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb101-518"><a href="#cb101-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb101-519"><a href="#cb101-519" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb101-520"><a href="#cb101-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-521"><a href="#cb101-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-522"><a href="#cb101-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Criação de uma variável que represente a diferença entre os momentos</span></span>
<span id="cb101-523"><a href="#cb101-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-524"><a href="#cb101-524" aria-hidden="true" tabindex="-1"></a>A diferença entre as média basal e final será atribuída ao nome <span class="in">`D`</span>. Esta ação será realizada, utilizando o banco de dados amplo (<span class="in">`dados`</span>):</span>
<span id="cb101-525"><a href="#cb101-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-528"><a href="#cb101-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-529"><a href="#cb101-529" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D <span class="ot">&lt;-</span> dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final</span>
<span id="cb101-530"><a href="#cb101-530" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (dados)</span>
<span id="cb101-531"><a href="#cb101-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-532"><a href="#cb101-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-533"><a href="#cb101-533" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Resumo da variável D</span><span class="co">]</span>{.underline}</span>
<span id="cb101-534"><a href="#cb101-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-535"><a href="#cb101-535" aria-hidden="true" tabindex="-1"></a>Ao resumo será atribuído ao nome <span class="in">`resumo2`</span>:</span>
<span id="cb101-536"><a href="#cb101-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-539"><a href="#cb101-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-540"><a href="#cb101-540" aria-hidden="true" tabindex="-1"></a>resumo2 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-541"><a href="#cb101-541" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span> (),</span>
<span id="cb101-542"><a href="#cb101-542" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (D, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-543"><a href="#cb101-543" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-544"><a href="#cb101-544" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb101-545"><a href="#cb101-545" aria-hidden="true" tabindex="-1"></a>resumo2</span>
<span id="cb101-546"><a href="#cb101-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-547"><a href="#cb101-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-548"><a href="#cb101-548" aria-hidden="true" tabindex="-1"></a>O sinal negativo demonstra que houve um aumento do PFE do momento basal para o final.</span>
<span id="cb101-549"><a href="#cb101-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-550"><a href="#cb101-550" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definição das hipóteses estatísticas</span></span>
<span id="cb101-551"><a href="#cb101-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-552"><a href="#cb101-552" aria-hidden="true" tabindex="-1"></a>Da mesma maneira que o teste *t* pareado, as hipóteses estabelecidas comparam dois grupos dependentes. O teste de Wilcoxon é usado para avaliar a hipótese nula de que a distribuição das diferenças entre os grupos tem uma diferença mediana igual a 0.</span>
<span id="cb101-553"><a href="#cb101-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-554"><a href="#cb101-554" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}: D_{i} = 0$</span></span>
<span id="cb101-555"><a href="#cb101-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-556"><a href="#cb101-556" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{A}: D_{i} \ne 0$</span></span>
<span id="cb101-557"><a href="#cb101-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-558"><a href="#cb101-558" aria-hidden="true" tabindex="-1"></a>Note que a $H_{A}$ estabelece que a diferença pode aumentar ou diminuir. Logo, o teste é bicaudal.</span>
<span id="cb101-559"><a href="#cb101-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-560"><a href="#cb101-560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Execução do teste estatístico</span></span>
<span id="cb101-561"><a href="#cb101-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-562"><a href="#cb101-562" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lógica do teste de Wilcoxon</span></span>
<span id="cb101-563"><a href="#cb101-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-564"><a href="#cb101-564" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A ideia do teste é verificar se as diferenças positivas são maiores ou menores, em grandeza absoluta, que as diferenças negativas. Para isso, foi criada, anteriormente, a variável <span class="in">`D`</span>. Agora, será criada outra variável, iguala a variável <span class="in">`D`</span>, apenas ignorando o sinal, denominada <span class="in">`D_abs`</span>, diferença absoluta entre as variáveis <span class="in">`final`</span> e <span class="in">`basal`</span>.</span>
<span id="cb101-565"><a href="#cb101-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-568"><a href="#cb101-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-569"><a href="#cb101-569" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D_abs <span class="ot">&lt;-</span> <span class="fu">abs</span>(dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final)</span>
<span id="cb101-570"><a href="#cb101-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-571"><a href="#cb101-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-572"><a href="#cb101-572" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Excluir os casos com diferença igual a 0 (zero). Para isso, uma maneira possível é extrair um subconjunto de dados do conjunto principal (<span class="in">`dados`</span>), criando um conjunto de dados com a função <span class="in">`filter()`</span> do pacote <span class="in">`dplyr`</span>, que receberá o nome de <span class="in">`dados1`</span>. O argumento <span class="in">`D_absbs != 0`</span> significa todas as diferenças absolutas diferentes de 0:</span>
<span id="cb101-573"><a href="#cb101-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-576"><a href="#cb101-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-577"><a href="#cb101-577" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D_abs <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb101-578"><a href="#cb101-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-579"><a href="#cb101-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-580"><a href="#cb101-580" aria-hidden="true" tabindex="-1"></a>Observe que como não há diferenças zeradas. Ou seja, o novo conjunto de dados continua o mesmo. O que pode ser confirmado, executando a função <span class="in">`str()`</span>:</span>
<span id="cb101-581"><a href="#cb101-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-584"><a href="#cb101-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-585"><a href="#cb101-585" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados1)</span>
<span id="cb101-586"><a href="#cb101-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-587"><a href="#cb101-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-588"><a href="#cb101-588" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Ordenar de forma crescente todos os valores da variável <span class="in">`D_abs`</span> do banco de dados <span class="in">`dados1`</span>, usando a função <span class="in">`arrange()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb101-589"><a href="#cb101-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-592"><a href="#cb101-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-593"><a href="#cb101-593" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dados1<span class="sc">$</span>D_abs)</span>
<span id="cb101-594"><a href="#cb101-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-595"><a href="#cb101-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-596"><a href="#cb101-596" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Estabelecer postos para os valores ordenados da variável <span class="in">`D_abs`</span>, do conjunto de dados <span class="in">`dados1`</span>, fazendo a média das ordens quando houver empate. A execução deste comando cria uma nova variável, chamada <span class="in">`postos`</span>:</span>
<span id="cb101-597"><a href="#cb101-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-600"><a href="#cb101-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-601"><a href="#cb101-601" aria-hidden="true" tabindex="-1"></a>dados1<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados1<span class="sc">$</span>D_abs)</span>
<span id="cb101-602"><a href="#cb101-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-603"><a href="#cb101-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-604"><a href="#cb101-604" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Estabelecer sinais para os postos, criando dois subconjuntos de dados do conjuntos dados1, um com os escolares com postos positivos (<span class="in">`pos`</span>) e outros com postos negativos(<span class="in">`neg`</span>):</span>
<span id="cb101-605"><a href="#cb101-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-608"><a href="#cb101-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-609"><a href="#cb101-609" aria-hidden="true" tabindex="-1"></a>neg <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb101-610"><a href="#cb101-610" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb101-611"><a href="#cb101-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-612"><a href="#cb101-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-613"><a href="#cb101-613" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Somar todos os postos (variável <span class="in">`posto`</span>) em cada um dos subconjuntos criados (<span class="in">`neg`</span> e <span class="in">`pos`</span>):</span>
<span id="cb101-614"><a href="#cb101-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-617"><a href="#cb101-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-618"><a href="#cb101-618" aria-hidden="true" tabindex="-1"></a>soma_neg <span class="ot">&lt;-</span> <span class="fu">sum</span>(neg<span class="sc">$</span>postos)</span>
<span id="cb101-619"><a href="#cb101-619" aria-hidden="true" tabindex="-1"></a>soma_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(pos<span class="sc">$</span>postos)</span>
<span id="cb101-620"><a href="#cb101-620" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (<span class="fu">c</span>(soma_neg, soma_pos))</span>
<span id="cb101-621"><a href="#cb101-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-622"><a href="#cb101-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-623"><a href="#cb101-623" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Atribuir a menor soma à estatística do teste, denotada *T*:</span>
<span id="cb101-624"><a href="#cb101-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-627"><a href="#cb101-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-628"><a href="#cb101-628" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">min</span> (soma_neg <span class="sc">:</span> soma_pos)</span>
<span id="cb101-629"><a href="#cb101-629" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb101-630"><a href="#cb101-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-631"><a href="#cb101-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-632"><a href="#cb101-632" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Para dados com tamanhos grandes (<span class="sc">\&gt;</span> 20 pares), a significância de *T* pode ser determinada [@zar2014wilcoxon], considerando que a distribuição de *T* tem aproximadamente distribuição normal com média igual a</span>
<span id="cb101-633"><a href="#cb101-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-634"><a href="#cb101-634" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-635"><a href="#cb101-635" aria-hidden="true" tabindex="-1"></a>\mu_{T} =\frac{n \times \left (n + 1  \right )}{4}</span>
<span id="cb101-636"><a href="#cb101-636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-637"><a href="#cb101-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-638"><a href="#cb101-638" aria-hidden="true" tabindex="-1"></a>onde *n* é o tamanho da amostra.</span>
<span id="cb101-639"><a href="#cb101-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-642"><a href="#cb101-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-643"><a href="#cb101-643" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(dados<span class="sc">$</span>D)</span>
<span id="cb101-644"><a href="#cb101-644" aria-hidden="true" tabindex="-1"></a>mu_T <span class="ot">&lt;-</span> (n <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb101-645"><a href="#cb101-645" aria-hidden="true" tabindex="-1"></a>mu_T</span>
<span id="cb101-646"><a href="#cb101-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-647"><a href="#cb101-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-648"><a href="#cb101-648" aria-hidden="true" tabindex="-1"></a>E desvio padrão igual a:</span>
<span id="cb101-649"><a href="#cb101-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-650"><a href="#cb101-650" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-651"><a href="#cb101-651" aria-hidden="true" tabindex="-1"></a>\sigma_{T}= \sqrt {\frac{n\left (n + 1  \right )\times \left (2n + 1  \right )}{24}}</span>
<span id="cb101-652"><a href="#cb101-652" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-653"><a href="#cb101-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-656"><a href="#cb101-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-657"><a href="#cb101-657" aria-hidden="true" tabindex="-1"></a>dp_T <span class="ot">&lt;-</span> <span class="fu">sqrt</span> ((n<span class="sc">*</span>(n <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span><span class="dv">24</span>) </span>
<span id="cb101-658"><a href="#cb101-658" aria-hidden="true" tabindex="-1"></a>dp_T</span>
<span id="cb101-659"><a href="#cb101-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-660"><a href="#cb101-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-661"><a href="#cb101-661" aria-hidden="true" tabindex="-1"></a>Os resultados da execução das equações fornecem os dados para calcular a estatística <span class="in">`Z_T`</span> com correção de continuidade e, a partir dela, calcular o valor *p*.</span>
<span id="cb101-662"><a href="#cb101-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-663"><a href="#cb101-663" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-664"><a href="#cb101-664" aria-hidden="true" tabindex="-1"></a>Z_{T}= \frac{\left |T - \mu_{T}  \right | - 0,5}{\sigma_{T}}</span>
<span id="cb101-665"><a href="#cb101-665" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-666"><a href="#cb101-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-669"><a href="#cb101-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-670"><a href="#cb101-670" aria-hidden="true" tabindex="-1"></a>Z_T <span class="ot">&lt;-</span> (<span class="fu">abs</span>(T <span class="sc">-</span> mu_T)<span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span>dp_T</span>
<span id="cb101-671"><a href="#cb101-671" aria-hidden="true" tabindex="-1"></a>Z_T</span>
<span id="cb101-672"><a href="#cb101-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-673"><a href="#cb101-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-674"><a href="#cb101-674" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Concluindo, o valor da estatística de teste *T* é superior ao $Z_{crítico} = 1,96$, para um $\alpha = 0,05$. Dessa forma, a $H_{0}$ é rejeitada. Existe uma diferença significativa entre o PFE basal e o PFE final, neste grupo de escolares asmáticos.</span>
<span id="cb101-675"><a href="#cb101-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-676"><a href="#cb101-676" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>O valor *p* pode ser obtido com a função <span class="in">`pnorm()`</span> e multiplicando o resultado por 2, pois o teste é bilateral.</span>
<span id="cb101-677"><a href="#cb101-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-680"><a href="#cb101-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-681"><a href="#cb101-681" aria-hidden="true" tabindex="-1"></a>valor_p <span class="ot">&lt;-</span> <span class="fu">pnorm</span> (Z_T, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb101-682"><a href="#cb101-682" aria-hidden="true" tabindex="-1"></a>valor_p</span>
<span id="cb101-683"><a href="#cb101-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-684"><a href="#cb101-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-685"><a href="#cb101-685" aria-hidden="true" tabindex="-1"></a>Como já dito anteriormente, na prática, não há necessidade de fazer todos esses cálculos, pois o R calcula facilmente o teste. Eles são apenas uma demonstração de como o teste funciona.</span>
<span id="cb101-686"><a href="#cb101-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-687"><a href="#cb101-687" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo do teste de Wilcoxon no R</span></span>
<span id="cb101-688"><a href="#cb101-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-689"><a href="#cb101-689" aria-hidden="true" tabindex="-1"></a>Usando o conjunto de dados no formato longo (<span class="in">`dadosL`</span>), calcula-se o teste com a função <span class="in">`wilcox_test()`</span> do pacote <span class="in">`rstatix`</span>. É a mesma função utilizada para o teste de U de Mann-Whitney, mudando apenas o argumento <span class="in">`paired=FALSE`</span> para <span class="in">`paired=TRUE`</span>:</span>
<span id="cb101-690"><a href="#cb101-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-693"><a href="#cb101-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-694"><a href="#cb101-694" aria-hidden="true" tabindex="-1"></a>teste1 <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb101-695"><a href="#cb101-695" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-696"><a href="#cb101-696" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span>()</span>
<span id="cb101-697"><a href="#cb101-697" aria-hidden="true" tabindex="-1"></a>teste1</span>
<span id="cb101-698"><a href="#cb101-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-699"><a href="#cb101-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-700"><a href="#cb101-700" aria-hidden="true" tabindex="-1"></a>Observe que o resultado é o mesmo calculado manualmente.</span>
<span id="cb101-701"><a href="#cb101-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-702"><a href="#cb101-702" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tamanho do efeito</span></span>
<span id="cb101-703"><a href="#cb101-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-704"><a href="#cb101-704" aria-hidden="true" tabindex="-1"></a>O tamanho do efeito pode ser calculado da mesma forma que para o teste de Mann-Whitney (@sec-tefMW), usando a mesma equação e os dados obtidos acima, onde <span class="in">`r Z_T`</span> e *n* = 10 tem-se</span>
<span id="cb101-705"><a href="#cb101-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-706"><a href="#cb101-706" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-707"><a href="#cb101-707" aria-hidden="true" tabindex="-1"></a>r = \frac {Z_{T}}{\sqrt{n}}</span>
<span id="cb101-708"><a href="#cb101-708" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-709"><a href="#cb101-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-710"><a href="#cb101-710" aria-hidden="true" tabindex="-1"></a>Pode-se usar também a função <span class="in">`wilcox_effsize()`</span> para calcular a estatística *r*. A Saída exibe junto a magnitude o efeito, que no caso é grande (<span class="sc">\&gt;</span> 0,5 como mostra a @tbl-wilcoxef do teste de Mann-Whitney).</span>
<span id="cb101-711"><a href="#cb101-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-714"><a href="#cb101-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-715"><a href="#cb101-715" aria-hidden="true" tabindex="-1"></a>dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb101-716"><a href="#cb101-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-717"><a href="#cb101-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-718"><a href="#cb101-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-719"><a href="#cb101-719" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb101-720"><a href="#cb101-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-721"><a href="#cb101-721" aria-hidden="true" tabindex="-1"></a>Assumindo um $\alpha = 0,05$, se o valor *p*, obtido pelo teste, for menor do que 0,05, rejeita-se a hipótese nula (V = 2, *p* = 0,01, *n* = 10).</span>
<span id="cb101-722"><a href="#cb101-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-723"><a href="#cb101-723" aria-hidden="true" tabindex="-1"></a>Pode-se concluir que existe diferença nas medidas do pico de fluxo expiratório máximo no início e no fim do programa de exercícios aeróbicos realizados pelos escolares asmáticos e a magnitude do efeito foi grande (*r* = 0,82).</span>
<span id="cb101-724"><a href="#cb101-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-725"><a href="#cb101-725" aria-hidden="true" tabindex="-1"></a>Isto pode ser visualizado na @fig-aero2:</span>
<span id="cb101-726"><a href="#cb101-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-729"><a href="#cb101-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-730"><a href="#cb101-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-aero2</span></span>
<span id="cb101-731"><a href="#cb101-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-732"><a href="#cb101-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-733"><a href="#cb101-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-734"><a href="#cb101-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-735"><a href="#cb101-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-736"><a href="#cb101-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos"</span></span>
<span id="cb101-737"><a href="#cb101-737" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb101-738"><a href="#cb101-738" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb101-739"><a href="#cb101-739" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb101-740"><a href="#cb101-740" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-741"><a href="#cb101-741" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-742"><a href="#cb101-742" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb101-743"><a href="#cb101-743" aria-hidden="true" tabindex="-1"></a>                         <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb101-744"><a href="#cb101-744" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-745"><a href="#cb101-745" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb101-746"><a href="#cb101-746" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb101-747"><a href="#cb101-747" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>) <span class="sc">+</span></span>
<span id="cb101-748"><a href="#cb101-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb101-749"><a href="#cb101-749" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb101-750"><a href="#cb101-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-751"><a href="#cb101-751" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb101-752"><a href="#cb101-752" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span> (medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-753"><a href="#cb101-753" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span> ()</span>
<span id="cb101-754"><a href="#cb101-754" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> teste <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span> ()</span>
<span id="cb101-755"><a href="#cb101-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-756"><a href="#cb101-756" aria-hidden="true" tabindex="-1"></a>bxp <span class="sc">+</span> </span>
<span id="cb101-757"><a href="#cb101-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span> (teste, </span>
<span id="cb101-758"><a href="#cb101-758" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb101-759"><a href="#cb101-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">subtitle =</span> <span class="fu">get_test_label</span> (<span class="at">stat.test =</span> teste, </span>
<span id="cb101-760"><a href="#cb101-760" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb101-761"><a href="#cb101-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-762"><a href="#cb101-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-763"><a href="#cb101-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teste de Kruskal-Wallis {#sec-kruskalwallis}</span></span>
<span id="cb101-764"><a href="#cb101-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-765"><a href="#cb101-765" aria-hidden="true" tabindex="-1"></a>Quando os pressupostos subjacentes à ANOVA não são atendidos, é possível usar o teste não paramétrico de Kruskal-Wallis (KW) para testar a hipótese de que os parâmetros de localização são iguais. Pode ser considerado uma extensão do teste de Wilcoxon-Mann-Whitney.</span>
<span id="cb101-766"><a href="#cb101-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-767"><a href="#cb101-767" aria-hidden="true" tabindex="-1"></a>Enquanto a ANOVA depende da hipótese de que todas as populações são independentes e com resíduos normalmente distribuídos, o teste de Kruskal-Wallis exige apenas amostras aleatórias independentes provenientes de suas respectivas populações. Entretanto, este teste somente deve ser aplicado se a amostra for pequena e/ou os pressupostos para a ANOVA forem seriamente violados.</span>
<span id="cb101-768"><a href="#cb101-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-769"><a href="#cb101-769" aria-hidden="true" tabindex="-1"></a>O teste não usa diretamente medições de quantidade conhecida, utiliza, como outros testes não paramétricos, os postos dos valores analisados. Em função disso, é também conhecido como *análise de variância de um fator em postos*.</span>
<span id="cb101-770"><a href="#cb101-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-771"><a href="#cb101-771" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados no exemplo</span></span>
<span id="cb101-772"><a href="#cb101-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-773"><a href="#cb101-773" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb101-774"><a href="#cb101-774" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb101-775"><a href="#cb101-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-776"><a href="#cb101-776" aria-hidden="true" tabindex="-1"></a>Um experimento foi realizado para verificar se o álcool ou o café afetam os tempos de reação ao dirigir <span class="co">[</span><span class="ot">@karadimitriou2020kruskal</span><span class="co">]</span>. O estudo tem três grupos diferentes de participantes: 10 bebendo água (controle), 10 bebendo cerveja contendo duas unidades de álcool<span class="ot">[^20-testes-naoparametricos-3]</span> e 10 bebendo café. O tempo de reação em uma simulação de direção foi medido para cada participante.</span>
<span id="cb101-777"><a href="#cb101-777" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb101-778"><a href="#cb101-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-779"><a href="#cb101-779" aria-hidden="true" tabindex="-1"></a><span class="ot">[^20-testes-naoparametricos-3]: </span>Para calcular as unidades de álcool, multiplique o volume da bebida (em mililitros) pelo teor alcoólico (ABV, do inglês *Alcohol by Volume*) e divida o resultado por 1000.</span>
<span id="cb101-780"><a href="#cb101-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-781"><a href="#cb101-781" aria-hidden="true" tabindex="-1"></a>Os dados encontram-se no arquivo <span class="in">`dadosResposta.xlsx`</span>. Clique <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosResposta.xlsx)</span> para baixar e, após, salve o mesmo no seu diretório de trabalho.</span>
<span id="cb101-782"><a href="#cb101-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-783"><a href="#cb101-783" aria-hidden="true" tabindex="-1"></a>As variáveis são:</span>
<span id="cb101-784"><a href="#cb101-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-785"><a href="#cb101-785" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**id** $\to$ identificação do participante;</span>
<span id="cb101-786"><a href="#cb101-786" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**tempo** $\to$ tempo de reação na simulação de direção em segundos;</span>
<span id="cb101-787"><a href="#cb101-787" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**bebida** $\to$ três grupo: água, álcool e café.</span>
<span id="cb101-788"><a href="#cb101-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-789"><a href="#cb101-789" aria-hidden="true" tabindex="-1"></a>O estudo pretende verificar se existe diferença no tempo de reação dos participantes em um teste de direção com a ingesta de água, café e álcool.</span>
<span id="cb101-790"><a href="#cb101-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-791"><a href="#cb101-791" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Leitura e exploração dos dados</span></span>
<span id="cb101-792"><a href="#cb101-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-793"><a href="#cb101-793" aria-hidden="true" tabindex="-1"></a>Como o dados estão contidos em um arquivo Excel (*.xlsx*), serão lidos com a função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span> e a sua estrutura será observada com função <span class="in">`str()`</span>:</span>
<span id="cb101-794"><a href="#cb101-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-797"><a href="#cb101-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-798"><a href="#cb101-798" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosResposta.xlsx"</span>)</span>
<span id="cb101-799"><a href="#cb101-799" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span>
<span id="cb101-800"><a href="#cb101-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-801"><a href="#cb101-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-802"><a href="#cb101-802" aria-hidden="true" tabindex="-1"></a>O formato do arquivo é o longo. A variável bebida encontra-se como caracter e deve ser transformada em fator e as categorias na sequência: <span class="in">`agua`</span>, <span class="in">`cafe`</span> e <span class="in">`alcool`</span>.</span>
<span id="cb101-803"><a href="#cb101-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-806"><a href="#cb101-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-807"><a href="#cb101-807" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>bebida <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>bebida, </span>
<span id="cb101-808"><a href="#cb101-808" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"agua"</span>, <span class="st">"cafe"</span>, <span class="st">"alcool"</span>))</span>
<span id="cb101-809"><a href="#cb101-809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-810"><a href="#cb101-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-811"><a href="#cb101-811" aria-hidden="true" tabindex="-1"></a>Os dados serão observados visualmente através de boxplots (@fig-bebida), usando a função <span class="in">`ggplot()`</span> do pacote <span class="in">`ggplot2`</span>, com cores do <span class="in">`nejm`</span> (*New England Journal of Medicine*) o pacote <span class="in">`ggsci`</span>.</span>
<span id="cb101-812"><a href="#cb101-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-815"><a href="#cb101-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-816"><a href="#cb101-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bebida</span></span>
<span id="cb101-817"><a href="#cb101-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-818"><a href="#cb101-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-819"><a href="#cb101-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-820"><a href="#cb101-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-821"><a href="#cb101-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-822"><a href="#cb101-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto do tipo de bebida no tempo de reação ao dirigir"</span></span>
<span id="cb101-823"><a href="#cb101-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-824"><a href="#cb101-824" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb101-825"><a href="#cb101-825" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb101-826"><a href="#cb101-826" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb101-827"><a href="#cb101-827" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> T,</span>
<span id="cb101-828"><a href="#cb101-828" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-829"><a href="#cb101-829" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb101-830"><a href="#cb101-830" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb101-831"><a href="#cb101-831" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-832"><a href="#cb101-832" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb101-833"><a href="#cb101-833" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tipo de bebida"</span> ,</span>
<span id="cb101-834"><a href="#cb101-834" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de reação (seg)"</span>) <span class="sc">+</span></span>
<span id="cb101-835"><a href="#cb101-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb101-836"><a href="#cb101-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-837"><a href="#cb101-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-838"><a href="#cb101-838" aria-hidden="true" tabindex="-1"></a>Os boxplots exibem dados com medianas visualmente diferentes, bigodes diferentes e grupos com presença de *outliers*. Para verificar o impacto desses achados, pode-se usar a função `identify_outliers()`, do pacote `rstatix` que confirma, na sua Saída, a presença de *outliers* no grupo <span class="in">`agua`</span> e <span class="in">`cafe`</span>, sendo dois extremos.</span>
<span id="cb101-839"><a href="#cb101-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-842"><a href="#cb101-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-843"><a href="#cb101-843" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-844"><a href="#cb101-844" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb101-845"><a href="#cb101-845" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(tempo)</span>
<span id="cb101-846"><a href="#cb101-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-847"><a href="#cb101-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-848"><a href="#cb101-848" aria-hidden="true" tabindex="-1"></a>Para avaliar a normalidade será usado o teste de Shapiro-Wilk, com a função <span class="in">`shapiro_test()`</span> e a função <span class="in">`group_by()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb101-849"><a href="#cb101-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-852"><a href="#cb101-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-853"><a href="#cb101-853" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-854"><a href="#cb101-854" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span> (bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb101-855"><a href="#cb101-855" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span> (tempo) </span>
<span id="cb101-856"><a href="#cb101-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-857"><a href="#cb101-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-858"><a href="#cb101-858" aria-hidden="true" tabindex="-1"></a>A variável <span class="in">`cafe`</span> tem uma distribuição que não se ajusta a distribuição normal.</span>
<span id="cb101-859"><a href="#cb101-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-860"><a href="#cb101-860" aria-hidden="true" tabindex="-1"></a>Para completar a exploração dos dados, será solicitado, usando as funções <span class="in">`group_by ()`</span> e <span class="in">`summarise`</span>, do pacote <span class="in">`dplyr`</span>, medidas de localização e dispersão adquadas para variáveis bem assimétricas.</span>
<span id="cb101-861"><a href="#cb101-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-864"><a href="#cb101-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-865"><a href="#cb101-865" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-866"><a href="#cb101-866" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb101-867"><a href="#cb101-867" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb101-868"><a href="#cb101-868" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-869"><a href="#cb101-869" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-870"><a href="#cb101-870" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb101-871"><a href="#cb101-871" aria-hidden="true" tabindex="-1"></a>resumo</span>
<span id="cb101-872"><a href="#cb101-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-873"><a href="#cb101-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-874"><a href="#cb101-874" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hipóteses estatísticas</span></span>
<span id="cb101-875"><a href="#cb101-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-876"><a href="#cb101-876" aria-hidden="true" tabindex="-1"></a>Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</span>
<span id="cb101-877"><a href="#cb101-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-878"><a href="#cb101-878" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: As populações são iguais.</span></span>
<span id="cb101-879"><a href="#cb101-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-880"><a href="#cb101-880" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: Pelo menos uma das populações tende a exibir valores diferentes do que as outras populações.</span></span>
<span id="cb101-881"><a href="#cb101-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-882"><a href="#cb101-882" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pressupostos do teste</span></span>
<span id="cb101-883"><a href="#cb101-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-884"><a href="#cb101-884" aria-hidden="true" tabindex="-1"></a>O teste de Kruskal-Wallis pressupõe as seguintes condições para o seu adequado uso:</span>
<span id="cb101-885"><a href="#cb101-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-886"><a href="#cb101-886" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>As amostras são amostras aleatórias independentes de suas respectivas populações;</span>
<span id="cb101-887"><a href="#cb101-887" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>A escala de medição utilizada é pelo menos ordinal e, se houver apenas três grupos, deve haver pelo menos 5 casos em cada grupo;</span>
<span id="cb101-888"><a href="#cb101-888" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>As distribuições dos valores nas populações amostradas são idênticas, exceto pela possibilidade de que uma ou mais das populações sejam compostas por valores que tendem a ser maiores do que os das outras populações.</span>
<span id="cb101-889"><a href="#cb101-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-890"><a href="#cb101-890" aria-hidden="true" tabindex="-1"></a><span class="fu">### Execução do teste estatístico</span></span>
<span id="cb101-891"><a href="#cb101-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-892"><a href="#cb101-892" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lógica do teste de Kruskall-Wallis</span></span>
<span id="cb101-893"><a href="#cb101-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-894"><a href="#cb101-894" aria-hidden="true" tabindex="-1"></a>A teoria do teste Kruskal-Wallis é semelhante à do teste de Mann-Whitney, ou seja, tem como base a soma dos postos. Em primeiro lugar, os escores são ordenados do menor para o maior, independentemente do grupo que pertençam.</span>
<span id="cb101-895"><a href="#cb101-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-896"><a href="#cb101-896" aria-hidden="true" tabindex="-1"></a>O menor recebe o posto 1 e assim por diante. Após a atribuição dos postos, soma-se os postos por grupo. A soma dos postos de cada grupo é representada por $R_{1}$, $R_{2}$, $R_{3}$, ..., $R_{i}$. A estatística do teste, *H*, é calculada com a equação <span class="co">[</span><span class="ot">@zar2014kruskal</span><span class="co">]</span>:</span>
<span id="cb101-897"><a href="#cb101-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-898"><a href="#cb101-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-899"><a href="#cb101-899" aria-hidden="true" tabindex="-1"></a>H =\frac {12}{N \times \left (N + 1  \right )} \sum_{i=1}^{k} \frac {R_{i}^{2}}{n_{{i}}}-3 \times\left (N + 1\right)</span>
<span id="cb101-900"><a href="#cb101-900" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-901"><a href="#cb101-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-902"><a href="#cb101-902" aria-hidden="true" tabindex="-1"></a>onde $n_{i}$ é o número de observações no grupo *i*, $N = \sum_{i=1}^{k}\times n_{i}$ (o número total de observações em todos os *k* grupos) e $R_{i}$ é a soma dos postos das $n_{i}$ observações no grupo *i*.</span>
<span id="cb101-903"><a href="#cb101-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-904"><a href="#cb101-904" aria-hidden="true" tabindex="-1"></a>Uma boa verificação (mas não uma garantia) de que os postos foram atribuídos corretamente é ver se a soma de todos os postos é igual a $\frac {N \times \left (N + 1\right )}{2}$.</span>
<span id="cb101-905"><a href="#cb101-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-906"><a href="#cb101-906" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Criar a variável <span class="in">`posto`</span> com os postos ordenados de forma crescente, independente do grupo, como realizado no teste de Mann-Whitney:</span>
<span id="cb101-907"><a href="#cb101-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-910"><a href="#cb101-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-911"><a href="#cb101-911" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>posto <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados<span class="sc">$</span>tempo, <span class="at">ties.method =</span> <span class="st">"average"</span>)</span>
<span id="cb101-912"><a href="#cb101-912" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span>
<span id="cb101-913"><a href="#cb101-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-914"><a href="#cb101-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-915"><a href="#cb101-915" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Somar os postos de cada grupo separadamente:</span>
<span id="cb101-916"><a href="#cb101-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-919"><a href="#cb101-919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-920"><a href="#cb101-920" aria-hidden="true" tabindex="-1"></a>resumo1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-921"><a href="#cb101-921" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb101-922"><a href="#cb101-922" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb101-923"><a href="#cb101-923" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(posto))</span>
<span id="cb101-924"><a href="#cb101-924" aria-hidden="true" tabindex="-1"></a>resumo1</span>
<span id="cb101-925"><a href="#cb101-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-926"><a href="#cb101-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-927"><a href="#cb101-927" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Cálculo da estatística do teste *H*</span>
<span id="cb101-928"><a href="#cb101-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-931"><a href="#cb101-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-932"><a href="#cb101-932" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb101-933"><a href="#cb101-933" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb101-934"><a href="#cb101-934" aria-hidden="true" tabindex="-1"></a>R_agua <span class="ot">&lt;-</span> resumo1[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb101-935"><a href="#cb101-935" aria-hidden="true" tabindex="-1"></a>R_alcool <span class="ot">&lt;-</span> resumo1[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb101-936"><a href="#cb101-936" aria-hidden="true" tabindex="-1"></a>R_cafe <span class="ot">&lt;-</span> resumo1[<span class="dv">3</span>,<span class="dv">3</span>]</span>
<span id="cb101-937"><a href="#cb101-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-938"><a href="#cb101-938" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> (<span class="dv">12</span><span class="sc">/</span>(N<span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">*</span> ((R_agua<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_alcool<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_cafe<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n)) <span class="sc">-</span> (<span class="dv">3</span><span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb101-939"><a href="#cb101-939" aria-hidden="true" tabindex="-1"></a>H</span>
<span id="cb101-940"><a href="#cb101-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-941"><a href="#cb101-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-942"><a href="#cb101-942" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Cálculo do Valor *p*</span>
<span id="cb101-943"><a href="#cb101-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-944"><a href="#cb101-944" aria-hidden="true" tabindex="-1"></a>Se existir três grupos, com cinco ou menos participantes em cada grupo, há necessidade de usar a tabela especial para tamanhos de amostra pequenos <span class="co">[</span><span class="ot">@gopal2006table</span><span class="co">]</span>. Se você tiver mais de cinco participantes por grupo, trate *H* como qui-quadrado. A estatística *H* é estatisticamente significativo se for igual ou maior que o valor crítico qui-quadrado para o grau de liberdade específico, igual a $k - 1$. Aqui, tem-se 10 participantes por grupo e, assumindo um $\alpha = 0,05$, o $H_{crítico}$ é igual a:</span>
<span id="cb101-945"><a href="#cb101-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-948"><a href="#cb101-948" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-949"><a href="#cb101-949" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb101-950"><a href="#cb101-950" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb101-951"><a href="#cb101-951" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb101-952"><a href="#cb101-952" aria-hidden="true" tabindex="-1"></a>H_critico <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, gl)</span>
<span id="cb101-953"><a href="#cb101-953" aria-hidden="true" tabindex="-1"></a>H_critico</span>
<span id="cb101-954"><a href="#cb101-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-955"><a href="#cb101-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-956"><a href="#cb101-956" aria-hidden="true" tabindex="-1"></a>Uma vez que o $H_{calculado} = 16,3$ é maior que $H_{crítico} = 6,0$ , rejeita-se a $H_{0}$. O valor *P* é obtido através da função <span class="in">`pchisq()`</span>:</span>
<span id="cb101-957"><a href="#cb101-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-960"><a href="#cb101-960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-961"><a href="#cb101-961" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fl">16.32</span></span>
<span id="cb101-962"><a href="#cb101-962" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(H, <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb101-963"><a href="#cb101-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-964"><a href="#cb101-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-965"><a href="#cb101-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-966"><a href="#cb101-966" aria-hidden="true" tabindex="-1"></a>O R tem funções que fazem facilmente esses cálculos enfadonhos. Eles são colocados aqui apenas para ilustrar o raciocínio de como o teste de Kruskal-Wallis funciona. Sempre existem curiosos lendo o livro!</span>
<span id="cb101-967"><a href="#cb101-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-968"><a href="#cb101-968" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Teste de Kruskal-Wallis no R</span></span>
<span id="cb101-969"><a href="#cb101-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-970"><a href="#cb101-970" aria-hidden="true" tabindex="-1"></a>No R, pode-se calcular o teste, usando a função <span class="in">`kruskal_test()`</span> do pacote <span class="in">`rstatix`</span>, cujos argumentos podem ser consultados na ajuda do *RStudio*.</span>
<span id="cb101-971"><a href="#cb101-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-974"><a href="#cb101-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-975"><a href="#cb101-975" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">kruskal_test</span> (<span class="at">data =</span> dados, <span class="at">formula =</span> tempo <span class="sc">~</span> bebida)</span>
<span id="cb101-976"><a href="#cb101-976" aria-hidden="true" tabindex="-1"></a>teste</span>
<span id="cb101-977"><a href="#cb101-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-978"><a href="#cb101-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-979"><a href="#cb101-979" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tamanho do efeito</span></span>
<span id="cb101-980"><a href="#cb101-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-981"><a href="#cb101-981" aria-hidden="true" tabindex="-1"></a>O eta quadrado ($\eta^{2}$), com base na estatística *H*, pode ser usado como a medida do tamanho do efeito do teste de Kruskal-Wallis. É calculado pela equação:</span>
<span id="cb101-982"><a href="#cb101-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-983"><a href="#cb101-983" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-984"><a href="#cb101-984" aria-hidden="true" tabindex="-1"></a>\eta_{H}^{2} = \frac {\left (H - k + 1 \right)}{\left (N - k\right)}</span>
<span id="cb101-985"><a href="#cb101-985" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb101-986"><a href="#cb101-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-987"><a href="#cb101-987" aria-hidden="true" tabindex="-1"></a>onde *H* é a estatística obtida no teste de Kruskal-Wallis; *k* é o número de grupos; N é o número total de observações <span class="co">[</span><span class="ot">@tomczak2014need</span><span class="co">]</span>.</span>
<span id="cb101-988"><a href="#cb101-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-989"><a href="#cb101-989" aria-hidden="true" tabindex="-1"></a>A estimativa eta ao quadrado assume valores de 0 a 1 e, multiplicada por 100, indica a porcentagem de variância na variável dependente explicada pela variável independente. Pode ser obtido no R com a função <span class="in">`kruskal_effsize()`</span> do pacote <span class="in">`rstatix:`</span></span>
<span id="cb101-990"><a href="#cb101-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-993"><a href="#cb101-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-994"><a href="#cb101-994" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> <span class="fu">kruskal_effsize</span> (tempo<span class="sc">~</span>bebida)</span>
<span id="cb101-995"><a href="#cb101-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-996"><a href="#cb101-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-997"><a href="#cb101-997" aria-hidden="true" tabindex="-1"></a>Um efeito $\ge 0,14$ é considerado grande e $&lt;0,06$ é pequeno <span class="co">[</span><span class="ot">@watson2021effectsize</span><span class="co">]</span>.</span>
<span id="cb101-998"><a href="#cb101-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-999"><a href="#cb101-999" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testes post hoc</span></span>
<span id="cb101-1000"><a href="#cb101-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1001"><a href="#cb101-1001" aria-hidden="true" tabindex="-1"></a>A partir do resultado do teste de Kruskal-Wallis, sabe-se que há uma diferença significativa entre os grupos, mas não se sabe quais pares de grupos são diferentes.</span>
<span id="cb101-1002"><a href="#cb101-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1003"><a href="#cb101-1003" aria-hidden="true" tabindex="-1"></a>Um teste de Kruskal-Wallis significativo é geralmente seguido pelo teste de Dunn <span class="co">[</span><span class="ot">@dunn1964multiple</span><span class="co">]</span> para identificar quais grupos são diferentes.</span>
<span id="cb101-1004"><a href="#cb101-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1005"><a href="#cb101-1005" aria-hidden="true" tabindex="-1"></a>Para realizar as múltiplas comparações, no R, pode ser usada a função <span class="in">`dunn_test()`</span>, incluído no pacote <span class="in">`rstatix`</span>. O ajuste de *P* é feito pelo método de Bonferroni:</span>
<span id="cb101-1006"><a href="#cb101-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1009"><a href="#cb101-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-1010"><a href="#cb101-1010" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb101-1011"><a href="#cb101-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunn_test</span> (tempo <span class="sc">~</span> bebida, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb101-1012"><a href="#cb101-1012" aria-hidden="true" tabindex="-1"></a>pwc</span>
<span id="cb101-1013"><a href="#cb101-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb101-1014"><a href="#cb101-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1015"><a href="#cb101-1015" aria-hidden="true" tabindex="-1"></a>A saída do teste de Dunn, mostra que existe uma diferença estatisticamente significativa apenas entre a água e o álcool, valor *p* ajustado igual a <span class="in">`r round(pwc$p.adj[2],6)`</span>.</span>
<span id="cb101-1016"><a href="#cb101-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1017"><a href="#cb101-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb101-1018"><a href="#cb101-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1019"><a href="#cb101-1019" aria-hidden="true" tabindex="-1"></a>Um teste de Kruskal-Wallis foi realizado para comparar os tempos de reação em uma simulação de direção após beber água, café ou álcool. Houve evidência de uma diferença (*p* = 0,00029) de pelo menos um par de grupos (@fig-bebida1).</span>
<span id="cb101-1020"><a href="#cb101-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1021"><a href="#cb101-1021" aria-hidden="true" tabindex="-1"></a>O teste de comparações de pares, usando o teste de Dunn, foi realizado para os três pares de grupos. Houve evidencia de diferença entre o grupo que consumiu duas unidades de álcool e o grupo que ingeriu água (*p* ajustado (Bonferroni) = 0,00016). Entre os demais pares não houve diferença significativa. O tempo mediano de reação para o grupo que recebeu água foi de 0,84 (0,65 – 0,94) segundos, em comparação com 2,25(1,77 – 2,85) segundos no grupo que bebeu cerveja equivalente a duas unidades de álcool, enquanto para o café foi de 1,45(1,28 – 1,69) segundos.</span>
<span id="cb101-1022"><a href="#cb101-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1025"><a href="#cb101-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb101-1026"><a href="#cb101-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bebida1</span></span>
<span id="cb101-1027"><a href="#cb101-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb101-1028"><a href="#cb101-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb101-1029"><a href="#cb101-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb101-1030"><a href="#cb101-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb101-1031"><a href="#cb101-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb101-1032"><a href="#cb101-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Impacto do tipo de bebida no tempo de reação ao dirigir"</span></span>
<span id="cb101-1033"><a href="#cb101-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1034"><a href="#cb101-1034" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> pwc <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span>(<span class="at">x=</span> <span class="st">"bebida"</span>)</span>
<span id="cb101-1035"><a href="#cb101-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-1036"><a href="#cb101-1036" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb101-1037"><a href="#cb101-1037" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb101-1038"><a href="#cb101-1038" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb101-1039"><a href="#cb101-1039" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-1040"><a href="#cb101-1040" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb101-1041"><a href="#cb101-1041" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb101-1042"><a href="#cb101-1042" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb101-1043"><a href="#cb101-1043" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb101-1044"><a href="#cb101-1044" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())<span class="sc">+</span></span>
<span id="cb101-1045"><a href="#cb101-1045" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span> (pwc,</span>
<span id="cb101-1046"><a href="#cb101-1046" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label =</span> <span class="st">"p = {scales::pvalue(p.adj)}"</span>,</span>
<span id="cb101-1047"><a href="#cb101-1047" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label.size =</span> <span class="fl">3.2</span>,</span>
<span id="cb101-1048"><a href="#cb101-1048" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hide.ns =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb101-1049"><a href="#cb101-1049" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tipo de bebida"</span>, </span>
<span id="cb101-1050"><a href="#cb101-1050" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Tempo de reação (seg)"</span>,</span>
<span id="cb101-1051"><a href="#cb101-1051" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-1052"><a href="#cb101-1052" aria-hidden="true" tabindex="-1"></a>                <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc))</span>
<span id="cb101-1053"><a href="#cb101-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar para a área de transferência" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>