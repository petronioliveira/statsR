<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>24&nbsp; Regressão Logística Binária – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./referencias.html" rel="next">
<link href="./23-sobrevida.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21-testesDiag.html">Parte IX - Bioestatística Aplicada à Epidemiologia</a></li><li class="breadcrumb-item"><a href="./24-reglogbin.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I - Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II - Ambiente Computacional com R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-introducaoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introdução ao uso do R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando dados no R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III - Estatística Descritiva</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-medidasResumidoras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Medidas Resumidoras</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tabelas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tabelas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gráficos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV - Probabilidades e Distribuições</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-assimetria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte V - Inferência Estatística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VI - Testes Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VII - Relações entre Variáveis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-correlacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VIII - Métodos Não Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dadoscategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-testes-naoParametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IX - Bioestatística Aplicada à Epidemiologia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-testesDiag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-medidasOcorrencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sobrevida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-reglogbin.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários-neste-capítulo" id="toc-pacotes-necessários-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-necessários-neste-capítulo"><span class="header-section-number">24.1</span> Pacotes necessários neste capítulo</a></li>
  <li><a href="#introduçao" id="toc-introduçao" class="nav-link" data-scroll-target="#introduçao"><span class="header-section-number">24.2</span> Introduçao</a></li>
  <li><a href="#sec-logisticfunction" id="toc-sec-logisticfunction" class="nav-link" data-scroll-target="#sec-logisticfunction"><span class="header-section-number">24.3</span> Função Logistica ou Função logit</a></li>
  <li><a href="#dados-para-o-exemplo" id="toc-dados-para-o-exemplo" class="nav-link" data-scroll-target="#dados-para-o-exemplo"><span class="header-section-number">24.4</span> Dados para o exemplo</a>
  <ul class="collapse">
  <li><a href="#leitura-dos-dados" id="toc-leitura-dos-dados" class="nav-link" data-scroll-target="#leitura-dos-dados"><span class="header-section-number">24.4.1</span> Leitura dos dados</a></li>
  <li><a href="#explorando-e-preparando-os-dados" id="toc-explorando-e-preparando-os-dados" class="nav-link" data-scroll-target="#explorando-e-preparando-os-dados"><span class="header-section-number">24.4.2</span> Explorando e preparando os dados</a></li>
  </ul></li>
  <li><a href="#construção-do-modelo-de-regressão-logística" id="toc-construção-do-modelo-de-regressão-logística" class="nav-link" data-scroll-target="#construção-do-modelo-de-regressão-logística"><span class="header-section-number">24.5</span> Construção do modelo de Regressão Logística</a>
  <ul class="collapse">
  <li><a href="#modelos-de-regressão-logística" id="toc-modelos-de-regressão-logística" class="nav-link" data-scroll-target="#modelos-de-regressão-logística"><span class="header-section-number">24.5.1</span> Modelos de Regressão Logística</a></li>
  </ul></li>
  <li><a href="#seleção-do-modelo" id="toc-seleção-do-modelo" class="nav-link" data-scroll-target="#seleção-do-modelo"><span class="header-section-number">24.6</span> Seleção do Modelo</a>
  <ul class="collapse">
  <li><a href="#deviance" id="toc-deviance" class="nav-link" data-scroll-target="#deviance"><span class="header-section-number">24.6.1</span> Deviance</a></li>
  <li><a href="#aic-akaike-information-criterion" id="toc-aic-akaike-information-criterion" class="nav-link" data-scroll-target="#aic-akaike-information-criterion"><span class="header-section-number">24.6.2</span> AIC (Akaike Information Criterion)</a></li>
  <li><a href="#modelo-4-interação" id="toc-modelo-4-interação" class="nav-link" data-scroll-target="#modelo-4-interação"><span class="header-section-number">24.6.3</span> Modelo 4: Interação</a></li>
  <li><a href="#multicolinearidade" id="toc-multicolinearidade" class="nav-link" data-scroll-target="#multicolinearidade"><span class="header-section-number">24.6.4</span> Multicolinearidade</a></li>
  </ul></li>
  <li><a href="#avaliação-preditiva-com-os-dados-de-teste" id="toc-avaliação-preditiva-com-os-dados-de-teste" class="nav-link" data-scroll-target="#avaliação-preditiva-com-os-dados-de-teste"><span class="header-section-number">24.7</span> Avaliação preditiva com os dados de teste</a>
  <ul class="collapse">
  <li><a href="#qualidade-do-modelo" id="toc-qualidade-do-modelo" class="nav-link" data-scroll-target="#qualidade-do-modelo"><span class="header-section-number">24.7.1</span> Qualidade do modelo</a></li>
  <li><a href="#auc-e-curva-roc" id="toc-auc-e-curva-roc" class="nav-link" data-scroll-target="#auc-e-curva-roc"><span class="header-section-number">24.7.2</span> AUC e curva ROC</a></li>
  <li><a href="#comparar-duas-curvas-roc-treino-vs-teste" id="toc-comparar-duas-curvas-roc-treino-vs-teste" class="nav-link" data-scroll-target="#comparar-duas-curvas-roc-treino-vs-teste"><span class="header-section-number">24.7.3</span> Comparar duas curvas ROC (treino vs teste)</a></li>
  </ul></li>
  <li><a href="#relato-dos-resultados" id="toc-relato-dos-resultados" class="nav-link" data-scroll-target="#relato-dos-resultados"><span class="header-section-number">24.8</span> Relato dos resultados</a></li>
  <li><a href="#exercícios" id="toc-exercícios" class="nav-link" data-scroll-target="#exercícios"><span class="header-section-number">24.9</span> Exercícios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21-testesDiag.html">Parte IX - Bioestatística Aplicada à Epidemiologia</a></li><li class="breadcrumb-item"><a href="./24-reglogbin.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários-neste-capítulo" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="pacotes-necessários-neste-capítulo"><span class="header-section-number">24.1</span> Pacotes necessários neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Amelia, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               caret, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               corrplot,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               flextable,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               ggplot2,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               gtsummary,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               performance,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               pROC,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>               quesrionr,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               sjPlot)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduçao" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="introduçao"><span class="header-section-number">24.2</span> Introduçao</h2>
<p>Os dois tipos de regressão mais comuns são a <strong>regressão linear</strong> e a <strong>regressão logística</strong>. A regressão linear é utilizada quando a variável dependente é <strong>quantitativa e contínua</strong>, enquanto a regressão logística é utilizada quando a variável dependente é <strong>qualitativa (categórica)</strong>.</p>
<p>A <strong>regressão logística binária</strong> é utilizada quando o objetivo é estimar a <strong>probabilidade</strong> de um indivíduo pertencer a uma das duas categorias possíveis (o desfecho binário, 0 ou 1), dada uma ou mais variáveis independentes ou preditoras (de qualquer tipo). A regressão logística binária é uma abordagem classificatória que estima a relação entre uma <strong>variável dependente dicotômica</strong> e um conjunto de preditores. Foi desenvolvida, em 1958, como um a extensão do modelo linear pelo estatístico britânico David Cox <span class="citation" data-cites="cox1958regression">(<a href="referencias.html#ref-cox1958regression" role="doc-biblioref">Cox 1958</a>)</span>. Pertence a uma família, denominada <em>Modelo Linear Generalizado</em> (GLM).</p>
</section>
<section id="sec-logisticfunction" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="sec-logisticfunction"><span class="header-section-number">24.3</span> Função Logistica ou Função logit</h2>
<p>A regressão linear simples (RLS) estima a relação entre uma <strong>variável dependente</strong> <strong>quantitativa contínua (Y)</strong> e uma <strong>variável explicativa contínua</strong> <strong>(X)</strong>. Por exemplo, a relação entre o <strong>Comprimento (Y)</strong> e a <strong>Idade (X)</strong> de crianças é estimada pelo método dos <em>Mínimos Quadrados Ordinários</em> (MQO) e descrita pela equação da reta de regressão. Esta reta tenta predizer a variável resposta contínua a partir de uma variável preditora também contínua (<a href="#fig-reglinear" class="quarto-xref">Figura&nbsp;<span>24.1</span></a>).</p>
<p><span class="math display">\[
y = \beta_{0} + \beta_{1} \times x
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-reglinear" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reglinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/rNwzZIq.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reglinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.1: Regressão Linear Simples
</figcaption>
</figure>
</div>
</div>
</div>
<p><u>Limitação da RLS para Desfechos Binários</u></p>
<p>Agora, se o objetivo é estimar o impacto da idade de um paciente na probabilidade de ele ter ou não um determinado desfecho (por exemplo, uma doença). A <code>idade</code> é uma variável preditora contínua, mas o desfecho (<code>doença</code>) é uma variável categórica dicotômica, assumindo apenas os valores 0 (não) e 1 (sim) (<a href="#fig-outcomebin" class="quarto-xref">Figura&nbsp;<span>24.2</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-outcomebin" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-outcomebin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/WrDPQNQ.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outcomebin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.2: Relação de uma variável desfecho dicotômica e uma variável preditora contínua.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Se for ajustada uma reta de regressão aos pontos usando o método dos Mínimos Quadrados Ordinários, o gráfico (<a href="#fig-fittingline" class="quarto-xref">Figura&nbsp;<span>24.3</span></a>) terá o seguinte aspecto: A reta de regressão se estende abaixo de 0 e acima de 1 em relação ao eixo Y.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fittingline" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fittingline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/Fit9SSq.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fittingline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.3: Reta de regressão quando a variável desfecho é dicotômica.
</figcaption>
</figure>
</div>
</div>
</div>
<p>No entanto, a variável Y (Probabilidade de Doença) não pode assumir valores fora do limite de 0 e 1. Além disso, a variável desfecho dicotômica viola os pressupostos de normalidade e homoscedasticidade dos erros, pois segue a Distribuição de Bernoulli. Em consequência, a regressão linear não é adequada nessa situação.</p>
<p><u>A Solução: A Função Logit</u></p>
<p>A solução é usar a <strong>regressão logística binária</strong>, que lida com essas limitações, usando uma função de ligação (link function) que transforma a probabilidade em um valor que pode ser modelado linearmente (e que pode variar de - a +. A função de ligação utilizada no modelo de regressão logística é a Logit (ou função logística), que resulta em uma curva em forma de ‘S’ chamada curva sigmoide (<a href="#fig-logit" class="quarto-xref">Figura&nbsp;<span>24.4</span></a>):</p>
<p><span class="math display">\[
logit_i = \ln\left(\frac{p}{1-p}\right)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-logit" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/lmI4IdG.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.4: Curva de regressão logística.
</figcaption>
</figure>
</div>
</div>
</div>
<p>O termo <span class="math inline">\(\frac{p}{1-p}\)</span> é a Razão de Chances (<em>Odds Ratio</em>), que representa a razão entre a probabilidade de ocorrência do evento (<em>p</em>) e a probabilidade de sua não ocorrência (<span class="math inline">\(1-p\)</span>). O <strong>logit</strong> é o logaritmo natural dessa razão de chances. Na regressão logística, o logit é modelado como uma função linear dos preditores, permitindo a estimação dos coeficientes (<span class="math inline">\(\beta\)</span>):</p>
<p><span class="math display">\[
logit_{i} = \ln\left(\frac{p}{1-p}\right) = \beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}
\]</span></p>
<p><u>Retornando à probabilidade <em>p</em></u></p>
<p>Através de manipulação algébrica, podemos isolar p para obter a probabilidade do evento Y=1 (sucesso) diretamente, garantindo que o valor final sempre esteja entre 0 e 1:</p>
<p><span class="math display">\[
p = \frac{e^{\beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}}}{1 + e^{\beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}}}
\]</span></p>
</section>
<section id="dados-para-o-exemplo" class="level2" data-number="24.4">
<h2 data-number="24.4" class="anchored" data-anchor-id="dados-para-o-exemplo"><span class="header-section-number">24.4</span> Dados para o exemplo</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tragédia do Titanic
</div>
</div>
<div class="callout-body-container callout-body">
<p>O RMS Titanic (<a href="#fig-titanic" class="quarto-xref">Figura&nbsp;<span>24.5</span></a>), considerado o navio inafundável de sua época, sofreu um trágico destino em sua viagem inaugural com destino a Nova Iorque. Construído com o intuito de ser o maior e mais luxuoso transatlântico, o Titanic colidiu com um iceberg na noite de 14 de abril de 1912, no Oceano Atlântico Norte, afundando rapidamente e causando a morte de inúmeras pessoas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-titanic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-titanic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://imgur.com/54il14d.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-titanic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.5: Titanic parado em Queenstown, 11 de abril.de 1912
</figcaption>
</figure>
</div>
</div>
</div>
<p>O Titanic partiu em sua primeira e única viagem com 1316 passageiros a bordo: 325 na primeira classe, 285 na segunda e 706 na terceira. Deles, 922 embarcaram em Southampton, 274 em Cherbourg-Octeville, na França, e 120 em Queenstown, na Irlanda. Além desses passageiros, havia 908 tripulantes, totalizando m 2224 pessoas. O número total de mortos mais aceito é 1514, quase 70% dos que embarcaram na viagem <span class="citation" data-cites="wiki:xxx">(<a href="referencias.html#ref-wiki:xxx" role="doc-biblioref">Wikipédia 2025</a>)</span>.</p>
</div>
</div>
<p>Os dados de 1309 passageiros estão em um arquivo denominado <code>dadosTitanic.xlsx</code>, obtido no pacote <code>titanic</code>, modificado estruturalmente e traduzido, sem alterar os dados, para chegar a este arquivo que pode ser baixado <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosTitanic.xlsx">aqui</a>. Possui 1309 observações e 12 variáveis:</p>
<p>• <strong>id</strong> <span class="math inline">\(\to\)</span> identificação do passageiro<br>
• <strong>sobreviveu</strong> <span class="math inline">\(\to\)</span> 0 = não; 1 = sim<br>
• <strong>classe</strong> <span class="math inline">\(\to\)</span> classe do passageiro (categórica): 1 = 1ª classe; 2 = 2ª classe e 3 = 3ª classe (qualitativa)<br>
• <strong>nome</strong> <span class="math inline">\(\to\)</span> nome do passageiro (nominal)<br>
• <strong>sexo</strong> <span class="math inline">\(\to\)</span> masc = masculino; fem = feminino (binária)<br>
• <strong>idade</strong> <span class="math inline">\(\to\)</span> idade em anos (numérica contínua)<br>
• <strong>irco</strong> <span class="math inline">\(\to\)</span> número de irmãos/cônjuges a bordo (numérica discreta)<br>
• <strong>pafi</strong> <span class="math inline">\(\to\)</span> número de pais/filhos a bordo (numérica discreta)<br>
• <strong>ticket</strong> <span class="math inline">\(\to\)</span> número do bilhete de embarque (nominal)<br>
• <strong>tarifa</strong> <span class="math inline">\(\to\)</span> valor pago pela passagem em dólares (numérica contínua)<br>
• <strong>cabine</strong> <span class="math inline">\(\to\)</span> número de identificação da cabine (nominal)<br>
• <strong>porto_embarque</strong> <span class="math inline">\(\to\)</span> porto de embarque: C = Cherbourg, Q = Queenstown, S = Southampton</p>
<section id="leitura-dos-dados" class="level3" data-number="24.4.1">
<h3 data-number="24.4.1" class="anchored" data-anchor-id="leitura-dos-dados"><span class="header-section-number">24.4.1</span> Leitura dos dados</h3>
<p>Após fazer o download do banco de dados em seu diretório <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, carregue-o no <em>RStudio</em>, usando a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTitanic.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explorando-e-preparando-os-dados" class="level3" data-number="24.4.2">
<h3 data-number="24.4.2" class="anchored" data-anchor-id="explorando-e-preparando-os-dados"><span class="header-section-number">24.4.2</span> Explorando e preparando os dados</h3>
<p>Para observar as variáveis do banco de dados, pode-se usar a função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTitanic)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,309 × 12] (S3: tbl_df/tbl/data.frame)
 $ id            : num [1:1309] 1 2 3 4 5 6 7 8 9 10 ...
 $ sobreviveu    : num [1:1309] 0 1 1 1 0 0 0 0 1 1 ...
 $ classe        : num [1:1309] 3 1 3 1 3 3 1 3 3 2 ...
 $ nome          : chr [1:1309] "Braund, Mr. Owen Harris" "Cumings, Mrs. John Bradley (Florence Briggs Thayer)" "Heikkinen, Miss. Laina" "Futrelle, Mrs. Jacques Heath (Lily May Peel)" ...
 $ sexo          : chr [1:1309] "masc" "fem" "fem" "fem" ...
 $ idade         : num [1:1309] 22 38 26 35 35 NA 54 2 27 14 ...
 $ irco          : num [1:1309] 1 1 0 1 0 0 0 3 0 1 ...
 $ pafi          : num [1:1309] 0 0 0 0 0 0 0 1 2 0 ...
 $ ticket        : chr [1:1309] "A/5 21171" "PC 17599" "STON/O2. 3101282" "113803" ...
 $ tarifa        : num [1:1309] 7.25 71.28 7.92 53.1 8.05 ...
 $ cabine        : chr [1:1309] NA "C85" NA "C123" ...
 $ porto_embarque: chr [1:1309] "S" "C" "S" "S" ...</code></pre>
</div>
</div>
<p>A saída exibe um <em>tibble</em> com 1309 linhas (casos = passageiros) e 12 colunas (variáveis).</p>
<section id="remoção-de-variáveis-irrelevantes" class="level4" data-number="24.4.2.1">
<h4 data-number="24.4.2.1" class="anchored" data-anchor-id="remoção-de-variáveis-irrelevantes"><span class="header-section-number">24.4.2.1</span> Remoção de variáveis irrelevantes</h4>
<p>Algumas dessas variáveis não terão utilidade para a análise de regressão logística: por exemplo, a coluna índice (<code>id</code>), o nome do passageiro, o número do ticket de embarque e o número da cabine. Elas serão removidas do banco de dados, usando a função <code>select()</code> do pacote <code>dplyr</code> (<a href="05-manipulandoDados.html#sec-dadosMater" class="quarto-xref"><span>Seção 5.6</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(dadosTitanic, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">-</span><span class="fu">c</span>(id, nome, ticket, cabine))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conversão-de-variáveis-para-fatores" class="level4" data-number="24.4.2.2">
<h4 data-number="24.4.2.2" class="anchored" data-anchor-id="conversão-de-variáveis-para-fatores"><span class="header-section-number">24.4.2.2</span> Conversão de variáveis para fatores</h4>
<p>Algumas variáveis estão classificadas como numéricas (<code>classe</code>, <code>sexo</code>, <code>porto_embarque</code> e <code>sobreviveu</code>), mas são fatores. Esta modificação será realizada, usando a função <code>mutate()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> dadosTitanic <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porto_embarque =</span> <span class="fu">factor</span>(porto_embarque)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sobreviveu =</span> <span class="fu">factor</span>(sobreviveu))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTitanic)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,309 × 8] (S3: tbl_df/tbl/data.frame)
 $ sobreviveu    : Factor w/ 2 levels "0","1": 1 2 2 2 1 1 1 1 2 2 ...
 $ classe        : Factor w/ 3 levels "1","2","3": 3 1 3 1 3 3 1 3 3 2 ...
 $ sexo          : Factor w/ 2 levels "fem","masc": 2 1 1 1 2 2 2 2 1 1 ...
 $ idade         : num [1:1309] 22 38 26 35 35 NA 54 2 27 14 ...
 $ irco          : num [1:1309] 1 1 0 1 0 0 0 3 0 1 ...
 $ pafi          : num [1:1309] 0 0 0 0 0 0 0 1 2 0 ...
 $ tarifa        : num [1:1309] 7.25 71.28 7.92 53.1 8.05 ...
 $ porto_embarque: Factor w/ 3 levels "C","Q","S": 3 1 3 3 3 2 3 3 3 1 ...</code></pre>
</div>
</div>
</section>
<section id="divisão-dos-dados-em-treino-e-teste" class="level4" data-number="24.4.2.3">
<h4 data-number="24.4.2.3" class="anchored" data-anchor-id="divisão-dos-dados-em-treino-e-teste"><span class="header-section-number">24.4.2.3</span> Divisão dos dados em Treino e Teste</h4>
<p>A divisão dos dados em conjuntos de <code>treino</code> e <code>teste</code> é uma prática frequente em aprendizado de regressão logística. Serve para avaliar a performance de um modelo de forma imparcial precisa. O conjunto <code>treino</code> é a parte dos dados que o modelo utiliza para aprender as relações entre as variáveis independentes e a variável dependente. O modelo analisa esses dados para encontrar os melhores coeficientes que descrevem a relação entre as variáveis. O conjunto <code>teste</code> é a parte dos dados que o modelo não analisou durante o treinamento. Ele é utilizado para avaliar a capacidade do modelo de fazer previsões em novos dados. Ao comparar as previsões do modelo com os valores reais no conjunto <code>teste</code>, pode-se medir a sua precisão e generalização. Essa técnica é utilizada para evitar o excesso de ajuste dos dadosconhecido como <em>overfitting</em> <span class="citation" data-cites="subramanian2013over">(<a href="referencias.html#ref-subramanian2013over" role="doc-biblioref">Subramanian e Simon 2013</a>)</span>, estimar a acurácia do modelo e comparação de modelos. A divisão mais comum é 70% para treinamento e 30% para teste, mas essa proporção pode variar dependendo do tamanho do conjunto de dados e da complexidade do problema.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a semente para reprodutibilidade (essencial)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Embaralhando os dados</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>dados_embaralhados <span class="ot">&lt;-</span> dadosTitanic[<span class="fu">sample</span>(<span class="fu">nrow</span>(dadosTitanic)),]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividindo os dados em treino e teste</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dados_embaralhados<span class="sc">$</span>classe, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> dados_embaralhados[trainIndex, ]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>teste  <span class="ot">&lt;-</span> dados_embaralhados[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Observar o tamanho das amostras</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(treino)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 918   8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(teste)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 391   8</code></pre>
</div>
</div>
</section>
<section id="verificação-e-tratamento-dos-dados-faltantes" class="level4" data-number="24.4.2.4">
<h4 data-number="24.4.2.4" class="anchored" data-anchor-id="verificação-e-tratamento-dos-dados-faltantes"><span class="header-section-number">24.4.2.4</span> Verificação e tratamento dos dados faltantes</h4>
<p>O próximo passo é investigar dados faltantes (NA) ou valores vazios<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> em cada conjunto separadamente. Isso garante que o tratamento seja feito corretamente sem contaminar o teste.</p>
<p>Para verificar os dados faltantes e espaços vazios (strings ““) no banco de dados, pode-se usar o comando que soma os dados faltantes e espaços vazios em cada coluna do banco de dados:</p>
<p><u>Verificar valores faltantes</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de valores faltantes por variável</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(treino))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0            175              0 
          pafi         tarifa porto_embarque 
             0              1              2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(teste))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0             88              0 
          pafi         tarifa porto_embarque 
             0              0              0 </code></pre>
</div>
</div>
<p><u>Verificar valores vazios</u> (strings ““)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(treino <span class="sc">==</span> <span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0             NA              0 
          pafi         tarifa porto_embarque 
             0             NA             NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(teste <span class="sc">==</span> <span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0             NA              0 
          pafi         tarifa porto_embarque 
             0              0              0 </code></pre>
</div>
</div>
<p>No subconjunto <code>treino</code>, existem 175 NAs na variável <code>idade</code>, um NA na variável <code>tarifa</code> e dois na variável <code>porto_embarque</code>; no subconjunto <code>teste</code>, têm 88 NAs na variável <code>idade</code>. Não existem espaços vazios em nenhum dos subconjuntos.</p>
<p>Uma visualização rápida (<a href="#fig-amelia1" class="quarto-xref">Figura&nbsp;<span>24.6</span></a>, <a href="#fig-amelia2" class="quarto-xref">Figura&nbsp;<span>24.7</span></a>) pode ser feita com a função <code>missmap()</code> do pacote <code>Amelia</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)   </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">missmap</span>(treino, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-amelia1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-amelia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="24-reglogbin_files/figure-html/fig-amelia1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-amelia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.6: Dados faltantes no subconjunto treino
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)   </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">missmap</span>(teste, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-amelia2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-amelia2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="24-reglogbin_files/figure-html/fig-amelia2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-amelia2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.7: Dados faltantes no subconjunto teste
</figcaption>
</figure>
</div>
</div>
</div>
<p><u>Tratamento dos dados faltantes</u></p>
<p>A melhor forma de tratar dados faltantes depende de diversos fatores <span class="citation" data-cites="Prabhakaran_2016">(<a href="referencias.html#ref-Prabhakaran_2016" role="doc-biblioref">Prabhakaran 2016</a>)</span>, como:</p>
<ul>
<li><em>Mecanismo de geração dos dados faltantes</em>: Por que os dados estão faltando? É aleatório, relacionado a outras variáveis ou a alguma característica da população?</li>
<li><em>Quantidade de dados faltantes</em>: 263 valores faltantes representam uma proporção considerável dos dados (20%).</li>
<li><em>Impacto na análise</em>: Como a presença de dados faltantes pode afetar os resultados da sua análise?</li>
</ul>
<p>O que fazer?</p>
<ol type="1">
<li><strong>Exclusão de casos</strong>:</li>
</ol>
<!-- -->
<ol type="a">
<li><em>Listwise deletion</em>: Remover todas as observações com algum dado faltante. Não recomendado neste caso, pois você perderia uma quantidade significativa de dados.</li>
<li><em>Pairwise deletion</em>: Utilizar todas as observações disponíveis para cada análise. Pode gerar resultados inconsistentes.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><strong>Imputação</strong>:</li>
</ol>
<!-- -->
<ol type="a">
<li><em>Imputação por média, mediana ou moda</em>: Substituir os valores faltantes pela média, mediana ou moda da variável. Simples, mas pode subestimar a variância.</li>
<li><em>Imputação por regressão</em>: Utilizar um modelo de regressão para prever os valores faltantes com base em outras variáveis. Mais preciso, mas pode ser enviesado se o modelo não for adequado.</li>
<li><em>Imputação múltipla</em>: Criar múltiplos conjuntos de dados, cada um com diferentes valores imputados, e combinar os resultados das análises. Método mais robusto e permite estimar a incerteza.</li>
<li><em>Imputação por K-Nearest Neighbors</em>: Substituir os valores faltantes pela média dos <em>k</em> vizinhos mais próximos. Útil para dados numéricos e pode capturar padrões locais.</li>
</ol>
<p>Inicialmente, será removido os valores omissos nas variáveis <code>tarifa</code> e <code>porto_embarque</code>, no subconjunto <code>treino</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> treino[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">is.na</span>(treino<span class="sc">$</span>tarifa)),]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> treino[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">is.na</span>(treino<span class="sc">$</span>porto_embarque)),]</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dessa forma, permanecem os valores faltantes na variáveis <code>idade</code> em ambos subconjuntos. Será feita a imputação, usando a mediana por ser uma estratégia simples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>treino<span class="sc">$</span>idade[<span class="fu">is.na</span>(treino<span class="sc">$</span>idade)] <span class="ot">&lt;-</span> <span class="fu">median</span>(treino<span class="sc">$</span>idade, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>teste<span class="sc">$</span>idade[<span class="fu">is.na</span>(teste<span class="sc">$</span>idade)] <span class="ot">&lt;-</span> <span class="fu">median</span>(teste<span class="sc">$</span>idade, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Novamente, se usarão as funções <code>colSums(is.na())</code> e <code>str()</code>para pesquisar se existem dados faltantes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de valores faltantes por variável</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(treino))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0              0              0 
          pafi         tarifa porto_embarque 
             0              0              0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(teste))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sobreviveu         classe           sexo          idade           irco 
             0              0              0              0              0 
          pafi         tarifa porto_embarque 
             0              0              0 </code></pre>
</div>
</div>
<p>Os dados (treino e teste) não apresentam mais dados faltantes e estão pronts para serem usados na análise.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Após o tratamento dos dados, tem-se dois conjuntos de dados que servirão para:</p>
<ol type="1">
<li><strong>Treino</strong> - que será usado para realizar a regressão logística. Corresponde a aproximadamente 70% dos dados originais.<br>
</li>
<li><strong>Teste</strong> - que será usado para avaliar a performance do modelo e a sua capacidade de predição.<br>
</li>
<li><strong>Variável dependente</strong> ou resposta: <code>sobreviveu</code><br>
</li>
<li><strong>Variáveis explicativas ou preditoras</strong>: as demais variáveis<br>
</li>
<li>O <strong>objetivo da análise</strong> é gerar um modelo de regressão logística capaz de predizer qual a probabilidade de um passageiro com determinasdas características sobreviver ao naugráfio do Titanic, ocorrido em 14 de abril de 1912</li>
</ol>
</div>
</div>
</section>
</section>
</section>
<section id="construção-do-modelo-de-regressão-logística" class="level2" data-number="24.5">
<h2 data-number="24.5" class="anchored" data-anchor-id="construção-do-modelo-de-regressão-logística"><span class="header-section-number">24.5</span> Construção do modelo de Regressão Logística</h2>
<p>Antes de criar o modelo, alguns passos são importantes:</p>
<ol type="1">
<li>Verificar se existe <strong>correlação entre as variáveis numéricas</strong>, para evitar problemas de multicolinearidade, pois se as variáveis forem altamente correlacionadas pode causar:</li>
</ol>
<ul>
<li><p><u>Coeficientes instáveis</u> (pequenas mudanças nos dados podem gerar grandes variações nos coeficientes estimados);</p></li>
<li><p><u>Torna difícil o entendimento</u> o efeito individual de cada variável sobre a probabilidade do desfecho;</p></li>
<li><p><u>Redução da precisão estatística,</u> pois aumentam os erros padrão dos coeficientes, podendo tornar variáveis significativas aparaentemente insignificantes.</p></li>
</ul>
<p>Para isso, deve-se avaliar a correlação de Pearson entre as variáveis numéricas. Valores acima de 0,8 ou abaixo de -0,8 são preocupantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecionar apenas as variáveis numéricas</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dados_numericos <span class="ot">&lt;-</span> treino[<span class="fu">c</span>(<span class="st">"idade"</span>, <span class="st">"irco"</span>, <span class="st">"pafi"</span>, <span class="st">"tarifa"</span>)]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula a matriz de correlação de Pearson</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>matriz_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dados_numericos, <span class="at">use =</span> <span class="st">"all.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibe a matriz</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matriz_cor)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            idade       irco       pafi    tarifa
idade   1.0000000 -0.1745660 -0.1218267 0.1914591
irco   -0.1745660  1.0000000  0.3914691 0.1755954
pafi   -0.1218267  0.3914691  1.0000000 0.2194998
tarifa  0.1914591  0.1755954  0.2194998 1.0000000</code></pre>
</div>
</div>
<p>É possível visualizar essa matriz com a função <code>corrplot</code>(<a href="#fig-corrplot" class="quarto-xref">Figura&nbsp;<span>24.8</span></a>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza a matriz de correlação</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(matriz_cor, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-corrplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corrplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="24-reglogbin_files/figure-html/fig-corrplot-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:60.0%;height:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corrplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.8: Matriz de correlação
</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Verificar se há observações incompletas, apesar de todo tratamento dos dados faltantes ou vazios:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se todas informações forem completas, retorna FALSE</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(treino))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Verificar se existe um desbalanceamento preocupante, ou seja, quando uma das classes do desfecho reperesenta menos de 10% dos casos (desfecho raro), pois pode comprometer a preformance e a interpretação do modelo, reduzindo a capacidade preditiva.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(treino<span class="sc">$</span>sobreviveu)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
575 340 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(tab)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.6284153 0.3715847 </code></pre>
</div>
</div>
<section id="modelos-de-regressão-logística" class="level3" data-number="24.5.1">
<h3 data-number="24.5.1" class="anchored" data-anchor-id="modelos-de-regressão-logística"><span class="header-section-number">24.5.1</span> Modelos de Regressão Logística</h3>
<section id="modelo-1---modelo-completo" class="level4" data-number="24.5.1.1">
<h4 data-number="24.5.1.1" class="anchored" data-anchor-id="modelo-1---modelo-completo"><span class="header-section-number">24.5.1.1</span> Modelo 1 - modelo completo</h4>
<p>O modelo 1 (<code>mod1</code>) será construído com o subconjunto <code>treino</code>, usando a função nativa <code>glm()</code> – <strong>g</strong>eneralized <strong>l</strong>inear <strong>m</strong>odel - usada para aplicar uma regressão logística no <em>R</em>. Sua funcionalidade é idêntica à função <code>lm()</code> da regressão linear. Necessita alguns argumentos:</p>
<ul>
<li><p><strong>formula</strong> <span class="math inline">\(\to\)</span> objeto da classe <em>formula</em>. Um preditor típico tem o formato <code>resposta ~ preditor</code> em que <code>resposta</code>, na regressão logística binária, é uma variável dicotômica e o <code>preditor</code> pode ser uma série de variáveis numéricas ou categóricas;</p></li>
<li><p><strong>family</strong> <span class="math inline">\(\to\)</span> uma descrição da distribuição de erro e função de <em>link</em> a ser usada no modelo <code>glm</code>, pode ser uma <em>string</em> que nomeia uma função de <em>family</em>. O padrão é <code>family = gaussian()</code>. No caso da regressão logística binária, <code>family = binomial()</code> ou <code>family = binomial (link =”logit”)</code>. Para outras informações, use <code>help(glm)</code> ou <code>help(family)</code>;</p></li>
<li><p><strong>data</strong> <span class="math inline">\(\to\)</span> banco de dados.</p></li>
</ul>
<p>Dentro dos parênteses da função <code>glm()</code>, são fornecidas informações essenciais sobre o modelo. À esquerda do til <code>(~)</code>, encontra-se a variável dependente, que deve estar codificada como 0 e 1 para que a função a interprete corretamente como binária. Após o til, são listadas as variáveis preditoras. Quando se utiliza um ponto (<code>~.</code>), isso indica a inclusão de todas as variáveis preditoras disponíveis. Já o uso do asterisco (<code>*</code>) entre duas variáveis preditoras especifica que, além dos efeitos principais, também deve ser considerado um termo de interação entre elas. No exemplo apresentado, nesta análise inicial, não será solicitada os efeitos da interação. Por fim, após a vírgula, define-se que a distribuição utilizada é a binomial. Como a função <code>glm</code> usa <code>logit</code> como link padrão para uma variável de desfecho binomial, não há necessidade de especificá-lo explicitamente no modelo.</p>
<p>O modelo inicial de regressão logística do tipo <strong>entrada forçada</strong> (<code>enter</code>), método padrão de conduzir uma regressão, que consiste em simplesmente colocar todos os preditores no modelo de regressão em um bloco (modelo completo) e estimar parâmetros para cada um <span class="citation" data-cites="field2012logit">(<a href="referencias.html#ref-field2012logit" role="doc-biblioref">Field, Miles, e Field 2012</a>)</span>. O dataframe <code>treino</code> será usado com todos os preditores dentro da função. O objeto criado será denominado de <code>mod1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span>., </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> treino, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A saída da função <code>glm()</code> fornece os coeficientes, da mesma forma como na regressão linear, que estima o efeito das variáveis preditoras sobre a <em>chance</em> de ocorrência do desfecho (no exemplo, sucesso = 1).</p>
<p><u>Interpretação Coeficientes</u></p>
<p>Os coeficientes podem ser interpretados da seguinte maneira <span class="citation" data-cites="anderson2023coeficientes">(<a href="referencias.html#ref-anderson2023coeficientes" role="doc-biblioref">Anderson 2023</a>)</span>:</p>
<ul>
<li><p><strong>Coeficiente positivo (</strong><span class="math inline">\(\beta \gt 0\)</span>) : Aumenta o log das chances do evento ocorrer. Ou seja, aumenta a probabilidade de desfecho = 1, mantendo as outras variáveis constantes.</p></li>
<li><p><strong>Coeficiente negativo (</strong><span class="math inline">\(\beta \lt 0\)</span>) : Diminui o log das chances do evento ocorrer. Ou seja, <em>reduz a probabilidade de desfecho = 1</em>, mantendo as outras variáveis constantes.</p></li>
<li><p><strong>Coeficiente zero (</strong><span class="math inline">\(\beta = 0\)</span>) : A variável não tem efeito sobre o desfecho.</p></li>
</ul>
<p><u>Interpretação das outras métricas</u></p>
<p>O <em>Null deviance</em> representa o quão bem a variável resposta é prevista por um modelo que inclui apenas o intercepto e não as variáveis independentes. Representa o erro do modelo sem preditores. Seria como dizer: “Qual o erro se eu apenas chutar a média geral?”;</p>
<p>O <em>Residual deviance</em> mostra quão bem a variável de resposta é prevista por um modelo que inclui todas as variáveis. Representa o erro do modelo com preditores. Quanto menor o <em>Residual Deviance</em> em relação ao <em>Null Deviance</em>, melhor o modelo ajusta os dados. No <code>mod1</code>, o <em>Residual Deviance</em> é igual a 708.95, bem menor que o <em>Null Deviance</em> (1207.42), ou seja, o modelo está explicando bem os dados. A diferença entre os dois (1207.42 − 708.95 = 498.47) indica o ganho de ajuste ao incluir as variáveis. Quanto maior essa redução, melhor o modelo. Podemos testar essa diferença com um teste qui-quadrado para verificar se a melhora é estatisticamente significativa:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: sobreviveu

Terms added sequentially (first to last)

               Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                             914    1207.42              
classe          2    71.16       912    1136.26 3.527e-16 ***
sexo            1   395.18       911     741.08 &lt; 2.2e-16 ***
idade           1    12.34       910     728.74 0.0004435 ***
irco            1    13.68       909     715.07 0.0002172 ***
pafi            1     2.96       908     712.11 0.0853955 .  
tarifa          1     1.84       907     710.27 0.1754262    
porto_embarque  2     1.32       905     708.95 0.5161721    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>O teste estatístico compara o <em>Null Deviance</em> (modelo com apenas o intercepto) com a <em>Residual Deviance</em> (modelo com preditores), usando o teste qui-quadrado para verificar se a inclusão das variáveis melhora significativamente o ajuste. Se o valor <em>p</em> for menor que 0.05, pode-se concluir que o modelo com preditores é significativamente melhor que o modelo nulo até a inclusão da variável irco. A partir daí a inclusão de novas variáveis não melhora estatisticamente o modelo.</p>
<p>O <em>AIC (Akaike Information Criterion)</em> é uma medida estatística de ajuste que penaliza o modelo logístico pelo número de variáveis preditivas. Um modelo com valor mínimo de AIC é considerado um modelo bem ajustado. Um AIC = 728.95 isolado é difícil de interpretar, pois é útil para comparar modelos, quanto menor, melhor. Útil quando se testa diferentes combinações de variáveis.</p>
<p>Para ver todo o resultado do modelo, executa-se a função <code>summary()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ ., family = binomial(link = "logit"), 
    data = treino)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      3.810669   0.482866   7.892 2.98e-15 ***
classe2         -0.784488   0.317787  -2.469  0.01356 *  
classe3         -1.842339   0.316591  -5.819 5.91e-09 ***
sexomasc        -3.483054   0.216705 -16.073  &lt; 2e-16 ***
idade           -0.032623   0.008303  -3.929 8.52e-05 ***
irco            -0.327286   0.117324  -2.790  0.00528 ** 
pafi            -0.200766   0.113950  -1.762  0.07809 .  
tarifa           0.002822   0.002310   1.222  0.22176    
porto_embarqueQ  0.265542   0.409950   0.648  0.51715    
porto_embarqueS -0.125789   0.255076  -0.493  0.62191    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1207.42  on 914  degrees of freedom
Residual deviance:  708.95  on 905  degrees of freedom
AIC: 728.95

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p><u>Uso do Odds Ratio (OR) na interpretação dos coeficientes</u></p>
<p>Numericamente, os coeficientes de regressão logística não são facilmente interpretáveis em escala bruta, pois estão representados como <code>log (odds)</code> ou <code>logit</code> . Para tornar mais simples, inverte-se a transformação logística, exponenciando os coeficientes (<code>exp(coeficiente)</code>). Isso faz com que os coeficientes se transformem em <strong>razões de chance</strong> (<em>odds ratio</em>), ficando mais intuitivos facilitando a interpretação. Isso pode ser realizado pela função <code>odds.ratio()</code> do pacote <code>questionr</code> <span class="citation" data-cites="barnier2025questior">(<a href="referencias.html#ref-barnier2025questior" role="doc-biblioref">Barnier, Briatte, e Larmarange 2025</a>)</span>, que retorna as OR e seus intervalos de confiança de 95%, além dos respectivos valores <em>p</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       OR     2.5 %   97.5 %         p    
(Intercept)     45.180634 17.845512 118.7689 2.979e-15 ***
classe2          0.456353  0.244196   0.8507  0.013564 *  
classe3          0.158446  0.084837   0.2944 5.909e-09 ***
sexomasc         0.030713  0.019839   0.0464 &lt; 2.2e-16 ***
idade            0.967903  0.952070   0.9836 8.521e-05 ***
irco             0.720878  0.564399   0.8952  0.005277 ** 
pafi             0.818104  0.648255   1.0181  0.078091 .  
tarifa           1.002826  0.998331   1.0077  0.221764    
porto_embarqueQ  1.304138  0.582937   2.9124  0.517151    
porto_embarqueS  0.881801  0.536235   1.4594  0.621912    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Quando o OR é menor que 1, significa que o evento (no exemplo: sobrevivência) é menos provável no grupo em questão comparado ao grupo de referência. Para interpretar em termos percentuais:</p>
<p><span class="math display">\[
\text{Redução percentual} = \left(1 - OR  \right) \times 100
\]</span></p>
<p>Ou seja, considerando os passageiros da 2ª classe, tem-se que <span class="math inline">\(1 - 0.46 = 0.54 \times 100 = 54\)</span>%. Assim, os passageiros da 2ª classe tem 54% menos chance de sobreviver que os da 1ª classe (nível de referência ); o da 3ª classe tem 84% menos chance de sobreviver que os da 1ª classe. Para saber o nível de referência, basta usar a função <code>levels()</code> da seguinte maneira:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(treino<span class="sc">$</span>classe)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2" "3"</code></pre>
</div>
</div>
<p>Quando o OR é maior que 1, o evento é mais provável no grupo em questão. A interpretação muda:</p>
<p><span class="math display">\[
\text{Aumento percentual} = \left(OR - 1 \right) \times 100
\]</span></p>
<p>Considerando a variável preditora <code>tarifa</code>, cujo OR = 1.003, tem-se <span class="math inline">\(1.003 - 1 = 0.003 \times 100 = 0.3\)</span>. Ou seja, um aumento de 0,3% na sobrevivência. Um valor muito pequeno que se mostrou sem significância estatística (<em>p</em> = 0.2218).<br>
Os homens têm <span class="math inline">\(1 - 0.03 = 0.97 \times 100 = 97\)</span>% menos chance de sobreviver do que as mulheres.</p>
<p>Qual a chance das mulheres sobreviverem em relação aos homens?</p>
<p>Para responder essa pergunta, basta inverter a OR. Assim, as mulheres têm <span class="math inline">\(1/0.03 \approx\)</span> 33 vezes mais chance de sobreviver que os homens.<br>
</p>
<p>A idade (variável numérica) mostra que o aumento da idade diminuiu a sobrevivência; para cada ano a mais de idade a chance de sobrevivência reduz em <span class="math inline">\(1 - 0.97 = 0.03 \times 100 = 3\)</span>%. Ter irmãos/cônjuges (variável <code>irco</code>) a bordo reduz a chance de sobrevivência em <span class="math inline">\(1 - 0.72 = 0.28 \times 100 = 28\)</span>%. As demais variáveis não tiveram um efeito significativo.&nbsp;</p>
</section>
<section id="modelo-2---modelo-simples" class="level4" data-number="24.5.1.2">
<h4 data-number="24.5.1.2" class="anchored" data-anchor-id="modelo-2---modelo-simples"><span class="header-section-number">24.5.1.2</span> Modelo 2 - modelo simples</h4>
<p>No ajuste realizado no modelo 1, apenas as variáveis <code>classe</code>, <code>sexo</code>, <code>idade</code> e <code>irco</code> foram significativas. Neste novo modelo (<code>mod2</code>), essas variáveis permanecem e as não significativas são removidas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span> classe <span class="sc">+</span> sexo <span class="sc">+</span> idade <span class="sc">+</span> irco,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> treino, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ classe + sexo + idade + irco, family = binomial(link = "logit"), 
    data = treino)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.866786   0.415034   9.317  &lt; 2e-16 ***
classe2     -0.980705   0.278733  -3.518 0.000434 ***
classe3     -2.021346   0.259335  -7.794 6.47e-15 ***
sexomasc    -3.436506   0.207677 -16.547  &lt; 2e-16 ***
idade       -0.032155   0.008241  -3.902 9.55e-05 ***
irco        -0.374735   0.113269  -3.308 0.000938 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1207.42  on 914  degrees of freedom
Residual deviance:  715.07  on 909  degrees of freedom
AIC: 727.07

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>A saída do <code>summary()</code> mostra que os coeficientes permaneceram apresentando significância estatística.</p>
<p><u>Razão de Chances do modelo 2</u></p>
<p>Usando a mesma função, usada para o <code>mod1</code>, calcula-se as OR para o <code>mod2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   OR     2.5 %   97.5 %         p    
(Intercept) 47.788557 21.606965 110.1338 &lt; 2.2e-16 ***
classe2      0.375046  0.215871   0.6447 0.0004341 ***
classe3      0.132477  0.078973   0.2186 6.474e-15 ***
sexomasc     0.032177  0.021173   0.0478 &lt; 2.2e-16 ***
idade        0.968357  0.952626   0.9839 9.551e-05 ***
irco         0.687472  0.542726   0.8465 0.0009384 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Os passageiros da 2ª classe, tem, agora, <span class="math inline">\(1 - 0.38 = 0.62 \times 100 = 62\)</span>% menos chance de sobreviver que os da 1ª classe (nível de referência); o da 3ª classe tem 87% menos chance de sobreviver que os da 1ª classe. Esses valores e os restantes não diferem muito dos do <code>mod1</code>.</p>
<p>Como o AIC do <code>mod2</code>(727.07) é menor que o do <code>mod1</code>(728.95) é possível dizer que houve uma melhora no ajuste, apesar de a diferença ser muito pequena.</p>
<p>Entretanto, outros modelos são possíveis.</p>
</section>
<section id="modelo-3" class="level4" data-number="24.5.1.3">
<h4 data-number="24.5.1.3" class="anchored" data-anchor-id="modelo-3"><span class="header-section-number">24.5.1.3</span> Modelo 3</h4>
<p>A partir do modelo completo (<code>mod1</code>), será criado um terceiro modelo, selecionando as variáveis automaticamente, usando a função <code>step()</code>. Usando o argumento <code>direction = "backward"</code>, a função realiza a <strong>eliminação regressiva</strong> — ou seja, começa com o modelo completo e vai retirando variáveis uma a uma. Avalia o impacto de <strong>remover cada variável</strong> individualmente. Remove a variável cuja retirada melhora o critério de ajuste (em geral, AIC) e vai repetindo o processo até que nenhuma remoção adicional melhore o modelo. Considerando ajuste e simplicidade , quanto menor o AIC, melhor o modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1, <span class="at">direction =</span> <span class="st">"backward"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=728.95
sobreviveu ~ classe + sexo + idade + irco + pafi + tarifa + porto_embarque

                 Df Deviance     AIC
- porto_embarque  2   710.27  726.27
- tarifa          1   710.48  728.48
&lt;none&gt;                708.95  728.95
- pafi            1   712.18  730.18
- irco            1   718.20  736.20
- idade           1   724.99  742.99
- classe          2   747.91  763.91
- sexo            1  1078.51 1096.51

Step:  AIC=726.27
sobreviveu ~ classe + sexo + idade + irco + pafi + tarifa

         Df Deviance     AIC
- tarifa  1   712.11  726.11
&lt;none&gt;        710.27  726.27
- pafi    1   714.11  728.11
- irco    1   720.40  734.40
- idade   1   725.91  739.91
- classe  2   749.18  761.18
- sexo    1  1093.47 1107.47

Step:  AIC=726.11
sobreviveu ~ classe + sexo + idade + irco + pafi

         Df Deviance     AIC
&lt;none&gt;        712.11  726.11
- pafi    1   715.07  727.07
- irco    1   721.21  733.21
- idade   1   728.02  740.02
- classe  2   779.41  789.41
- sexo    1  1098.56 1110.56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ classe + sexo + idade + irco + pafi, 
    family = binomial(link = "logit"), data = treino)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.979416   0.423047   9.407  &lt; 2e-16 ***
classe2     -0.987641   0.279600  -3.532 0.000412 ***
classe3     -2.013771   0.259956  -7.747 9.44e-15 ***
sexomasc    -3.519814   0.215357 -16.344  &lt; 2e-16 ***
idade       -0.032431   0.008297  -3.909 9.28e-05 ***
irco        -0.321086   0.116010  -2.768 0.005645 ** 
pafi        -0.186557   0.110554  -1.687 0.091512 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1207.42  on 914  degrees of freedom
Residual deviance:  712.11  on 908  degrees of freedom
AIC: 726.11

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Este terceiro modelo chega a um AIC = AIC: 726.11, melhor que os anteriores e incluindo a variável <code>pafi</code>.</p>
</section>
</section>
</section>
<section id="seleção-do-modelo" class="level2" data-number="24.6">
<h2 data-number="24.6" class="anchored" data-anchor-id="seleção-do-modelo"><span class="header-section-number">24.6</span> Seleção do Modelo</h2>
<p>Existem várias maneiras de verificar qual o modelo apresenta um melhor ajuste.</p>
<section id="deviance" class="level3" data-number="24.6.1">
<h3 data-number="24.6.1" class="anchored" data-anchor-id="deviance"><span class="header-section-number">24.6.1</span> Deviance</h3>
<p>O <em>Deviance</em> mede o quão bem o modelo se ajusta aos dados observados. Ele é baseado na log-verossimilhança (<em>log-likelihood</em> -LL) e funciona como uma medida de erro:</p>
<p>• <strong>Deviance nulo</strong>: Representa o erro do modelo sem preditores, apenas com intercepto.</p>
<p><span class="math display">\[
D_{null} = 2 \times \left(LL_{\text{modelo saturado}} - LL_{\text{modelo nulo}}\right)
\]</span></p>
<p>Onde o <strong>modelo saturado</strong> é um modelo teórico que se ajusta perfeitamente os dados - a log-verossimilhança é máxima possível e o <strong>modelo nulo</strong> é o modelo que só usa a média da resposta (sem preditores) e serve como base de comparação.</p>
<p>• <strong>Deviance residual:</strong> Representa o erro do modelo <strong>com preditores</strong>.</p>
<p><span class="math display">\[
D_{residual} = 2 \times \left(LL_{\text{modelo saturado}} - LL_{\text{modelo proposto}}\right)
\]</span></p>
<p>Se a <strong>null deviance</strong> é pequena, o modelo nulo já explica bem os dados; Se a <strong>deviance residual</strong> é muito menor que a null deviance, o modelo proposto melhora o ajuste. A diferença entre elas pode ser testada com um teste qui-quadrado.</p>
<p>Como os modelos são aninhados (um é uma versão mais simples do outro), pode-se compará-los, usando a função <code>anova()</code>. Assumindo que o <span class="math inline">\(mod2 \subset mod3 \subset mod1\)</span>, ou seja, <code>mod2</code> tem menos preditores que <code>mod3</code>, que tem menos que <code>mod1</code>. A hipótese nula deste teste é que os modelos são equivalentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3, mod1, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: sobreviveu ~ classe + sexo + idade + irco
Model 2: sobreviveu ~ classe + sexo + idade + irco + pafi
Model 3: sobreviveu ~ classe + sexo + idade + irco + pafi + tarifa + porto_embarque
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  
1       909     715.07                       
2       908     712.11  1   2.9591   0.0854 .
3       905     708.95  3   3.1586   0.3678  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>O argumento poderia ser <code>test ="LRT"</code>. Ambos testes calculam a diferença entre as deviances dos modelos e comparam essa diferença com uma distribuição qui-quadrado para obter o valor <em>p</em>.</p>
<p>A <em>Tabela de Deviance</em> mostra a inclusão das variável <code>pafi</code> no <code>mod3</code>, melhora o modelo, mas não de forma estatisticamente significativa ao nível de 5% (<em>p</em> &gt; 0.05), embora seja marginalmente significativa ao nível de 10% (<em>p</em> &lt; 0.10).<br>
A inclusão de <code>Parch</code> e <code>Fare</code> no <code>mod1</code> não melhora significativamente o modelo (<em>p</em> &gt; 0.05).</p>
<p><u>Concluindo</u>: Os modelos têm, a grosso modo, Deviances muito próximos e a diferença não é significativa (valor <em>p</em> &gt; 0,05 no teste de razão de verossimilhança), e pode-se aceitar que eles têm desempenho equivalente. Entretanto, o <code>mod2</code> (<em>model 1</em> na tabela de Deviance) é o mais simples, mais parcimonioso. Portanto, seria o mais adequado para seguir a análise.</p>
<p>Pode-se, também, usar um critério empírico que compara o Deviance residual com os <strong>graus de liberdade</strong>:</p>
<p><span class="math display">\[
\frac{D_{residual}}{n-k}
\]</span></p>
<p>Onde <em>n</em> = número de observações e <em>k</em> = número de <strong>parâmetros</strong>, incluindo o intercepto.</p>
<p>Considerando o <code>mod2</code>, temos 4 variáveis explicativas (<code>classe</code> + <code>sexo</code> + <code>idade</code> + <code>irco</code>), mas cada uma pode gerar mais um parâmetro, dependendo da codificação (por ex.: <code>classe</code> com 3 níveis <span class="math inline">\(\to\)</span> 2 parâmetros; <code>sexo</code> com dois níveis <span class="math inline">\(\to\)</span> 1 parâmetro). Além disso, o modelo inclui um intercepto, então o total de parametros <em>k</em> é:</p>
<ul>
<li><code>classe</code>: 2 parâmetros (niveis 2 e 3)<br>
</li>
<li><code>sexo</code>: 1 parâmetro (masculino)<br>
</li>
<li><code>idade</code>: 1 parâmetro (numérica)<br>
</li>
<li><code>irco</code>: 1 parâmetro (numérica)<br>
</li>
<li><code>Intercepto</code>: 1</li>
</ul>
<p><span class="math display">\[
\frac{715.07}{889-6} = \frac{790.88}{883} \approx 0.810
\]</span></p>
<p>Esse valor <span class="math inline">\(&lt;1\)</span> indica que o modelo está ajustado de forma adequada — ou seja, o erro médio por grau de liberdade é baixo. Os outros modelos também têm valoes <span class="math inline">\(&lt;1\)</span>. Como visto anteriormente, eles não são muito diferentes em relação ao ajuste.</p>
</section>
<section id="aic-akaike-information-criterion" class="level3" data-number="24.6.2">
<h3 data-number="24.6.2" class="anchored" data-anchor-id="aic-akaike-information-criterion"><span class="header-section-number">24.6.2</span> AIC (Akaike Information Criterion)</h3>
<p>O <em>AIC</em> é uma medida estatística de ajuste que penaliza o modelo logístico pelo número de variáveis preditivas. Um modelo com valor mínimo de AIC é considerado um modelo bem ajustado. Desta forma o AIC serve para comparar modelos;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 728.9485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 727.0662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 726.1071</code></pre>
</div>
</div>
<p>Existe uma melhora do AIC do <code>mod1</code> para o <code>mod2</code> e deste para o <code>mod3</code>. O teste estatístico (anova) mostrou que estatisticamente os modelos podem ser considerados equivalentes.</p>
<p>Assim, até aqui, baseado no princípio da simplicidade com eficácia (parcimônia), segue-se com o <code>mod2</code>. Entretanto, em um modelo mais complexo existe a possibilidade de interação entre variáveis.</p>
</section>
<section id="modelo-4-interação" class="level3" data-number="24.6.3">
<h3 data-number="24.6.3" class="anchored" data-anchor-id="modelo-4-interação"><span class="header-section-number">24.6.3</span> Modelo 4: Interação</h3>
<p>Uma interação ocorre quando a relação entre as variáveis preditora e desfecho depende do valor ou do nível assumido por outra variável preditora.<br>
No exemplo em estudo, poderia haver uma interação se, por exemplo, a relação entre <code>classe</code> do passageiro e <code>sobrevivência</code> ao naufrágio dependesse do <code>sexo</code>. Ou seja, passageiros de uma mesma classe no navio podem ter diferentes probabilidades de sobrevivência se forem de sexos diferentes. Diante dessa possibilidade, será ajustado um novo modelo (<code>mod4</code>), incluindo a interação <code>classe * sexo</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  sobreviveu <span class="sc">~</span> classe <span class="sc">*</span> sexo <span class="sc">+</span> idade <span class="sc">+</span> irco,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> treino,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ classe * sexo + idade + irco, family = binomial(link = "logit"), 
    data = treino)

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       5.600274   0.827754   6.766 1.33e-11 ***
classe2          -1.542878   0.860253  -1.794 0.072890 .  
classe3          -4.054871   0.757701  -5.352 8.72e-08 ***
sexomasc         -5.255350   0.754549  -6.965 3.29e-12 ***
idade            -0.037505   0.009137  -4.105 4.05e-05 ***
irco             -0.374646   0.116956  -3.203 0.001359 ** 
classe2:sexomasc  0.246207   0.935090   0.263 0.792322    
classe3:sexomasc  2.717634   0.791466   3.434 0.000595 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1207.42  on 914  degrees of freedom
Residual deviance:  683.37  on 907  degrees of freedom
AIC: 699.37

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Comparando esse novo modelo com o modelo 2 (<code>mod2</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod2, mod4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     df      AIC
mod2  6 727.0662
mod4  8 699.3672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: sobreviveu ~ classe + sexo + idade + irco
Model 2: sobreviveu ~ classe * sexo + idade + irco
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       909     715.07                          
2       907     683.37  2   31.699 1.308e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>conclui-se que houve uma melhora significativa <code>mod2</code> quando se inclui a interação.</p>
<p><u>Interpretação das OR do modelo de interação</u></p>
<p>Como foi visto anteriormente, o cálculo das Odds Ratios (OR) e seus respectivos Intervalos de Confiança (IC<sub>95%</sub>) é fundamental para interpretar o efeito de cada preditor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         OR      2.5 %    97.5 %         p    
(Intercept)      2.7050e+02 6.5093e+01 1908.7073 1.327e-11 ***
classe2          2.1376e-01 2.9620e-02    1.0416 0.0728904 .  
classe3          1.7338e-02 2.7062e-03    0.0613 8.721e-08 ***
sexomasc         5.2195e-03 8.1811e-04    0.0183 3.287e-12 ***
idade            9.6319e-01 9.4576e-01    0.9803 4.050e-05 ***
irco             6.8753e-01 5.3719e-01    0.8499 0.0013586 ** 
classe2:sexomasc 1.2792e+00 2.2264e-01   10.2411 0.7923217    
classe3:sexomasc 1.5144e+01 3.9122e+00  101.1695 0.0005955 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><u>Interpretação dos Efeitos Singulares (Significativos)</u>:</p>
<ul>
<li><strong>Idade</strong>: OR = 0.963. Para cada aumento de um ano na idade, as chances de sobrevivência são 0.963 vezes menores (ou reduzem cerca de 3.7%), mantendo todas as outras variáveis constantes.</li>
<li><strong>classe3</strong> (vs.&nbsp;classe1, para Mulheres): OR = 0.0173. Para uma mulher na 3ª Classe, as chances de sobrevivência são 98% menores do que para uma mulher na 1ª Classe.</li>
<li><strong>sexomasc</strong> (vs.&nbsp;Feminino, na Classe 1): OR = 0.005. Para o homem na 1ª Classe, as chances de sobrevivência são mínimas em relação a uma mulher na 1ª Classe.</li>
</ul>
<p><u>Interpretação da Interação (<code>classe * sexo</code>)</u></p>
<p>Como o termo de interação <code>classe3:sexomasc</code> é <strong>significativo</strong>, isso confirma que o efeito do sexo é <strong>diferente</strong> na Classe 3 em comparação com a Classe 1.</p>
<p>O <strong>OR</strong> final para homens na Classe 3 (vs.&nbsp;Mulheres na Classe 1) é calculado multiplicando os ORs relevantes:</p>
<p><span class="math display">\[
\text{OR}_{\text{H, C3 vs. M, C1}} = \text{OR}_{\text{C3}} \times \text{OR}_{\text{H}} \times \text{OR}_{\text{C3:H}}
\]</span></p>
<p>Usando os resultados:</p>
<p><span class="math display">\[
\text{OR}_{\text{H, C3 vs. M, C1}} \approx 0.005 \times 0.0173 \times 15.1 \approx {0.00131}
\]</span></p>
<p>A OR de interação de 15.1 significa que a desvantagem extremamente alta de ser homem é parcialmente abrandada (multiplicada por 15.1) quando ele está na 3ª Classe. Apesar disso, o efeito total para um homem na 3ª Classe ainda representa uma chance de sobrevivência de quase zero comparada à mulher na 1ª Classe.</p>
<p><u>Preditoras Não Significativas</u></p>
<p>Os termos <code>irco</code>, <code>classe2</code>, e <code>classe2:sexomasc</code> não são estatisticamente significativos, pois seus IC<sub>95%</sub> incluem o valor 1.0. A diferença de chance de sobrevivência entre a 1ª Classe e a 2ª Classe (para mulheres) e a interação <code>classe2:sexomasc</code> não são estatisticamente significativas.</p>
<p>O modelo <code>mod4</code> é estatisticamente robusto, parcimonioso e possui uma Qualidade do Ajuste aceitável, <strong>representando um bom modelo</strong> . portanto, melhor modelo é aquele que inclui:</p>
<ul>
<li><code>classe</code>,</li>
<li><code>idade</code>,</li>
<li><code>sexo</code>,</li>
<li><code>irco</code> e</li>
<li>a interação entre <code>classe</code> e <code>sexo</code>.</li>
</ul>
<section id="tabela-tab_model" class="level4" data-number="24.6.3.1">
<h4 data-number="24.6.3.1" class="anchored" data-anchor-id="tabela-tab_model"><span class="header-section-number">24.6.3.1</span> Tabela tab_model()</h4>
<p>Também é possível comparar facilmente os modelos, usando o AIC com a função <code>tab_model()</code>, disponível no pacote <code>sjPlot</code>:</p>
<div class="cell">
<div id="tbl-tabmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;24.1: Comparação entre o modelo sem interação e o Modelo com interação
</figcaption>
<div aria-describedby="tbl-tabmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Modelo sem interação</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Modelo com interação</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">47.79 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">270.50 <sup>***</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">classe [2]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.38 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.21 <sup></sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">classe [3]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.13 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.02 <sup>***</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">sexo [masc]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01 <sup>***</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">idade</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.97 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.96 <sup>***</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">irco</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.69 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.69 <sup>**</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">classe [2] × sexo [masc]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.28 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">classe [3] × sexo [masc]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">15.14 <sup>***</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">915</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">915</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> Tjur</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.490</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.510</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">AIC</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">727.066</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">699.367</td>
</tr>
<tr class="even">
<td colspan="3" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.05&nbsp;&nbsp;&nbsp;** p&lt;0.01&nbsp;&nbsp;&nbsp;*** p&lt;0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#tbl-tabmodel" class="quarto-xref">Tabela&nbsp;<span>24.1</span></a> mostra a compação dos <code>mod2</code> (modelo sem interação) e <code>mod4</code> (modelo com interação). Observa-se que o AIC no modelo com interação é bem menor, indicando que interação melhorou o ajuste.</p>
<p>O <span class="math inline">\(R^2\)</span> Tjur (também chamado de coeficiente de discriminação) é um dos chamados pseudo-<span class="math inline">\(R^2\)</span> usados em regressão logística. Ele mede o quanto o modelo consegue distinguir entre os grupos da variável resposta binária (por exemplo, quem sobreviveu vs.&nbsp;quem não sobreviveu). Proposto por Tjur <span class="citation" data-cites="tjur2009coefficients">(<a href="referencias.html#ref-tjur2009coefficients" role="doc-biblioref">Tjur 2009</a>)</span>, é uma alternativa simples e intuitiva aos pseudo-<span class="math inline">\(R^2\)</span> de Cox &amp; Snell, Nagelkerke ou McFadden <span class="citation" data-cites="franca2023pseudor">(<a href="referencias.html#ref-franca2023pseudor" role="doc-biblioref">França 2023</a>)</span>. A definição matemática é a diferença entre a média das probabilidades previstas para os casos com resposta = 1 (positivos), e a média das probabilidades previstas para os casos com resposta = 0 (negativos).</p>
<p><span class="math display">\[
\mathrm{R}_{Tjur}^{2} =\overline{p}_{y=1}-\overline{p}_{y=0}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Médias condicionais</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>mean_p_y1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob[treino<span class="sc">$</span>sobreviveu <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>mean_p_y0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob[treino<span class="sc">$</span>sobreviveu <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mean_p_y1, mean_p_y0))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6922983 0.1819453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R² Tjur</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>R2_Tjur <span class="ot">&lt;-</span> mean_p_y1 <span class="sc">-</span> mean_p_y0</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>R2_Tjur</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.510353</code></pre>
</div>
</div>
<p>O modelo prevê em média 0.69 de probabilidade de sobrevivência para quem realmente sobreviveu e 0.18 para quem não sobreviveu, resultando num <span class="math inline">\(\mathrm{R}_{Tjur}^{2} = 0.51\)</span>. Isso significa que o modelo tem uma boa capacidade de discriminar entre sobreviventes e não sobreviventes.</p>
<ul>
<li><p>Se o modelo não tem poder discriminativo, as médias das probabilidades previstas para os dois grupos serão muito próximas → <span class="math inline">\(\mathrm{R}_{Tjur}^{2}\)</span> ≈ 0.</p></li>
<li><p>Se o modelo separa bem os grupos, a média das probabilidades para os positivos será alta e para os negativos será baixa → <span class="math inline">\(\mathrm{R}_{Tjur}^{2}\)</span> próximo de 1.</p></li>
<li><p>Valores típicos em regressão logística raramente chegam perto de 1; um <span class="math inline">\(\mathrm{R}_{Tjur}^{2}\)</span> de 0.3–0.5 já indica um modelo com boa capacidade discriminativa.</p></li>
</ul>
<p>Pode-se calcular o <span class="math inline">\(\mathrm{R}_{Tjur}^{2}\)</span>, usando a função <code>r2_tjur()</code> do pacote <code>performance</code> <span class="citation" data-cites="easystats2025R2Tjur">(<a href="referencias.html#ref-easystats2025R2Tjur" role="doc-biblioref">Team 2025</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_tjur</span>(mod4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tjur's R2 
 0.510353 </code></pre>
</div>
</div>
<p>Isto significa, como dito, uma boa capacidade de dicriminação. Entretanto, não confundir com o <span class="math inline">\(R^2\)</span> da regressão linear, pois o <span class="math inline">\(\mathrm{R}_{Tjur}^{2}\)</span> mede a capacidade discriminação, ou seja, quão bem o modelo separa os dois grupos da resposta binária. Enquanto o <span class="math inline">\(R^2\)</span> (Coeficiente de determinação), mede a proporção da variância da variável dependente que é explicada pelo modelo.</p>
</section>
</section>
<section id="multicolinearidade" class="level3" data-number="24.6.4">
<h3 data-number="24.6.4" class="anchored" data-anchor-id="multicolinearidade"><span class="header-section-number">24.6.4</span> Multicolinearidade</h3>
<p>A <strong>multicolinearidade</strong> ocorre quando duas ou mais variáveis preditoras estão altamente correlacionadas, o que infla o erro padrão dos coeficientes, tornando-os instáveis. Para verificar a multicolinearidade, pode-se usar o <strong>Fator de Inflação da Variância (VIF)</strong> através da função <code>check_collinearity()</code> do pacote <code>performance</code>, pois fornece análise mais clara da colinearidade em modelos GLM com interações quando comparada a função <code>vif()</code> do pacote <code>car</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(mod4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model has interaction terms. VIFs might be inflated.
  Try to center the variables used for the interaction, or check
  multicollinearity among predictors of a model without interaction terms.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

  Term  VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
 idade 1.27 [ 1.18,  1.39]     1.13      0.79     [0.72, 0.84]
  irco 1.09 [ 1.04,  1.21]     1.05      0.91     [0.83, 0.96]

High Correlation

        Term   VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
      classe 31.88 [28.11, 36.18]     5.65      0.03     [0.03, 0.04]
        sexo 13.99 [12.37, 15.84]     3.74      0.07     [0.06, 0.08]
 classe:sexo 47.81 [42.13, 54.28]     6.91      0.02     [0.02, 0.02]</code></pre>
</div>
</div>
<p>Se o VIF &lt; 5 geralmente é aceitável e o modelo deve ser mantido. Um VIF acima de 10 é uma preocupação significativa e deve ser considerada a remoção de uma das variáveis correlacionadas. Quando o VIF se encontra enter 5 e 10 é uma preocupalçao moderada e a decisão depende do contexto. Pode-se manter o modelo, mas estar ciente da instabilidade potencial.</p>
<p>A interação <code>classe * sexo</code> gera redundância matemática com os termos principais, inflando os VIFs. Isso não invalida o modelo, mas indica que os coeficientes podem ser instáveis (mudam a amostra for alterada ou houver inclusão/exclusão de variáveis). O modelo ainda é utilizável, mas os coeficientes devem ser interpretados com cautela, especialmente os de <code>classe</code> e da interação <code>classe:sexo</code>.</p>
<p>Concluindo e levando em consideração o valor do VIF ajustado:</p>
<ul>
<li><code>idade</code> e <code>irco</code> <span class="math inline">\(\to\)</span> seguros, sem colinearidade (VIF ajustado &lt; 5).<br>
</li>
<li><code>classe</code>, <code>sexo</code> e <code>classe:sexo</code> <span class="math inline">\(\to\)</span> apresentam colinearidade moderada/alta, mas ainda abaixo do limiar crítico (10).</li>
</ul>
<p>O modelo continua válido, mas os efeitos principais e de interação devem ser interpretados com cuidado.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusão sobre os modelos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Foram ajustados dois modelos de regressão logística: um modelo simples, contendo apenas os efeitos principais, e um modelo com interação entre as variáveis classe e sexo. O modelo com interação apresentou melhor ajuste (menor AIC e deviance), além de indicar que o efeito do sexo depende da classe, especialmente na terceira classe, onde os homens tiveram probabilidade significativamente menor de sobrevivência. Contudo, a inclusão da interação elevou os valores de VIF, revelando colinearidade moderada a alta entre os termos principais e o termo de interação. Essa situação pode comprometer a estabilidade dos coeficientes e dificultar a interpretação direta dos efeitos. Por esse motivo, optou-se por apresentar ambos os modelos: o <strong>modelo simples</strong>, mais parcimonioso e estável, para interpretação dos efeitos principais; e o <strong>modelo com interação</strong>, para evidenciar a dependência entre as variáveis e o ganho em capacidade explicativa, ainda que com maior complexidade.</p>
<p>O modelo com interação entre <code>classe</code> e <code>sexo</code> apresentou melhor ajuste estatístico, mas elevou os índices de colinearidade, indicando menor estabilidade dos coeficientes. Já o modelo simples mostrou-se mais parcimonioso e estável. Assim, ambos foram considerados: o modelo sem interação para interpretação dos efeitos principais e o modelo com interação para evidenciar dependências entre variáveis.</p>
</div>
</div>
</section>
</section>
<section id="avaliação-preditiva-com-os-dados-de-teste" class="level2" data-number="24.7">
<h2 data-number="24.7" class="anchored" data-anchor-id="avaliação-preditiva-com-os-dados-de-teste"><span class="header-section-number">24.7</span> Avaliação preditiva com os dados de teste</h2>
<section id="qualidade-do-modelo" class="level3" data-number="24.7.1">
<h3 data-number="24.7.1" class="anchored" data-anchor-id="qualidade-do-modelo"><span class="header-section-number">24.7.1</span> Qualidade do modelo</h3>
<p>Normalmente, o objetivo da construção de um modelo é ser capaz de prever, com a maior acurácia possível, a variável resposta para novos dados. Uma boa maneira de avaliar a acurácia de um modelo é monitorar seu desempenho em novos dados (<code>teste</code>) e contar com que frequência ele prevê o resultado correto.</p>
<p>Suponha que, se a probabilidade de o paciente sobreviver for inferior a 50%, será considerado que o resultado previsto é <strong>não sobrevivência</strong>; caso contrário, o resultado previsto é sucesso, o paciente <strong>sobreviveu</strong>.</p>
<p>Inicialmente, constroi-se uma tabela de contingência comparando o desempenho do modelo, usando os dados observados nos dados <code>teste</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um vetor de probabilidades previstas no dataframe teste</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>prob_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>prob_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação binária (ponto de corte 0.5) ----</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_mod2 <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_mod4 <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar as predições em fatores e colocar rótulos</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>pred_mod2  <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_mod2,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>pred_mod4  <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_mod4,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar o resultado observado com o resultado previsto</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">observado =</span> teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">previsto  =</span> pred_mod2)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>tab4 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">observado =</span> teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">previsto  =</span> pred_mod4)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         previsto
observado   0   1
        0 228  22
        1  31 110</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tab4</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         previsto
observado   0   1
        0 233  17
        1  34 107</code></pre>
</div>
</div>
<p>A partir da tabela de contingência (tab2) dos resultados previstos e observados, verifica-se que o modelo 2:</p>
<ul>
<li>previu corretamente que 228 passageiros que não sobreviveram.<br>
</li>
<li>previu incorretamente 31 passageiros que não sobreviveram.<br>
</li>
<li>previu incorretamente que 17 passageiros que sobreviveram, e<br>
</li>
<li>previu corretamente 110 passageiros que sobreviveram.</li>
</ul>
<p>A partir da tabela de contingência (tab4) dos resultados previstos e observados, verifica-se que o modelo 4:</p>
<ul>
<li>previu corretamente que 233 passageiros que não sobreviveram.<br>
</li>
<li>previu incorretamente 34 passageiros que não sobreviveram.<br>
</li>
<li>previu incorretamente que 17 passageiros que sobreviveram, e<br>
</li>
<li>previu corretamente 107 passageiros que sobreviveram.</li>
</ul>
<p>A porcentagem de previsões corretas, também chamada de <strong>acurácia</strong>, é a soma das previsões corretas (verdadeiros positivos + verdadeiros negativos) dividida pelo número total de previsões:</p>
<p><span class="math display">\[
acurácia = \frac{VP + VN}{VP + VN + FP + FN}
\]</span></p>
<p>Usando a tabela de contingência <code>tab2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>acuracia2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tab2)) <span class="sc">/</span> <span class="fu">sum</span>(tab2)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>acuracia2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8644501</code></pre>
</div>
</div>
<p>O modelo tem uma alta acurácia (86%), isso indica um bom desempenho geral. Um modelo é considerado razoavelmente bom se a acurácia do modelo for superior a 70%.</p>
<p>Usando a tabela de contingência <code>tab4</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>acuracia4 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tab4)) <span class="sc">/</span> <span class="fu">sum</span>(tab4)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>acuracia4</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8695652</code></pre>
</div>
</div>
<p>O modelo tem uma alta acurácia (87%), isso indica um bom desempenho geral.</p>
<p>Ambos modelos apresentam uma boa acurácia!</p>
<p>Embora a acurácia seja a maneira mais intuitiva e fácil de medir o desempenho preditivo de um modelo, ela apresenta algumas desvantagens, principalmente porque há necessidade de escolher um limiar arbitrário (aqui foi escolhido 50%) a partir do qual uma nova observação é classificada como 1 ou 0. Poderia ser escolhido outro limite e os resultados seriam diferentes!</p>
<p>Usando uma matriz de confusão, através da função <code>confusionMatrix()</code> do pacote <code>caret</code> pode-se calcular a acurácia e outras métricas de avaliação da qualidade (validade) do modelo :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>conf_matrix2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_mod2, teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 228  31
         1  22 110
                                          
               Accuracy : 0.8645          
                 95% CI : (0.8265, 0.8968)
    No Information Rate : 0.6394          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.7019          
                                          
 Mcnemar's Test P-Value : 0.2718          
                                          
            Sensitivity : 0.7801          
            Specificity : 0.9120          
         Pos Pred Value : 0.8333          
         Neg Pred Value : 0.8803          
             Prevalence : 0.3606          
         Detection Rate : 0.2813          
   Detection Prevalence : 0.3376          
      Balanced Accuracy : 0.8461          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>conf_matrix4 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_mod4, teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 233  34
         1  17 107
                                          
               Accuracy : 0.8696          
                 95% CI : (0.8321, 0.9013)
    No Information Rate : 0.6394          
    P-Value [Acc &gt; NIR] : &lt; 2e-16         
                                          
                  Kappa : 0.7095          
                                          
 Mcnemar's Test P-Value : 0.02506         
                                          
            Sensitivity : 0.7589          
            Specificity : 0.9320          
         Pos Pred Value : 0.8629          
         Neg Pred Value : 0.8727          
             Prevalence : 0.3606          
         Detection Rate : 0.2737          
   Detection Prevalence : 0.3171          
      Balanced Accuracy : 0.8454          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>A <strong>Sensibilidade (Recall)</strong> é a proporção de verdadeiros positivos (VP) identificados corretamente. . É obtida pela fórmula:</p>
<p><span class="math display">\[
sensibilidade = \frac{VP}{VP + FN}
\]</span></p>
<p>O <code>mod2</code> identifica corretamete 70,2% e o <code>mod4</code> 75,9% dos verdadeiros positivos. Isto significa que apresentam 29,8% e 24,1% de falsos negativos. São valores que dependendo do contexto podem exigir atenção, principalmente na área da saúde. Entre os modelos, o mod4 gera menos falsos negativos, houve um pequeno avanço. A análise deve ser feita em conjunto com outras métricas.</p>
<p>A <strong>Especificidade</strong> é a proporção de verdadeiros negativos(VN). A fórmula para calcular a especificidade é:</p>
<p><span class="math display">\[
especificidade = \frac{VN}{FP + VN}
\]</span></p>
<p>O <code>mod2</code> reconhece 91.2% dos verdadeiros negativos e o mod4, 93,2%. Ambos tem uma baixa taxa de falos positivos.</p>
<p>O <strong>Valor P do Teste de McNemar</strong> testa se há viés significativo na classificação dos erros. O valor alto (<em>p</em> = 0.2718), no <code>mod2</code> sugere que os erros entre classes não são estatisticamente diferentes. Já no <code>mod4</code>, o valor <em>p</em> &lt; 0.05, indica que ele não é neutro nos erros, não erra de forma aleatória, mas sim enviesada. Isso pode ser problemático quando os falsos negativos forem graves (por ex.: área da saúde) e aí o modelo pode ser inadequado. Isso não invalida o <code>mod4</code>, mas mostra que ele precisa ser avaliado com cuidado quanto ao tipo de erro que gera. Avaliar outras métricas junto (sensibilidade, especificidade, AUC).</p>
<p>O <strong>Kappa</strong> mede concordância ajustada para a distribuição dos dados. Um valor próximo de 1 indica boa concordância entre previsões e valores reais.</p>
<p>O <strong>escore F1</strong> (não listado diretamente) representa o equilíbrio entre precisão e recall. Pode ser obtido pela equação:</p>
<p><span class="math display">\[
F_{1} = 2 \times \frac{VPP \times sensibilidade}{VPP + sensibilidade}
\]</span></p>
<p>Ou consultando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>conf_matrix2<span class="sc">$</span>byClass[<span class="dv">7</span>]</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       F1 
0.8058608 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>conf_matrix4<span class="sc">$</span>byClass[<span class="dv">7</span>]</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       F1 
0.8075472 </code></pre>
</div>
</div>
<p>Ambos os modelos têm <span class="math inline">\(F_{1}\approx 0.81\)</span>, o que indica bom equilíbrio entre sensibilidade e precisão. A diferença entre eles é mínima (0.0017), mostrando que em termos de qualidade preditiva global, os dois modelos são praticamente equivalentes.</p>
<p>A <strong>Precisão</strong> é a proporção de previsões positivas que estavam corretas, também denominada de <strong>valor preditivo positivo</strong> (VPP). A precisão do <code>mod2</code> é igual 83.3% e do mod4 86.3%, ambas são consideradas valores altos.</p>
</section>
<section id="auc-e-curva-roc" class="level3" data-number="24.7.2">
<h3 data-number="24.7.2" class="anchored" data-anchor-id="auc-e-curva-roc"><span class="header-section-number">24.7.2</span> AUC e curva ROC</h3>
<p>Outra forma comum de avaliar a qualidade de um modelo é calcular a <strong>AUC</strong> (Área Sob a Curva) e traçar a <strong>curva ROC</strong> (Característica de Operação do Receptor). A curva ROC mostra a relação entre <strong>sensibilidade(recall)</strong> e <strong>1 - especificidade (FP)</strong> para diferentes limiares de classificação. A AUC resume a curva ROC em um único número (quanto mais próximo de 1, melhor o modelo). A curva ROC/AUC pode ser calculada com os dados treino, mas tende a ser otimista, já que o modelo foi ajustado nesses dados. O ideal é usar os dados teste (ou de validação), porque mede o desempenho em dados não vistos, refletindo a capacidade de generalização do modelo.</p>
<p>Isso pode ser facilmente alcançado graças à função <code>roc()</code> e <code>ggroc()</code> do pacote <code>pROC</code> associado ao <code>ggplot2</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerar objetos ROC</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>roc_mod2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_mod2)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>roc_mod4 <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_mod4)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular AUCs</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>auc_mod2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_mod2)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>auc_mod4 <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_mod4)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para ggroc</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>roc_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Modelo simples"</span> <span class="ot">=</span> roc_mod2,</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Modelo interação"</span> <span class="ot">=</span> roc_mod4)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot com ggplot2</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(roc_list, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Curvas ROC"</span>,</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"1 - Especificidade (Taxa de Falsos Positivos)"</span>,</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensibilidade (Taxa de Verdadeiros Positivos)"</span>) <span class="sc">+</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC simples: "</span>, <span class="fu">round</span>(auc_mod2, <span class="dv">3</span>)),</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC interação: "</span>, <span class="fu">round</span>(auc_mod4, <span class="dv">3</span>)),</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-auc2-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-auc2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="24-reglogbin_files/figure-html/fig-auc2-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-auc2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.9: Comparação do modelo simples com o modelo com interação
</figcaption>
</figure>
</div>
</div>
</div>
<p>A AUC (Área sob a Curva ROC) indica a qualidade do modelo (veja também a Seção 21.6):</p>
<ul>
<li><span class="math inline">\(AUC \approx 0.5\)</span>: O modelo não tem poder preditivo (equivalente ao puro acaso).</li>
<li><span class="math inline">\(AUC &gt; 0.7\)</span>: Modelo razoável.</li>
<li><span class="math inline">\(AUC &gt; 0.8\)</span>: Modelo muito bom.</li>
<li><span class="math inline">\(AUC &gt; 0.9\)</span>: Excelebte desempenho</li>
</ul>
<p>Usando as métricas de validade, a curva ROC e a AUC, conclui-se que:</p>
<p>Após a avaliação dos modelos ajustados, observou-se que o modelo com interação entre classe e sexo (<code>mod4</code>) apresentou melhor ajuste estatístico, com menor AIC e deviance, além de capturar nuances importantes entre as variáveis. No entanto, esse modelo também apresentou colinearidade moderada e padrão de erro enviesado, conforme indicado pelo teste de McNemar (<em>p</em> &lt; 0,05), o que pode comprometer a estabilidade dos coeficientes e a neutralidade preditiva. Por outro lado, o modelo simples (<em>mod2</em>) demonstrou desempenho preditivo praticamente equivalente, com AUC ligeiramente superior (0,919 vs.&nbsp;0,918), menor colinearidade e maior robustez interpretativa. Diante disso, optou-se por priorizar o modelo simples para fins de interpretação e comunicação dos resultados, mantendo o modelo com interação como referência complementar para análise de padrões específicos</p>
</section>
<section id="comparar-duas-curvas-roc-treino-vs-teste" class="level3" data-number="24.7.3">
<h3 data-number="24.7.3" class="anchored" data-anchor-id="comparar-duas-curvas-roc-treino-vs-teste"><span class="header-section-number">24.7.3</span> Comparar duas curvas ROC (treino vs teste)</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas no treino e teste</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>prob_treino <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> treino, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>prob_teste  <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas ROC</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>roc_treino <span class="ot">&lt;-</span> <span class="fu">roc</span>(treino<span class="sc">$</span>sobreviveu, prob_treino)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>roc_teste  <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_teste)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC e IC95% para treino</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>auc_treino <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_treino)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>ci_treino  <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(roc_treino)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC e IC95% para teste</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>auc_teste <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_teste)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>ci_teste  <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(roc_teste)</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar textos para anotação</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>texto_treino <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Treino: AUC = "</span>, <span class="fu">round</span>(auc_treino, <span class="dv">3</span>),</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>                       <span class="st">" (IC95%: "</span>, <span class="fu">round</span>(ci_treino[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(ci_treino[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>texto_teste <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Teste: AUC = "</span>, <span class="fu">round</span>(auc_teste, <span class="dv">3</span>),</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" (IC95%: "</span>, <span class="fu">round</span>(ci_teste[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">round</span>(ci_teste[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar ambas curvas ROC com ggroc</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(<span class="fu">list</span>(<span class="at">Treino =</span> roc_treino, <span class="at">Teste =</span> roc_teste), <span class="at">aes =</span> <span class="fu">c</span>(<span class="st">"color"</span>)) <span class="sc">+</span></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Curvas ROC - Treino vs Teste"</span>,</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensibilidade"</span>,</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"1 - Especificidade"</span>) <span class="sc">+</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> texto_treino,</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> texto_teste,</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-treino_teste" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-treino_teste-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="24-reglogbin_files/figure-html/fig-treino_teste-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-treino_teste-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24.10: Comparação do modelo simples com o modelo com interação
</figcaption>
</figure>
</div>
</div>
</div>
<p>Além de observar visualmente, pode-se realizar um teste estatístico, o Teste de Delong <span class="citation" data-cites="delong1988comparing">(<a href="referencias.html#ref-delong1988comparing" role="doc-biblioref">DeLong, DeLong, e Clarke-Pearson 1988</a>)</span>, para verificar se a diferença entre as AUCs das curvas tem significância estatística:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas no treino e teste</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>prob_treino <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> treino, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>prob_teste  <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas ROC</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>roc_treino <span class="ot">&lt;-</span> <span class="fu">roc</span>(treino<span class="sc">$</span>sobreviveu, prob_treino)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>roc_teste  <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_teste)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparação estatística com teste de DeLong</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>teste_delong <span class="ot">&lt;-</span> <span class="fu">roc.test</span>(roc_treino, roc_teste, <span class="at">method =</span> <span class="st">"delong"</span>)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultado</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>teste_delong</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DeLong's test for two ROC curves

data:  roc_treino and roc_teste
D = -1.4695, df = 883.58, p-value = 0.1421
alternative hypothesis: true difference in AUC is not equal to 0
sample estimates:
AUC of roc1 AUC of roc2 
  0.8884194   0.9179291 </code></pre>
</div>
</div>
<p>A saída do teste retorna um valor <em>p</em> = 0.1421 (&lt; 0.05) indicando que a diferença entre os AUCs é estatisticamente não significativa. Os modelo apresentam AUCs semelhantes em ambos dados.</p>
</section>
</section>
<section id="relato-dos-resultados" class="level2" data-number="24.8">
<h2 data-number="24.8" class="anchored" data-anchor-id="relato-dos-resultados"><span class="header-section-number">24.8</span> Relato dos resultados</h2>
<blockquote class="blockquote">
<p>Para avaliar a capacidade de generalização do modelo, foram comparadas as curvas ROC obtidas nos conjuntos de treino e teste. O modelo apresentou AUC de 0,888 no treino (IC95%: 0,864–0,913) e AUC de 0,918 no teste (IC95%: 0,887–0,949), indicando desempenho superior nos dados não vistos. A sobreposição dos intervalos de confiança sugere que a diferença pode não ser estatisticamente significativa, mas reforça a robustez do modelo. O Teste de Delong confirma que a diferença não é estatisticamente significativa (<em>p</em> = 0.1421), A curva ROC do teste posicionou-se mais próxima do canto superior esquerdo, evidenciando maior capacidade discriminativa e ausência de sobreajuste (<em>overfitting</em>). Esses resultados demonstram que o modelo é confiável e apresenta boa performance preditiva fora da amostra de treinamento.</p>
</blockquote>
<p>Pode-se também relatar os resultados de uma regressão logística binária usando uma tabela (<a href="#tbl-finalreg" class="quarto-xref">Tabela&nbsp;<span>24.2</span></a>) gerada, por exemplo, pela função <code>tbl_regression()</code> do pacote <code>gtsummary</code> <span class="quarto-unresolved-ref">?sec-gtsummary</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)  <span class="co"># para partial, opcional</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  mod4,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    classe <span class="sc">~</span> <span class="st">"Classe"</span>,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    sexo   <span class="sc">~</span> <span class="st">"Sexo"</span>,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    idade  <span class="sc">~</span> <span class="st">"Idade"</span>,</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">classe:sexo</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interação Classe × Sexo"</span>),</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate_fun =</span> <span class="fu">partial</span>(style_sigfig, <span class="at">digits =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"**Variável**"</span>,</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    p.value <span class="sc">~</span> <span class="st">"**Valor p**"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-finalreg" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-finalreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;24.2: Resultados da Regressão Logística Binária - modelo com interação
</figcaption>
<div aria-describedby="tbl-finalreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="shfbrvgccm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#shfbrvgccm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#shfbrvgccm thead, #shfbrvgccm tbody, #shfbrvgccm tfoot, #shfbrvgccm tr, #shfbrvgccm td, #shfbrvgccm th {
  border-style: none;
}

#shfbrvgccm p {
  margin: 0;
  padding: 0;
}

#shfbrvgccm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#shfbrvgccm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#shfbrvgccm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#shfbrvgccm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#shfbrvgccm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#shfbrvgccm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#shfbrvgccm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#shfbrvgccm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#shfbrvgccm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#shfbrvgccm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#shfbrvgccm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#shfbrvgccm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#shfbrvgccm .gt_spanner_row {
  border-bottom-style: hidden;
}

#shfbrvgccm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#shfbrvgccm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#shfbrvgccm .gt_from_md > :first-child {
  margin-top: 0;
}

#shfbrvgccm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#shfbrvgccm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#shfbrvgccm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#shfbrvgccm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#shfbrvgccm .gt_row_group_first td {
  border-top-width: 2px;
}

#shfbrvgccm .gt_row_group_first th {
  border-top-width: 2px;
}

#shfbrvgccm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#shfbrvgccm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#shfbrvgccm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#shfbrvgccm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#shfbrvgccm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#shfbrvgccm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#shfbrvgccm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#shfbrvgccm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#shfbrvgccm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#shfbrvgccm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#shfbrvgccm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#shfbrvgccm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#shfbrvgccm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#shfbrvgccm .gt_left {
  text-align: left;
}

#shfbrvgccm .gt_center {
  text-align: center;
}

#shfbrvgccm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#shfbrvgccm .gt_font_normal {
  font-weight: normal;
}

#shfbrvgccm .gt_font_bold {
  font-weight: bold;
}

#shfbrvgccm .gt_font_italic {
  font-style: italic;
}

#shfbrvgccm .gt_super {
  font-size: 65%;
}

#shfbrvgccm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#shfbrvgccm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#shfbrvgccm .gt_indent_1 {
  text-indent: 5px;
}

#shfbrvgccm .gt_indent_2 {
  text-indent: 10px;
}

#shfbrvgccm .gt_indent_3 {
  text-indent: 15px;
}

#shfbrvgccm .gt_indent_4 {
  text-indent: 20px;
}

#shfbrvgccm .gt_indent_5 {
  text-indent: 25px;
}

#shfbrvgccm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#shfbrvgccm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variável</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Valor p</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Classe</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="estimate">0.214</td>
<td class="gt_row gt_center" headers="conf.low">0.030, 1.04</td>
<td class="gt_row gt_center" headers="p.value">0.073</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="estimate">0.017</td>
<td class="gt_row gt_center" headers="conf.low">0.003, 0.061</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Sexo</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;fem</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;masc</td>
<td class="gt_row gt_center" headers="estimate">0.005</td>
<td class="gt_row gt_center" headers="conf.low">0.001, 0.018</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Idade</td>
<td class="gt_row gt_center" headers="estimate">0.963</td>
<td class="gt_row gt_center" headers="conf.low">0.946, 0.980</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">irco</td>
<td class="gt_row gt_center" headers="estimate">0.688</td>
<td class="gt_row gt_center" headers="conf.low">0.537, 0.850</td>
<td class="gt_row gt_center" headers="p.value">0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Interação Classe × Sexo</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2 * masc</td>
<td class="gt_row gt_center" headers="estimate">1.28</td>
<td class="gt_row gt_center" headers="conf.low">0.223, 10.2</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3 * masc</td>
<td class="gt_row gt_center" headers="estimate">15.1</td>
<td class="gt_row gt_center" headers="conf.low">3.91, 101</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="exercícios" class="level2" data-number="24.9">
<h2 data-number="24.9" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">24.9</span> Exercícios</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercício 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para fins ilustrativos, suponha-se agora que se deseja prever a probabilidade de um “novo” passageiro sobreviver. Esse passageiro seja uma mulher de 35 anos, que comprou bilhete de viagem na terceira classe e viaja com o marido.</p>
<p><u>Solução</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>novo_passageiro1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">35</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"fem"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">3</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro1, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro1, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo simples (mod2): 0.585 IC95%: 0.494 0.672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo com interação (mod4): 0.465 IC95%: 0.365 0.567</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercício 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calcular a probabilidade de sobreviver do esposo dessa passageira. Ele tem 40 anos.</p>
<p><u>Solução</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>novo_passageiro2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">40</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"masc"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">3</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro2, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro2, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo simples (mod2): 0.037 IC95%: 0.023 0.059</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo com interação (mod4): 0.054 IC95%: 0.034 0.085</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercício 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suponha-se que se deseja prever a probabilidade de um “novo” passageiro sobreviver. Esse passageiro é uma mulher de 35 anos, que comprou bilhete de viagem na primeira classe e viaja com o marido</p>
<p><u>Solução</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>novo_passageiro3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">35</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"fem"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">1</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro3, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro3, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo simples (mod2): 0.914 IC95%: 0.870 0.944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo com interação (mod4): 0.980 IC95%: 0.924 0.995</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercício 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Quala a probabilidade de sobreviver do esposo, 40 anos, da mulher do esxercício 3?</p>
<p><u>Solução</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>novo_passageiro4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">40</span>,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"masc"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">1</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro4, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro4, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo simples (mod2): 0.226 IC95%: 0.164 0.303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo com interação (mod4): 0.178 IC95%: 0.119 0.257</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comentário sobre os exercícios
</div>
</div>
<div class="callout-body-container callout-body">
<p>Foi verificado que os modelos são estatisticamente válidos. Isso dá segurança para confiar nas estimativas geradas. Mesmo que os modelos <code>mod2</code> (simples) e <code>mod4</code> (com interação) tenham dado estimativas diferentes de sobrevivência, isso não quer dizer que essas diferenças sejam realmente significativas. Quando se observa os intervalos de confiança de 95% na <a href="#tbl-tabmodelos" class="quarto-xref">Tabela&nbsp;<span>24.3</span></a>, ve-se que eles se sobrepõem em todos os casos. Isso quer dizer que, apesar de um modelo prever uma chance um pouco maior ou menor, essa diferença está dentro da margem de erro — ou seja, pode ter acontecido só por variação natural dos dados. O modelo com interação até se saiu melhor no teste geral (aquele que compara o desempenho dos dois), mas quando se olha para cada passageiro individual, não dá pra afirmar com segurança que um modelo está “mais certo” que o outro. Por isso, é importante considerar não só o número da previsão, mas também o intervalo de confiança que vem junto com ela</p>
<div class="cell">
<div id="tbl-tabmodelos" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabmodelos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;24.3: Previsões com os modelos simples e com interação
</figcaption>
<div aria-describedby="tbl-tabmodelos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-bec1e134{}.cl-beb07386{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-beb073a4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-beb6e13a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-beb70c8c{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70c96{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70ca0{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70ca1{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70caa{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cb4{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cb5{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cbe{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cc8{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cc9{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cd2{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cd3{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cdc{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cdd{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70ce6{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70ce7{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cf0{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cf1{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70cfa{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d04{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d0e{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d0f{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d18{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d19{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d22{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d2c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d2d{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d36{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d40{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d41{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d4a{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d4b{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d54{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d55{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d56{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d5e{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d5f{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d68{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d69{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d72{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d73{width:0.913in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d7c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d7d{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d86{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d87{width:1.606in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d88{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d90{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beb70d91{width:1.135in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-bec1e134"><thead><tr style="overflow-wrap:break-word;"><th class="cl-beb70c8c"><p class="cl-beb6e13a"><span class="cl-beb07386">Exercício</span></p></th><th class="cl-beb70c96"><p class="cl-beb6e13a"><span class="cl-beb07386">Idade</span></p></th><th class="cl-beb70ca0"><p class="cl-beb6e13a"><span class="cl-beb07386">Sexo</span></p></th><th class="cl-beb70ca1"><p class="cl-beb6e13a"><span class="cl-beb07386">Classe</span></p></th><th class="cl-beb70caa"><p class="cl-beb6e13a"><span class="cl-beb07386">Nº irmãos/cônjuges</span></p></th><th class="cl-beb70cb4"><p class="cl-beb6e13a"><span class="cl-beb07386">Modelo</span></p></th><th class="cl-beb70cb5"><p class="cl-beb6e13a"><span class="cl-beb07386">Estimativa</span></p></th><th class="cl-beb70cbe"><p class="cl-beb6e13a"><span class="cl-beb07386">IC95%</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-beb70cc8"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70cc9"><p class="cl-beb6e13a"><span class="cl-beb073a4">35</span></p></td><td class="cl-beb70cd2"><p class="cl-beb6e13a"><span class="cl-beb073a4">fem</span></p></td><td class="cl-beb70cd3"><p class="cl-beb6e13a"><span class="cl-beb073a4">3ª</span></p></td><td class="cl-beb70cdc"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70cdd"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod2</span></p></td><td class="cl-beb70ce6"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.585</span></p></td><td class="cl-beb70ce7"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.494–0.672</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70cf0"><p class="cl-beb6e13a"><span class="cl-beb073a4"></span></p></td><td class="cl-beb70cf1"><p class="cl-beb6e13a"><span class="cl-beb073a4">40</span></p></td><td class="cl-beb70cfa"><p class="cl-beb6e13a"><span class="cl-beb073a4">masc</span></p></td><td class="cl-beb70d04"><p class="cl-beb6e13a"><span class="cl-beb073a4">1ª</span></p></td><td class="cl-beb70d0e"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70d0f"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod4</span></p></td><td class="cl-beb70d18"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.465</span></p></td><td class="cl-beb70d19"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.365–0.567</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70cc8"><p class="cl-beb6e13a"><span class="cl-beb073a4">2</span></p></td><td class="cl-beb70cc9"><p class="cl-beb6e13a"><span class="cl-beb073a4">35</span></p></td><td class="cl-beb70cd2"><p class="cl-beb6e13a"><span class="cl-beb073a4">fem</span></p></td><td class="cl-beb70cd3"><p class="cl-beb6e13a"><span class="cl-beb073a4">3ª</span></p></td><td class="cl-beb70cdc"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70cdd"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod2</span></p></td><td class="cl-beb70ce6"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.037</span></p></td><td class="cl-beb70ce7"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.023–0.059</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70d22"><p class="cl-beb6e13a"><span class="cl-beb073a4"></span></p></td><td class="cl-beb70d2c"><p class="cl-beb6e13a"><span class="cl-beb073a4">40</span></p></td><td class="cl-beb70d2d"><p class="cl-beb6e13a"><span class="cl-beb073a4">masc</span></p></td><td class="cl-beb70d36"><p class="cl-beb6e13a"><span class="cl-beb073a4">1ª</span></p></td><td class="cl-beb70d40"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70d41"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod4</span></p></td><td class="cl-beb70d4a"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.054</span></p></td><td class="cl-beb70d4b"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.034, 0.085</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70cc8"><p class="cl-beb6e13a"><span class="cl-beb073a4">3</span></p></td><td class="cl-beb70cc9"><p class="cl-beb6e13a"><span class="cl-beb073a4">35</span></p></td><td class="cl-beb70cd2"><p class="cl-beb6e13a"><span class="cl-beb073a4">fem</span></p></td><td class="cl-beb70cd3"><p class="cl-beb6e13a"><span class="cl-beb073a4">3ª</span></p></td><td class="cl-beb70cdc"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70cdd"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod2</span></p></td><td class="cl-beb70ce6"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.914</span></p></td><td class="cl-beb70ce7"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.870–0.944</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70d54"><p class="cl-beb6e13a"><span class="cl-beb073a4"></span></p></td><td class="cl-beb70d55"><p class="cl-beb6e13a"><span class="cl-beb073a4">40</span></p></td><td class="cl-beb70d56"><p class="cl-beb6e13a"><span class="cl-beb073a4">masc</span></p></td><td class="cl-beb70d5e"><p class="cl-beb6e13a"><span class="cl-beb073a4">1ª</span></p></td><td class="cl-beb70d5f"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70d68"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod4</span></p></td><td class="cl-beb70d69"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.980</span></p></td><td class="cl-beb70d72"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.924–0.995</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70cc8"><p class="cl-beb6e13a"><span class="cl-beb073a4">4</span></p></td><td class="cl-beb70cc9"><p class="cl-beb6e13a"><span class="cl-beb073a4">35</span></p></td><td class="cl-beb70cd2"><p class="cl-beb6e13a"><span class="cl-beb073a4">fem</span></p></td><td class="cl-beb70cd3"><p class="cl-beb6e13a"><span class="cl-beb073a4">3ª</span></p></td><td class="cl-beb70cdc"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70cdd"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod2</span></p></td><td class="cl-beb70ce6"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.236</span></p></td><td class="cl-beb70ce7"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.164–0.303</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beb70d73"><p class="cl-beb6e13a"><span class="cl-beb073a4"></span></p></td><td class="cl-beb70d7c"><p class="cl-beb6e13a"><span class="cl-beb073a4">40</span></p></td><td class="cl-beb70d7d"><p class="cl-beb6e13a"><span class="cl-beb073a4">masc</span></p></td><td class="cl-beb70d86"><p class="cl-beb6e13a"><span class="cl-beb073a4">1ª</span></p></td><td class="cl-beb70d87"><p class="cl-beb6e13a"><span class="cl-beb073a4">1</span></p></td><td class="cl-beb70d88"><p class="cl-beb6e13a"><span class="cl-beb073a4">mod4</span></p></td><td class="cl-beb70d90"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.178</span></p></td><td class="cl-beb70d91"><p class="cl-beb6e13a"><span class="cl-beb073a4">0.119–0.217</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
<p><em>It’s frightening, but that’s roughly what happened. It’s the voice of numbers!</em></p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-anderson2023coeficientes" class="csl-entry" role="listitem">
Anderson, Benjamim. 2023. <span>«Como interpretar coeficientes de regressão logística (com exemplo)»</span>. <a href="https://statorials.org/pt/interpretar-coeficientes-de-regressao-logistica/">https://statorials.org/pt/interpretar-coeficientes-de-regressao-logistica/</a>.
</div>
<div id="ref-barnier2025questior" class="csl-entry" role="listitem">
Barnier, Julien, François Briatte, e Joseph Larmarange. 2025. <em>questionr: Functions to Make Surveys Processing Easier</em>. doi:<a href="https://doi.org/10.32614/CRAN.package.questionr">10.32614/CRAN.package.questionr</a>.
</div>
<div id="ref-cox1958regression" class="csl-entry" role="listitem">
Cox, David R. 1958. <span>«The regression analysis of binary sequences»</span>. <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em> 20 (2). Oxford University Press: 215–32.
</div>
<div id="ref-delong1988comparing" class="csl-entry" role="listitem">
DeLong, Elizabeth R, David M DeLong, e Daniel L Clarke-Pearson. 1988. <span>«Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach»</span>. <em>Biometrics</em> 44. JSTOR: 837–45.
</div>
<div id="ref-field2012logit" class="csl-entry" role="listitem">
Field, Andy, Jeremy Miles, e Zoë Field. 2012. <span>«Logistic regression»</span>. Em <em>Discovering statistics using R</em>, 320. Sage Publications, Ltd.
</div>
<div id="ref-franca2023pseudor" class="csl-entry" role="listitem">
França, A. 2023. <span>«Regressão logística: Pseudo R²»</span>. <a href="https://www.blog.psicometriaonline.com.br/regressao-logistica-pseudo-r2/" class="uri">https://www.blog.psicometriaonline.com.br/regressao-logistica-pseudo-r2/</a>.
</div>
<div id="ref-Prabhakaran_2016" class="csl-entry" role="listitem">
Prabhakaran, Selva. 2016. <span>«Missing Value Treatment»</span>. <em>datascienceplus</em>. <a href="https://datascienceplus.com/missing-value-treatment/">https://datascienceplus.com/missing-value-treatment/</a>.
</div>
<div id="ref-subramanian2013over" class="csl-entry" role="listitem">
Subramanian, Jyothi, e Richard Simon. 2013. <span>«Overfitting in prediction models–is it a problem only in high dimensions?»</span> <em>Contemporary clinical trials</em> 36 (2). Elsevier: 636–41.
</div>
<div id="ref-easystats2025R2Tjur" class="csl-entry" role="listitem">
Team, Easystats. 2025. <span>«R2 Tjur — performance package reference»</span>. <a href="https://easystats.github.io/performance/reference/r2_tjur.html" class="uri">https://easystats.github.io/performance/reference/r2_tjur.html</a>.
</div>
<div id="ref-tjur2009coefficients" class="csl-entry" role="listitem">
Tjur, Tue. 2009. <span>«Coefficients of determination in logistic regression models—A new proposal: The coefficient of discrimination»</span>. <em>The American Statistician</em> 63 (4). Taylor &amp; Francis: 366–72.
</div>
<div id="ref-wiki:xxx" class="csl-entry" role="listitem">
Wikipédia. 2025. <span>«RMS Titanic — Wikipédia<span>,</span> a enciclopédia livre»</span>. <a href="https://pt.wikipedia.org/w/index.php?title=RMS_Titanic&amp;oldid=69869298">https://pt.wikipedia.org/w/index.php?title=RMS_Titanic&amp;oldid=69869298</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Lembre-se que o diretório mostrado no comando é o do autor, você deverá usar o do seu computador<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Deve-se fazer isso, pois algumas vezes, o R não interpreta espaços vazios como NA.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./23-sobrevida.html" class="pagination-link" aria-label="Análise de Sobrevida">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./referencias.html" class="pagination-link" aria-label="Referências">
        <span class="nav-page-text">Referências</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regressão Logística Binária</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pacotes necessários neste capítulo</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Amelia, </span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>               caret, </span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>               corrplot,</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>               flextable,</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>               ggplot2,</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>               gtsummary,</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>               performance,</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>               pROC,</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>               quesrionr,</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>               sjPlot)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduçao</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>Os dois tipos de regressão mais comuns são a **regressão linear** e a **regressão logística**. A regressão linear é utilizada quando a variável dependente é **quantitativa e contínua**, enquanto a regressão logística é utilizada quando a variável dependente é **qualitativa (categórica)**.</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>A **regressão logística binária** é utilizada quando o objetivo é estimar a **probabilidade** de um indivíduo pertencer a uma das duas categorias possíveis (o desfecho binário, 0 ou 1), dada uma ou mais variáveis independentes ou preditoras (de qualquer tipo). A regressão logística binária é uma abordagem classificatória que estima a relação entre uma **variável dependente dicotômica** e um conjunto de preditores. Foi desenvolvida, em 1958, como um a extensão do modelo linear pelo estatístico britânico David Cox <span class="co">[</span><span class="ot">@cox1958regression</span><span class="co">]</span>. Pertence a uma família, denominada *Modelo Linear Generalizado* (GLM).</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Função Logistica ou Função logit {#sec-logisticfunction}</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>A regressão linear simples (RLS) estima a relação entre uma **variável dependente** **quantitativa contínua (Y)** e uma **variável explicativa contínua** **(X)**. Por exemplo, a relação entre o **Comprimento (Y)** e a **Idade (X)** de crianças é estimada pelo método dos *Mínimos Quadrados Ordinários* (MQO) e descrita pela equação da reta de regressão. Esta reta tenta predizer a variável resposta contínua a partir de uma variável preditora também contínua (@fig-reglinear).</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>y = \beta_{0} + \beta_{1} \times x</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "50%"</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-reglinear</span></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Regressão Linear Simples"</span></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/rNwzZIq.png"</span>)</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Limitação da RLS para Desfechos Binários</span><span class="co">]</span>{.underline}</span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a>Agora, se o objetivo é estimar o impacto da idade de um paciente na probabilidade de ele ter ou não um determinado desfecho (por exemplo, uma doença). A <span class="in">`idade`</span> é uma variável preditora contínua, mas o desfecho (<span class="in">`doença`</span>) é uma variável categórica dicotômica, assumindo apenas os valores 0 (não) e 1 (sim) (@fig-outcomebin).</span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-56"><a href="#cb116-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-58"><a href="#cb116-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "50%"</span></span>
<span id="cb116-59"><a href="#cb116-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-outcomebin</span></span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Relação de uma variável desfecho dicotômica e uma variável preditora contínua."</span></span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/WrDPQNQ.png"</span>)</span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-65"><a href="#cb116-65" aria-hidden="true" tabindex="-1"></a>Se for ajustada uma reta de regressão aos pontos usando o método dos Mínimos Quadrados Ordinários, o gráfico (@fig-fittingline) terá o seguinte aspecto: A reta de regressão se estende abaixo de 0 e acima de 1 em relação ao eixo Y.</span>
<span id="cb116-66"><a href="#cb116-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "50%"</span></span>
<span id="cb116-72"><a href="#cb116-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fittingline</span></span>
<span id="cb116-73"><a href="#cb116-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Reta de regressão quando a variável desfecho é dicotômica."</span></span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/Fit9SSq.png"</span>)</span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a>No entanto, a variável Y (Probabilidade de Doença) não pode assumir valores fora do limite de 0 e 1. Além disso, a variável desfecho dicotômica viola os pressupostos de normalidade e homoscedasticidade dos erros, pois segue a Distribuição de Bernoulli. Em consequência, a regressão linear não é adequada nessa situação.</span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">A Solução: A Função Logit</span><span class="co">]</span>{.underline}</span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-82"><a href="#cb116-82" aria-hidden="true" tabindex="-1"></a>A solução é usar a **regressão logística binária**, que lida com essas limitações, usando uma função de ligação (link function) que transforma a probabilidade em um valor que pode ser modelado linearmente (e que pode variar de - a +. A função de ligação utilizada no modelo de regressão logística é a Logit (ou função logística), que resulta em uma curva em forma de 'S' chamada curva sigmoide (@fig-logit):</span>
<span id="cb116-83"><a href="#cb116-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a>logit_i = \ln\left(\frac{p}{1-p}\right)</span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-91"><a href="#cb116-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-92"><a href="#cb116-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "50%"</span></span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-logit</span></span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-95"><a href="#cb116-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Curva de regressão logística."</span></span>
<span id="cb116-96"><a href="#cb116-96" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://i.imgur.com/lmI4IdG.png"</span>)</span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a>O termo $\frac{p}{1-p}$ é a Razão de Chances (*Odds Ratio*), que representa a razão entre a probabilidade de ocorrência do evento (*p*) e a probabilidade de sua não ocorrência ($1-p$). O **logit** é o logaritmo natural dessa razão de chances. Na regressão logística, o logit é modelado como uma função linear dos preditores, permitindo a estimação dos coeficientes ($\beta$):</span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a>logit_{i} = \ln\left(\frac{p}{1-p}\right) = \beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}</span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Retornando à probabilidade *p*</span><span class="co">]</span>{.underline}</span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a>Através de manipulação algébrica, podemos isolar p para obter a probabilidade do evento Y=1 (sucesso) diretamente, garantindo que o valor final sempre esteja entre 0 e 1:</span>
<span id="cb116-108"><a href="#cb116-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-109"><a href="#cb116-109" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-110"><a href="#cb116-110" aria-hidden="true" tabindex="-1"></a>p = \frac{e^{\beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}}}{1 + e^{\beta_{0} + \beta_{1}x_{1} + \dots + \beta_{n}x_{n}}}</span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dados para o exemplo</span></span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tragédia do Titanic</span></span>
<span id="cb116-117"><a href="#cb116-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-118"><a href="#cb116-118" aria-hidden="true" tabindex="-1"></a>O RMS Titanic (@fig-titanic), considerado o navio inafundável de sua época, sofreu um trágico destino em sua viagem inaugural com destino a Nova Iorque. Construído com o intuito de ser o maior e mais luxuoso transatlântico, o Titanic colidiu com um iceberg na noite de 14 de abril de 1912, no Oceano Atlântico Norte, afundando rapidamente e causando a morte de inúmeras pessoas.</span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-122"><a href="#cb116-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "50%"</span></span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-titanic</span></span>
<span id="cb116-126"><a href="#cb116-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-127"><a href="#cb116-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Titanic parado em Queenstown, 11 de abril.de 1912"</span></span>
<span id="cb116-128"><a href="#cb116-128" aria-hidden="true" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"https://imgur.com/54il14d.png"</span>)</span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a>O Titanic partiu em sua primeira e única viagem com 1316 passageiros a bordo: 325 na primeira classe, 285 na segunda e 706 na terceira. Deles, 922 embarcaram em Southampton, 274 em Cherbourg-Octeville, na França, e 120 em Queenstown, na Irlanda. Além desses passageiros, havia 908 tripulantes, totalizando m 2224 pessoas. O número total de mortos mais aceito é 1514, quase 70% dos que embarcaram na viagem <span class="co">[</span><span class="ot">@wiki:xxx</span><span class="co">]</span>.</span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-134"><a href="#cb116-134" aria-hidden="true" tabindex="-1"></a>Os dados de 1309 passageiros estão em um arquivo denominado <span class="in">`dadosTitanic.xlsx`</span>, obtido no pacote <span class="in">`titanic`</span>, modificado estruturalmente e traduzido, sem alterar os dados, para chegar a este arquivo que pode ser baixado <span class="co">[</span><span class="ot">aqui</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosTitanic.xlsx)</span>. Possui 1309 observações e 12 variáveis:</span>
<span id="cb116-135"><a href="#cb116-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a>• **id** $\to$ identificação do passageiro\</span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a>• **sobreviveu** $\to$ 0 = não; 1 = sim\</span>
<span id="cb116-138"><a href="#cb116-138" aria-hidden="true" tabindex="-1"></a>• **classe** $\to$ classe do passageiro (categórica): 1 = 1ª classe; 2 = 2ª classe e 3 = 3ª classe (qualitativa)\</span>
<span id="cb116-139"><a href="#cb116-139" aria-hidden="true" tabindex="-1"></a>• **nome** $\to$ nome do passageiro (nominal)\</span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a>• **sexo** $\to$ masc = masculino; fem = feminino (binária)\</span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a>• **idade** $\to$ idade em anos (numérica contínua)\</span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a>• **irco** $\to$ número de irmãos/cônjuges a bordo (numérica discreta)\</span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a>• **pafi** $\to$ número de pais/filhos a bordo (numérica discreta)\</span>
<span id="cb116-144"><a href="#cb116-144" aria-hidden="true" tabindex="-1"></a>• **ticket** $\to$ número do bilhete de embarque (nominal)\</span>
<span id="cb116-145"><a href="#cb116-145" aria-hidden="true" tabindex="-1"></a>• **tarifa** $\to$ valor pago pela passagem em dólares (numérica contínua)\</span>
<span id="cb116-146"><a href="#cb116-146" aria-hidden="true" tabindex="-1"></a>• **cabine** $\to$ número de identificação da cabine (nominal)\</span>
<span id="cb116-147"><a href="#cb116-147" aria-hidden="true" tabindex="-1"></a>• **porto_embarque** $\to$ porto de embarque: C = Cherbourg, Q = Queenstown, S = Southampton</span>
<span id="cb116-148"><a href="#cb116-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-149"><a href="#cb116-149" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leitura dos dados</span></span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-151"><a href="#cb116-151" aria-hidden="true" tabindex="-1"></a>Após fazer o download do banco de dados em seu diretório <span class="ot">[^24-reglogbin-1]</span>, carregue-o no *RStudio*, usando a função <span class="in">`read_excel()`</span> do pacote <span class="in">`readxl`</span>:</span>
<span id="cb116-152"><a href="#cb116-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a><span class="ot">[^24-reglogbin-1]: </span>Lembre-se que o diretório mostrado no comando é o do autor, você deverá usar o do seu computador</span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-157"><a href="#cb116-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTitanic.xlsx"</span>)</span>
<span id="cb116-159"><a href="#cb116-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-160"><a href="#cb116-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Explorando e preparando os dados</span></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a>Para observar as variáveis do banco de dados, pode-se usar a função <span class="in">`str()`</span>:</span>
<span id="cb116-164"><a href="#cb116-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTitanic)</span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-170"><a href="#cb116-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-171"><a href="#cb116-171" aria-hidden="true" tabindex="-1"></a>A saída exibe um *tibble* com 1309 linhas (casos = passageiros) e 12 colunas (variáveis).</span>
<span id="cb116-172"><a href="#cb116-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Remoção de variáveis irrelevantes</span></span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a>Algumas dessas variáveis não terão utilidade para a análise de regressão logística: por exemplo, a coluna índice (<span class="in">`id`</span>), o nome do passageiro, o número do ticket de embarque e o número da cabine. Elas serão removidas do banco de dados, usando a função <span class="in">`select()`</span> do pacote <span class="in">`dplyr`</span> (@sec-dadosMater):</span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(dadosTitanic, </span>
<span id="cb116-181"><a href="#cb116-181" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">-</span><span class="fu">c</span>(id, nome, ticket, cabine))</span>
<span id="cb116-182"><a href="#cb116-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-183"><a href="#cb116-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conversão de variáveis para fatores</span></span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a>Algumas variáveis estão classificadas como numéricas (<span class="in">`classe`</span>, <span class="in">`sexo`</span>, <span class="in">`porto_embarque`</span> e <span class="in">`sobreviveu`</span>), mas são fatores. Esta modificação será realizada, usando a função <span class="in">`mutate()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb116-187"><a href="#cb116-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb116-194"><a href="#cb116-194" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> dadosTitanic <span class="sc">%&gt;%</span></span>
<span id="cb116-195"><a href="#cb116-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porto_embarque =</span> <span class="fu">factor</span>(porto_embarque)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sobreviveu =</span> <span class="fu">factor</span>(sobreviveu))</span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTitanic)</span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-202"><a href="#cb116-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-203"><a href="#cb116-203" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Divisão dos dados em Treino e Teste</span></span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a>A divisão dos dados em conjuntos de <span class="in">`treino`</span> e <span class="in">`teste`</span> é uma prática frequente em aprendizado de regressão logística. Serve para avaliar a performance de um modelo de forma imparcial precisa. O conjunto <span class="in">`treino`</span> é a parte dos dados que o modelo utiliza para aprender as relações entre as variáveis independentes e a variável dependente. O modelo analisa esses dados para encontrar os melhores coeficientes que descrevem a relação entre as variáveis. O conjunto <span class="in">`teste`</span> é a parte dos dados que o modelo não analisou durante o treinamento. Ele é utilizado para avaliar a capacidade do modelo de fazer previsões em novos dados. Ao comparar as previsões do modelo com os valores reais no conjunto <span class="in">`teste`</span>, pode-se medir a sua precisão e generalização. Essa técnica é utilizada para evitar o excesso de ajuste dos dadosconhecido como *overfitting* <span class="co">[</span><span class="ot">@subramanian2013over</span><span class="co">]</span>, estimar a acurácia do modelo e comparação de modelos. A divisão mais comum é 70% para treinamento e 30% para teste, mas essa proporção pode variar dependendo do tamanho do conjunto de dados e da complexidade do problema.</span>
<span id="cb116-206"><a href="#cb116-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a semente para reprodutibilidade (essencial)</span></span>
<span id="cb116-213"><a href="#cb116-213" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-214"><a href="#cb116-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-215"><a href="#cb116-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Embaralhando os dados</span></span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a>dados_embaralhados <span class="ot">&lt;-</span> dadosTitanic[<span class="fu">sample</span>(<span class="fu">nrow</span>(dadosTitanic)),]</span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividindo os dados em treino e teste</span></span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dados_embaralhados<span class="sc">$</span>classe, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> dados_embaralhados[trainIndex, ]</span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a>teste  <span class="ot">&lt;-</span> dados_embaralhados[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Observar o tamanho das amostras</span></span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(treino)</span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(teste)</span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Verificação e tratamento dos dados faltantes</span></span>
<span id="cb116-230"><a href="#cb116-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-231"><a href="#cb116-231" aria-hidden="true" tabindex="-1"></a>O próximo passo é investigar dados faltantes (NA) ou valores vazios<span class="ot">[^24-reglogbin-2]</span> em cada conjunto separadamente. Isso garante que o tratamento seja feito corretamente sem contaminar o teste.</span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-233"><a href="#cb116-233" aria-hidden="true" tabindex="-1"></a><span class="ot">[^24-reglogbin-2]: </span>Deve-se fazer isso, pois algumas vezes, o R não interpreta espaços vazios como NA.</span>
<span id="cb116-234"><a href="#cb116-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a>Para verificar os dados faltantes e espaços vazios (strings "") no banco de dados, pode-se usar o comando que soma os dados faltantes e espaços vazios em cada coluna do banco de dados:</span>
<span id="cb116-236"><a href="#cb116-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-237"><a href="#cb116-237" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Verificar valores faltantes</span><span class="co">]</span>{.underline}</span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de valores faltantes por variável</span></span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(treino))</span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(teste))</span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Verificar valores vazios</span><span class="co">]</span>{.underline} (strings "")</span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-251"><a href="#cb116-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(treino <span class="sc">==</span> <span class="st">""</span>)</span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(teste <span class="sc">==</span> <span class="st">""</span>)</span>
<span id="cb116-254"><a href="#cb116-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-255"><a href="#cb116-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-256"><a href="#cb116-256" aria-hidden="true" tabindex="-1"></a>No subconjunto <span class="in">`treino`</span>, existem 175 NAs na variável <span class="in">`idade`</span>, um NA na variável <span class="in">`tarifa`</span> e dois na variável <span class="in">`porto_embarque`</span>; no subconjunto <span class="in">`teste`</span>, têm 88 NAs na variável <span class="in">`idade`</span>. Não existem espaços vazios em nenhum dos subconjuntos.</span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a>Uma visualização rápida (@fig-amelia1, @fig-amelia2) pode ser feita com a função <span class="in">`missmap()`</span> do pacote <span class="in">`Amelia`</span>:</span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-265"><a href="#cb116-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-266"><a href="#cb116-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-amelia1</span></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dados faltantes no subconjunto treino"</span></span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)   </span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a><span class="fu">missmap</span>(treino, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-273"><a href="#cb116-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-276"><a href="#cb116-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-277"><a href="#cb116-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-amelia2</span></span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dados faltantes no subconjunto teste"</span></span>
<span id="cb116-284"><a href="#cb116-284" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)   </span>
<span id="cb116-285"><a href="#cb116-285" aria-hidden="true" tabindex="-1"></a><span class="fu">missmap</span>(teste, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Tratamento dos dados faltantes</span><span class="co">]</span>{.underline}</span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-290"><a href="#cb116-290" aria-hidden="true" tabindex="-1"></a>A melhor forma de tratar dados faltantes depende de diversos fatores <span class="co">[</span><span class="ot">@Prabhakaran_2016</span><span class="co">]</span>, como:</span>
<span id="cb116-291"><a href="#cb116-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Mecanismo de geração dos dados faltantes*: Por que os dados estão faltando? É aleatório, relacionado a outras variáveis ou a alguma característica da população?</span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Quantidade de dados faltantes*: 263 valores faltantes representam uma proporção considerável dos dados (20%).</span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Impacto na análise*: Como a presença de dados faltantes pode afetar os resultados da sua análise?</span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-296"><a href="#cb116-296" aria-hidden="true" tabindex="-1"></a>O que fazer?</span>
<span id="cb116-297"><a href="#cb116-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-298"><a href="#cb116-298" aria-hidden="true" tabindex="-1"></a>1)  **Exclusão de casos**:</span>
<span id="cb116-299"><a href="#cb116-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a>a.  *Listwise deletion*: Remover todas as observações com algum dado faltante. Não recomendado neste caso, pois você perderia uma quantidade significativa de dados.</span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>b.  *Pairwise deletion*: Utilizar todas as observações disponíveis para cada análise. Pode gerar resultados inconsistentes.</span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a>2)  **Imputação**:</span>
<span id="cb116-308"><a href="#cb116-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-309"><a href="#cb116-309" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a>a.  *Imputação por média, mediana ou moda*: Substituir os valores faltantes pela média, mediana ou moda da variável. Simples, mas pode subestimar a variância.</span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a>b.  *Imputação por regressão*: Utilizar um modelo de regressão para prever os valores faltantes com base em outras variáveis. Mais preciso, mas pode ser enviesado se o modelo não for adequado.</span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a>c.  *Imputação múltipla*: Criar múltiplos conjuntos de dados, cada um com diferentes valores imputados, e combinar os resultados das análises. Método mais robusto e permite estimar a incerteza.</span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a>d.  *Imputação por K-Nearest Neighbors*: Substituir os valores faltantes pela média dos *k* vizinhos mais próximos. Útil para dados numéricos e pode capturar padrões locais.</span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a>Inicialmente, será removido os valores omissos nas variáveis <span class="in">`tarifa`</span> e <span class="in">`porto_embarque`</span>, no subconjunto <span class="in">`treino`</span>:</span>
<span id="cb116-317"><a href="#cb116-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-320"><a href="#cb116-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> treino[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">is.na</span>(treino<span class="sc">$</span>tarifa)),]</span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> treino[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">is.na</span>(treino<span class="sc">$</span>porto_embarque)),]</span>
<span id="cb116-323"><a href="#cb116-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-324"><a href="#cb116-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a>Dessa forma, permanecem os valores faltantes na variáveis <span class="in">`idade`</span> em ambos subconjuntos. Será feita a imputação, usando a mediana por ser uma estratégia simples.</span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a>treino<span class="sc">$</span>idade[<span class="fu">is.na</span>(treino<span class="sc">$</span>idade)] <span class="ot">&lt;-</span> <span class="fu">median</span>(treino<span class="sc">$</span>idade, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a>teste<span class="sc">$</span>idade[<span class="fu">is.na</span>(teste<span class="sc">$</span>idade)] <span class="ot">&lt;-</span> <span class="fu">median</span>(teste<span class="sc">$</span>idade, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb116-332"><a href="#cb116-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-333"><a href="#cb116-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a>Novamente, se usarão as funções <span class="in">`colSums(is.na())`</span> e <span class="in">`str()`</span>para pesquisar se existem dados faltantes:</span>
<span id="cb116-335"><a href="#cb116-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-338"><a href="#cb116-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de valores faltantes por variável</span></span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(treino))</span>
<span id="cb116-341"><a href="#cb116-341" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(teste))</span>
<span id="cb116-342"><a href="#cb116-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a>Os dados (treino e teste) não apresentam mais dados faltantes e estão pronts para serem usados na análise.</span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb116-347"><a href="#cb116-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importante</span></span>
<span id="cb116-348"><a href="#cb116-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a>Após o tratamento dos dados, tem-se dois conjuntos de dados que servirão para:</span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-351"><a href="#cb116-351" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Treino** - que será usado para realizar a regressão logística. Corresponde a aproximadamente 70% dos dados originais.\</span>
<span id="cb116-352"><a href="#cb116-352" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Teste** - que será usado para avaliar a performance do modelo e a sua capacidade de predição.\</span>
<span id="cb116-353"><a href="#cb116-353" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Variável dependente** ou resposta: <span class="in">`sobreviveu`</span>\</span>
<span id="cb116-354"><a href="#cb116-354" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Variáveis explicativas ou preditoras**: as demais variáveis\</span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>O **objetivo da análise** é gerar um modelo de regressão logística capaz de predizer qual a probabilidade de um passageiro com determinasdas características sobreviver ao naugráfio do Titanic, ocorrido em 14 de abril de 1912</span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a><span class="fu">## Construção do modelo de Regressão Logística</span></span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a>Antes de criar o modelo, alguns passos são importantes:</span>
<span id="cb116-361"><a href="#cb116-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-362"><a href="#cb116-362" aria-hidden="true" tabindex="-1"></a>1)  Verificar se existe **correlação entre as variáveis numéricas**, para evitar problemas de multicolinearidade, pois se as variáveis forem altamente correlacionadas pode causar:</span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Coeficientes instáveis</span><span class="co">]</span>{.underline} (pequenas mudanças nos dados podem gerar grandes variações nos coeficientes estimados);</span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Torna difícil o entendimento</span><span class="co">]</span>{.underline} o efeito individual de cada variável sobre a probabilidade do desfecho;</span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Redução da precisão estatística,</span><span class="co">]</span>{.underline} pois aumentam os erros padrão dos coeficientes, podendo tornar variáveis significativas aparaentemente insignificantes.</span>
<span id="cb116-369"><a href="#cb116-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-370"><a href="#cb116-370" aria-hidden="true" tabindex="-1"></a>Para isso, deve-se avaliar a correlação de Pearson entre as variáveis numéricas. Valores acima de 0,8 ou abaixo de -0,8 são preocupantes.</span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecionar apenas as variáveis numéricas</span></span>
<span id="cb116-376"><a href="#cb116-376" aria-hidden="true" tabindex="-1"></a>dados_numericos <span class="ot">&lt;-</span> treino[<span class="fu">c</span>(<span class="st">"idade"</span>, <span class="st">"irco"</span>, <span class="st">"pafi"</span>, <span class="st">"tarifa"</span>)]</span>
<span id="cb116-377"><a href="#cb116-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula a matriz de correlação de Pearson</span></span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a>matriz_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dados_numericos, <span class="at">use =</span> <span class="st">"all.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb116-380"><a href="#cb116-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-381"><a href="#cb116-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibe a matriz</span></span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matriz_cor)</span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-385"><a href="#cb116-385" aria-hidden="true" tabindex="-1"></a>É possível visualizar essa matriz com a função <span class="in">`corrplot`</span>(@fig-corrplot)</span>
<span id="cb116-386"><a href="#cb116-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-389"><a href="#cb116-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-corrplot</span></span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "60%"</span></span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "60%"</span></span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-396"><a href="#cb116-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-397"><a href="#cb116-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Matriz de correlação"</span></span>
<span id="cb116-398"><a href="#cb116-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-399"><a href="#cb116-399" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza a matriz de correlação</span></span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(matriz_cor, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-405"><a href="#cb116-405" aria-hidden="true" tabindex="-1"></a>2)  Verificar se há observações incompletas, apesar de todo tratamento dos dados faltantes ou vazios:</span>
<span id="cb116-406"><a href="#cb116-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-409"><a href="#cb116-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Se todas informações forem completas, retorna FALSE</span></span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(treino))</span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a>3)  Verificar se existe um desbalanceamento preocupante, ou seja, quando uma das classes do desfecho reperesenta menos de 10% dos casos (desfecho raro), pois pode comprometer a preformance e a interpretação do modelo, reduzindo a capacidade preditiva.</span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-418"><a href="#cb116-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-419"><a href="#cb116-419" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(treino<span class="sc">$</span>sobreviveu)</span>
<span id="cb116-420"><a href="#cb116-420" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb116-421"><a href="#cb116-421" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(tab)</span>
<span id="cb116-422"><a href="#cb116-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-423"><a href="#cb116-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modelos de Regressão Logística</span></span>
<span id="cb116-425"><a href="#cb116-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-426"><a href="#cb116-426" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo 1 - modelo completo</span></span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a>O modelo 1 (<span class="in">`mod1`</span>) será construído com o subconjunto <span class="in">`treino`</span>, usando a função nativa <span class="in">`glm()`</span> – **g**eneralized **l**inear **m**odel - usada para aplicar uma regressão logística no *R*. Sua funcionalidade é idêntica à função <span class="in">`lm()`</span> da regressão linear. Necessita alguns argumentos:</span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**formula** $\to$ objeto da classe *formula*. Um preditor típico tem o formato <span class="in">`resposta ~ preditor`</span> em que <span class="in">`resposta`</span>, na regressão logística binária, é uma variável dicotômica e o <span class="in">`preditor`</span> pode ser uma série de variáveis numéricas ou categóricas;</span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-432"><a href="#cb116-432" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**family** $\to$ uma descrição da distribuição de erro e função de *link* a ser usada no modelo `glm`, pode ser uma *string* que nomeia uma função de *family*. O padrão é <span class="in">`family = gaussian()`</span>. No caso da regressão logística binária, <span class="in">`family = binomial()`</span> ou <span class="in">`family = binomial (link =”logit”)`</span>. Para outras informações, use <span class="in">`help(glm)`</span> ou <span class="in">`help(family)`</span>;</span>
<span id="cb116-433"><a href="#cb116-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**data** $\to$ banco de dados.</span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a>Dentro dos parênteses da função <span class="in">`glm()`</span>, são fornecidas informações essenciais sobre o modelo. À esquerda do til <span class="in">`(~)`</span>, encontra-se a variável dependente, que deve estar codificada como 0 e 1 para que a função a interprete corretamente como binária. Após o til, são listadas as variáveis preditoras. Quando se utiliza um ponto (<span class="in">`~.`</span>), isso indica a inclusão de todas as variáveis preditoras disponíveis. Já o uso do asterisco (<span class="in">`*`</span>) entre duas variáveis preditoras especifica que, além dos efeitos principais, também deve ser considerado um termo de interação entre elas. No exemplo apresentado, nesta análise inicial, não será solicitada os efeitos da interação. Por fim, após a vírgula, define-se que a distribuição utilizada é a binomial. Como a função <span class="in">`glm`</span> usa <span class="in">`logit`</span> como link padrão para uma variável de desfecho binomial, não há necessidade de especificá-lo explicitamente no modelo.</span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a>O modelo inicial de regressão logística do tipo **entrada forçada** (<span class="in">`enter`</span>), método padrão de conduzir uma regressão, que consiste em simplesmente colocar todos os preditores no modelo de regressão em um bloco (modelo completo) e estimar parâmetros para cada um <span class="co">[</span><span class="ot">@field2012logit</span><span class="co">]</span>. O dataframe <span class="in">`treino`</span> será usado com todos os preditores dentro da função. O objeto criado será denominado de <span class="in">`mod1`</span>.</span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-442"><a href="#cb116-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-443"><a href="#cb116-443" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span>., </span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> treino, </span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a>A saída da função <span class="in">`glm()`</span> fornece os coeficientes, da mesma forma como na regressão linear, que estima o efeito das variáveis preditoras sobre a *chance* de ocorrência do desfecho (no exemplo, sucesso = 1).</span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Interpretação Coeficientes</span><span class="co">]</span>{.underline}</span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a>Os coeficientes podem ser interpretados da seguinte maneira <span class="co">[</span><span class="ot">@anderson2023coeficientes</span><span class="co">]</span>:</span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-454"><a href="#cb116-454" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Coeficiente positivo (**$\beta \gt 0$) : Aumenta o log das chances do evento ocorrer. Ou seja, aumenta a probabilidade de desfecho = 1, mantendo as outras variáveis constantes.</span>
<span id="cb116-455"><a href="#cb116-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-456"><a href="#cb116-456" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Coeficiente negativo (**$\beta \lt 0$) : Diminui o log das chances do evento ocorrer. Ou seja, *reduz a probabilidade de desfecho = 1*, mantendo as outras variáveis constantes.</span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Coeficiente zero (**$\beta = 0$) : A variável não tem efeito sobre o desfecho.</span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Interpretação das outras métricas</span><span class="co">]</span>{.underline}</span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-462"><a href="#cb116-462" aria-hidden="true" tabindex="-1"></a>O *Null deviance* representa o quão bem a variável resposta é prevista por um modelo que inclui apenas o intercepto e não as variáveis independentes. Representa o erro do modelo sem preditores. Seria como dizer: "Qual o erro se eu apenas chutar a média geral?";</span>
<span id="cb116-463"><a href="#cb116-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-464"><a href="#cb116-464" aria-hidden="true" tabindex="-1"></a>O *Residual deviance* mostra quão bem a variável de resposta é prevista por um modelo que inclui todas as variáveis. Representa o erro do modelo com preditores. Quanto menor o *Residual Deviance* em relação ao *Null Deviance*, melhor o modelo ajusta os dados. No `mod1`, o *Residual Deviance* é igual a 708.95, bem menor que o *Null Deviance* (1207.42), ou seja, o modelo está explicando bem os dados. A diferença entre os dois (1207.42 − 708.95 = 498.47) indica o ganho de ajuste ao incluir as variáveis. Quanto maior essa redução, melhor o modelo. Podemos testar essa diferença com um teste qui-quadrado para verificar se a melhora é estatisticamente significativa:</span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-472"><a href="#cb116-472" aria-hidden="true" tabindex="-1"></a>O teste estatístico compara o *Null Deviance* (modelo com apenas o intercepto) com a *Residual Deviance* (modelo com preditores), usando o teste qui-quadrado para verificar se a inclusão das variáveis melhora significativamente o ajuste. Se o valor *p* for menor que 0.05, pode-se concluir que o modelo com preditores é significativamente melhor que o modelo nulo até a inclusão da variável irco. A partir daí a inclusão de novas variáveis não melhora estatisticamente o modelo.</span>
<span id="cb116-473"><a href="#cb116-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a>O *AIC (Akaike Information Criterion)* é uma medida estatística de ajuste que penaliza o modelo logístico pelo número de variáveis preditivas. Um modelo com valor mínimo de AIC é considerado um modelo bem ajustado. Um AIC = 728.95 isolado é difícil de interpretar, pois é útil para comparar modelos, quanto menor, melhor. Útil quando se testa diferentes combinações de variáveis.</span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a>Para ver todo o resultado do modelo, executa-se a função <span class="in">`summary()`</span>:</span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-483"><a href="#cb116-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-484"><a href="#cb116-484" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Uso do Odds Ratio (OR) na interpretação dos coeficientes</span><span class="co">]</span>{.underline}</span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-486"><a href="#cb116-486" aria-hidden="true" tabindex="-1"></a>Numericamente, os coeficientes de regressão logística não são facilmente interpretáveis em escala bruta, pois estão representados como <span class="in">`log (odds)`</span> ou <span class="in">`logit`</span> . Para tornar mais simples, inverte-se a transformação logística, exponenciando os coeficientes (<span class="in">`exp(coeficiente)`</span>). Isso faz com que os coeficientes se transformem em **razões de chance** (*odds ratio*), ficando mais intuitivos facilitando a interpretação. Isso pode ser realizado pela função `odds.ratio()` do pacote `questionr` [@barnier2025questior], que retorna as OR e seus intervalos de confiança de 95%, além dos respectivos valores *p*:</span>
<span id="cb116-487"><a href="#cb116-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod1)</span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-497"><a href="#cb116-497" aria-hidden="true" tabindex="-1"></a>Quando o OR é menor que 1, significa que o evento (no exemplo: sobrevivência) é menos provável no grupo em questão comparado ao grupo de referência. Para interpretar em termos percentuais:</span>
<span id="cb116-498"><a href="#cb116-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a>\text{Redução percentual} = \left(1 - OR  \right) \times 100</span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a>Ou seja, considerando os passageiros da 2ª classe, tem-se que $1 - 0.46 = 0.54 \times 100 = 54$%. Assim, os passageiros da 2ª classe tem 54% menos chance de sobreviver que os da 1ª classe (nível de referência ); o da 3ª classe tem 84% menos chance de sobreviver que os da 1ª classe. Para saber o nível de referência, basta usar a função <span class="in">`levels()`</span> da seguinte maneira:</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-508"><a href="#cb116-508" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(treino<span class="sc">$</span>classe)</span>
<span id="cb116-509"><a href="#cb116-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a>Quando o OR é maior que 1, o evento é mais provável no grupo em questão. A interpretação muda:</span>
<span id="cb116-512"><a href="#cb116-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-513"><a href="#cb116-513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a>\text{Aumento percentual} = \left(OR - 1 \right) \times 100</span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a>Considerando a variável preditora <span class="in">`tarifa`</span>, cujo OR = 1.003, tem-se $1.003 - 1 = 0.003 \times 100 = 0.3$. Ou seja, um aumento de 0,3% na sobrevivência. Um valor muito pequeno que se mostrou sem significância estatística (*p* = 0.2218).\</span>
<span id="cb116-518"><a href="#cb116-518" aria-hidden="true" tabindex="-1"></a>Os homens têm $1 - 0.03 = 0.97 \times 100 = 97$% menos chance de sobreviver do que as mulheres.</span>
<span id="cb116-519"><a href="#cb116-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a>Qual a chance das mulheres sobreviverem em relação aos homens?</span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a>Para responder essa pergunta, basta inverter a OR. Assim, as mulheres têm $1/0.03 \approx$ <span class="in">`r round(1/0.03, 0)`</span> vezes mais chance de sobreviver que os homens.\</span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a>A idade (variável numérica) mostra que o aumento da idade diminuiu a sobrevivência; para cada ano a mais de idade a chance de sobrevivência reduz em $1 - 0.97 = 0.03 \times 100 = 3$%. Ter irmãos/cônjuges (variável <span class="in">`irco`</span>) a bordo reduz a chance de sobrevivência em $1 - 0.72 = 0.28 \times 100 = 28$%. As demais variáveis não tiveram um efeito significativo.&nbsp;</span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo 2 - modelo simples</span></span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a>No ajuste realizado no modelo 1, apenas as variáveis <span class="in">`classe`</span>, <span class="in">`sexo`</span>, <span class="in">`idade`</span> e <span class="in">`irco`</span> foram significativas. Neste novo modelo (<span class="in">`mod2`</span>), essas variáveis permanecem e as não significativas são removidas.</span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span> classe <span class="sc">+</span> sexo <span class="sc">+</span> idade <span class="sc">+</span> irco,</span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> treino, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-535"><a href="#cb116-535" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb116-536"><a href="#cb116-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-537"><a href="#cb116-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a>A saída do <span class="in">`summary()`</span> mostra que os coeficientes permaneceram apresentando significância estatística.</span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Razão de Chances do modelo 2</span><span class="co">]</span>{.underline}</span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a>Usando a mesma função, usada para o <span class="in">`mod1`</span>, calcula-se as OR para o <span class="in">`mod2`</span>:</span>
<span id="cb116-543"><a href="#cb116-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-549"><a href="#cb116-549" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb116-550"><a href="#cb116-550" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod2)</span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a>Os passageiros da 2ª classe, tem, agora, $1 - 0.38 = 0.62 \times 100 = 62$% menos chance de sobreviver que os da 1ª classe (nível de referência); o da 3ª classe tem 87% menos chance de sobreviver que os da 1ª classe. Esses valores e os restantes não diferem muito dos do <span class="in">`mod1`</span>.</span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a>Como o AIC do <span class="in">`mod2`</span>(727.07) é menor que o do <span class="in">`mod1`</span>(728.95) é possível dizer que houve uma melhora no ajuste, apesar de a diferença ser muito pequena.</span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-557"><a href="#cb116-557" aria-hidden="true" tabindex="-1"></a>Entretanto, outros modelos são possíveis.</span>
<span id="cb116-558"><a href="#cb116-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo 3</span></span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-561"><a href="#cb116-561" aria-hidden="true" tabindex="-1"></a>A partir do modelo completo (<span class="in">`mod1`</span>), será criado um terceiro modelo, selecionando as variáveis automaticamente, usando a função <span class="in">`step()`</span>. Usando o argumento <span class="in">`direction = "backward"`</span>, a função realiza a **eliminação regressiva** — ou seja, começa com o modelo completo e vai retirando variáveis uma a uma. Avalia o impacto de **remover cada variável** individualmente. Remove a variável cuja retirada melhora o critério de ajuste (em geral, AIC) e vai repetindo o processo até que nenhuma remoção adicional melhore o modelo. Considerando ajuste e simplicidade , quanto menor o AIC, melhor o modelo.</span>
<span id="cb116-562"><a href="#cb116-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1, <span class="at">direction =</span> <span class="st">"backward"</span>) </span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-570"><a href="#cb116-570" aria-hidden="true" tabindex="-1"></a>Este terceiro modelo chega a um AIC = AIC: 726.11, melhor que os anteriores e incluindo a variável <span class="in">`pafi`</span>.</span>
<span id="cb116-571"><a href="#cb116-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a><span class="fu">## Seleção do Modelo</span></span>
<span id="cb116-573"><a href="#cb116-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-574"><a href="#cb116-574" aria-hidden="true" tabindex="-1"></a>Existem várias maneiras de verificar qual o modelo apresenta um melhor ajuste.</span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deviance</span></span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a>O *Deviance* mede o quão bem o modelo se ajusta aos dados observados. Ele é baseado na log-verossimilhança (*log-likelihood* -LL) e funciona como uma medida de erro:</span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a>• **Deviance nulo**: Representa o erro do modelo sem preditores, apenas com intercepto.</span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a>D_{null} = 2 \times \left(LL_{\text{modelo saturado}} - LL_{\text{modelo nulo}}\right)</span>
<span id="cb116-584"><a href="#cb116-584" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-585"><a href="#cb116-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a>Onde o **modelo saturado** é um modelo teórico que se ajusta perfeitamente os dados - a log-verossimilhança é máxima possível e o **modelo nulo** é o modelo que só usa a média da resposta (sem preditores) e serve como base de comparação.</span>
<span id="cb116-587"><a href="#cb116-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-588"><a href="#cb116-588" aria-hidden="true" tabindex="-1"></a>• **Deviance residual:** Representa o erro do modelo **com preditores**.</span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a>D_{residual} = 2 \times \left(LL_{\text{modelo saturado}} - LL_{\text{modelo proposto}}\right)</span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a>Se a **null deviance** é pequena, o modelo nulo já explica bem os dados; Se a **deviance residual** é muito menor que a null deviance, o modelo proposto melhora o ajuste. A diferença entre elas pode ser testada com um teste qui-quadrado.</span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-596"><a href="#cb116-596" aria-hidden="true" tabindex="-1"></a>Como os modelos são aninhados (um é uma versão mais simples do outro), pode-se compará-los, usando a função <span class="in">`anova()`</span>. Assumindo que o $mod2 \subset mod3 \subset mod1$, ou seja, <span class="in">`mod2`</span> tem menos preditores que <span class="in">`mod3`</span>, que tem menos que <span class="in">`mod1`</span>. A hipótese nula deste teste é que os modelos são equivalentes.</span>
<span id="cb116-597"><a href="#cb116-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-600"><a href="#cb116-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-601"><a href="#cb116-601" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3, mod1, <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb116-602"><a href="#cb116-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-603"><a href="#cb116-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-604"><a href="#cb116-604" aria-hidden="true" tabindex="-1"></a>O argumento poderia ser <span class="in">`test ="LRT"`</span>. Ambos testes calculam a diferença entre as deviances dos modelos e comparam essa diferença com uma distribuição qui-quadrado para obter o valor *p*.</span>
<span id="cb116-605"><a href="#cb116-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a>A *Tabela de Deviance* mostra a inclusão das variável `pafi` no `mod3`, melhora o modelo, mas não de forma estatisticamente significativa ao nível de 5% (*p* \&gt; 0.05), embora seja marginalmente significativa ao nível de 10% (*p* <span class="sc">\&lt;</span> 0.10).\</span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a>A inclusão de <span class="in">`Parch`</span> e <span class="in">`Fare`</span> no <span class="in">`mod1`</span> não melhora significativamente o modelo (*p* <span class="sc">\&gt;</span> 0.05).</span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Concluindo</span><span class="co">]</span>{.underline}: Os modelos têm, a grosso modo, Deviances muito próximos e a diferença não é significativa (valor *p* \&gt; 0,05 no teste de razão de verossimilhança), e pode-se aceitar que eles têm desempenho equivalente. Entretanto, o `mod2` (*model 1* na tabela de Deviance) é o mais simples, mais parcimonioso. Portanto, seria o mais adequado para seguir a análise.</span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-611"><a href="#cb116-611" aria-hidden="true" tabindex="-1"></a>Pode-se, também, usar um critério empírico que compara o Deviance residual com os **graus de liberdade**:</span>
<span id="cb116-612"><a href="#cb116-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-613"><a href="#cb116-613" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-614"><a href="#cb116-614" aria-hidden="true" tabindex="-1"></a>\frac{D_{residual}}{n-k}</span>
<span id="cb116-615"><a href="#cb116-615" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-616"><a href="#cb116-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-617"><a href="#cb116-617" aria-hidden="true" tabindex="-1"></a>Onde *n* = número de observações e *k* = número de **parâmetros**, incluindo o intercepto.</span>
<span id="cb116-618"><a href="#cb116-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-619"><a href="#cb116-619" aria-hidden="true" tabindex="-1"></a>Considerando o <span class="in">`mod2`</span>, temos 4 variáveis explicativas (<span class="in">`classe`</span> + <span class="in">`sexo`</span> + <span class="in">`idade`</span> + <span class="in">`irco`</span>), mas cada uma pode gerar mais um parâmetro, dependendo da codificação (por ex.: <span class="in">`classe`</span> com 3 níveis $\to$ 2 parâmetros; <span class="in">`sexo`</span> com dois níveis $\to$ 1 parâmetro). Além disso, o modelo inclui um intercepto, então o total de parametros *k* é:</span>
<span id="cb116-620"><a href="#cb116-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-621"><a href="#cb116-621" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`classe`</span>: 2 parâmetros (niveis 2 e 3)\</span>
<span id="cb116-622"><a href="#cb116-622" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sexo`</span>: 1 parâmetro (masculino)\</span>
<span id="cb116-623"><a href="#cb116-623" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`idade`</span>: 1 parâmetro (numérica)\</span>
<span id="cb116-624"><a href="#cb116-624" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`irco`</span>: 1 parâmetro (numérica)\</span>
<span id="cb116-625"><a href="#cb116-625" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Intercepto`</span>: 1</span>
<span id="cb116-626"><a href="#cb116-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-627"><a href="#cb116-627" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-628"><a href="#cb116-628" aria-hidden="true" tabindex="-1"></a>\frac{715.07}{889-6} = \frac{790.88}{883} \approx 0.810</span>
<span id="cb116-629"><a href="#cb116-629" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-630"><a href="#cb116-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-631"><a href="#cb116-631" aria-hidden="true" tabindex="-1"></a>Esse valor $&lt;1$ indica que o modelo está ajustado de forma adequada — ou seja, o erro médio por grau de liberdade é baixo. Os outros modelos também têm valoes $&lt;1$. Como visto anteriormente, eles não são muito diferentes em relação ao ajuste.</span>
<span id="cb116-632"><a href="#cb116-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-633"><a href="#cb116-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### AIC (Akaike Information Criterion)</span></span>
<span id="cb116-634"><a href="#cb116-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-635"><a href="#cb116-635" aria-hidden="true" tabindex="-1"></a>O *AIC* é uma medida estatística de ajuste que penaliza o modelo logístico pelo número de variáveis preditivas. Um modelo com valor mínimo de AIC é considerado um modelo bem ajustado. Desta forma o AIC serve para comparar modelos;</span>
<span id="cb116-636"><a href="#cb116-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-639"><a href="#cb116-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-640"><a href="#cb116-640" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1)</span>
<span id="cb116-641"><a href="#cb116-641" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod2)</span>
<span id="cb116-642"><a href="#cb116-642" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod3)</span>
<span id="cb116-643"><a href="#cb116-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-644"><a href="#cb116-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-645"><a href="#cb116-645" aria-hidden="true" tabindex="-1"></a>Existe uma melhora do AIC do <span class="in">`mod1`</span> para o <span class="in">`mod2`</span> e deste para o <span class="in">`mod3`</span>. O teste estatístico (anova) mostrou que estatisticamente os modelos podem ser considerados equivalentes.</span>
<span id="cb116-646"><a href="#cb116-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-647"><a href="#cb116-647" aria-hidden="true" tabindex="-1"></a>Assim, até aqui, baseado no princípio da simplicidade com eficácia (parcimônia), segue-se com o <span class="in">`mod2`</span>. Entretanto, em um modelo mais complexo existe a possibilidade de interação entre variáveis.</span>
<span id="cb116-648"><a href="#cb116-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-649"><a href="#cb116-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modelo 4: Interação</span></span>
<span id="cb116-650"><a href="#cb116-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-651"><a href="#cb116-651" aria-hidden="true" tabindex="-1"></a>Uma interação ocorre quando a relação entre as variáveis preditora e desfecho depende do valor ou do nível assumido por outra variável preditora.\</span>
<span id="cb116-652"><a href="#cb116-652" aria-hidden="true" tabindex="-1"></a>No exemplo em estudo, poderia haver uma interação se, por exemplo, a relação entre <span class="in">`classe`</span> do passageiro e <span class="in">`sobrevivência`</span> ao naufrágio dependesse do <span class="in">`sexo`</span>. Ou seja, passageiros de uma mesma classe no navio podem ter diferentes probabilidades de sobrevivência se forem de sexos diferentes. Diante dessa possibilidade, será ajustado um novo modelo (<span class="in">`mod4`</span>), incluindo a interação <span class="in">`classe * sexo`</span>.</span>
<span id="cb116-653"><a href="#cb116-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-656"><a href="#cb116-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-657"><a href="#cb116-657" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb116-658"><a href="#cb116-658" aria-hidden="true" tabindex="-1"></a>  sobreviveu <span class="sc">~</span> classe <span class="sc">*</span> sexo <span class="sc">+</span> idade <span class="sc">+</span> irco,</span>
<span id="cb116-659"><a href="#cb116-659" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> treino,</span>
<span id="cb116-660"><a href="#cb116-660" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-661"><a href="#cb116-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-662"><a href="#cb116-662" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span>
<span id="cb116-663"><a href="#cb116-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-664"><a href="#cb116-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-665"><a href="#cb116-665" aria-hidden="true" tabindex="-1"></a>Comparando esse novo modelo com o modelo 2 (<span class="in">`mod2`</span>):</span>
<span id="cb116-666"><a href="#cb116-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-669"><a href="#cb116-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-670"><a href="#cb116-670" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod2, mod4)</span>
<span id="cb116-671"><a href="#cb116-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-672"><a href="#cb116-672" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4, <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb116-673"><a href="#cb116-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-674"><a href="#cb116-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-675"><a href="#cb116-675" aria-hidden="true" tabindex="-1"></a>conclui-se que houve uma melhora significativa <span class="in">`mod2`</span> quando se inclui a interação.</span>
<span id="cb116-676"><a href="#cb116-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-677"><a href="#cb116-677" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Interpretação das OR do modelo de interação</span><span class="co">]</span>{.underline}</span>
<span id="cb116-678"><a href="#cb116-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-679"><a href="#cb116-679" aria-hidden="true" tabindex="-1"></a>Como foi visto anteriormente, o cálculo das Odds Ratios (OR) e seus respectivos Intervalos de Confiança (IC~95%~) é fundamental para interpretar o efeito de cada preditor.</span>
<span id="cb116-680"><a href="#cb116-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-683"><a href="#cb116-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-684"><a href="#cb116-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-685"><a href="#cb116-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-686"><a href="#cb116-686" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb116-687"><a href="#cb116-687" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(mod4)</span>
<span id="cb116-688"><a href="#cb116-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-689"><a href="#cb116-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-690"><a href="#cb116-690" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Interpretação dos Efeitos Singulares (Significativos)</span><span class="co">]</span>{.underline}:</span>
<span id="cb116-691"><a href="#cb116-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-692"><a href="#cb116-692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Idade**: OR = 0.963. Para cada aumento de um ano na idade, as chances de sobrevivência são 0.963 vezes menores (ou reduzem cerca de 3.7%), mantendo todas as outras variáveis constantes.</span>
<span id="cb116-693"><a href="#cb116-693" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**classe3** (vs. classe1, para Mulheres): OR = 0.0173. Para uma mulher na 3ª Classe, as chances de sobrevivência são 98% menores do que para uma mulher na 1ª Classe.</span>
<span id="cb116-694"><a href="#cb116-694" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**sexomasc** (vs. Feminino, na Classe 1): OR = 0.005. Para o homem na 1ª Classe, as chances de sobrevivência são mínimas em relação a uma mulher na 1ª Classe.</span>
<span id="cb116-695"><a href="#cb116-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-696"><a href="#cb116-696" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Interpretação da Interação (`classe * sexo`)</span><span class="co">]</span>{.underline}</span>
<span id="cb116-697"><a href="#cb116-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-698"><a href="#cb116-698" aria-hidden="true" tabindex="-1"></a>Como o termo de interação <span class="in">`classe3:sexomasc`</span> é **significativo**, isso confirma que o efeito do sexo é **diferente** na Classe 3 em comparação com a Classe 1.</span>
<span id="cb116-699"><a href="#cb116-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-700"><a href="#cb116-700" aria-hidden="true" tabindex="-1"></a>O **OR** final para homens na Classe 3 (vs. Mulheres na Classe 1) é calculado multiplicando os ORs relevantes:</span>
<span id="cb116-701"><a href="#cb116-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-702"><a href="#cb116-702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-703"><a href="#cb116-703" aria-hidden="true" tabindex="-1"></a>\text{OR}_{\text{H, C3 vs. M, C1}} = \text{OR}_{\text{C3}} \times \text{OR}_{\text{H}} \times \text{OR}_{\text{C3:H}}</span>
<span id="cb116-704"><a href="#cb116-704" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-705"><a href="#cb116-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-706"><a href="#cb116-706" aria-hidden="true" tabindex="-1"></a>Usando os resultados:</span>
<span id="cb116-707"><a href="#cb116-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-708"><a href="#cb116-708" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-709"><a href="#cb116-709" aria-hidden="true" tabindex="-1"></a>\text{OR}_{\text{H, C3 vs. M, C1}} \approx 0.005 \times 0.0173 \times 15.1 \approx {0.00131}</span>
<span id="cb116-710"><a href="#cb116-710" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-711"><a href="#cb116-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-712"><a href="#cb116-712" aria-hidden="true" tabindex="-1"></a>A OR de interação de 15.1 significa que a desvantagem extremamente alta de ser homem é parcialmente abrandada (multiplicada por 15.1) quando ele está na 3ª Classe. Apesar disso, o efeito total para um homem na 3ª Classe ainda representa uma chance de sobrevivência de quase zero comparada à mulher na 1ª Classe.</span>
<span id="cb116-713"><a href="#cb116-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-714"><a href="#cb116-714" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Preditoras Não Significativas</span><span class="co">]</span>{.underline}</span>
<span id="cb116-715"><a href="#cb116-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-716"><a href="#cb116-716" aria-hidden="true" tabindex="-1"></a>Os termos <span class="in">`irco`</span>, <span class="in">`classe2`</span>, e <span class="in">`classe2:sexomasc`</span> não são estatisticamente significativos, pois seus IC~95%~ incluem o valor 1.0. A diferença de chance de sobrevivência entre a 1ª Classe e a 2ª Classe (para mulheres) e a interação <span class="in">`classe2:sexomasc`</span> não são estatisticamente significativas.</span>
<span id="cb116-717"><a href="#cb116-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-718"><a href="#cb116-718" aria-hidden="true" tabindex="-1"></a>O modelo <span class="in">`mod4`</span> é estatisticamente robusto, parcimonioso e possui uma Qualidade do Ajuste aceitável, **representando um bom modelo** . portanto, melhor modelo é aquele que inclui:</span>
<span id="cb116-719"><a href="#cb116-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-720"><a href="#cb116-720" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`classe`</span>,</span>
<span id="cb116-721"><a href="#cb116-721" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`idade`</span>,</span>
<span id="cb116-722"><a href="#cb116-722" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sexo`</span>,</span>
<span id="cb116-723"><a href="#cb116-723" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`irco`</span> e</span>
<span id="cb116-724"><a href="#cb116-724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a interação entre <span class="in">`classe`</span> e <span class="in">`sexo`</span>.</span>
<span id="cb116-725"><a href="#cb116-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-726"><a href="#cb116-726" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Tabela tab_model()</span></span>
<span id="cb116-727"><a href="#cb116-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-728"><a href="#cb116-728" aria-hidden="true" tabindex="-1"></a>Também é possível comparar facilmente os modelos, usando o AIC com a função <span class="in">`tab_model()`</span>, disponível no pacote <span class="in">`sjPlot`</span>:</span>
<span id="cb116-729"><a href="#cb116-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-732"><a href="#cb116-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-733"><a href="#cb116-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tabmodel</span></span>
<span id="cb116-734"><a href="#cb116-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Comparação entre o modelo sem interação e o Modelo com interação"</span></span>
<span id="cb116-735"><a href="#cb116-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-736"><a href="#cb116-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-737"><a href="#cb116-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-738"><a href="#cb116-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-739"><a href="#cb116-739" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(mod2, mod4,</span>
<span id="cb116-740"><a href="#cb116-740" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"Modelo sem interação"</span>, <span class="st">"Modelo com interação"</span>),</span>
<span id="cb116-741"><a href="#cb116-741" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-742"><a href="#cb116-742" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-743"><a href="#cb116-743" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.r2 =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-744"><a href="#cb116-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>)           </span>
<span id="cb116-745"><a href="#cb116-745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-746"><a href="#cb116-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-747"><a href="#cb116-747" aria-hidden="true" tabindex="-1"></a>A @tbl-tabmodel mostra a compação dos <span class="in">`mod2`</span> (modelo sem interação) e <span class="in">`mod4`</span> (modelo com interação). Observa-se que o AIC no modelo com interação é bem menor, indicando que interação melhorou o ajuste.</span>
<span id="cb116-748"><a href="#cb116-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-749"><a href="#cb116-749" aria-hidden="true" tabindex="-1"></a>O $R^2$ Tjur (também chamado de coeficiente de discriminação) é um dos chamados pseudo-$R^2$ usados em regressão logística. Ele mede o quanto o modelo consegue distinguir entre os grupos da variável resposta binária (por exemplo, quem sobreviveu vs. quem não sobreviveu). Proposto por Tjur <span class="co">[</span><span class="ot">@tjur2009coefficients</span><span class="co">]</span>, é uma alternativa simples e intuitiva aos pseudo-$R^2$ de Cox &amp; Snell, Nagelkerke ou McFadden <span class="co">[</span><span class="ot">@franca2023pseudor</span><span class="co">]</span>. A definição matemática é a diferença entre a média das probabilidades previstas para os casos com resposta = 1 (positivos), e a média das probabilidades previstas para os casos com resposta = 0 (negativos).</span>
<span id="cb116-750"><a href="#cb116-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-751"><a href="#cb116-751" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-752"><a href="#cb116-752" aria-hidden="true" tabindex="-1"></a>\mathrm{R}_{Tjur}^{2} =\overline{p}_{y=1}-\overline{p}_{y=0}</span>
<span id="cb116-753"><a href="#cb116-753" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-754"><a href="#cb116-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-757"><a href="#cb116-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-758"><a href="#cb116-758" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas</span></span>
<span id="cb116-759"><a href="#cb116-759" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-760"><a href="#cb116-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-761"><a href="#cb116-761" aria-hidden="true" tabindex="-1"></a><span class="co"># Médias condicionais</span></span>
<span id="cb116-762"><a href="#cb116-762" aria-hidden="true" tabindex="-1"></a>mean_p_y1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob[treino<span class="sc">$</span>sobreviveu <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-763"><a href="#cb116-763" aria-hidden="true" tabindex="-1"></a>mean_p_y0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob[treino<span class="sc">$</span>sobreviveu <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-764"><a href="#cb116-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-765"><a href="#cb116-765" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mean_p_y1, mean_p_y0))</span>
<span id="cb116-766"><a href="#cb116-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-767"><a href="#cb116-767" aria-hidden="true" tabindex="-1"></a><span class="co"># R² Tjur</span></span>
<span id="cb116-768"><a href="#cb116-768" aria-hidden="true" tabindex="-1"></a>R2_Tjur <span class="ot">&lt;-</span> mean_p_y1 <span class="sc">-</span> mean_p_y0</span>
<span id="cb116-769"><a href="#cb116-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-770"><a href="#cb116-770" aria-hidden="true" tabindex="-1"></a>R2_Tjur</span>
<span id="cb116-771"><a href="#cb116-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-772"><a href="#cb116-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-773"><a href="#cb116-773" aria-hidden="true" tabindex="-1"></a>O modelo prevê em média 0.69 de probabilidade de sobrevivência para quem realmente sobreviveu e 0.18 para quem não sobreviveu, resultando num $\mathrm{R}_{Tjur}^{2} = 0.51$. Isso significa que o modelo tem uma boa capacidade de discriminar entre sobreviventes e não sobreviventes.</span>
<span id="cb116-774"><a href="#cb116-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-775"><a href="#cb116-775" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Se o modelo não tem poder discriminativo, as médias das probabilidades previstas para os dois grupos serão muito próximas → $\mathrm{R}_{Tjur}^{2}$ ≈ 0.</span>
<span id="cb116-776"><a href="#cb116-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-777"><a href="#cb116-777" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Se o modelo separa bem os grupos, a média das probabilidades para os positivos será alta e para os negativos será baixa → $\mathrm{R}_{Tjur}^{2}$ próximo de 1.</span>
<span id="cb116-778"><a href="#cb116-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-779"><a href="#cb116-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Valores típicos em regressão logística raramente chegam perto de 1; um $\mathrm{R}_{Tjur}^{2}$ de 0.3–0.5 já indica um modelo com boa capacidade discriminativa.</span>
<span id="cb116-780"><a href="#cb116-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-781"><a href="#cb116-781" aria-hidden="true" tabindex="-1"></a>Pode-se calcular o $\mathrm{R}_{Tjur}^{2}$, usando a função <span class="in">`r2_tjur()`</span> do pacote <span class="in">`performance`</span> <span class="co">[</span><span class="ot">@easystats2025R2Tjur</span><span class="co">]</span>.</span>
<span id="cb116-782"><a href="#cb116-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-785"><a href="#cb116-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-786"><a href="#cb116-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-787"><a href="#cb116-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-788"><a href="#cb116-788" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb116-789"><a href="#cb116-789" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_tjur</span>(mod4)</span>
<span id="cb116-790"><a href="#cb116-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-791"><a href="#cb116-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-792"><a href="#cb116-792" aria-hidden="true" tabindex="-1"></a>Isto significa, como dito, uma boa capacidade de dicriminação. Entretanto, não confundir com o $R^2$ da regressão linear, pois o $\mathrm{R}_{Tjur}^{2}$ mede a capacidade discriminação, ou seja, quão bem o modelo separa os dois grupos da resposta binária. Enquanto o $R^2$ (Coeficiente de determinação), mede a proporção da variância da variável dependente que é explicada pelo modelo.</span>
<span id="cb116-793"><a href="#cb116-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-794"><a href="#cb116-794" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multicolinearidade</span></span>
<span id="cb116-795"><a href="#cb116-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-796"><a href="#cb116-796" aria-hidden="true" tabindex="-1"></a>A **multicolinearidade** ocorre quando duas ou mais variáveis preditoras estão altamente correlacionadas, o que infla o erro padrão dos coeficientes, tornando-os instáveis. Para verificar a multicolinearidade, pode-se usar o **Fator de Inflação da Variância (VIF)** através da função <span class="in">`check_collinearity()`</span> do pacote <span class="in">`performance`</span>, pois fornece análise mais clara da colinearidade em modelos GLM com interações quando comparada a função <span class="in">`vif()`</span> do pacote <span class="in">`car`</span>.</span>
<span id="cb116-797"><a href="#cb116-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-800"><a href="#cb116-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-801"><a href="#cb116-801" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb116-802"><a href="#cb116-802" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(mod4)</span>
<span id="cb116-803"><a href="#cb116-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-804"><a href="#cb116-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-805"><a href="#cb116-805" aria-hidden="true" tabindex="-1"></a>Se o VIF <span class="sc">\&lt;</span> 5 geralmente é aceitável e o modelo deve ser mantido. Um VIF acima de 10 é uma preocupação significativa e deve ser considerada a remoção de uma das variáveis correlacionadas. Quando o VIF se encontra enter 5 e 10 é uma preocupalçao moderada e a decisão depende do contexto. Pode-se manter o modelo, mas estar ciente da instabilidade potencial.</span>
<span id="cb116-806"><a href="#cb116-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-807"><a href="#cb116-807" aria-hidden="true" tabindex="-1"></a>A interação <span class="in">`classe * sexo`</span> gera redundância matemática com os termos principais, inflando os VIFs. Isso não invalida o modelo, mas indica que os coeficientes podem ser instáveis (mudam a amostra for alterada ou houver inclusão/exclusão de variáveis). O modelo ainda é utilizável, mas os coeficientes devem ser interpretados com cautela, especialmente os de <span class="in">`classe`</span> e da interação <span class="in">`classe:sexo`</span>.</span>
<span id="cb116-808"><a href="#cb116-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-809"><a href="#cb116-809" aria-hidden="true" tabindex="-1"></a>Concluindo e levando em consideração o valor do VIF ajustado:</span>
<span id="cb116-810"><a href="#cb116-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-811"><a href="#cb116-811" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`idade`</span> e <span class="in">`irco`</span> $\to$ seguros, sem colinearidade (VIF ajustado <span class="sc">\&lt;</span> 5).\</span>
<span id="cb116-812"><a href="#cb116-812" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`classe`</span>, <span class="in">`sexo`</span> e <span class="in">`classe:sexo`</span> $\to$ apresentam colinearidade moderada/alta, mas ainda abaixo do limiar crítico (10).</span>
<span id="cb116-813"><a href="#cb116-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-814"><a href="#cb116-814" aria-hidden="true" tabindex="-1"></a>O modelo continua válido, mas os efeitos principais e de interação devem ser interpretados com cuidado.</span>
<span id="cb116-815"><a href="#cb116-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-816"><a href="#cb116-816" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb116-817"><a href="#cb116-817" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusão sobre os modelos</span></span>
<span id="cb116-818"><a href="#cb116-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-819"><a href="#cb116-819" aria-hidden="true" tabindex="-1"></a>Foram ajustados dois modelos de regressão logística: um modelo simples, contendo apenas os efeitos principais, e um modelo com interação entre as variáveis classe e sexo. O modelo com interação apresentou melhor ajuste (menor AIC e deviance), além de indicar que o efeito do sexo depende da classe, especialmente na terceira classe, onde os homens tiveram probabilidade significativamente menor de sobrevivência. Contudo, a inclusão da interação elevou os valores de VIF, revelando colinearidade moderada a alta entre os termos principais e o termo de interação. Essa situação pode comprometer a estabilidade dos coeficientes e dificultar a interpretação direta dos efeitos. Por esse motivo, optou-se por apresentar ambos os modelos: o **modelo simples**, mais parcimonioso e estável, para interpretação dos efeitos principais; e o **modelo com interação**, para evidenciar a dependência entre as variáveis e o ganho em capacidade explicativa, ainda que com maior complexidade.</span>
<span id="cb116-820"><a href="#cb116-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-821"><a href="#cb116-821" aria-hidden="true" tabindex="-1"></a>O modelo com interação entre <span class="in">`classe`</span> e <span class="in">`sexo`</span> apresentou melhor ajuste estatístico, mas elevou os índices de colinearidade, indicando menor estabilidade dos coeficientes. Já o modelo simples mostrou-se mais parcimonioso e estável. Assim, ambos foram considerados: o modelo sem interação para interpretação dos efeitos principais e o modelo com interação para evidenciar dependências entre variáveis.</span>
<span id="cb116-822"><a href="#cb116-822" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-823"><a href="#cb116-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-824"><a href="#cb116-824" aria-hidden="true" tabindex="-1"></a><span class="fu">## Avaliação preditiva com os dados de teste</span></span>
<span id="cb116-825"><a href="#cb116-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-826"><a href="#cb116-826" aria-hidden="true" tabindex="-1"></a><span class="fu">### Qualidade do modelo</span></span>
<span id="cb116-827"><a href="#cb116-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-828"><a href="#cb116-828" aria-hidden="true" tabindex="-1"></a>Normalmente, o objetivo da construção de um modelo é ser capaz de prever, com a maior acurácia possível, a variável resposta para novos dados. Uma boa maneira de avaliar a acurácia de um modelo é monitorar seu desempenho em novos dados (<span class="in">`teste`</span>) e contar com que frequência ele prevê o resultado correto.</span>
<span id="cb116-829"><a href="#cb116-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-830"><a href="#cb116-830" aria-hidden="true" tabindex="-1"></a>Suponha que, se a probabilidade de o paciente sobreviver for inferior a 50%, será considerado que o resultado previsto é **não sobrevivência**; caso contrário, o resultado previsto é sucesso, o paciente **sobreviveu**.</span>
<span id="cb116-831"><a href="#cb116-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-832"><a href="#cb116-832" aria-hidden="true" tabindex="-1"></a>Inicialmente, constroi-se uma tabela de contingência comparando o desempenho do modelo, usando os dados observados nos dados <span class="in">`teste`</span>:</span>
<span id="cb116-833"><a href="#cb116-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-836"><a href="#cb116-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-837"><a href="#cb116-837" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um vetor de probabilidades previstas no dataframe teste</span></span>
<span id="cb116-838"><a href="#cb116-838" aria-hidden="true" tabindex="-1"></a>prob_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-839"><a href="#cb116-839" aria-hidden="true" tabindex="-1"></a>prob_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-840"><a href="#cb116-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-841"><a href="#cb116-841" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação binária (ponto de corte 0.5) ----</span></span>
<span id="cb116-842"><a href="#cb116-842" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_mod2 <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb116-843"><a href="#cb116-843" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_mod4 <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb116-844"><a href="#cb116-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-845"><a href="#cb116-845" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar as predições em fatores e colocar rótulos</span></span>
<span id="cb116-846"><a href="#cb116-846" aria-hidden="true" tabindex="-1"></a>pred_mod2  <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_mod2,</span>
<span id="cb116-847"><a href="#cb116-847" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb116-848"><a href="#cb116-848" aria-hidden="true" tabindex="-1"></a>pred_mod4  <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_mod4,</span>
<span id="cb116-849"><a href="#cb116-849" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb116-850"><a href="#cb116-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-851"><a href="#cb116-851" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar o resultado observado com o resultado previsto</span></span>
<span id="cb116-852"><a href="#cb116-852" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">observado =</span> teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb116-853"><a href="#cb116-853" aria-hidden="true" tabindex="-1"></a>              <span class="at">previsto  =</span> pred_mod2)</span>
<span id="cb116-854"><a href="#cb116-854" aria-hidden="true" tabindex="-1"></a>tab4 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">observado =</span> teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb116-855"><a href="#cb116-855" aria-hidden="true" tabindex="-1"></a>              <span class="at">previsto  =</span> pred_mod4)</span>
<span id="cb116-856"><a href="#cb116-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-857"><a href="#cb116-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb116-858"><a href="#cb116-858" aria-hidden="true" tabindex="-1"></a>tab2</span>
<span id="cb116-859"><a href="#cb116-859" aria-hidden="true" tabindex="-1"></a>tab4</span>
<span id="cb116-860"><a href="#cb116-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-861"><a href="#cb116-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-862"><a href="#cb116-862" aria-hidden="true" tabindex="-1"></a>A partir da tabela de contingência (tab2) dos resultados previstos e observados, verifica-se que o modelo 2:</span>
<span id="cb116-863"><a href="#cb116-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-864"><a href="#cb116-864" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu corretamente que 228 passageiros que não sobreviveram.\</span>
<span id="cb116-865"><a href="#cb116-865" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu incorretamente 31 passageiros que não sobreviveram.\</span>
<span id="cb116-866"><a href="#cb116-866" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu incorretamente que 17 passageiros que sobreviveram, e\</span>
<span id="cb116-867"><a href="#cb116-867" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu corretamente 110 passageiros que sobreviveram.</span>
<span id="cb116-868"><a href="#cb116-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-869"><a href="#cb116-869" aria-hidden="true" tabindex="-1"></a>A partir da tabela de contingência (tab4) dos resultados previstos e observados, verifica-se que o modelo 4:</span>
<span id="cb116-870"><a href="#cb116-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-871"><a href="#cb116-871" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu corretamente que 233 passageiros que não sobreviveram.\</span>
<span id="cb116-872"><a href="#cb116-872" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu incorretamente 34 passageiros que não sobreviveram.\</span>
<span id="cb116-873"><a href="#cb116-873" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu incorretamente que 17 passageiros que sobreviveram, e\</span>
<span id="cb116-874"><a href="#cb116-874" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>previu corretamente 107 passageiros que sobreviveram.</span>
<span id="cb116-875"><a href="#cb116-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-876"><a href="#cb116-876" aria-hidden="true" tabindex="-1"></a>A porcentagem de previsões corretas, também chamada de **acurácia**, é a soma das previsões corretas (verdadeiros positivos + verdadeiros negativos) dividida pelo número total de previsões:</span>
<span id="cb116-877"><a href="#cb116-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-878"><a href="#cb116-878" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-879"><a href="#cb116-879" aria-hidden="true" tabindex="-1"></a>acurácia = \frac{VP + VN}{VP + VN + FP + FN}</span>
<span id="cb116-880"><a href="#cb116-880" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-881"><a href="#cb116-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-882"><a href="#cb116-882" aria-hidden="true" tabindex="-1"></a>Usando a tabela de contingência <span class="in">`tab2`</span>:</span>
<span id="cb116-883"><a href="#cb116-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-886"><a href="#cb116-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-887"><a href="#cb116-887" aria-hidden="true" tabindex="-1"></a>acuracia2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tab2)) <span class="sc">/</span> <span class="fu">sum</span>(tab2)</span>
<span id="cb116-888"><a href="#cb116-888" aria-hidden="true" tabindex="-1"></a>acuracia2</span>
<span id="cb116-889"><a href="#cb116-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-890"><a href="#cb116-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-891"><a href="#cb116-891" aria-hidden="true" tabindex="-1"></a>O modelo tem uma alta acurácia (86%), isso indica um bom desempenho geral. Um modelo é considerado razoavelmente bom se a acurácia do modelo for superior a 70%.</span>
<span id="cb116-892"><a href="#cb116-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-893"><a href="#cb116-893" aria-hidden="true" tabindex="-1"></a>Usando a tabela de contingência <span class="in">`tab4`</span>:</span>
<span id="cb116-894"><a href="#cb116-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-897"><a href="#cb116-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-898"><a href="#cb116-898" aria-hidden="true" tabindex="-1"></a>acuracia4 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tab4)) <span class="sc">/</span> <span class="fu">sum</span>(tab4)</span>
<span id="cb116-899"><a href="#cb116-899" aria-hidden="true" tabindex="-1"></a>acuracia4</span>
<span id="cb116-900"><a href="#cb116-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-901"><a href="#cb116-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-902"><a href="#cb116-902" aria-hidden="true" tabindex="-1"></a>O modelo tem uma alta acurácia (87%), isso indica um bom desempenho geral.</span>
<span id="cb116-903"><a href="#cb116-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-904"><a href="#cb116-904" aria-hidden="true" tabindex="-1"></a>Ambos modelos apresentam uma boa acurácia!</span>
<span id="cb116-905"><a href="#cb116-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-906"><a href="#cb116-906" aria-hidden="true" tabindex="-1"></a>Embora a acurácia seja a maneira mais intuitiva e fácil de medir o desempenho preditivo de um modelo, ela apresenta algumas desvantagens, principalmente porque há necessidade de escolher um limiar arbitrário (aqui foi escolhido 50%) a partir do qual uma nova observação é classificada como 1 ou 0. Poderia ser escolhido outro limite e os resultados seriam diferentes!</span>
<span id="cb116-907"><a href="#cb116-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-908"><a href="#cb116-908" aria-hidden="true" tabindex="-1"></a>Usando uma matriz de confusão, através da função <span class="in">`confusionMatrix()`</span> do pacote <span class="in">`caret`</span> pode-se calcular a acurácia e outras métricas de avaliação da qualidade (validade) do modelo :</span>
<span id="cb116-909"><a href="#cb116-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-912"><a href="#cb116-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-913"><a href="#cb116-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-914"><a href="#cb116-914" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-915"><a href="#cb116-915" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb116-916"><a href="#cb116-916" aria-hidden="true" tabindex="-1"></a>conf_matrix2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_mod2, teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb116-917"><a href="#cb116-917" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb116-918"><a href="#cb116-918" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix2)</span>
<span id="cb116-919"><a href="#cb116-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-920"><a href="#cb116-920" aria-hidden="true" tabindex="-1"></a>conf_matrix4 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_mod4, teste<span class="sc">$</span>sobreviveu,</span>
<span id="cb116-921"><a href="#cb116-921" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb116-922"><a href="#cb116-922" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix4)</span>
<span id="cb116-923"><a href="#cb116-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-924"><a href="#cb116-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-925"><a href="#cb116-925" aria-hidden="true" tabindex="-1"></a>A **Sensibilidade (Recall)** é a proporção de verdadeiros positivos (VP) identificados corretamente. . É obtida pela fórmula:</span>
<span id="cb116-926"><a href="#cb116-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-927"><a href="#cb116-927" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-928"><a href="#cb116-928" aria-hidden="true" tabindex="-1"></a>sensibilidade = \frac{VP}{VP + FN}</span>
<span id="cb116-929"><a href="#cb116-929" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-930"><a href="#cb116-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-931"><a href="#cb116-931" aria-hidden="true" tabindex="-1"></a>O <span class="in">`mod2`</span> identifica corretamete 70,2% e o <span class="in">`mod4`</span> 75,9% dos verdadeiros positivos. Isto significa que apresentam 29,8% e 24,1% de falsos negativos. São valores que dependendo do contexto podem exigir atenção, principalmente na área da saúde. Entre os modelos, o mod4 gera menos falsos negativos, houve um pequeno avanço. A análise deve ser feita em conjunto com outras métricas.</span>
<span id="cb116-932"><a href="#cb116-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-933"><a href="#cb116-933" aria-hidden="true" tabindex="-1"></a>A **Especificidade** é a proporção de verdadeiros negativos(VN). A fórmula para calcular a especificidade é:</span>
<span id="cb116-934"><a href="#cb116-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-935"><a href="#cb116-935" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-936"><a href="#cb116-936" aria-hidden="true" tabindex="-1"></a>especificidade = \frac{VN}{FP + VN}</span>
<span id="cb116-937"><a href="#cb116-937" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-938"><a href="#cb116-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-939"><a href="#cb116-939" aria-hidden="true" tabindex="-1"></a>O <span class="in">`mod2`</span> reconhece 91.2% dos verdadeiros negativos e o mod4, 93,2%. Ambos tem uma baixa taxa de falos positivos.</span>
<span id="cb116-940"><a href="#cb116-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-941"><a href="#cb116-941" aria-hidden="true" tabindex="-1"></a>O **Valor P do Teste de McNemar** testa se há viés significativo na classificação dos erros. O valor alto (*p* = 0.2718), no `mod2` sugere que os erros entre classes não são estatisticamente diferentes. Já no `mod4`, o valor *p* <span class="sc">\&lt;</span> 0.05, indica que ele não é neutro nos erros, não erra de forma aleatória, mas sim enviesada. Isso pode ser problemático quando os falsos negativos forem graves (por ex.: área da saúde) e aí o modelo pode ser inadequado. Isso não invalida o <span class="in">`mod4`</span>, mas mostra que ele precisa ser avaliado com cuidado quanto ao tipo de erro que gera. Avaliar outras métricas junto (sensibilidade, especificidade, AUC).</span>
<span id="cb116-942"><a href="#cb116-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-943"><a href="#cb116-943" aria-hidden="true" tabindex="-1"></a>O **Kappa** mede concordância ajustada para a distribuição dos dados. Um valor próximo de 1 indica boa concordância entre previsões e valores reais.</span>
<span id="cb116-944"><a href="#cb116-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-945"><a href="#cb116-945" aria-hidden="true" tabindex="-1"></a>O **escore F1** (não listado diretamente) representa o equilíbrio entre precisão e recall. Pode ser obtido pela equação:</span>
<span id="cb116-946"><a href="#cb116-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-947"><a href="#cb116-947" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-948"><a href="#cb116-948" aria-hidden="true" tabindex="-1"></a>F_{1} = 2 \times \frac{VPP \times sensibilidade}{VPP + sensibilidade} </span>
<span id="cb116-949"><a href="#cb116-949" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-950"><a href="#cb116-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-951"><a href="#cb116-951" aria-hidden="true" tabindex="-1"></a>Ou consultando:</span>
<span id="cb116-952"><a href="#cb116-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-955"><a href="#cb116-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-956"><a href="#cb116-956" aria-hidden="true" tabindex="-1"></a>conf_matrix2<span class="sc">$</span>byClass[<span class="dv">7</span>]</span>
<span id="cb116-957"><a href="#cb116-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-958"><a href="#cb116-958" aria-hidden="true" tabindex="-1"></a>conf_matrix4<span class="sc">$</span>byClass[<span class="dv">7</span>]</span>
<span id="cb116-959"><a href="#cb116-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-960"><a href="#cb116-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-961"><a href="#cb116-961" aria-hidden="true" tabindex="-1"></a>Ambos os modelos têm $F_{1}\approx 0.81$, o que indica bom equilíbrio entre sensibilidade e precisão. A diferença entre eles é mínima (0.0017), mostrando que em termos de qualidade preditiva global, os dois modelos são praticamente equivalentes.</span>
<span id="cb116-962"><a href="#cb116-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-963"><a href="#cb116-963" aria-hidden="true" tabindex="-1"></a>A **Precisão** é a proporção de previsões positivas que estavam corretas, também denominada de **valor preditivo positivo** (VPP). A precisão do <span class="in">`mod2`</span> é igual 83.3% e do mod4 86.3%, ambas são consideradas valores altos.</span>
<span id="cb116-964"><a href="#cb116-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-965"><a href="#cb116-965" aria-hidden="true" tabindex="-1"></a><span class="fu">### AUC e curva ROC</span></span>
<span id="cb116-966"><a href="#cb116-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-967"><a href="#cb116-967" aria-hidden="true" tabindex="-1"></a>Outra forma comum de avaliar a qualidade de um modelo é calcular a **AUC** (Área Sob a Curva) e traçar a **curva ROC** (Característica de Operação do Receptor). A curva ROC mostra a relação entre **sensibilidade(recall)** e **1 - especificidade (FP)** para diferentes limiares de classificação. A AUC resume a curva ROC em um único número (quanto mais próximo de 1, melhor o modelo). A curva ROC/AUC pode ser calculada com os dados treino, mas tende a ser otimista, já que o modelo foi ajustado nesses dados. O ideal é usar os dados teste (ou de validação), porque mede o desempenho em dados não vistos, refletindo a capacidade de generalização do modelo.</span>
<span id="cb116-968"><a href="#cb116-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-969"><a href="#cb116-969" aria-hidden="true" tabindex="-1"></a>Isso pode ser facilmente alcançado graças à função <span class="in">`roc()`</span> e <span class="in">`ggroc()`</span> do pacote <span class="in">`pROC`</span> associado ao <span class="in">`ggplot2`</span>:</span>
<span id="cb116-970"><a href="#cb116-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-973"><a href="#cb116-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-974"><a href="#cb116-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-975"><a href="#cb116-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-976"><a href="#cb116-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-977"><a href="#cb116-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb116-978"><a href="#cb116-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-auc2-4</span></span>
<span id="cb116-979"><a href="#cb116-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-980"><a href="#cb116-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparação do modelo simples com o modelo com interação"</span></span>
<span id="cb116-981"><a href="#cb116-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-982"><a href="#cb116-982" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb116-983"><a href="#cb116-983" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb116-984"><a href="#cb116-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-985"><a href="#cb116-985" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerar objetos ROC</span></span>
<span id="cb116-986"><a href="#cb116-986" aria-hidden="true" tabindex="-1"></a>roc_mod2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_mod2)</span>
<span id="cb116-987"><a href="#cb116-987" aria-hidden="true" tabindex="-1"></a>roc_mod4 <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_mod4)</span>
<span id="cb116-988"><a href="#cb116-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-989"><a href="#cb116-989" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular AUCs</span></span>
<span id="cb116-990"><a href="#cb116-990" aria-hidden="true" tabindex="-1"></a>auc_mod2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_mod2)</span>
<span id="cb116-991"><a href="#cb116-991" aria-hidden="true" tabindex="-1"></a>auc_mod4 <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_mod4)</span>
<span id="cb116-992"><a href="#cb116-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-993"><a href="#cb116-993" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para ggroc</span></span>
<span id="cb116-994"><a href="#cb116-994" aria-hidden="true" tabindex="-1"></a>roc_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Modelo simples"</span> <span class="ot">=</span> roc_mod2,</span>
<span id="cb116-995"><a href="#cb116-995" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Modelo interação"</span> <span class="ot">=</span> roc_mod4)</span>
<span id="cb116-996"><a href="#cb116-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-997"><a href="#cb116-997" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot com ggplot2</span></span>
<span id="cb116-998"><a href="#cb116-998" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(roc_list, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb116-999"><a href="#cb116-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Curvas ROC"</span>,</span>
<span id="cb116-1000"><a href="#cb116-1000" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"1 - Especificidade (Taxa de Falsos Positivos)"</span>,</span>
<span id="cb116-1001"><a href="#cb116-1001" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensibilidade (Taxa de Verdadeiros Positivos)"</span>) <span class="sc">+</span></span>
<span id="cb116-1002"><a href="#cb116-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb116-1003"><a href="#cb116-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1004"><a href="#cb116-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb116-1005"><a href="#cb116-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb116-1006"><a href="#cb116-1006" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC simples: "</span>, <span class="fu">round</span>(auc_mod2, <span class="dv">3</span>)),</span>
<span id="cb116-1007"><a href="#cb116-1007" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb116-1008"><a href="#cb116-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb116-1009"><a href="#cb116-1009" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC interação: "</span>, <span class="fu">round</span>(auc_mod4, <span class="dv">3</span>)),</span>
<span id="cb116-1010"><a href="#cb116-1010" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb116-1011"><a href="#cb116-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1012"><a href="#cb116-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1013"><a href="#cb116-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1014"><a href="#cb116-1014" aria-hidden="true" tabindex="-1"></a>A AUC (Área sob a Curva ROC) indica a qualidade do modelo (veja também a Seção 21.6):</span>
<span id="cb116-1015"><a href="#cb116-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1016"><a href="#cb116-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$AUC \approx 0.5$: O modelo não tem poder preditivo (equivalente ao puro acaso).</span>
<span id="cb116-1017"><a href="#cb116-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$AUC &gt; 0.7$: Modelo razoável.</span>
<span id="cb116-1018"><a href="#cb116-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$AUC &gt; 0.8$: Modelo muito bom.</span>
<span id="cb116-1019"><a href="#cb116-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$AUC &gt; 0.9$: Excelebte desempenho</span>
<span id="cb116-1020"><a href="#cb116-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1021"><a href="#cb116-1021" aria-hidden="true" tabindex="-1"></a>Usando as métricas de validade, a curva ROC e a AUC, conclui-se que:</span>
<span id="cb116-1022"><a href="#cb116-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1023"><a href="#cb116-1023" aria-hidden="true" tabindex="-1"></a>Após a avaliação dos modelos ajustados, observou-se que o modelo com interação entre classe e sexo (<span class="in">`mod4`</span>) apresentou melhor ajuste estatístico, com menor AIC e deviance, além de capturar nuances importantes entre as variáveis. No entanto, esse modelo também apresentou colinearidade moderada e padrão de erro enviesado, conforme indicado pelo teste de McNemar (*p* \&lt; 0,05), o que pode comprometer a estabilidade dos coeficientes e a neutralidade preditiva. Por outro lado, o modelo simples (*mod2*) demonstrou desempenho preditivo praticamente equivalente, com AUC ligeiramente superior (0,919 vs. 0,918), menor colinearidade e maior robustez interpretativa. Diante disso, optou-se por priorizar o modelo simples para fins de interpretação e comunicação dos resultados, mantendo o modelo com interação como referência complementar para análise de padrões específicos</span>
<span id="cb116-1024"><a href="#cb116-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1025"><a href="#cb116-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparar duas curvas ROC (treino vs teste)</span></span>
<span id="cb116-1026"><a href="#cb116-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1029"><a href="#cb116-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1030"><a href="#cb116-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1031"><a href="#cb116-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1032"><a href="#cb116-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-1033"><a href="#cb116-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb116-1034"><a href="#cb116-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-treino_teste</span></span>
<span id="cb116-1035"><a href="#cb116-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-1036"><a href="#cb116-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparação do modelo simples com o modelo com interação"</span></span>
<span id="cb116-1037"><a href="#cb116-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1038"><a href="#cb116-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb116-1039"><a href="#cb116-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb116-1040"><a href="#cb116-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1041"><a href="#cb116-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas no treino e teste</span></span>
<span id="cb116-1042"><a href="#cb116-1042" aria-hidden="true" tabindex="-1"></a>prob_treino <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> treino, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-1043"><a href="#cb116-1043" aria-hidden="true" tabindex="-1"></a>prob_teste  <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-1044"><a href="#cb116-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1045"><a href="#cb116-1045" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas ROC</span></span>
<span id="cb116-1046"><a href="#cb116-1046" aria-hidden="true" tabindex="-1"></a>roc_treino <span class="ot">&lt;-</span> <span class="fu">roc</span>(treino<span class="sc">$</span>sobreviveu, prob_treino)</span>
<span id="cb116-1047"><a href="#cb116-1047" aria-hidden="true" tabindex="-1"></a>roc_teste  <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_teste)</span>
<span id="cb116-1048"><a href="#cb116-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1049"><a href="#cb116-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC e IC95% para treino</span></span>
<span id="cb116-1050"><a href="#cb116-1050" aria-hidden="true" tabindex="-1"></a>auc_treino <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_treino)</span>
<span id="cb116-1051"><a href="#cb116-1051" aria-hidden="true" tabindex="-1"></a>ci_treino  <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(roc_treino)</span>
<span id="cb116-1052"><a href="#cb116-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1053"><a href="#cb116-1053" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC e IC95% para teste</span></span>
<span id="cb116-1054"><a href="#cb116-1054" aria-hidden="true" tabindex="-1"></a>auc_teste <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_teste)</span>
<span id="cb116-1055"><a href="#cb116-1055" aria-hidden="true" tabindex="-1"></a>ci_teste  <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(roc_teste)</span>
<span id="cb116-1056"><a href="#cb116-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1057"><a href="#cb116-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar textos para anotação</span></span>
<span id="cb116-1058"><a href="#cb116-1058" aria-hidden="true" tabindex="-1"></a>texto_treino <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Treino: AUC = "</span>, <span class="fu">round</span>(auc_treino, <span class="dv">3</span>),</span>
<span id="cb116-1059"><a href="#cb116-1059" aria-hidden="true" tabindex="-1"></a>                       <span class="st">" (IC95%: "</span>, <span class="fu">round</span>(ci_treino[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb116-1060"><a href="#cb116-1060" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(ci_treino[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb116-1061"><a href="#cb116-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1062"><a href="#cb116-1062" aria-hidden="true" tabindex="-1"></a>texto_teste <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Teste: AUC = "</span>, <span class="fu">round</span>(auc_teste, <span class="dv">3</span>),</span>
<span id="cb116-1063"><a href="#cb116-1063" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" (IC95%: "</span>, <span class="fu">round</span>(ci_teste[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb116-1064"><a href="#cb116-1064" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">round</span>(ci_teste[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb116-1065"><a href="#cb116-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1066"><a href="#cb116-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar ambas curvas ROC com ggroc</span></span>
<span id="cb116-1067"><a href="#cb116-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(<span class="fu">list</span>(<span class="at">Treino =</span> roc_treino, <span class="at">Teste =</span> roc_teste), <span class="at">aes =</span> <span class="fu">c</span>(<span class="st">"color"</span>)) <span class="sc">+</span></span>
<span id="cb116-1068"><a href="#cb116-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1069"><a href="#cb116-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Curvas ROC - Treino vs Teste"</span>,</span>
<span id="cb116-1070"><a href="#cb116-1070" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensibilidade"</span>,</span>
<span id="cb116-1071"><a href="#cb116-1071" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"1 - Especificidade"</span>) <span class="sc">+</span></span>
<span id="cb116-1072"><a href="#cb116-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb116-1073"><a href="#cb116-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> texto_treino,</span>
<span id="cb116-1074"><a href="#cb116-1074" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb116-1075"><a href="#cb116-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> texto_teste,</span>
<span id="cb116-1076"><a href="#cb116-1076" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb116-1077"><a href="#cb116-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1078"><a href="#cb116-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1079"><a href="#cb116-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1080"><a href="#cb116-1080" aria-hidden="true" tabindex="-1"></a>Além de observar visualmente, pode-se realizar um teste estatístico, o Teste de Delong <span class="co">[</span><span class="ot">@delong1988comparing</span><span class="co">]</span>, para verificar se a diferença entre as AUCs das curvas tem significância estatística:</span>
<span id="cb116-1081"><a href="#cb116-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1084"><a href="#cb116-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1085"><a href="#cb116-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1086"><a href="#cb116-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1087"><a href="#cb116-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1088"><a href="#cb116-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb116-1089"><a href="#cb116-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1090"><a href="#cb116-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades previstas no treino e teste</span></span>
<span id="cb116-1091"><a href="#cb116-1091" aria-hidden="true" tabindex="-1"></a>prob_treino <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> treino, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-1092"><a href="#cb116-1092" aria-hidden="true" tabindex="-1"></a>prob_teste  <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> teste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb116-1093"><a href="#cb116-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1094"><a href="#cb116-1094" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas ROC</span></span>
<span id="cb116-1095"><a href="#cb116-1095" aria-hidden="true" tabindex="-1"></a>roc_treino <span class="ot">&lt;-</span> <span class="fu">roc</span>(treino<span class="sc">$</span>sobreviveu, prob_treino)</span>
<span id="cb116-1096"><a href="#cb116-1096" aria-hidden="true" tabindex="-1"></a>roc_teste  <span class="ot">&lt;-</span> <span class="fu">roc</span>(teste<span class="sc">$</span>sobreviveu, prob_teste)</span>
<span id="cb116-1097"><a href="#cb116-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1098"><a href="#cb116-1098" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparação estatística com teste de DeLong</span></span>
<span id="cb116-1099"><a href="#cb116-1099" aria-hidden="true" tabindex="-1"></a>teste_delong <span class="ot">&lt;-</span> <span class="fu">roc.test</span>(roc_treino, roc_teste, <span class="at">method =</span> <span class="st">"delong"</span>)</span>
<span id="cb116-1100"><a href="#cb116-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1101"><a href="#cb116-1101" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultado</span></span>
<span id="cb116-1102"><a href="#cb116-1102" aria-hidden="true" tabindex="-1"></a>teste_delong</span>
<span id="cb116-1103"><a href="#cb116-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1104"><a href="#cb116-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1105"><a href="#cb116-1105" aria-hidden="true" tabindex="-1"></a>A saída do teste retorna um valor *p* = 0.1421 (<span class="sc">\&lt;</span> 0.05) indicando que a diferença entre os AUCs é estatisticamente não significativa. Os modelo apresentam AUCs semelhantes em ambos dados.</span>
<span id="cb116-1106"><a href="#cb116-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1107"><a href="#cb116-1107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relato dos resultados</span></span>
<span id="cb116-1108"><a href="#cb116-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1109"><a href="#cb116-1109" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Para avaliar a capacidade de generalização do modelo, foram comparadas as curvas ROC obtidas nos conjuntos de treino e teste. O modelo apresentou AUC de 0,888 no treino (IC95%: 0,864–0,913) e AUC de 0,918 no teste (IC95%: 0,887–0,949), indicando desempenho superior nos dados não vistos. A sobreposição dos intervalos de confiança sugere que a diferença pode não ser estatisticamente significativa, mas reforça a robustez do modelo. O Teste de Delong confirma que a diferença não é estatisticamente significativa (*p* = 0.1421), A curva ROC do teste posicionou-se mais próxima do canto superior esquerdo, evidenciando maior capacidade discriminativa e ausência de sobreajuste (*overfitting*). Esses resultados demonstram que o modelo é confiável e apresenta boa performance preditiva fora da amostra de treinamento.</span></span>
<span id="cb116-1110"><a href="#cb116-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1111"><a href="#cb116-1111" aria-hidden="true" tabindex="-1"></a>Pode-se também relatar os resultados de uma regressão logística binária usando uma tabela (@tbl-finalreg) gerada, por exemplo, pela função <span class="in">`tbl_regression()`</span> do pacote <span class="in">`gtsummary`</span> @sec-gtsummary.</span>
<span id="cb116-1112"><a href="#cb116-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1115"><a href="#cb116-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1116"><a href="#cb116-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1117"><a href="#cb116-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1118"><a href="#cb116-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-1119"><a href="#cb116-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-finalreg</span></span>
<span id="cb116-1120"><a href="#cb116-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb116-1121"><a href="#cb116-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Resultados da Regressão Logística Binária - modelo com interação"</span></span>
<span id="cb116-1122"><a href="#cb116-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1123"><a href="#cb116-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb116-1124"><a href="#cb116-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)  <span class="co"># para partial, opcional</span></span>
<span id="cb116-1125"><a href="#cb116-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1126"><a href="#cb116-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(</span>
<span id="cb116-1127"><a href="#cb116-1127" aria-hidden="true" tabindex="-1"></a>  mod4,</span>
<span id="cb116-1128"><a href="#cb116-1128" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1129"><a href="#cb116-1129" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb116-1130"><a href="#cb116-1130" aria-hidden="true" tabindex="-1"></a>    classe <span class="sc">~</span> <span class="st">"Classe"</span>,</span>
<span id="cb116-1131"><a href="#cb116-1131" aria-hidden="true" tabindex="-1"></a>    sexo   <span class="sc">~</span> <span class="st">"Sexo"</span>,</span>
<span id="cb116-1132"><a href="#cb116-1132" aria-hidden="true" tabindex="-1"></a>    idade  <span class="sc">~</span> <span class="st">"Idade"</span>,</span>
<span id="cb116-1133"><a href="#cb116-1133" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">classe:sexo</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interação Classe × Sexo"</span>),</span>
<span id="cb116-1134"><a href="#cb116-1134" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate_fun =</span> <span class="fu">partial</span>(style_sigfig, <span class="at">digits =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-1135"><a href="#cb116-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(</span>
<span id="cb116-1136"><a href="#cb116-1136" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"**Variável**"</span>,</span>
<span id="cb116-1137"><a href="#cb116-1137" aria-hidden="true" tabindex="-1"></a>    p.value <span class="sc">~</span> <span class="st">"**Valor p**"</span>) </span>
<span id="cb116-1138"><a href="#cb116-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1139"><a href="#cb116-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1140"><a href="#cb116-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercícios</span></span>
<span id="cb116-1141"><a href="#cb116-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1142"><a href="#cb116-1142" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-1143"><a href="#cb116-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercício 1</span></span>
<span id="cb116-1144"><a href="#cb116-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1145"><a href="#cb116-1145" aria-hidden="true" tabindex="-1"></a>Para fins ilustrativos, suponha-se agora que se deseja prever a probabilidade de um "novo" passageiro sobreviver. Esse passageiro seja uma mulher de 35 anos, que comprou bilhete de viagem na terceira classe e viaja com o marido.</span>
<span id="cb116-1146"><a href="#cb116-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1147"><a href="#cb116-1147" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Solução</span><span class="co">]</span>{.underline}</span>
<span id="cb116-1148"><a href="#cb116-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1151"><a href="#cb116-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1152"><a href="#cb116-1152" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb116-1153"><a href="#cb116-1153" aria-hidden="true" tabindex="-1"></a>novo_passageiro1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-1154"><a href="#cb116-1154" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">35</span>,</span>
<span id="cb116-1155"><a href="#cb116-1155" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"fem"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb116-1156"><a href="#cb116-1156" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">3</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb116-1157"><a href="#cb116-1157" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb116-1158"><a href="#cb116-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1159"><a href="#cb116-1159" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb116-1160"><a href="#cb116-1160" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro1, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1161"><a href="#cb116-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1162"><a href="#cb116-1162" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb116-1163"><a href="#cb116-1163" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1164"><a href="#cb116-1164" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb116-1165"><a href="#cb116-1165" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb116-1166"><a href="#cb116-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1167"><a href="#cb116-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb116-1168"><a href="#cb116-1168" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb116-1169"><a href="#cb116-1169" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb116-1170"><a href="#cb116-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1171"><a href="#cb116-1171" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb116-1172"><a href="#cb116-1172" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro1, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1173"><a href="#cb116-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1174"><a href="#cb116-1174" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1175"><a href="#cb116-1175" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb116-1176"><a href="#cb116-1176" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb116-1177"><a href="#cb116-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1178"><a href="#cb116-1178" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb116-1179"><a href="#cb116-1179" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb116-1180"><a href="#cb116-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1181"><a href="#cb116-1181" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb116-1182"><a href="#cb116-1182" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb116-1183"><a href="#cb116-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1184"><a href="#cb116-1184" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span>
<span id="cb116-1185"><a href="#cb116-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1186"><a href="#cb116-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb116-1187"><a href="#cb116-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1188"><a href="#cb116-1188" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span>
<span id="cb116-1189"><a href="#cb116-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1190"><a href="#cb116-1190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1191"><a href="#cb116-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1192"><a href="#cb116-1192" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-1193"><a href="#cb116-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercício 2</span></span>
<span id="cb116-1194"><a href="#cb116-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1195"><a href="#cb116-1195" aria-hidden="true" tabindex="-1"></a>Calcular a probabilidade de sobreviver do esposo dessa passageira. Ele tem 40 anos.</span>
<span id="cb116-1196"><a href="#cb116-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1197"><a href="#cb116-1197" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Solução</span><span class="co">]</span>{.underline}</span>
<span id="cb116-1198"><a href="#cb116-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1201"><a href="#cb116-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1202"><a href="#cb116-1202" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb116-1203"><a href="#cb116-1203" aria-hidden="true" tabindex="-1"></a>novo_passageiro2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-1204"><a href="#cb116-1204" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">40</span>,</span>
<span id="cb116-1205"><a href="#cb116-1205" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"masc"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb116-1206"><a href="#cb116-1206" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">3</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb116-1207"><a href="#cb116-1207" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb116-1208"><a href="#cb116-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1209"><a href="#cb116-1209" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb116-1210"><a href="#cb116-1210" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro2, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1211"><a href="#cb116-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1212"><a href="#cb116-1212" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb116-1213"><a href="#cb116-1213" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1214"><a href="#cb116-1214" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb116-1215"><a href="#cb116-1215" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb116-1216"><a href="#cb116-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1217"><a href="#cb116-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb116-1218"><a href="#cb116-1218" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb116-1219"><a href="#cb116-1219" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb116-1220"><a href="#cb116-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1221"><a href="#cb116-1221" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb116-1222"><a href="#cb116-1222" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro2, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1223"><a href="#cb116-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1224"><a href="#cb116-1224" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1225"><a href="#cb116-1225" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb116-1226"><a href="#cb116-1226" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb116-1227"><a href="#cb116-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1228"><a href="#cb116-1228" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb116-1229"><a href="#cb116-1229" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb116-1230"><a href="#cb116-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1231"><a href="#cb116-1231" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb116-1232"><a href="#cb116-1232" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb116-1233"><a href="#cb116-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1234"><a href="#cb116-1234" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span>
<span id="cb116-1235"><a href="#cb116-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1236"><a href="#cb116-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb116-1237"><a href="#cb116-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1238"><a href="#cb116-1238" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span>
<span id="cb116-1239"><a href="#cb116-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1240"><a href="#cb116-1240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1241"><a href="#cb116-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1242"><a href="#cb116-1242" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-1243"><a href="#cb116-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercício 3</span></span>
<span id="cb116-1244"><a href="#cb116-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1245"><a href="#cb116-1245" aria-hidden="true" tabindex="-1"></a>Suponha-se que se deseja prever a probabilidade de um "novo" passageiro sobreviver. Esse passageiro é uma mulher de 35 anos, que comprou bilhete de viagem na primeira classe e viaja com o marido</span>
<span id="cb116-1246"><a href="#cb116-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1247"><a href="#cb116-1247" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Solução</span><span class="co">]</span>{.underline}</span>
<span id="cb116-1248"><a href="#cb116-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1251"><a href="#cb116-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1252"><a href="#cb116-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb116-1253"><a href="#cb116-1253" aria-hidden="true" tabindex="-1"></a>novo_passageiro3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-1254"><a href="#cb116-1254" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">35</span>,</span>
<span id="cb116-1255"><a href="#cb116-1255" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"fem"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb116-1256"><a href="#cb116-1256" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">1</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb116-1257"><a href="#cb116-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb116-1258"><a href="#cb116-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1259"><a href="#cb116-1259" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb116-1260"><a href="#cb116-1260" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro3, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1261"><a href="#cb116-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1262"><a href="#cb116-1262" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb116-1263"><a href="#cb116-1263" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1264"><a href="#cb116-1264" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb116-1265"><a href="#cb116-1265" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb116-1266"><a href="#cb116-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1267"><a href="#cb116-1267" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb116-1268"><a href="#cb116-1268" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb116-1269"><a href="#cb116-1269" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb116-1270"><a href="#cb116-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1271"><a href="#cb116-1271" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb116-1272"><a href="#cb116-1272" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro3, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1273"><a href="#cb116-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1274"><a href="#cb116-1274" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1275"><a href="#cb116-1275" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb116-1276"><a href="#cb116-1276" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb116-1277"><a href="#cb116-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1278"><a href="#cb116-1278" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb116-1279"><a href="#cb116-1279" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb116-1280"><a href="#cb116-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1281"><a href="#cb116-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb116-1282"><a href="#cb116-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb116-1283"><a href="#cb116-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1284"><a href="#cb116-1284" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span>
<span id="cb116-1285"><a href="#cb116-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1286"><a href="#cb116-1286" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb116-1287"><a href="#cb116-1287" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1288"><a href="#cb116-1288" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span>
<span id="cb116-1289"><a href="#cb116-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1290"><a href="#cb116-1290" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1291"><a href="#cb116-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1292"><a href="#cb116-1292" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-1293"><a href="#cb116-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercício 4</span></span>
<span id="cb116-1294"><a href="#cb116-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1295"><a href="#cb116-1295" aria-hidden="true" tabindex="-1"></a>Quala a probabilidade de sobreviver do esposo, 40 anos, da mulher do esxercício 3?</span>
<span id="cb116-1296"><a href="#cb116-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1297"><a href="#cb116-1297" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Solução</span><span class="co">]</span>{.underline}</span>
<span id="cb116-1298"><a href="#cb116-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1301"><a href="#cb116-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1302"><a href="#cb116-1302" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um novo dataframe para o novo passageiro</span></span>
<span id="cb116-1303"><a href="#cb116-1303" aria-hidden="true" tabindex="-1"></a>novo_passageiro4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-1304"><a href="#cb116-1304" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="dv">40</span>,</span>
<span id="cb116-1305"><a href="#cb116-1305" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">factor</span>(<span class="st">"masc"</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>sexo)),</span>
<span id="cb116-1306"><a href="#cb116-1306" aria-hidden="true" tabindex="-1"></a>  <span class="at">classe =</span> <span class="fu">factor</span>(<span class="dv">1</span>, <span class="at">levels =</span> <span class="fu">levels</span>(teste<span class="sc">$</span>classe)),</span>
<span id="cb116-1307"><a href="#cb116-1307" aria-hidden="true" tabindex="-1"></a>  <span class="at">irco =</span> <span class="dv">1</span>)</span>
<span id="cb116-1308"><a href="#cb116-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1309"><a href="#cb116-1309" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo simples</span></span>
<span id="cb116-1310"><a href="#cb116-1310" aria-hidden="true" tabindex="-1"></a>pred_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> novo_passageiro4, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1311"><a href="#cb116-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1312"><a href="#cb116-1312" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confiança no espaço do logit</span></span>
<span id="cb116-1313"><a href="#cb116-1313" aria-hidden="true" tabindex="-1"></a>ic_logit_mod2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1314"><a href="#cb116-1314" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit,</span>
<span id="cb116-1315"><a href="#cb116-1315" aria-hidden="true" tabindex="-1"></a>  pred_mod2<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod2<span class="sc">$</span>se.fit)</span>
<span id="cb116-1316"><a href="#cb116-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1317"><a href="#cb116-1317" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar para probabilidade</span></span>
<span id="cb116-1318"><a href="#cb116-1318" aria-hidden="true" tabindex="-1"></a>ic_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod2)</span>
<span id="cb116-1319"><a href="#cb116-1319" aria-hidden="true" tabindex="-1"></a>pred_prob_mod2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod2<span class="sc">$</span>fit)</span>
<span id="cb116-1320"><a href="#cb116-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1321"><a href="#cb116-1321" aria-hidden="true" tabindex="-1"></a><span class="co"># Predição com erro padrão no modelo com interação</span></span>
<span id="cb116-1322"><a href="#cb116-1322" aria-hidden="true" tabindex="-1"></a>pred_mod4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod4, <span class="at">newdata =</span> novo_passageiro4, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1323"><a href="#cb116-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1324"><a href="#cb116-1324" aria-hidden="true" tabindex="-1"></a>ic_logit_mod4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-1325"><a href="#cb116-1325" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit,</span>
<span id="cb116-1326"><a href="#cb116-1326" aria-hidden="true" tabindex="-1"></a>  pred_mod4<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_mod4<span class="sc">$</span>se.fit)</span>
<span id="cb116-1327"><a href="#cb116-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1328"><a href="#cb116-1328" aria-hidden="true" tabindex="-1"></a>ic_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ic_logit_mod4)</span>
<span id="cb116-1329"><a href="#cb116-1329" aria-hidden="true" tabindex="-1"></a>pred_prob_mod4 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(pred_mod4<span class="sc">$</span>fit)</span>
<span id="cb116-1330"><a href="#cb116-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1331"><a href="#cb116-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados, usando a função cat() e sprintf()</span></span>
<span id="cb116-1332"><a href="#cb116-1332" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo simples (mod2)</span></span>
<span id="cb116-1333"><a href="#cb116-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo simples (mod2): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1334"><a href="#cb116-1334" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod2, ic_prob_mod2[<span class="dv">1</span>], ic_prob_mod2[<span class="dv">2</span>]))</span>
<span id="cb116-1335"><a href="#cb116-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1336"><a href="#cb116-1336" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com interação (mod4)</span></span>
<span id="cb116-1337"><a href="#cb116-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Modelo com interação (mod4): %.3f IC95%%: %.3f %.3f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb116-1338"><a href="#cb116-1338" aria-hidden="true" tabindex="-1"></a>            pred_prob_mod4, ic_prob_mod4[<span class="dv">1</span>], ic_prob_mod4[<span class="dv">2</span>]))</span>
<span id="cb116-1339"><a href="#cb116-1339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1340"><a href="#cb116-1340" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1341"><a href="#cb116-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1342"><a href="#cb116-1342" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-1343"><a href="#cb116-1343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comentário sobre os exercícios</span></span>
<span id="cb116-1344"><a href="#cb116-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1345"><a href="#cb116-1345" aria-hidden="true" tabindex="-1"></a>Foi verificado que os modelos são estatisticamente válidos. Isso dá segurança para confiar nas estimativas geradas. Mesmo que os modelos <span class="in">`mod2`</span> (simples) e <span class="in">`mod4`</span> (com interação) tenham dado estimativas diferentes de sobrevivência, isso não quer dizer que essas diferenças sejam realmente significativas. Quando se observa os intervalos de confiança de 95% na @tbl-tabmodelos, ve-se que eles se sobrepõem em todos os casos. Isso quer dizer que, apesar de um modelo prever uma chance um pouco maior ou menor, essa diferença está dentro da margem de erro — ou seja, pode ter acontecido só por variação natural dos dados. O modelo com interação até se saiu melhor no teste geral (aquele que compara o desempenho dos dois), mas quando se olha para cada passageiro individual, não dá pra afirmar com segurança que um modelo está “mais certo” que o outro. Por isso, é importante considerar não só o número da previsão, mas também o intervalo de confiança que vem junto com ela</span>
<span id="cb116-1346"><a href="#cb116-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1349"><a href="#cb116-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1350"><a href="#cb116-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tabmodelos</span></span>
<span id="cb116-1351"><a href="#cb116-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1352"><a href="#cb116-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1353"><a href="#cb116-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1354"><a href="#cb116-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "80%"</span></span>
<span id="cb116-1355"><a href="#cb116-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Previsões com os modelos simples e com interação"</span></span>
<span id="cb116-1356"><a href="#cb116-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1357"><a href="#cb116-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb116-1358"><a href="#cb116-1358" aria-hidden="true" tabindex="-1"></a>Exercicio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">""</span>, <span class="st">"2"</span>, <span class="st">""</span>, <span class="st">"3"</span>, <span class="st">""</span>, <span class="st">"4"</span>, <span class="st">""</span>)</span>
<span id="cb116-1359"><a href="#cb116-1359" aria-hidden="true" tabindex="-1"></a>Idade <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">40</span>)</span>
<span id="cb116-1360"><a href="#cb116-1360" aria-hidden="true" tabindex="-1"></a>Sexo <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"fem"</span>, <span class="st">"masc"</span>, <span class="st">"fem"</span>, <span class="st">"masc"</span>, <span class="st">"fem"</span>, <span class="st">"masc"</span>, <span class="st">"fem"</span>, <span class="st">"masc"</span>)</span>
<span id="cb116-1361"><a href="#cb116-1361" aria-hidden="true" tabindex="-1"></a>Classe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3ª"</span>, <span class="st">"1ª"</span>, <span class="st">"3ª"</span>, <span class="st">"1ª"</span>, <span class="st">"3ª"</span>, <span class="st">"1ª"</span>, <span class="st">"3ª"</span>, <span class="st">"1ª"</span>)</span>
<span id="cb116-1362"><a href="#cb116-1362" aria-hidden="true" tabindex="-1"></a>Nirco <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb116-1363"><a href="#cb116-1363" aria-hidden="true" tabindex="-1"></a>Modelo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mod2"</span>, <span class="st">"mod4"</span>, <span class="st">"mod2"</span>, <span class="st">"mod4"</span>, <span class="st">"mod2"</span>, <span class="st">"mod4"</span>, <span class="st">"mod2"</span>, <span class="st">"mod4"</span>)</span>
<span id="cb116-1364"><a href="#cb116-1364" aria-hidden="true" tabindex="-1"></a>Estimativa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.585</span>, <span class="fl">0.465</span>, <span class="fl">0.037</span>, <span class="fl">0.054</span>, <span class="fl">0.914</span>, <span class="fl">0.980</span>, <span class="fl">0.236</span>, <span class="fl">0.178</span>)</span>
<span id="cb116-1365"><a href="#cb116-1365" aria-hidden="true" tabindex="-1"></a>IC95 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0.494–0.672"</span>, <span class="st">"0.365–0.567"</span>, <span class="st">"0.023–0.059"</span>, <span class="st">"0.034, 0.085"</span>, <span class="st">"0.870–0.944"</span>, <span class="st">"0.924–0.995"</span>, <span class="st">"0.164–0.303"</span>, <span class="st">"0.119–0.217"</span>)</span>
<span id="cb116-1366"><a href="#cb116-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1367"><a href="#cb116-1367" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Exercicio, Idade, Sexo, Classe, Nirco, Modelo, Estimativa, IC95)</span>
<span id="cb116-1368"><a href="#cb116-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1369"><a href="#cb116-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb116-1370"><a href="#cb116-1370" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb116-1371"><a href="#cb116-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb116-1372"><a href="#cb116-1372" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exercicio =</span> <span class="st">"Exercício"</span>,</span>
<span id="cb116-1373"><a href="#cb116-1373" aria-hidden="true" tabindex="-1"></a>    <span class="at">Idade =</span> <span class="st">"Idade"</span>,</span>
<span id="cb116-1374"><a href="#cb116-1374" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sexo =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb116-1375"><a href="#cb116-1375" aria-hidden="true" tabindex="-1"></a>    <span class="at">Classe =</span> <span class="st">"Classe"</span>,</span>
<span id="cb116-1376"><a href="#cb116-1376" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nirco =</span> <span class="st">"Nº irmãos/cônjuges"</span>,</span>
<span id="cb116-1377"><a href="#cb116-1377" aria-hidden="true" tabindex="-1"></a>    <span class="at">Modelo =</span> <span class="st">"Modelo"</span>,</span>
<span id="cb116-1378"><a href="#cb116-1378" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimativa =</span> <span class="st">"Estimativa"</span>,</span>
<span id="cb116-1379"><a href="#cb116-1379" aria-hidden="true" tabindex="-1"></a>    <span class="at">IC95 =</span> <span class="st">"IC95%"</span></span>
<span id="cb116-1380"><a href="#cb116-1380" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1381"><a href="#cb116-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1382"><a href="#cb116-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1383"><a href="#cb116-1383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1384"><a href="#cb116-1384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb116-1385"><a href="#cb116-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1386"><a href="#cb116-1386" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb116-1387"><a href="#cb116-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1388"><a href="#cb116-1388" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1389"><a href="#cb116-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1390"><a href="#cb116-1390" aria-hidden="true" tabindex="-1"></a>*It's frightening, but that's roughly what happened. It's the voice of numbers!*</span>
</code><button title="Copiar para a área de transferência" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>