<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; Análise de Dados Categóricos – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./20-testes-naoParametricos.html" rel="next">
<link href="./18-regressao.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html">Parte VIII - Métodos Não Paramétricos</a></li><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I - Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II - Ambiente Computacional com R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-introducaoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introdução ao uso do R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando dados no R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III - Estatística Descritiva</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-medidasResumidoras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Medidas Resumidoras</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tabelas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tabelas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gráficos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV - Probabilidades e Distribuições</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-assimetria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte V - Inferência Estatística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VI - Testes Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Anova de Medidas Repetidas</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VII - Relações entre Variáveis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-correlacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte VIII - Métodos Não Paramétricos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dadoscategoricos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-testes-naoParametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IX - Bioestatística Aplicada à Epidemiologia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-testesDiag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Determinação da validade e confiabilidade de testes diagnósticos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-medidasOcorrencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Medidas de ocorrência de doença</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sobrevida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Análise de Sobrevida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-reglogbin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Regressão Logística Binária</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossário</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários" id="toc-pacotes-necessários" class="nav-link active" data-scroll-target="#pacotes-necessários"><span class="header-section-number">19.1</span> Pacotes necessários</a></li>
  <li><a href="#sec-qui" id="toc-sec-qui" class="nav-link" data-scroll-target="#sec-qui"><span class="header-section-number">19.2</span> Qui-Quadrado</a>
  <ul class="collapse">
  <li><a href="#distribuição-qui-quadrado" id="toc-distribuição-qui-quadrado" class="nav-link" data-scroll-target="#distribuição-qui-quadrado"><span class="header-section-number">19.2.1</span> Distribuição qui-quadrado</a></li>
  <li><a href="#lógica-da-estatística-do-qui-quadrado" id="toc-lógica-da-estatística-do-qui-quadrado" class="nav-link" data-scroll-target="#lógica-da-estatística-do-qui-quadrado"><span class="header-section-number">19.2.2</span> Lógica da estatística do qui-quadrado</a></li>
  <li><a href="#qui-quadrado-de-independência-ou-associação" id="toc-qui-quadrado-de-independência-ou-associação" class="nav-link" data-scroll-target="#qui-quadrado-de-independência-ou-associação"><span class="header-section-number">19.2.3</span> Qui-quadrado de independência ou associação</a></li>
  <li><a href="#teste-aderência-ou-do-melhor-ajuste" id="toc-teste-aderência-ou-do-melhor-ajuste" class="nav-link" data-scroll-target="#teste-aderência-ou-do-melhor-ajuste"><span class="header-section-number">19.2.4</span> Teste Aderência ou do Melhor Ajuste</a></li>
  <li><a href="#sec-tabextensas" id="toc-sec-tabextensas" class="nav-link" data-scroll-target="#sec-tabextensas"><span class="header-section-number">19.2.5</span> Qui-quadrado de Pearson para tabelas extensas</a></li>
  </ul></li>
  <li><a href="#teste-exato-de-fisher" id="toc-teste-exato-de-fisher" class="nav-link" data-scroll-target="#teste-exato-de-fisher"><span class="header-section-number">19.3</span> Teste exato de Fisher</a>
  <ul class="collapse">
  <li><a href="#dados-usados-como-exemplo" id="toc-dados-usados-como-exemplo" class="nav-link" data-scroll-target="#dados-usados-como-exemplo"><span class="header-section-number">19.3.1</span> Dados usados como exemplo</a></li>
  <li><a href="#hipóteses-estatísticas-3" id="toc-hipóteses-estatísticas-3" class="nav-link" data-scroll-target="#hipóteses-estatísticas-3"><span class="header-section-number">19.3.2</span> Hipóteses estatísticas</a></li>
  <li><a href="#cálculo-da-estatística-do-teste-2" id="toc-cálculo-da-estatística-do-teste-2" class="nav-link" data-scroll-target="#cálculo-da-estatística-do-teste-2"><span class="header-section-number">19.3.3</span> Cálculo da estatística do teste</a></li>
  <li><a href="#conclusão-2" id="toc-conclusão-2" class="nav-link" data-scroll-target="#conclusão-2"><span class="header-section-number">19.3.4</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#teste-de-mcnemar" id="toc-teste-de-mcnemar" class="nav-link" data-scroll-target="#teste-de-mcnemar"><span class="header-section-number">19.4</span> Teste de McNemar</a>
  <ul class="collapse">
  <li><a href="#pressupostos-do-teste-de-mcnemar" id="toc-pressupostos-do-teste-de-mcnemar" class="nav-link" data-scroll-target="#pressupostos-do-teste-de-mcnemar"><span class="header-section-number">19.4.1</span> Pressupostos do teste de McNemar</a></li>
  <li><a href="#dados-usados-como-exemplo-1" id="toc-dados-usados-como-exemplo-1" class="nav-link" data-scroll-target="#dados-usados-como-exemplo-1"><span class="header-section-number">19.4.2</span> Dados usados como exemplo</a></li>
  <li><a href="#hipóteses-estatísticas-4" id="toc-hipóteses-estatísticas-4" class="nav-link" data-scroll-target="#hipóteses-estatísticas-4"><span class="header-section-number">19.4.3</span> Hipóteses estatísticas</a></li>
  <li><a href="#lógica-do-teste" id="toc-lógica-do-teste" class="nav-link" data-scroll-target="#lógica-do-teste"><span class="header-section-number">19.4.4</span> Lógica do teste</a></li>
  <li><a href="#cálculo-do-teste-de-mcnemar" id="toc-cálculo-do-teste-de-mcnemar" class="nav-link" data-scroll-target="#cálculo-do-teste-de-mcnemar"><span class="header-section-number">19.4.5</span> Cálculo do teste de McNemar</a></li>
  <li><a href="#conclusão-3" id="toc-conclusão-3" class="nav-link" data-scroll-target="#conclusão-3"><span class="header-section-number">19.4.6</span> Conclusão</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html">Parte VIII - Métodos Não Paramétricos</a></li><li class="breadcrumb-item"><a href="./19-dadoscategoricos.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="pacotes-necessários"><span class="header-section-number">19.1</span> Pacotes necessários</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(coin,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                DescTools,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                dplyr,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                expss,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                flextable,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                ggplot2, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                gmodels,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                nhstplot,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                readxl,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                rstatix,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                summarytools)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-qui" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sec-qui"><span class="header-section-number">19.2</span> Qui-Quadrado</h2>
<p>Dois testes de hipótese são proeminentes na pesquisa na área da saúde. Um é o teste <em>t</em> de duas amostras, que é usado para testar a igualdade de duas médias populacionais independentes. O segundo é o teste qui-quadrado (denotado por <span class="math inline">\(\chi^{2}\)</span>). O teste é denominado teste qui-quadrado porque usa a distribuição qui-quadrado ou <span class="math inline">\(\chi^{2}\)</span>.</p>
<section id="distribuição-qui-quadrado" class="level3" data-number="19.2.1">
<h3 data-number="19.2.1" class="anchored" data-anchor-id="distribuição-qui-quadrado"><span class="header-section-number">19.2.1</span> Distribuição qui-quadrado</h3>
<p>Se uma variável <em>X</em> é normalmente distribuída, então a variável <span class="math inline">\(X^{2}\)</span> tem uma distribuição qui-quadrado <span class="citation" data-cites="altman1991chisquared">(<a href="referencias.html#ref-altman1991chisquared" role="doc-biblioref">1</a>)</span>. A distribuição qui-quadrado com <em>k</em> categorias é a distribuição de uma soma dos quadrados de <em>k</em> variáveis aleatórias independentes com distribuição normal. O número de categorias determina o número de graus de liberdade. O formato da distribuição qui-quadrado depende desses graus de liberdade. Em geral, ela é assimétrica com apenas valores positivos, iniciando em zero. A assimetria diminui à medida que aumentam os graus de liberdade. Para cada grau de liberdade tem-se curvas de distribuição diferentes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">5</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"royalblue"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">10</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">15</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">20</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"cyan"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">30</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"green3"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(<span class="at">bty =</span> <span class="st">"L"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="at">legend=</span><span class="fu">c</span> (<span class="st">"gl = 05"</span>, <span class="st">"gl = 10"</span>, <span class="st">"gl = 15"</span>, <span class="st">"gl = 20"</span>, <span class="st">"gl = 30"</span>), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">c</span> (<span class="st">"royalblue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"cyan"</span>, <span class="st">"green3"</span>), </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">bty=</span><span class="st">"n"</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span><span class="st">"right"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-chi-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.1: Distribuição do Qui-Quadrado
</figcaption>
</figure>
</div>
</div>
</div>
<p>A distribuição <span class="math inline">\(\chi^{2}\)</span> converge para a distribuição normal à medida que os graus de liberdade aumentam, de acordo com o teorema do limite central, entretanto esta convergência é lenta (<a href="#fig-chi" class="quarto-xref">Figura&nbsp;<span>19.1</span></a>).</p>
<p>A distribuição qui-quadrado tem duas aplicações comuns: primeiro, como um teste para saber se duas variáveis categóricas são independentes ou não (<strong>Teste de independência ou associação</strong>); segundo, o teste de qualidade do ajuste do qui-quadrado (<strong>Teste de aderência ou ajuste</strong>) que é usado para comparar uma determinada distribuição com uma distribuição conhecida.</p>
</section>
<section id="lógica-da-estatística-do-qui-quadrado" class="level3" data-number="19.2.2">
<h3 data-number="19.2.2" class="anchored" data-anchor-id="lógica-da-estatística-do-qui-quadrado"><span class="header-section-number">19.2.2</span> Lógica da estatística do qui-quadrado</h3>
<p>O cálculo da estatística <span class="math inline">\(\chi^{2}\)</span> é baseado nas frequências existentes nas células da tabela de contingência. Em primeiro lugar, calcula-se as frequências que se espera em cada célula caso a hipótese nula seja verdadeira (<strong>frequências esperadas</strong>). Em segundo lugar, usando a equação geral, o teste mede o grau de discrepância entre o conjunto de <strong>frequências observadas</strong> (O) e o conjunto de <strong>frequências esperadas</strong> (E).</p>
<p><span class="math display">\[
\chi^{2}= \sum \left [\frac{\left (O_{i} - E_{i} \right )^2}{E_{i}} \right]
\]</span></p>
<p>Se <span class="math inline">\(O_{i}\)</span> é muito semelhante ao <span class="math inline">\(E_{i}\)</span>, então o <span class="math inline">\(\chi^{2}\)</span> é baixo; se <span class="math inline">\(O_{i}\)</span> é muito diferente em relação ao <span class="math inline">\(E_{i}\)</span>, então o <span class="math inline">\(\chi^{2}\)</span> é alto.</p>
<p>As <em>frequências observadas</em> são o número de sujeitos ou objetos na amostra que se enquadram nas várias categorias da variável de interesse. As <em>frequências esperadas</em> são o número de sujeitos ou objetos na amostra que seria esperado observar se hipótese nula fosse verdadeira.</p>
<p><span class="math display">\[
E = \frac{total\ coluna\ \times total\ linha }{total\ geral}
\]</span></p>
<p>Por exemplo, suponha os dados da <a href="#tbl-tab2x2" class="quarto-xref">Tabela&nbsp;<span>19.1</span></a>,</p>
<div class="cell">
<div id="tbl-tab2x2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tab2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.1: Distribuição de Acidentes Automobilísticos por Gênero
</figcaption>
<div aria-describedby="tbl-tab2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-20576ffa{}.cl-20441676{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-20441680{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-204e0ee2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-204e6090{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60a4{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60a5{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60ae{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60af{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60b8{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60b9{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60c2{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60c3{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60cc{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60cd{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60d6{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60f4{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60f5{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e60fe{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-204e6112{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-20576ffa"><thead><tr style="overflow-wrap:break-word;"><th class="cl-204e6090"><p class="cl-204e0ee2"><span class="cl-20441676">Sexo</span></p></th><th class="cl-204e60a4"><p class="cl-204e0ee2"><span class="cl-20441676">Com Acidentes</span></p></th><th class="cl-204e60a5"><p class="cl-204e0ee2"><span class="cl-20441676">Sem Acidentes</span></p></th><th class="cl-204e60ae"><p class="cl-204e0ee2"><span class="cl-20441676">Total de Pessoas</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-204e60af"><p class="cl-204e0ee2"><span class="cl-20441680">Homens</span></p></td><td class="cl-204e60b8"><p class="cl-204e0ee2"><span class="cl-20441680">16</span></p></td><td class="cl-204e60b9"><p class="cl-204e0ee2"><span class="cl-20441680">44</span></p></td><td class="cl-204e60c2"><p class="cl-204e0ee2"><span class="cl-20441680">60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-204e60c3"><p class="cl-204e0ee2"><span class="cl-20441680">Mulheres</span></p></td><td class="cl-204e60cc"><p class="cl-204e0ee2"><span class="cl-20441680">4</span></p></td><td class="cl-204e60cd"><p class="cl-204e0ee2"><span class="cl-20441680">36</span></p></td><td class="cl-204e60d6"><p class="cl-204e0ee2"><span class="cl-20441680">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-204e60f4"><p class="cl-204e0ee2"><span class="cl-20441676">Total</span></p></td><td class="cl-204e60f5"><p class="cl-204e0ee2"><span class="cl-20441676">20</span></p></td><td class="cl-204e60fe"><p class="cl-204e0ee2"><span class="cl-20441676">80</span></p></td><td class="cl-204e6112"><p class="cl-204e0ee2"><span class="cl-20441676">100</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>o número de acidentes esperados para os homens</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>total_c <span class="ot">&lt;-</span> df<span class="sc">$</span>Acidentes[<span class="dv">3</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>total_l <span class="ot">&lt;-</span> df<span class="sc">$</span>Total[<span class="dv">1</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>total_geral <span class="ot">&lt;-</span> df<span class="sc">$</span>Total[<span class="dv">3</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>esperado <span class="ot">&lt;-</span> (total_c<span class="sc">*</span>total_l)<span class="sc">/</span>total_geral</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>esperado </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
<p>é igual a 12, entretanto ocorreram 16. Houve uma <strong>diferença</strong>. Essa diferença é calculada para todas as células e é o importante no cálculo do qui-quadrado. Após o cálculo, acrescentando os valores esperados à <a href="#tbl-tab2x2" class="quarto-xref">Tabela&nbsp;<span>19.1</span></a>, tem-se a <a href="#tbl-ntab2x2" class="quarto-xref">Tabela&nbsp;<span>19.2</span></a> que é usada no cálculo do qui-quadrado.</p>
<div class="cell">
<div id="tbl-ntab2x2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ntab2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.2: Distribuição de Acidentes Automobilísticos por Gênero
</figcaption>
<div aria-describedby="tbl-ntab2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-208b483e{}.cl-20812070{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2081207a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-20857198{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-20859024{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859038{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859039{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859042{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2085904c{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859056{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859057{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859060{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859061{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859062{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859063{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2085906a{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2085906b{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859074{width:1.321in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-20859075{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2085907e{width:1.466in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-208b483e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-20859024"><p class="cl-20857198"><span class="cl-20812070">Sexo</span></p></th><th class="cl-20859038"><p class="cl-20857198"><span class="cl-20812070">Com Acidentes</span></p></th><th class="cl-20859039"><p class="cl-20857198"><span class="cl-20812070">Sem Acidentes</span></p></th><th class="cl-20859042"><p class="cl-20857198"><span class="cl-20812070">Total de Pessoas</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2085904c"><p class="cl-20857198"><span class="cl-2081207a">Homens</span></p></td><td class="cl-20859056"><p class="cl-20857198"><span class="cl-2081207a">12</span></p></td><td class="cl-20859057"><p class="cl-20857198"><span class="cl-2081207a">48</span></p></td><td class="cl-20859060"><p class="cl-20857198"><span class="cl-2081207a">60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-20859061"><p class="cl-20857198"><span class="cl-2081207a">Mulheres</span></p></td><td class="cl-20859062"><p class="cl-20857198"><span class="cl-2081207a">8</span></p></td><td class="cl-20859063"><p class="cl-20857198"><span class="cl-2081207a">32</span></p></td><td class="cl-2085906a"><p class="cl-20857198"><span class="cl-2081207a">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2085906b"><p class="cl-20857198"><span class="cl-20812070">Total</span></p></td><td class="cl-20859074"><p class="cl-20857198"><span class="cl-20812070">20</span></p></td><td class="cl-20859075"><p class="cl-20857198"><span class="cl-20812070">80</span></p></td><td class="cl-2085907e"><p class="cl-20857198"><span class="cl-20812070">100</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Para o cálculo do <span class="math inline">\(\chi^2\)</span>, como se está comparando proporções em uma tabela contingência <span class="math inline">\(2\times2\)</span> (ou seja, duas linhas e duas colunas), deve-se aplicar uma correção na fórmula, mostrada acima, para ajustar o viés de continuidade. Esta correção, denominada de <em>correção de Yates</em>, consiste em subtrair 0,5 do valor absoluto da diferença entre a frequência observada e a esperada em cada célula da tabela, antes de elevar ao quadrado e dividir pela frequência esperada.</p>
<p><span class="math display">\[
\chi^{2}= \sum \left [\frac{\left |(O_{i} - E_{i}|-0,5 \right )^2}{E_{i}} \right]
\]</span></p>
<p>Substituindo os dados na fórmula do qui-quadrado, tem-se:</p>
<p><span class="math display">\[
\chi^{2}= \left [\frac{\left (|16 - 12 \right |-0.5)^2}{12} \right]+ \left [\frac{\left (|44 - 48 \right |-0.5)^2}{48} \right]+\left [\frac{\left (|4 - 8 \right |-0.5)^2}{8} \right]+\left [\frac{\left (|36 - 32 \right|-0.5)^2}{32} \right]
\]</span></p>
<p><span class="math display">\[
\chi^{2}=1,021 + 0,255 + 1,531  +0,383 = 3,19
\]</span></p>
<p>A correção de Yates reduz o valor do qui-quadrado (sem a correção o valor do qui-quadrado seria 4,17) e torna o teste mais conservador, reduzindo a probabilidade de rejeitar a hipótese nula quando ela é verdadeira.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Indicação da correção de Yates
</div>
</div>
<div class="callout-body-container callout-body">
<p>A correção é recomendada em tabelas de contingência <span class="math inline">\(2\times2\)</span> ou quando o tamanho da amostra é pequeno (menor que 40) ou quando há pelo menos uma célula com frequência esperada menor que 5.</p>
</div>
</div>
<section id="restrições-ao-qui-quadrado" class="level4" data-number="19.2.2.1">
<h4 data-number="19.2.2.1" class="anchored" data-anchor-id="restrições-ao-qui-quadrado"><span class="header-section-number">19.2.2.1</span> Restrições ao qui-quadrado</h4>
<ol type="1">
<li><u>Regra Geral</u></li>
</ol>
<p>O teste pode ser usado, se a frequência observada em cada célula for maior ou igual a 5 e a frequência esperada for maior ou igual a 5.</p>
<ol start="2" type="1">
<li><u>Tabela 2 <span class="math inline">\(\times\)</span> 2 (gl = 1)</u></li>
</ol>
<p>Como mostrado no exemplo acima, neste caso, é recomendada a <em>Correção de Continuidade de Yates</em>, mesmo quando o n for grande.</p>
<ol start="3" type="1">
<li><u>Tabela l <span class="math inline">\(\times\)</span> c</u></li>
</ol>
<p>O teste pode ser usado se o número de células com frequência esperada inferior a 5 for menor do que 20% do total das células e nenhuma frequência esperada é igual a zero.</p>
<ol start="4" type="1">
<li><u>n pequeno</u></li>
</ol>
<p>Neste caso, é preconizado o <em>Teste Exato de Fisher</em>.</p>
</section>
<section id="valor-crítico-do-qui-quadrado" class="level4" data-number="19.2.2.2">
<h4 data-number="19.2.2.2" class="anchored" data-anchor-id="valor-crítico-do-qui-quadrado"><span class="header-section-number">19.2.2.2</span> Valor crítico do qui-quadrado</h4>
<p>A estatística de teste (que em certo sentido é a diferença entre as frequências observadas e esperadas) deve ser comparada a um valor crítico para determinar se a diferença é grande ou pequena. Não se pode dizer se uma estatística de teste é grande ou pequena sem colocá-la em perspectiva com o valor crítico. Se a estatística de teste estiver acima do valor crítico, significa que a probabilidade de observar tal diferença entre as frequências observadas e esperadas é improvável.</p>
<p>O valor crítico pode ser encontrado na tabela estatística da distribuição Qui-quadrado e depende do nível de significância, denotado <span class="math inline">\(\alpha\)</span>, e dos graus de liberdade, denotado <span class="math inline">\(gl\)</span>. O nível de significância geralmente é igual a 5%. Os graus de liberdade para um teste de Qui-quadrado de independência são encontrados da seguinte forma:</p>
<p><span class="math display">\[
gl = (numero \ de \ linhas - 1) \ \times \ (numero \ de \ colunas - 1)
\]</span></p>
<p>Em uma tabela de contingência 2 <span class="math inline">\(\times\)</span> 2, como a <a href="#tbl-tab2x2" class="quarto-xref">Tabela&nbsp;<span>19.1</span></a>, tem <span class="math inline">\(gl = (2 - 1) \times (2 - 1) = 1\)</span>. Basta agora obter o valor crítico com a função <code>qchisq()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span>  <span class="fl">0.05</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span> (<span class="dv">1</span><span class="sc">-</span>alpha, gl)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.841459</code></pre>
</div>
</div>
<p>Esse valor é comparado com o <span class="math inline">\(\chi^{2}_{calculado}\)</span> para um nível de significância de 5%. Se ele é maior, rejeita-se se a <span class="math inline">\(H_{0}\)</span>; caso contrário, não se rejeita. Para obter o valor <em>P</em>, pode-se usar a função <code>pchisq()</code>, onde, como argumento, coloca-se o valor do <span class="math inline">\(\chi^{2}_{calculado}\)</span>, os graus de liberdade e acrescenta-se <code>lower.tail = FALSE</code> para obter a probabilidade da cauda superior, uma vez que a distribuição do qui-quadrado é positiva.</p>
<p>O valor crítico é igual a 3,84 e, no exemplo, o <span class="math inline">\(\chi^{2}_{calculado}\)</span> é igual a 3,19, logo a valor <em>p</em> é igual a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span> (<span class="fl">3.19</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07409001</code></pre>
</div>
</div>
<p>Dessa forma, conclui-se ,com uma confiança de 95%, que não se rejeita <span class="math inline">\(H_{0}\)</span>, ou seja, a proporção acidentes nos homens é igual a proporção de acidentes nas mulheres (<span class="math inline">\(\chi^{2} (1) = 3,19;P=0,074\)</span>). Observe na <a href="#fig-chi384" class="quarto-xref">Figura&nbsp;<span>19.2</span></a> que o <span class="math inline">\(\chi^{2}_{calculado}\)</span> localiza-se a esquerda da linha vertical, da área vermelha de rejeição da <span class="math inline">\(H_{0}\)</span>. Atente, que se não fosse feita a correção de Yates, a conclusão seria diferente, pois o <span class="math inline">\(\chi^{2}_{calculado}\)</span> seria igual a 4,17 e estaria um pouco cima do <span class="math inline">\(\chi^{2}_{crítico}\)</span>, na área de rejeição da <span class="math inline">\(H_{0}\)</span>. Com a correção de Yates o valor <em>P</em> é igual a 0,074, sem a correção de continuidade igual a 0,041, isto configura o que se chama de <em>valor P marginal</em> e, nesses casos, deve-se ter muito cuidado na conclusão, pois existe risco de erro tipo II, não rejeitar uma <span class="math inline">\(H_{0}\)</span> quando ela é falsa.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotchisqtest</span>(<span class="at">chisq =</span> <span class="fl">3.84</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">df =</span> <span class="dv">1</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorleft =</span> <span class="st">"aliceblue"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorright =</span> <span class="st">"red"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylabel =</span> <span class="st">"Densidade de probabilidade"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chi384" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chi384-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-chi384-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chi384-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.2: Distribuição do qui-quadrado, gl = 1, alpha = 0,05
</figcaption>
</figure>
</div>
</div>
</div>
<p>O gráfico foi criado com a função <code>plotchisqteste()</code> do pacote <code>nhstplot</code>, pacote simples e conveniente para representar graficamente os testes de significância de hipótese nula mais comuns, como testes <em>F</em>, testes <em>t</em> e testes <em>z</em> <span class="citation" data-cites="myszkowski2020nhstplot">(<a href="referencias.html#ref-myszkowski2020nhstplot" role="doc-biblioref">2</a>)</span>.</p>
</section>
</section>
<section id="qui-quadrado-de-independência-ou-associação" class="level3" data-number="19.2.3">
<h3 data-number="19.2.3" class="anchored" data-anchor-id="qui-quadrado-de-independência-ou-associação"><span class="header-section-number">19.2.3</span> Qui-quadrado de independência ou associação</h3>
<section id="dados-usados-no-exemplo" class="level4" data-number="19.2.3.1">
<h4 data-number="19.2.3.1" class="anchored" data-anchor-id="dados-usados-no-exemplo"><span class="header-section-number">19.2.3.1</span> Dados usados no exemplo</h4>
<p>O exemplo da <a href="#tbl-tab2x2" class="quarto-xref">Tabela&nbsp;<span>19.1</span></a>, usado para mostrar a lógica do qui-quadrado, é um teste de independência ou associação. Ali, foi mostrado que não existe uma associação estatisticamente significativa (<em>p</em> &gt; 0,05) entre acidentes automobilísticos e o sexo.<br>
Como exercício, serão usados outros dados que necessitam mais manipulação, como treinamento do qui-quadrado de associação e do próprio R. Estes dados servirão para testar a hipótese de associação entre tabagismo e baixo peso ao nascer (&lt; 2500g).</p>
<section id="leitura-e-transformação-dos-dados" class="level5" data-number="19.2.3.1.1">
<h5 data-number="19.2.3.1.1" class="anchored" data-anchor-id="leitura-e-transformação-dos-dados"><span class="header-section-number">19.2.3.1.1</span> Leitura e transformação dos dados</h5>
<p>Os dados serão provenientes do banco de dados <code>dadosMater.xlsx</code>. bastante usado neste livro <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> . A partir do diretório, será feita a leitura da seguinte maneira:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adicione a este arquivo uma variável denominada <code>baixoPeso</code>, usando a função <code>mutate()</code> do pacote <code>dplyr</code> e a função <code>ifelse ()</code>, da base do R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">baixoPeso =</span> <span class="fu">ifelse</span>(pesoRN <span class="sc">&lt;</span> <span class="dv">2500</span>, <span class="st">"1"</span>, <span class="st">"2"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Onde <code>1 = sim</code> e <code>2 = não</code>, ou seja, com peso de nascimento &lt; 2500g e <span class="math inline">\(\ge\)</span> 2500g.</p>
<p>O próximo passo é selecionar, deste arquivo, apenas esta variável criada e a variável <code>fumo</code>, porque o objetivo da análise será verificar se existe associação entre tabagismo na gestação e baixo peso ao nascer (&lt; 2500g). Para isso, usa-se a função <code>select()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">select</span> (fumo, baixoPeso)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A seguir, será extraída uma amostra deste banco de dados com n = 300, usando a função <code>slice_sample()</code> do pacote <code>dplyr</code>. A função <code>set.seed()</code> apenas garante que os dados selecionados aleatoriamente se mantenham os mesmos em outros sorteios (veja <a href="09-probabilidades.html#sec-dnp" class="quarto-xref"><span>Seção 9.7.2</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(dados, <span class="at">n=</span><span class="dv">300</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [300 × 2] (S3: tbl_df/tbl/data.frame)
 $ fumo     : num [1:300] 2 2 1 2 2 2 1 2 2 2 ...
 $ baixoPeso: chr [1:300] "2" "2" "1" "2" ...</code></pre>
</div>
</div>
<p>Todos esses passos poderiam ser feitos em um só comando, precedido pela semente (<code>set.seed(123)</code>), usando o operador pipe %&gt;%:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">baixoPeso =</span> <span class="fu">ifelse</span>(pesoRN <span class="sc">&lt;</span> <span class="dv">2500</span>, <span class="st">"1"</span>, <span class="st">"2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (fumo, baixoPeso) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">300</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tem-se, agora, um conjunto de dados com duas colunas: <code>fumo</code>, como uma variável numérica e <code>baixoPeso</code>, como caractere. Ambas devem ser transformadas em fator e, onde os rótulos são 1 e 2, passam para “sim” e “não” e mantendo a ordem “sim” e “não”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>fumo <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>fumo,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>baixoPeso <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>baixoPeso,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [300 × 2] (S3: tbl_df/tbl/data.frame)
 $ fumo     : Factor w/ 2 levels "sim","não": 2 2 1 2 2 2 1 2 2 2 ...
 $ baixoPeso: Factor w/ 2 levels "sim","não": 2 2 1 2 1 2 2 2 2 2 ...</code></pre>
</div>
</div>
</section>
<section id="construção-da-tabela" class="level5" data-number="19.2.3.1.2">
<h5 data-number="19.2.3.1.2" class="anchored" data-anchor-id="construção-da-tabela"><span class="header-section-number">19.2.3.1.2</span> Construção da Tabela</h5>
<p>Antes de construir a <a href="#tbl-tab2x2fumo" class="quarto-xref">Tabela&nbsp;<span>19.3</span></a>, será verificado a distribuição de baixo peso de acordo com o tabagismo materno, usando a função <code>with()</code> e, dentro dela, a função <code>table()</code>, seguida da função <code>addmargins()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> dados, <span class="fu">table</span>(fumo, baixoPeso))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     baixoPeso
fumo  sim não Sum
  sim  18  51  69
  não  22 209 231
  Sum  40 260 300</code></pre>
</div>
</div>
<p>Assim, tem-se</p>
<div class="cell">
<div id="tbl-tab2x2fumo" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tab2x2fumo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.3: Baixo peso* ao nascer e tabagismo
</figcaption>
<div aria-describedby="tbl-tab2x2fumo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2172b57a{}.cl-2168067a{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2168068e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2168068f{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-216d126e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-216d1282{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-216d128c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-216d3744{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3758{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3759{width:1.415in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3762{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d376c{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d376d{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3776{width:1.415in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3780{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d378a{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3794{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d3795{width:1.415in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d379e{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d379f{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37a8{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37b2{width:1.415in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37bc{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37bd{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37c6{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37c7{width:1.415in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-216d37d0{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2172b57a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-216d3744"><p class="cl-216d126e"><span class="cl-2168067a">Tabagismo</span></p></th><th class="cl-216d3758"><p class="cl-216d126e"><span class="cl-2168067a">Baixo Peso</span></p></th><th class="cl-216d3759"><p class="cl-216d126e"><span class="cl-2168067a">Sem Baixo Peso</span></p></th><th class="cl-216d3762"><p class="cl-216d126e"><span class="cl-2168067a">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-216d376c"><p class="cl-216d126e"><span class="cl-2168068e">Sim</span></p></td><td class="cl-216d376d"><p class="cl-216d126e"><span class="cl-2168068e">18</span></p></td><td class="cl-216d3776"><p class="cl-216d126e"><span class="cl-2168068e">51</span></p></td><td class="cl-216d3780"><p class="cl-216d126e"><span class="cl-2168068e">69</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-216d378a"><p class="cl-216d126e"><span class="cl-2168068e">Não</span></p></td><td class="cl-216d3794"><p class="cl-216d126e"><span class="cl-2168068e">22</span></p></td><td class="cl-216d3795"><p class="cl-216d126e"><span class="cl-2168068e">209</span></p></td><td class="cl-216d379e"><p class="cl-216d126e"><span class="cl-2168068e">260</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-216d379f"><p class="cl-216d126e"><span class="cl-2168067a">Total</span></p></td><td class="cl-216d37a8"><p class="cl-216d126e"><span class="cl-2168067a">40</span></p></td><td class="cl-216d37b2"><p class="cl-216d126e"><span class="cl-2168067a">260</span></p></td><td class="cl-216d37bc"><p class="cl-216d126e"><span class="cl-2168067a">300</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-216d37bd"><p class="cl-216d1282"><span class="cl-2168068f">* Baixo Peso = peso ao nascer &lt; 2500g</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observação
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uma tabela é constituída por linhas e colunas. Para se extrair valores da tabela, usa-se os colchetes, após o nome da tabela. O primeiro valor dentro dos colchetes é referente ao <strong>número da linha</strong>; o segundo, separado pela virgula, é referente ao <strong>número da coluna</strong>. Então, <code>tab[1,1]</code> se refere ao valor que está na primeira linha e primeira coluna:</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>
<p>A proporção de baixo peso por categoria de tabagismo (nº de casos/total da linha):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fumantes <span class="ot">&lt;-</span>  tab[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span>(tab[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> tab[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fumantes</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2608696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>não.fumantes <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span>(tab[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">+</span> tab[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>não.fumantes</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0952381</code></pre>
</div>
</div>
</section>
<section id="visualização-gráfica" class="level5" data-number="19.2.3.1.3">
<h5 data-number="19.2.3.1.3" class="anchored" data-anchor-id="visualização-gráfica"><span class="header-section-number">19.2.3.1.3</span> Visualização gráfica</h5>
<p>Um gráfico de barras empilhadas, construído com o <code>ggplot()</code> do pacote <code>ggplot2</code> (ver <a href="08-graficos.html#sec-ggplot2" class="quarto-xref"><span>Seção 8.3</span></a>), será usado para visualizar os dados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dados) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span> (<span class="at">x =</span> fumo, <span class="at">fill =</span> baixoPeso) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span> (<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"aliceblue"</span>)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="cn">NULL</span>,  </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Tabagismo"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="st">"sim"</span>, <span class="at">y=</span><span class="dv">62</span>, <span class="at">label=</span> <span class="st">"26,1%"</span>) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"não"</span>, <span class="at">y=</span><span class="dv">223</span>, <span class="at">label =</span> <span class="st">"9,5%"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span> () <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Peso ao nascer &lt; 2500g"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fumobp" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fumobp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-fumobp-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fumobp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.3: Gráfico de barras empilhadas: tabagismo vs baixo peso ao nascer
</figcaption>
</figure>
</div>
</div>
</div>
<p>Observa-se, <a href="#fig-fumobp" class="quarto-xref">Figura&nbsp;<span>19.3</span></a>, que 24,6% das gestantes fumantes geram bebês com baixo peso, enquanto que entre as não fumantes este percentual cai três vezes, indo para 9,5%. É uma diferença grande! Aqui, quase se tem certeza que ela é significativa, mesmo sem cálculos!</p>
</section>
</section>
<section id="hipóteses-estatísticas" class="level4" data-number="19.2.3.2">
<h4 data-number="19.2.3.2" class="anchored" data-anchor-id="hipóteses-estatísticas"><span class="header-section-number">19.2.3.2</span> Hipóteses estatísticas</h4>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: a proporção de baixo peso é igual nos dois grupo (fumantes e não fumantes); não há associação entre as variáveis.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: a proporção de baixo peso é diferente nos dois grupo (fumantes e não fumantes); existe associação entre as variáveis.</p>
</blockquote>
</section>
<section id="cálculo-do-qui-quadrado-de-pearson-no-r" class="level4" data-number="19.2.3.3">
<h4 data-number="19.2.3.3" class="anchored" data-anchor-id="cálculo-do-qui-quadrado-de-pearson-no-r"><span class="header-section-number">19.2.3.3</span> Cálculo do Qui-quadrado de Pearson no R</h4>
<p>Para este exemplo, o <span class="math inline">\(\chi^{2}\)</span> irá verificar se existe uma associação entre as variáveis <code>fumo</code> e <code>baixoPeso</code>, assumindo um <span class="math inline">\(\alpha = 0,05\)</span> que equivale a um valor crítico de 3,84 com um grau de liberdade, em uma tabela <span class="math inline">\(2 \times 2\)</span>. A função <code>chisq_test()</code> do pacote <code>rstatix</code> libera o qui-quadrado, usando os seguintes argumentos:</p>
<ul>
<li><strong>x</strong> <span class="math inline">\(\to\)</span> vetor numérico ou matriz. Tanto x como y podem ser fatores;</li>
<li><strong>y</strong> <span class="math inline">\(\to\)</span> vetor numérico. Ignorado quando se x é uma matriz;</li>
<li>correct <span class="math inline">\(\to\)</span> TRUE é o padrão. Indica se deve ser aplicada a correção de continuidade ao calcular a estatística de teste para tabelas 2 por 2 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>;</li>
<li><strong>…</strong> <span class="math inline">\(\to\)</span> para outros argumentos consulte a ajuda do <em>RStudio</em>.</li>
</ul>
<p>Para executar a função <code>chisq_test()</code>, basta colocar como argumento as variáveis <code>fumo</code> e <code>baixoPeso</code> ou construir antes uma tabela de contingência com a função <code>table()</code> e depois colocá-la como argumento. Como tabela <code>tab</code> já existe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">chisq_test</span>(tab)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>teste</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n statistic        p    df method          p.signif
* &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;   
1   300      11.2 0.000809     1 Chi-square test ***     </code></pre>
</div>
</div>
<p>A saída do teste exibe tudo que é necessário. O <span class="math inline">\(\chi^{2}\)</span> = 11.2 com um valor muito maior que o valor crítico de 3,84, mostrando que a diferença é estatisticamente significativa (<em>P</em> = 8.09^{-4}). Essas e outras estatísticas podem ser obtidas, usando o objeto <code>teste</code> seguido do sinal <code>$</code>. Por exemplo, para o valor <em>p</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>teste<span class="sc">$</span>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000809</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Se um aviso como <span style="color:red">Chi-squared approximation may be incorrect</span> (<em>Aproximação qui-quadrado pode estar incorreta</em>) aparecer, significa que as menores frequências esperadas são inferiores a 5. Para evitar esse problema, é possível usar uma das seguintes opções:</p>
<ul>
<li>reunir alguns níveis (especialmente aqueles com um pequeno número de observações) para aumentar o número de observações nos subgrupos, ou</li>
<li>usar o teste exato de Fisher.</li>
</ul>
</div>
</div>
<section id="outras-maneiras-de-calcular-o-qui-quadrado-no-r" class="level5" data-number="19.2.3.3.1">
<h5 data-number="19.2.3.3.1" class="anchored" data-anchor-id="outras-maneiras-de-calcular-o-qui-quadrado-no-r"><span class="header-section-number">19.2.3.3.1</span> Outras maneiras de calcular o qui-quadrado no R</h5>
<p>No pacote <code>gmodels</code> <span class="citation" data-cites="warnes2022gmodels">(<a href="referencias.html#ref-warnes2022gmodels" role="doc-biblioref">3</a>)</span>, existe uma função muito interessante, a função <code>CrossTable()</code> que que imprime, além de uma tabela de frequência com as proporções, exibe vários testes, como o teste <span class="math inline">\(\chi^2\)</span>, o teste exato de Fisher e o teste de McNemar com e sem correção de continuidade. Consulte a ajuda para melhor estudar esta elegante função! Neste momento, será explorado apenas o qui-quadrado e os valores esperados com três dígitos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span> (tab,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop.chisq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop.t =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">chisq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">expected =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
|           N / Row Total |
|           N / Col Total |
|-------------------------|

 
Total Observations in Table:  300 

 
             | baixoPeso 
        fumo |       sim |       não | Row Total | 
-------------|-----------|-----------|-----------|
         sim |        18 |        51 |        69 | 
             |     9.200 |    59.800 |           | 
             |     0.261 |     0.739 |     0.230 | 
             |     0.450 |     0.196 |           | 
-------------|-----------|-----------|-----------|
         não |        22 |       209 |       231 | 
             |    30.800 |   200.200 |           | 
             |     0.095 |     0.905 |     0.770 | 
             |     0.550 |     0.804 |           | 
-------------|-----------|-----------|-----------|
Column Total |        40 |       260 |       300 | 
             |     0.133 |     0.867 |           | 
-------------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  12.61347     d.f. =  1     p =  0.0003829762 

Pearson's Chi-squared test with Yates' continuity correction 
------------------------------------------------------------
Chi^2 =  11.22084     d.f. =  1     p =  0.0008088369 

 </code></pre>
</div>
</div>
<p>Observe que a saída mostra em cada célula da tabela, o número de casos, o número esperado, a percentagem por linha (nº de casos/total da linha) e a percentagem por coluna (nº de casos/total da coluna). Por último, exibe o qui-quadrado de Pearson com e sem coreção de continuidade de Yates.</p>
</section>
</section>
<section id="conclusão-e-relato-dos-resultados" class="level4" data-number="19.2.3.4">
<h4 data-number="19.2.3.4" class="anchored" data-anchor-id="conclusão-e-relato-dos-resultados"><span class="header-section-number">19.2.3.4</span> Conclusão e relato dos resultados</h4>
<p>Usando a correção de continuidade de Yates, pois é uma tabela <span class="math inline">\(2\times2\)</span>, vê-se que o valor <em>p</em> é menor que o nível de significância de 5% e, consequentemente, rejeita-se a hipótese nula e conclui-se que existe uma associação significativa entre tabagismo na gestação e o baixo peso ao nascimento (<span class="math inline">\(\chi^{2}_{com \ correção \ de \ Yates} (1)\)</span> = 11.2; <em>P</em> = 0,00081).</p>
<p>Além disso, no relato dos resultados pode-se apresentar uma tabela ou em um gráfico.</p>
<section id="tabela" class="level5" data-number="19.2.3.4.1">
<h5 data-number="19.2.3.4.1" class="anchored" data-anchor-id="tabela"><span class="header-section-number">19.2.3.4.1</span> Tabela</h5>
<p>Para a construção da tabela, pode-se usar a função <code>ctable()</code> do pacote <code>summarytools</code><span class="citation" data-cites="comtois2022summarytools">(<a href="referencias.html#ref-comtois2022summarytools" role="doc-biblioref">4</a>)</span> para obter uma tabela com todos os dados a serem exibidos. O argumento <code>prop = "r"</code> exibe os percentuais das linhas (“c”, nas colunas). Na realidade, são maneiras diferente de se obter o mesmo resultado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ctable</span>(dados<span class="sc">$</span>fumo, dados<span class="sc">$</span>baixoPeso,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">prop =</span> <span class="st">"r"</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">chisq =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">headings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">OR =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in if (tmp_name %in% colnames(obj)) {: the condition has length &gt; 1</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in if (tmp_name %in% colnames(obj)) {: the condition has length &gt; 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
------------ ----------------- ------------ ------------- --------------
               dados$baixoPeso          sim           não          Total
  dados$fumo                                                            
         sim                     18 (26.1%)    51 (73.9%)    69 (100.0%)
         não                     22 ( 9.5%)   209 (90.5%)   231 (100.0%)
       Total                     40 (13.3%)   260 (86.7%)   300 (100.0%)
------------ ----------------- ------------ ------------- --------------

----------------------------
 Chi.squared   df   p.value 
------------- ---- ---------
   11.2208     1     8e-04  
----------------------------

----------------------------------
 Odds Ratio   Lo - 95%   Hi - 95% 
------------ ---------- ----------
    3.35        1.67       6.71   
----------------------------------</code></pre>
</div>
</div>
<p>Ou seja, os bebês que se expuseram ao fator de risco (fumo) têm uma chance 3,35 (IC95% : 1,67-6,71) vezes maior de apresentar peso &lt; 2500g ao nascer, nessa amostra.</p>
<p>Além desses resultados, a tabela final pode conter (e isto é recomendado!) os intervalos de confiança para cada uma das proporções de fumantes e não fumantes. Para isso a função <code>BinomCI()</code> cumpre um papel suficiente (veja <a href="12-estimacao.html#sec-ICproporcao" class="quarto-xref"><span>Seção 12.7.3</span></a>).</p>
<p>Então, a proporção de baixo peso entre as fumantes é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BinomCI</span>(<span class="dv">18</span>, <span class="dv">69</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"clopper-pearson"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           est    lwr.ci    upr.ci
[1,] 0.2608696 0.1625161 0.3805962</code></pre>
</div>
</div>
<p>E, entre as não fumantes é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BinomCI</span>(<span class="dv">22</span>, <span class="dv">231</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"clopper-pearson"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           est     lwr.ci    upr.ci
[1,] 0.0952381 0.06065157 0.1406387</code></pre>
</div>
</div>
<p>Finalmente, esses dados podem ser colocados em uma tabela, como a <a href="#tbl-tabres" class="quarto-xref">Tabela&nbsp;<span>19.4</span></a>:</p>
<div class="cell">
<div id="tbl-tabres" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.4: Efeito do tabagismo materno no peso ao nascer
</figcaption>
<div aria-describedby="tbl-tabres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-22302ede{}.cl-22225cc8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-22225cdc{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-22225ce6{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-22293674{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-22293688{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-22295906{width:1.347in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295910{width:0.964in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229591a{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295924{width:0.846in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295925{width:1.347in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229592e{width:0.964in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295938{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295939{width:0.846in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229593a{width:1.347in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229594c{width:0.964in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295956{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295957{width:0.846in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295960{width:1.347in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22295961{width:0.964in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229596a{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2229596b{width:0.846in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-22302ede"><thead><tr style="overflow-wrap:break-word;"><th class="cl-22295906"><p class="cl-22293674"><span class="cl-22225cc8">Peso ao nascer</span></p></th><th class="cl-22295910"><p class="cl-22293674"><span class="cl-22225cc8">Fumantes</span></p></th><th class="cl-2229591a"><p class="cl-22293674"><span class="cl-22225cc8">Não fumantes</span></p></th><th class="cl-22295924"><p class="cl-22293674"><span class="cl-22225cc8">Valor P*</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-22295925"><p class="cl-22293674"><span class="cl-22225cdc">Baixo Peso</span></p></td><td class="cl-2229592e"><p class="cl-22293674"><span class="cl-22225cdc">18/69</span></p></td><td class="cl-22295938"><p class="cl-22293674"><span class="cl-22225cdc">22/231</span></p></td><td class="cl-22295939"><p class="cl-22293674"><span class="cl-22225cdc">0.00081</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2229593a"><p class="cl-22293674"><span class="cl-22225cdc">IC95%</span></p></td><td class="cl-2229594c"><p class="cl-22293674"><span class="cl-22225cdc">16,3-38,1</span></p></td><td class="cl-22295956"><p class="cl-22293674"><span class="cl-22225cdc">6,1-14,1</span></p></td><td class="cl-22295957"><p class="cl-22293674"><span class="cl-22225cdc"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-22295960"><p class="cl-22293688"><span class="cl-22225ce6">* Qui-quadrado de Pearson com correção</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="gráfico" class="level5" data-number="19.2.3.4.2">
<h5 data-number="19.2.3.4.2" class="anchored" data-anchor-id="gráfico"><span class="header-section-number">19.2.3.4.2</span> Gráfico</h5>
<p>Uma boa apresentação gráfica complementa o relatório dos resultados. Pode-se fazer isso com gráfico de barras empilhadas (), acompanhado dos percentuais e do tipo de teste realizado, usando a função <code>get_test_label()</code> que necessita do teste calculado com a função <code>chisq_test()</code> do pacote <code>rstatix</code>, apresentado antes. O gráfico assume o aspecto da <a href="#fig-fumobp1" class="quarto-xref">Figura&nbsp;<span>19.4</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span> (<span class="at">x =</span> fumo, <span class="at">fill =</span> baixoPeso) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span> (<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"gray95"</span>)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span> (<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Tabagismo"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="st">"sim"</span>, <span class="at">y=</span><span class="dv">62</span>, <span class="at">label=</span> <span class="st">"24,6% (15,0-36,5)"</span>) <span class="sc">+</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"não"</span>, <span class="at">y=</span><span class="dv">223</span>, <span class="at">label =</span> <span class="st">"8,2% (5,0-12,5)"</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span> () <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Peso ao nascer &lt; 2500g"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fumobp1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fumobp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-fumobp1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fumobp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.4: Gráfico de barras empilhadas: tabagismo vs baixo peso ao nascer
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="teste-aderência-ou-do-melhor-ajuste" class="level3" data-number="19.2.4">
<h3 data-number="19.2.4" class="anchored" data-anchor-id="teste-aderência-ou-do-melhor-ajuste"><span class="header-section-number">19.2.4</span> Teste Aderência ou do Melhor Ajuste</h3>
<p>O teste de qualidade de ajuste do qui-quadrado (<em>chi-square goodness of fit</em>) é usado para comparar a distribuição observada com uma distribuição esperada, em uma situação em que se tem duas ou mais categorias em dados discretos. Em outras palavras, ele compara várias proporções observadas com as probabilidades esperadas <span class="citation" data-cites="daniel2013chisquare">(<a href="referencias.html#ref-daniel2013chisquare" role="doc-biblioref">5</a>)</span>.</p>
<section id="dados-usados-no-exemplo-1" class="level4" data-number="19.2.4.1">
<h4 data-number="19.2.4.1" class="anchored" data-anchor-id="dados-usados-no-exemplo-1"><span class="header-section-number">19.2.4.1</span> Dados usados no exemplo</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Há uma dúvida se o número de pacientes que procura uma determinada Unidade de Pronto Atendimento (UPA) é aproximadamente o mesmo em todos os dias da semana. Esta é uma informação importante sob o ponto de vista administrativo. Para se atingir este objetivo registrou-se o número de pacientes que procurou a UPA por dia da semana.</p>
</div>
</div>
<p>O número de atendimentos nos sete dias (de segunda-feira à domingo) da semana está representada pela <em>frequência observada</em>, <code>freq_obs</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>freq_obs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">33</span>, <span class="dv">36</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>freq_obs</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20 17 22 21 26 33 36</code></pre>
</div>
</div>
<p>O total de atendimentos durante uma semana é igual a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>soma <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_obs)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>soma</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 175</code></pre>
</div>
</div>
<p>Assim, a frequência esperada diária é igual a soma total dos atendimentos dividido pelo número observações (no caso, dias da semana), representada por <code>k</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>freq_esp <span class="ot">&lt;-</span> soma<span class="sc">/</span>k</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>freq_esp</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
</div>
<p>Com esses valores , pode-se criar um vetor, <code>p</code>, com as proporções dos atendimentos diários esperados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rep</span>(freq_esp<span class="sc">/</span>soma, <span class="dv">7</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1428571 0.1428571 0.1428571 0.1428571 0.1428571 0.1428571 0.1428571</code></pre>
</div>
</div>
</section>
<section id="hipóteses-estatísticas-1" class="level4" data-number="19.2.4.2">
<h4 data-number="19.2.4.2" class="anchored" data-anchor-id="hipóteses-estatísticas-1"><span class="header-section-number">19.2.4.2</span> Hipóteses estatísticas</h4>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: a distribuição das frequências observadas (O) é igual a distribuição de frequências esperadas (E).</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: a distribuição das frequências observadas (O) não é igual a distribuição de frequências esperadas (E)</p>
</blockquote>
</section>
<section id="cálculo-da-estatística-do-teste" class="level4" data-number="19.2.4.3">
<h4 data-number="19.2.4.3" class="anchored" data-anchor-id="cálculo-da-estatística-do-teste"><span class="header-section-number">19.2.4.3</span> Cálculo da estatística do teste</h4>
<p>Assumindo um <span class="math inline">\(\alpha = 0,05\)</span>. Os graus de liberdade são calculados como o número de células (<em>k</em>) menos 1: <span class="math inline">\(gl = (k - 1)\)</span>. O <span class="math inline">\(\chi^{2}_{crítico}\)</span> pode ser encontrado usando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span> (<span class="dv">1</span> <span class="sc">-</span> alpha, gl)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.59159</code></pre>
</div>
</div>
<p>Em outras palavras, se o <span class="math inline">\(\chi^{2}_{calculado}\)</span> &gt; <span class="math inline">\(\chi^{2}_{crítico}\)</span>, rejeita-se a <span class="math inline">\(H_{0}\)</span>. Na <a href="#fig-chi126" class="quarto-xref">Figura&nbsp;<span>19.5</span></a>), o resultado tem que ficar à direita da linha vertical vermelha para que a hipótese nula seja rejeitada. Se cair fora da área de rejeição, à esquerda da linha vertical vermelha, aceita-se a hipóteses nula.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotchisqtest</span>(<span class="at">chisq =</span> <span class="fl">12.6</span>, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">df =</span> <span class="dv">6</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorleft =</span> <span class="st">"aliceblue"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorright =</span> <span class="st">"red"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylabel =</span> <span class="st">"Densidade de probabilidade"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorcut =</span> <span class="st">"red"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chi126" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chi126-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-chi126-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chi126-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.5: Distribuição do qui-quadrado, gl = 6, alpha = 0,05
</figcaption>
</figure>
</div>
</div>
</div>
<p>A estatística do teste pode ser encontrada, usando a função <code>chisq.test()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>teste1 <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">chisq_test</span> (<span class="at">x =</span> freq_obs, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">p =</span> p)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>teste1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n statistic     p    df method          p.signif
* &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;   
1     7        12 0.062     6 Chi-square test ns      </code></pre>
</div>
</div>
</section>
<section id="conclusão" class="level4" data-number="19.2.4.4">
<h4 data-number="19.2.4.4" class="anchored" data-anchor-id="conclusão"><span class="header-section-number">19.2.4.4</span> Conclusão</h4>
<p>Observando-se a saída do teste do qui-quadrado, verifica-se que o <span class="math inline">\(\chi^{2}_{calculado}\)</span> &lt; <span class="math inline">\(\chi^{2}_{crítico}\)</span>, portanto, não se rejeita a <span class="math inline">\(H_{0}\)</span> e conclui-se que, nesta amostra, com uma confiança de 95%, que a frequência observada de pacientes à UPA é igual a esperada (<em>P</em> = 0.062). Lembrando que, neste caso, como se tem um valor <em>P</em> limitrofe, marginal, existe a possibilidade de se estar aceitando uma <span class="math inline">\(H_{0}\)</span> falsa e cometendo um erro tipo II. Seria recomendado, aumentar o tamanho amostral em uma nova coleta, usando estes dados como um piloto para o cálculo amostral.</p>
</section>
</section>
<section id="sec-tabextensas" class="level3" data-number="19.2.5">
<h3 data-number="19.2.5" class="anchored" data-anchor-id="sec-tabextensas"><span class="header-section-number">19.2.5</span> Qui-quadrado de Pearson para tabelas extensas</h3>
<p>Este teste é utilizado quando o número de grupos, k, é superior a 2.</p>
<section id="sec-dadosCirurgia" class="level4" data-number="19.2.5.1">
<h4 data-number="19.2.5.1" class="anchored" data-anchor-id="sec-dadosCirurgia"><span class="header-section-number">19.2.5.1</span> Dados usados como exemplo</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Em um hospital pediátrico, 144 recém-nascidos foram submetidos a diferentes procedimentos cirúrgicos (abdominal, cardíaco ou outro). Os cirurgiões estavam preocupados em saber se há uma tendência de maior taxa de indecção entreos neonatos que permanecem mais tempo hospitalizados.</p>
</div>
</div>
<p>O banco de dados <code>dadosCirurgia.xlsx</code> que pode ser encontrado <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosCirurgia.xlsx"><strong>aqui</strong></a>. Salve o mesmo no seu diretório de trabalho. As variáveis disponíveis no banco de dados são:</p>
<ul>
<li><strong>id</strong> <span class="math inline">\(\to\)</span> identificação do neonato;</li>
<li><strong>sexo</strong> <span class="math inline">\(\to\)</span> sexo do recém-nascido, <code>fem</code> e <code>masc</code>;</li>
<li><strong>peso</strong> <span class="math inline">\(\to\)</span> peso do neonato em gramas;</li>
<li><strong>tempohosp</strong> <span class="math inline">\(\to\)</span> tempo de hospitalização em dias;</li>
<li><strong>infec</strong> <span class="math inline">\(\to\)</span> presença de infecção secundária: sim e não;</li>
<li><strong>cirurgia</strong> <span class="math inline">\(\to\)</span> tipo de cirurgia: abdominal, cardíaca, outra.</li>
</ul>
<p>A variável tempo de hospitalização (<code>tempohosp</code>) é contínua e assimétrica. Para ser usada aqui, será categorizada por quartis. A variável <code>infec</code> (presença de infecção) é uma variável dicotômica (<code>sim</code>, <code>não</code>).</p>
<section id="leitura-e-transformação-dos-dados-1" class="level5" data-number="19.2.5.1.1">
<h5 data-number="19.2.5.1.1" class="anchored" data-anchor-id="leitura-e-transformação-dos-dados-1"><span class="header-section-number">19.2.5.1.1</span> Leitura e transformação dos dados</h5>
<p>A leitura dos dados pode ser feita com:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosCirurgia.xlsx"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cirurgia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [144 × 7] (S3: tbl_df/tbl/data.frame)
 $ id       : num [1:144] 1 2 3 4 5 6 7 8 9 10 ...
 $ sexo     : chr [1:144] "masc" "masc" "masc" "masc" ...
 $ peso     : num [1:144] 2020 1850 2540 1150 2900 ...
 $ ig       : num [1:144] 36 30 38 31 36 37 38 39 38 39 ...
 $ tempohosp: num [1:144] 37 37 37 46 37 36 30 18 25 14 ...
 $ infec    : chr [1:144] "não" "não" "sim" "sim" ...
 $ cirurgia : chr [1:144] "abdominal" "abdominal" "abdominal" "outra" ...</code></pre>
</div>
</div>
<p>Os dados foram atribuídos a um objeto denominado de <code>cirurgia</code>. Característicamente, a variável <code>tempohosp</code> (tempo de hospitalização) é assimétrica (<a href="#fig-tempohosp" class="quarto-xref">Figura&nbsp;<span>19.6</span></a>):</p>
<div class="cell" data-layout-align="center" data-tbl-cap="Distribuição da variável tempo de hospitalização">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> tempohosp,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"tomato"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"gray40"</span>,<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun=</span>dnorm,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">na.rm =</span> T),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd=</span> <span class="fu">sd</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">na.rm =</span> T)), </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">col=</span><span class="st">'dodgerblue4'</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd=</span><span class="dv">1</span>,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Tempo de hospitalização (dias)'</span>,    </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">'Densidade de probabilidade'</span>) <span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-tempohosp" class="quarto-float quarto-figure quarto-figure-center anchored" width="70%" data-fig-align="center" height="70%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tempohosp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="19-dadoscategoricos_files/figure-html/fig-tempohosp-1.png" id="fig-tempohosp" class="quarto-figure quarto-figure-center anchored figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-tempohosp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19.6
</figcaption>
</figure>
</div>
</div>
</div>
<p>A variável <code>tempohosp</code> será categorizada em quartis. O resumo da mesma, usando a função <code>summary()</code>, fornece orientação para esse procedimento com o retorno do 1º quartil, mediana e 3º quartil:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (cirurgia<span class="sc">$</span>tempohosp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00   20.75   27.50   37.42   42.00  245.00 </code></pre>
</div>
</div>
<p>A categorização da variável <code>tempohosp</code>, que será realizada, usando a função <code>cut()</code>, consulte a <a href="07-tabelas.html#sec-freq" class="quarto-xref"><span>Seção 7.2.3.3</span></a> para detalhes de construção de uma tabela de frequência:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>tempo <span class="ot">&lt;-</span> <span class="fu">cut</span>(cirurgia<span class="sc">$</span>tempohosp, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">20.75</span>, <span class="fl">27.50</span>, <span class="fl">42.00</span>, <span class="dv">245</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;= 21"</span>,<span class="st">"22-28"</span>, <span class="st">"29-42"</span>,<span class="st">"&gt;42"</span>),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">right =</span> <span class="cn">FALSE</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span> (cirurgia<span class="sc">$</span>tempo)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&lt;= 21 22-28 29-42   &gt;42 
   36    36    35    37 </code></pre>
</div>
</div>
<p>Por exemplo, 36 recém-nascidos premaneceram 21 dias ou menos no pós-operatório e 37 recém-nascidos ficarm internados mais do que 42 dias.</p>
<p>Agora, a variável <code>cirurgia$infec</code> será colocada como um fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>infec <span class="ot">&lt;-</span> <span class="fu">factor</span>(cirurgia<span class="sc">$</span>infec, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cirurgia<span class="sc">$</span>infec)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
sim não 
 56  88 </code></pre>
</div>
</div>
<p>A nova variável <code>tempo</code> será cruzada com a variável <code>infec</code> em uma tabela:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> cirurgia, <span class="fu">table</span>(tempo, infec))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       infec
tempo   sim não Sum
  &lt;= 21   9  27  36
  22-28  11  25  36
  29-42  14  21  35
  &gt;42    22  15  37
  Sum    56  88 144</code></pre>
</div>
</div>
<p>Ou seja, a proporção de recém-nascidos que se infectaram no pós-operatório foi 56/144 = 0,39 ou 39%. Se for calculada a proporção para cada um dos quartis do tempo de hospitalização, através da função <code>ctable()</code> do pacote <code>summarytools</code>, observa-se que a proporção de neonatos infectados no pós-operatório aumenta com o tempo de hospitalização:</p>
</section>
</section>
<section id="hipóteses-estatísticas-2" class="level4" data-number="19.2.5.2">
<h4 data-number="19.2.5.2" class="anchored" data-anchor-id="hipóteses-estatísticas-2"><span class="header-section-number">19.2.5.2</span> Hipóteses estatísticas</h4>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: A presença de infecção não altera o tempo de hospitalização.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: A presença de infecção altera o tempo de hospitalização.</p>
</blockquote>
</section>
<section id="cálculo-da-estatística-do-teste-1" class="level4" data-number="19.2.5.3">
<h4 data-number="19.2.5.3" class="anchored" data-anchor-id="cálculo-da-estatística-do-teste-1"><span class="header-section-number">19.2.5.3</span> Cálculo da estatística do teste</h4>
<p>O teste estatístico pode ser calculado, usando o argumento <code>chisq = TRUE</code> na função <code>ctable()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">ctable</span>(cirurgia<span class="sc">$</span>tempo, cirurgia<span class="sc">$</span>infec,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prop =</span> <span class="st">"r"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chisq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">headings =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
------- ------- ------------ ------------ --------------
          infec          sim          não          Total
  tempo                                                 
  &lt;= 21            9 (25.0%)   27 (75.0%)    36 (100.0%)
  22-28           11 (30.6%)   25 (69.4%)    36 (100.0%)
  29-42           14 (40.0%)   21 (60.0%)    35 (100.0%)
    &gt;42           22 (59.5%)   15 (40.5%)    37 (100.0%)
  Total           56 (38.9%)   88 (61.1%)   144 (100.0%)
------- ------- ------------ ------------ --------------

----------------------------
 Chi.squared   df   p.value 
------------- ---- ---------
   10.5801     3    0.0142  
----------------------------</code></pre>
</div>
</div>
</section>
<section id="conclusão-1" class="level4" data-number="19.2.5.4">
<h4 data-number="19.2.5.4" class="anchored" data-anchor-id="conclusão-1"><span class="header-section-number">19.2.5.4</span> Conclusão</h4>
<p>A partir desses resultados, pode-se inferir que a menor taxa de infecção ocorre no grupo do primeiro quartil e é significativamente diferente em relação a taxa de infecção do maior quartil, mas sem indicação para os grupos intermediários. É útil fazer o teste de tendência linear (<em>Linear-by-linear Association</em>). Para isso, pode-se usar a função <code>lbl_test ()</code> do pacote <code>coin</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">lbl_test</span> (cirurgia<span class="sc">$</span>tempo <span class="sc">~</span> cirurgia<span class="sc">$</span>infec)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Linear-by-Linear Association Test

data:  cirurgia$tempo (ordered) by cirurgia$infec (sim, não)
Z = 3.1231, p-value = 0.001789
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Este teste indica uma tendência significativa para a presença de infecção à medida que aumenta o tempo de hospitalização (<em>P</em> = 0,0018).</p>
</section>
</section>
</section>
<section id="teste-exato-de-fisher" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="teste-exato-de-fisher"><span class="header-section-number">19.3</span> Teste exato de Fisher</h2>
<p>O teste do qui-quadrado não é um método apropriado de análise se a amostra é pequena. Por exemplo, se <em>n</em> for menor que 20 ou se <em>n</em> estiver entre 20 e 40 e uma das frequências esperadas for menor que 5, o teste do qui-quadrado deve ser evitado. Nesta situação, é recomendado o <strong>teste exato de Fisher</strong>.</p>
<section id="dados-usados-como-exemplo" class="level3" data-number="19.3.1">
<h3 data-number="19.3.1" class="anchored" data-anchor-id="dados-usados-como-exemplo"><span class="header-section-number">19.3.1</span> Dados usados como exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um estudo estabeleceu como objetivo verificar se a asma não controlada é um fator de risco para a procura da emergência. Foram acompanhados 16 escolares asmáticos durante um ano com relação ao número de visitas à emergência de acordo com o controle da sua asma.</p>
</div>
</div>
<section id="entrando-com-os-dados" class="level4" data-number="19.3.1.1">
<h4 data-number="19.3.1.1" class="anchored" data-anchor-id="entrando-com-os-dados"><span class="header-section-number">19.3.1.1</span> Entrando com os dados</h4>
<p>Em primeiro lugar, serão criadas duas variáveis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>emerg <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>controle <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A seguir, usando essas variáveis, será construído um dataframe que será atribuído ao objeto <code>dadosAsma</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>dadosAsma <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(emerg, controle)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transformação-dos-dados" class="level4" data-number="19.3.1.2">
<h4 data-number="19.3.1.2" class="anchored" data-anchor-id="transformação-dos-dados"><span class="header-section-number">19.3.1.2</span> Transformação dos dados</h4>
<p>Ambas as variáveis são numéricas e serão transformadas em fatores, considerando para a variável <code>emerg</code>, 1 = “consultou” e 2 = “não consultou”, e, para a variável controle, 1 = “asma controlada” e 2 = “asma não controlada”. É importante mater a ordem:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dadosAsma<span class="sc">$</span>emerg <span class="ot">&lt;-</span> <span class="fu">factor</span> (dadosAsma<span class="sc">$</span>emerg,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span> (<span class="st">'consultou'</span>, <span class="st">'não consultou'</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>dadosAsma<span class="sc">$</span>controle <span class="ot">&lt;-</span> <span class="fu">factor</span> (dadosAsma<span class="sc">$</span>controle, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span> (<span class="st">'asma controlada'</span>, <span class="st">'não controlada'</span>))</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosAsma)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   16 obs. of  2 variables:
 $ emerg   : Factor w/ 2 levels "consultou","não consultou": 1 1 2 2 2 2 2 1 1 1 ...
 $ controle: Factor w/ 2 levels "asma controlada",..: 1 1 1 1 1 1 1 2 2 2 ...</code></pre>
</div>
</div>
</section>
<section id="construção-da-tabela-1" class="level4" data-number="19.3.1.3">
<h4 data-number="19.3.1.3" class="anchored" data-anchor-id="construção-da-tabela-1"><span class="header-section-number">19.3.1.3</span> Construção da tabela</h4>
<p>Para o cálculo da estatística do teste, é necessário uma tabela <span class="math inline">\(2\times2\)</span> (<a href="#tbl-rafisher" class="quarto-xref">Tabela&nbsp;<span>19.5</span></a>), obtida com os dados acima:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>tab3 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> dadosAsma, <span class="fu">table</span>(controle, emerg))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-rafisher" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rafisher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.5: Consulta à emergência e controle da asma (tab3)
</figcaption>
<div aria-describedby="tbl-rafisher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-23c50ab2{}.cl-23bc0f34{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-23bc0f48{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-23bfeb36{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-23bfeb4a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-23c00c60{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c6a{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c74{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c75{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c7e{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c7f{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c88{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c89{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.3pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c8a{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23c00c92{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.3pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-23c50ab2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-23c00c60"><p class="cl-23bfeb36"><span class="cl-23bc0f34"></span></p></th><th colspan="2" class="cl-23c00c6a"><p class="cl-23bfeb36"><span class="cl-23bc0f34">Visita à Emergência</span></p></th><th class="cl-23c00c6a"><p class="cl-23bfeb36"><span class="cl-23bc0f34"></span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-23c00c74"><p class="cl-23bfeb36"><span class="cl-23bc0f34">Controle</span></p></th><th class="cl-23c00c75"><p class="cl-23bfeb36"><span class="cl-23bc0f34">Sim</span></p></th><th class="cl-23c00c75"><p class="cl-23bfeb36"><span class="cl-23bc0f34">Não</span></p></th><th class="cl-23c00c75"><p class="cl-23bfeb36"><span class="cl-23bc0f34">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-23c00c7e"><p class="cl-23bfeb4a"><span class="cl-23bc0f34">Asma controlada</span></p></td><td class="cl-23c00c7f"><p class="cl-23bfeb36"><span class="cl-23bc0f48">2</span></p></td><td class="cl-23c00c7f"><p class="cl-23bfeb36"><span class="cl-23bc0f48">5</span></p></td><td class="cl-23c00c7f"><p class="cl-23bfeb36"><span class="cl-23bc0f48">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23c00c88"><p class="cl-23bfeb4a"><span class="cl-23bc0f34">Não controlada</span></p></td><td class="cl-23c00c89"><p class="cl-23bfeb36"><span class="cl-23bc0f48">8</span></p></td><td class="cl-23c00c89"><p class="cl-23bfeb36"><span class="cl-23bc0f48">1</span></p></td><td class="cl-23c00c89"><p class="cl-23bfeb36"><span class="cl-23bc0f48">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23c00c8a"><p class="cl-23bfeb4a"><span class="cl-23bc0f34">Total</span></p></td><td class="cl-23c00c92"><p class="cl-23bfeb36"><span class="cl-23bc0f48">10</span></p></td><td class="cl-23c00c92"><p class="cl-23bfeb36"><span class="cl-23bc0f48">6</span></p></td><td class="cl-23c00c92"><p class="cl-23bfeb36"><span class="cl-23bc0f48">16</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="hipóteses-estatísticas-3" class="level3" data-number="19.3.2">
<h3 data-number="19.3.2" class="anchored" data-anchor-id="hipóteses-estatísticas-3"><span class="header-section-number">19.3.2</span> Hipóteses estatísticas</h3>
<blockquote class="blockquote">
<p><span class="math inline">\(H_0\)</span>: as variáveis são independentes, não há relação entre as duas variáveis categóricas.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_1\)</span>: as variáveis são dependentes, existe uma relação entre as duas variáveis categóricas. </p>
</blockquote>
</section>
<section id="cálculo-da-estatística-do-teste-2" class="level3" data-number="19.3.3">
<h3 data-number="19.3.3" class="anchored" data-anchor-id="cálculo-da-estatística-do-teste-2"><span class="header-section-number">19.3.3</span> Cálculo da estatística do teste</h3>
<p>O teste exato de Fisher é usado quando há pelo menos uma célula na tabela de contingência das frequências esperadas abaixo de 5. Para recuperar as frequências esperadas, use a função <code>chisq.test()</code>, do <em>R</em> base, junto com <code>$expected</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>teste2 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tab3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(tab3): Aproximação do qui-quadrado pode estar incorreta</code></pre>
</div>
</div>
<p>A saída do teste imprime um aviso de que o qui-quadrado pode estar incorreto. Há necessidade, devido a presença de três células com valores abaixo de 5, de se usar o teste de Fisher. este pode ser obtido através da função <code>fisher_test()</code>, do pacote <code>rstatix</code>, colocando uma tabela <span class="math inline">\(2\times2\)</span> como argumento, <code>tab3</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">fisher_test</span> (tab3, <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
      n estimate     p conf.low conf.high method            alternative p.signif
* &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;       &lt;chr&gt;   
1    16   0.0646 0.035 0.000953     0.991 Fisher's Exact t… two.sided   *       </code></pre>
</div>
</div>
</section>
<section id="conclusão-2" class="level3" data-number="19.3.4">
<h3 data-number="19.3.4" class="anchored" data-anchor-id="conclusão-2"><span class="header-section-number">19.3.4</span> Conclusão</h3>
<p>O valor <span class="math inline">\(P=0,035\)</span> é menor que o nível de significância de 5%, previamente estabelecido, e, portanto, deve-se rejeitar a hipótese nula. No contexto, rejeitar a hipótese nula para o teste exato de independência de Fisher significa que há uma associação significativa entre as duas variáveis categóricas (controle da asma e visitas à emergência).</p>
</section>
</section>
<section id="teste-de-mcnemar" class="level2" data-number="19.4">
<h2 data-number="19.4" class="anchored" data-anchor-id="teste-de-mcnemar"><span class="header-section-number">19.4</span> Teste de McNemar</h2>
<p>É um teste estatístico não paramétrico aplicável nos estudos tipo “antes-e-depois” em que cada indivíduo é utilizado como seu próprio controle e a medida é efetuada em escala nominal. O <em>teste de McNemar</em> é usado para determinar se há uma diferença estatisticamente significativa nas proporções entre os dados emparelhados.</p>
<p>As medidas coletadas nesses tipos de projetos de estudo não são independentes e, portanto, os testes do Qui-quadrado não podem ser usados porque os pressupostos serão violados.</p>
<p>O teste de McNemar é usado para avaliar se há uma mudança significativa nas proporções ao longo do tempo para dados emparelhados ou se há uma diferença significativa nas proporções entre casos e controles. O resultado de interesse é a mudança dentro da pessoa (ou diferenças dentro do par) e não há variáveis explicativas.</p>
<p>O teste é calculado examinando o número de respostas que são <em>concordantes</em> para positivo (sim em ambas as ocasiões) e negativo (não em ambas as ocasiões) e o número de pares <em>disconcordantes</em> (sim e não, ou não e sim). Os pares concordantes não fornecem informações sobre as diferenças e não são usados na avaliação. Em vez disso, deve-se concentrar nos pares discordantes, que podem ser divididos em dois tipos: um par discordante do tipo <em>sim – não</em> e um par discordante tipo <em>não – sim</em> <span class="citation" data-cites="eliasziw1991application">(<a href="referencias.html#ref-eliasziw1991application" role="doc-biblioref">6</a>)</span>.</p>
<section id="pressupostos-do-teste-de-mcnemar" class="level3" data-number="19.4.1">
<h3 data-number="19.4.1" class="anchored" data-anchor-id="pressupostos-do-teste-de-mcnemar"><span class="header-section-number">19.4.1</span> Pressupostos do teste de McNemar</h3>
<p>Os pressupostos para o teste de McNemar são:</p>
<ol type="1">
<li>A variável desfecho é binária, dicotômica;</li>
<li>Cada participante é representado na tabela apenas uma vez;</li>
<li>A diferença entre as proporções emparelhadas é o resultado de interesse;</li>
<li>O teste de McNemar pode não ser confiável se houver contagens baixas nas células “discordantes”. Existe recomendação de que a soma dessas células seja <span class="math inline">\(\ge 20\)</span> <span class="citation" data-cites="rosner2011mcnemar">(<a href="referencias.html#ref-rosner2011mcnemar" role="doc-biblioref">7</a>)</span>.</li>
</ol>
</section>
<section id="dados-usados-como-exemplo-1" class="level3" data-number="19.4.2">
<h3 data-number="19.4.2" class="anchored" data-anchor-id="dados-usados-como-exemplo-1"><span class="header-section-number">19.4.2</span> Dados usados como exemplo</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cenário
</div>
</div>
<div class="callout-body-container callout-body">
<p>Em uma universidade, um professor de bioestatística comparou as atitudes de 200 estudantes de Medicina em relação à confiança que eles depositam na análise estatística antes e depois da conclusão da disciplina. A pergunta feita foi: Confiam na análise estatística utilizada nos periódicos médicos?</p>
</div>
</div>
<p>As respostas obtidas estão na <a href="#tbl-tabmcnemar" class="quarto-xref">Tabela&nbsp;<span>19.6</span></a>:</p>
<div class="cell">
<div id="tbl-tabmcnemar" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabmcnemar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;19.6: Confiança na análise estatística após término da disciplina
</figcaption>
<div aria-describedby="tbl-tabmcnemar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-240e58a2{}.cl-240552f2{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24055306{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2408be56{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2408db34{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2408db48{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2408db49{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2408db52{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2408db5c{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-240e58a2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-2408db34"><p class="cl-2408be56"><span class="cl-240552f2"></span></p></th><th colspan="2" class="cl-2408db34"><p class="cl-2408be56"><span class="cl-240552f2">Pós-teste</span></p></th><th class="cl-2408db34"><p class="cl-2408be56"><span class="cl-240552f2"></span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-2408db48"><p class="cl-2408be56"><span class="cl-240552f2">Pré-Teste</span></p></th><th class="cl-2408db48"><p class="cl-2408be56"><span class="cl-240552f2">Sim</span></p></th><th class="cl-2408db48"><p class="cl-2408be56"><span class="cl-240552f2">Não</span></p></th><th class="cl-2408db48"><p class="cl-2408be56"><span class="cl-240552f2">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2408db49"><p class="cl-2408be56"><span class="cl-240552f2">Sim</span></p></td><td class="cl-2408db49"><p class="cl-2408be56"><span class="cl-24055306">20 (a)</span></p></td><td class="cl-2408db49"><p class="cl-2408be56"><span class="cl-24055306">8 (b)</span></p></td><td class="cl-2408db49"><p class="cl-2408be56"><span class="cl-24055306">28</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2408db52"><p class="cl-2408be56"><span class="cl-240552f2">Não</span></p></td><td class="cl-2408db52"><p class="cl-2408be56"><span class="cl-24055306">22 (c)</span></p></td><td class="cl-2408db52"><p class="cl-2408be56"><span class="cl-24055306">150 (d)</span></p></td><td class="cl-2408db52"><p class="cl-2408be56"><span class="cl-24055306">172</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2408db5c"><p class="cl-2408be56"><span class="cl-240552f2">Total</span></p></td><td class="cl-2408db5c"><p class="cl-2408be56"><span class="cl-24055306">42</span></p></td><td class="cl-2408db5c"><p class="cl-2408be56"><span class="cl-24055306">158</span></p></td><td class="cl-2408db5c"><p class="cl-2408be56"><span class="cl-24055306">200</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="hipóteses-estatísticas-4" class="level3" data-number="19.4.3">
<h3 data-number="19.4.3" class="anchored" data-anchor-id="hipóteses-estatísticas-4"><span class="header-section-number">19.4.3</span> Hipóteses estatísticas</h3>
<p>Considerando as caselas <em>a</em>, <em>b</em>, <em>c</em> e <em>d</em> da <a href="#tbl-tabmcnemar" class="quarto-xref">Tabela&nbsp;<span>19.6</span></a>, a hipótese nula de homogeneidade marginal indica que as duas probabilidades marginais para cada resultado são as mesmas, isto é,</p>
<p><span class="math display">\[
p_{a} + p_{b} = p_{a} + p_{c}
\]</span> e</p>
<p><span class="math display">\[
p_{c} + p_{d} = p_{b} + p_{d}
\]</span></p>
<p>Assim, a hipótese nula e a hipótese alternativa são:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: a proporção de alunos que respondem <code>sim</code> no pré-teste e no pós-teste é a mesma.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: a proporção de alunos que respondem <code>sim</code> no pré-teste e no pós-teste não é a mesma. </p>
</blockquote>
</section>
<section id="lógica-do-teste" class="level3" data-number="19.4.4">
<h3 data-number="19.4.4" class="anchored" data-anchor-id="lógica-do-teste"><span class="header-section-number">19.4.4</span> Lógica do teste</h3>
<p>O teste estatístico de McNemar, com correção de continuidade, é obtido utilizando a equação:</p>
<p><span class="math display">\[
\chi^{2} = \frac {\left (\left |b - c  \right |- 1  \right )^{2}}{b + c}
\]</span></p>
<p>Sob a hipótese nula, com um número suficientemente grande de discordantes (células <em>b</em> e <em>c</em>), o <span class="math inline">\(\chi^{2}\)</span> tem uma distribuição qui-quadrado com um grau de liberdade. Se o resultado é significativo, isto é, fornece evidências suficientes para rejeitar a hipótese nula, significa que as proporções marginais são significativamente diferentes umas das outras.</p>
<p>Substituindo os dados da Tabela na Equação, tem-se:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>chi <span class="ot">&lt;-</span> ((<span class="fu">abs</span>(b <span class="sc">-</span> c) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(b <span class="sc">+</span> c)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>chi</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.633333</code></pre>
</div>
</div>
<p>Assumindo um <span class="math inline">\(\alpha = 0,05\)</span>, pode-se obter valor crítico para o <span class="math inline">\(\chi^{2}\)</span> para gl = 1, usando a função <code>qchisq()</code>, do pacote <code>stats</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="dv">1</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.841459</code></pre>
</div>
</div>
<p>Desta maneira, rejeita-se a <span class="math inline">\(H_{0}\)</span>, pois o <span class="math inline">\(\chi_{calculado}^{2} &gt; \chi_{crítico}^{2}\)</span>. O valor <em>P</em> pode ser conseguido com a função <code>pchisq()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span> (<span class="fl">5.633</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01762544</code></pre>
</div>
</div>
</section>
<section id="cálculo-do-teste-de-mcnemar" class="level3" data-number="19.4.5">
<h3 data-number="19.4.5" class="anchored" data-anchor-id="cálculo-do-teste-de-mcnemar"><span class="header-section-number">19.4.5</span> Cálculo do teste de McNemar</h3>
<p>Carregar o arquivo <code>dadosBioestatistica.xlsx</code>, que pode ser encontrado <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosBioestatistica.xlsx"><strong>aqui</strong></a>. Este conjunto de dados contem os dados da <a href="#tbl-tabmcnemar" class="quarto-xref">Tabela&nbsp;<span>19.6</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosBioestatistica.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Construir uma tabela de contingência</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>preteste <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>preteste, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>posteste <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>posteste, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>tab4 <span class="ot">&lt;-</span> <span class="fu">table</span>(dados<span class="sc">$</span>preteste, dados<span class="sc">$</span>posteste, </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Pré-teste"</span>, <span class="st">"Pós-teste"</span>))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>tab4</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Pós-teste
Pré-teste sim não
      sim  20   8
      não  22 150</code></pre>
</div>
</div>
<p>Agora, pode-se calcular o teste de McNemar<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> com a função <code>mcnemar_test()</code> do pacote <code>rstatix</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">mcnemar_test</span> (tab4, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n statistic    df      p p.signif method      
* &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;       
1   200      5.63     1 0.0176 *        McNemar test</code></pre>
</div>
</div>
<p>O resultado do teste de McNemar com correção de continuidade é exatamente igual ao calculado manualmente.</p>
</section>
<section id="conclusão-3" class="level3" data-number="19.4.6">
<h3 data-number="19.4.6" class="anchored" data-anchor-id="conclusão-3"><span class="header-section-number">19.4.6</span> Conclusão</h3>
<p>Houve uma modificação estatisticamente significativa na opinião dos alunos após o curso de Bioestatística em relação à confiança nas análises estatísticas (86% no pré-teste de respostas <code>não</code> x 79% no pós-teste, <span class="math inline">\(\chi^{2} = 5,63, gl = 1, P = 0,018\)</span>). Alguns alunos (14) mudaram de opinião em relação a sua confiança nas análises estatísticas dos periódicos médicos.</p>


<!-- -->

<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-altman1991chisquared" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Altman DG. Comparing groups: categorical data. Em: Practical Statistics for Medical Research. London: Chapman &amp; Hall/CRC; 1991. p. 244–7. </div>
</div>
<div id="ref-myszkowski2020nhstplot" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Myszkowski N. nhstplot package [Internet]. RDocumentation. 2020. Disponível em: <a href="https://rdocumentation.org/packages/nhstplot/versions/1.1.0">https://rdocumentation.org/packages/nhstplot/versions/1.1.0</a></div>
</div>
<div id="ref-warnes2022gmodels" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Warnes GR, Bolker B, et al. Gmodels: Various R programming tools for model fitting [Internet]. CRAN R Project. 2022. Disponível em: <a href="https://rdrr.io/cran/gmodels/">https://rdrr.io/cran/gmodels/</a></div>
</div>
<div id="ref-comtois2022summarytools" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Comtois D. summarytools: Tools to Quickly and Neatly Summarize Data [Internet]. CRAN R Project. 2022. Disponível em:<a href="	https://github.com/dcomtois/summarytools"> https://github.com/dcomtois/summarytools</a></div>
</div>
<div id="ref-daniel2013chisquare" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Daniel WW, Cross CL. The chi-square distribution and analysis of frequencies. Em: Practical Statistics for Medical Research. Hoboken, NJ: John Wiley &amp; Sons, Inc; 2013. p. 604–19. </div>
</div>
<div id="ref-eliasziw1991application" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Eliasziw M, Donner A. Application of the McNemar test to non-independent matched pair data. Statistics in medicine. 1991;10(12):1981–91. </div>
</div>
<div id="ref-rosner2011mcnemar" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Rosner B. Hypothesis Testing: Categorical Data. Em: Fundamentals of Biostatistics. Seventh Edition. Boston: Cengage; 2011. p. 377. </div>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Ver <a href="05-manipulandoDados.html#sec-dadosMater" class="quarto-xref"><span>Seção 5.6</span></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Quando não se está trabalhando com uma tabela <span class="math inline">\(2 \times 2\)</span> e a regra geral for obedecida e o n for grande, pode-se usar o qui-quadrado de Pearson sem correção.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>É possível também obter o teste de McNemar de outras formas, como, por exemplo, usando a função <code>CrossTable()</code> do pacote <code>gmodels</code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./18-regressao.html" class="pagination-link" aria-label="Regressão Linear Simples">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Regressão Linear Simples</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./20-testes-naoParametricos.html" class="pagination-link" aria-label="Métodos não paramétricos">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb90" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Análise de Dados Categóricos</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pacotes necessários</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(coin,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>                DescTools,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>                dplyr,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>                expss,</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>                flextable,</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>                ggplot2, </span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                gmodels,</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>                nhstplot,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                readxl,</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>                rstatix,</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>                summarytools)</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Qui-Quadrado {#sec-qui}</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>Dois testes de hipótese são proeminentes na pesquisa na área da saúde. Um é o teste *t* de duas amostras, que é usado para testar a igualdade de duas médias populacionais independentes. O segundo é o teste qui-quadrado (denotado por $\chi^{2}$). O teste é denominado teste qui-quadrado porque usa a distribuição qui-quadrado ou $\chi^{2}$.</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribuição qui-quadrado</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>Se uma variável *X* é normalmente distribuída, então a variável $X^{2}$ tem uma distribuição qui-quadrado @altman1991chisquared. A distribuição qui-quadrado com *k* categorias é a distribuição de uma soma dos quadrados de *k* variáveis aleatórias independentes com distribuição normal. O número de categorias determina o número de graus de liberdade. O formato da distribuição qui-quadrado depende desses graus de liberdade. Em geral, ela é assimétrica com apenas valores positivos, iniciando em zero. A assimetria diminui à medida que aumentam os graus de liberdade. Para cada grau de liberdade tem-se curvas de distribuição diferentes.</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-chi</span></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Distribuição do Qui-Quadrado"</span></span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">5</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"royalblue"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">10</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">15</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">20</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"cyan"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">30</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">col =</span> <span class="st">"green3"</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(<span class="at">bty =</span> <span class="st">"L"</span>)</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="at">legend=</span><span class="fu">c</span> (<span class="st">"gl = 05"</span>, <span class="st">"gl = 10"</span>, <span class="st">"gl = 15"</span>, <span class="st">"gl = 20"</span>, <span class="st">"gl = 30"</span>), </span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">c</span> (<span class="st">"royalblue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"cyan"</span>, <span class="st">"green3"</span>), </span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">bty=</span><span class="st">"n"</span>, </span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span><span class="st">"right"</span>)</span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>A distribuição $\chi^{2}$ converge para a distribuição normal à medida que os graus de liberdade aumentam, de acordo com o teorema do limite central, entretanto esta convergência é lenta (@fig-chi).</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>A distribuição qui-quadrado tem duas aplicações comuns: primeiro, como um teste para saber se duas variáveis categóricas são independentes ou não (**Teste de independência ou associação**); segundo, o teste de qualidade do ajuste do qui-quadrado (**Teste de aderência ou ajuste**) que é usado para comparar uma determinada distribuição com uma distribuição conhecida.</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lógica da estatística do qui-quadrado</span></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>O cálculo da estatística $\chi^{2}$ é baseado nas frequências existentes nas células da tabela de contingência. Em primeiro lugar, calcula-se as frequências que se espera em cada célula caso a hipótese nula seja verdadeira (**frequências esperadas**). Em segundo lugar, usando a equação geral, o teste mede o grau de discrepância entre o conjunto de **frequências observadas** (O) e o conjunto de **frequências esperadas** (E).</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>\chi^{2}= \sum \left <span class="co">[</span><span class="ot">\frac{\left (O_{i} - E_{i} \right )^2}{E_{i}} \right</span><span class="co">]</span></span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>Se $O_{i}$ é muito semelhante ao $E_{i}$, então o $\chi^{2}$ é baixo; se $O_{i}$ é muito diferente em relação ao $E_{i}$, então o $\chi^{2}$ é alto.</span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>As *frequências observadas* são o número de sujeitos ou objetos na amostra que se enquadram nas várias categorias da variável de interesse. As *frequências esperadas* são o número de sujeitos ou objetos na amostra que seria esperado observar se hipótese nula fosse verdadeira.</span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>E = \frac{total\ coluna\ \times total\ linha }{total\ geral}</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a>Por exemplo, suponha os dados da @tbl-tab2x2,</span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tab2x2</span></span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Distribuição de Acidentes Automobilísticos por Gênero"</span></span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a>Sexo <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Homens"</span>, <span class="st">"Mulheres"</span>, <span class="st">"Total"</span>)</span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a>Acidentes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">4</span>, <span class="dv">20</span>)</span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a>Sem_acidentes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>, <span class="dv">36</span>, <span class="dv">80</span>)</span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a>Total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">100</span>)</span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Sexo, Acidentes, Sem_acidentes, Total)</span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a>my_flextable <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb90-95"><a href="#cb90-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sexo =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb90-96"><a href="#cb90-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Acidentes =</span> <span class="st">"Com Acidentes"</span>,</span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sem_acidentes =</span> <span class="st">"Sem Acidentes"</span>,</span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total de Pessoas"</span></span>
<span id="cb90-99"><a href="#cb90-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-100"><a href="#cb90-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-101"><a href="#cb90-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-102"><a href="#cb90-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-103"><a href="#cb90-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-104"><a href="#cb90-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="sc">~</span> Sexo <span class="sc">==</span> <span class="st">"Total"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-105"><a href="#cb90-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">part =</span> <span class="st">"body"</span>, </span>
<span id="cb90-106"><a href="#cb90-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.5</span>))</span>
<span id="cb90-107"><a href="#cb90-107" aria-hidden="true" tabindex="-1"></a>my_flextable</span>
<span id="cb90-108"><a href="#cb90-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-109"><a href="#cb90-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-110"><a href="#cb90-110" aria-hidden="true" tabindex="-1"></a>o número de acidentes esperados para os homens</span>
<span id="cb90-111"><a href="#cb90-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-114"><a href="#cb90-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-115"><a href="#cb90-115" aria-hidden="true" tabindex="-1"></a>total_c <span class="ot">&lt;-</span> df<span class="sc">$</span>Acidentes[<span class="dv">3</span>]</span>
<span id="cb90-116"><a href="#cb90-116" aria-hidden="true" tabindex="-1"></a>total_l <span class="ot">&lt;-</span> df<span class="sc">$</span>Total[<span class="dv">1</span>]</span>
<span id="cb90-117"><a href="#cb90-117" aria-hidden="true" tabindex="-1"></a>total_geral <span class="ot">&lt;-</span> df<span class="sc">$</span>Total[<span class="dv">3</span>]</span>
<span id="cb90-118"><a href="#cb90-118" aria-hidden="true" tabindex="-1"></a>esperado <span class="ot">&lt;-</span> (total_c<span class="sc">*</span>total_l)<span class="sc">/</span>total_geral</span>
<span id="cb90-119"><a href="#cb90-119" aria-hidden="true" tabindex="-1"></a>esperado </span>
<span id="cb90-120"><a href="#cb90-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-121"><a href="#cb90-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-122"><a href="#cb90-122" aria-hidden="true" tabindex="-1"></a>é igual a <span class="in">`r esperado`</span>, entretanto ocorreram <span class="in">`r df$Acidentes[1]`</span>. Houve uma **diferença**. Essa diferença é calculada para todas as células e é o importante no cálculo do qui-quadrado. Após o cálculo, acrescentando os valores esperados à @tbl-tab2x2, tem-se a @tbl-ntab2x2 que é usada no cálculo do qui-quadrado.</span>
<span id="cb90-123"><a href="#cb90-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-126"><a href="#cb90-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-127"><a href="#cb90-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ntab2x2</span></span>
<span id="cb90-128"><a href="#cb90-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-129"><a href="#cb90-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-130"><a href="#cb90-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-131"><a href="#cb90-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Distribuição de Acidentes Automobilísticos por Gênero"</span></span>
<span id="cb90-132"><a href="#cb90-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-133"><a href="#cb90-133" aria-hidden="true" tabindex="-1"></a>Sexo <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Homens"</span>, <span class="st">"Mulheres"</span>, <span class="st">"Total"</span>)</span>
<span id="cb90-134"><a href="#cb90-134" aria-hidden="true" tabindex="-1"></a>Acidentes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">20</span>)</span>
<span id="cb90-135"><a href="#cb90-135" aria-hidden="true" tabindex="-1"></a>Sem_acidentes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">32</span>, <span class="dv">80</span>)</span>
<span id="cb90-136"><a href="#cb90-136" aria-hidden="true" tabindex="-1"></a>Total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">100</span>)</span>
<span id="cb90-137"><a href="#cb90-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-138"><a href="#cb90-138" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Sexo, Acidentes, Sem_acidentes, Total)</span>
<span id="cb90-139"><a href="#cb90-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-140"><a href="#cb90-140" aria-hidden="true" tabindex="-1"></a>my_flextable <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-141"><a href="#cb90-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb90-142"><a href="#cb90-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sexo =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb90-143"><a href="#cb90-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">Acidentes =</span> <span class="st">"Com Acidentes"</span>,</span>
<span id="cb90-144"><a href="#cb90-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sem_acidentes =</span> <span class="st">"Sem Acidentes"</span>,</span>
<span id="cb90-145"><a href="#cb90-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total de Pessoas"</span></span>
<span id="cb90-146"><a href="#cb90-146" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-147"><a href="#cb90-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-148"><a href="#cb90-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-149"><a href="#cb90-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-150"><a href="#cb90-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-151"><a href="#cb90-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="sc">~</span> Sexo <span class="sc">==</span> <span class="st">"Total"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-152"><a href="#cb90-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">part =</span> <span class="st">"body"</span>, </span>
<span id="cb90-153"><a href="#cb90-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.5</span>))</span>
<span id="cb90-154"><a href="#cb90-154" aria-hidden="true" tabindex="-1"></a>my_flextable</span>
<span id="cb90-155"><a href="#cb90-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-156"><a href="#cb90-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-157"><a href="#cb90-157" aria-hidden="true" tabindex="-1"></a>Para o cálculo do $\chi^2$, como se está comparando proporções em uma tabela contingência $2\times2$ (ou seja, duas linhas e duas colunas), deve-se aplicar uma correção na fórmula, mostrada acima, para ajustar o viés de continuidade. Esta correção, denominada de *correção de Yates*, consiste em subtrair 0,5 do valor absoluto da diferença entre a frequência observada e a esperada em cada célula da tabela, antes de elevar ao quadrado e dividir pela frequência esperada.</span>
<span id="cb90-158"><a href="#cb90-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-159"><a href="#cb90-159" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-160"><a href="#cb90-160" aria-hidden="true" tabindex="-1"></a>\chi^{2}= \sum \left <span class="co">[</span><span class="ot">\frac{\left |(O_{i} - E_{i}|-0,5 \right )^2}{E_{i}} \right</span><span class="co">]</span></span>
<span id="cb90-161"><a href="#cb90-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-162"><a href="#cb90-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-163"><a href="#cb90-163" aria-hidden="true" tabindex="-1"></a>Substituindo os dados na fórmula do qui-quadrado, tem-se:</span>
<span id="cb90-164"><a href="#cb90-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-165"><a href="#cb90-165" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-166"><a href="#cb90-166" aria-hidden="true" tabindex="-1"></a>\chi^{2}= \left <span class="co">[</span><span class="ot">\frac{\left (|16 - 12 \right |-0.5)^2}{12} \right</span><span class="co">]</span>+ \left <span class="co">[</span><span class="ot">\frac{\left (|44 - 48 \right |-0.5)^2}{48} \right</span><span class="co">]</span>+\left <span class="co">[</span><span class="ot">\frac{\left (|4 - 8 \right |-0.5)^2}{8} \right</span><span class="co">]</span>+\left <span class="co">[</span><span class="ot">\frac{\left (|36 - 32 \right|-0.5)^2}{32} \right</span><span class="co">]</span></span>
<span id="cb90-167"><a href="#cb90-167" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-168"><a href="#cb90-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-169"><a href="#cb90-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-170"><a href="#cb90-170" aria-hidden="true" tabindex="-1"></a>\chi^{2}=1,021 + 0,255 + 1,531  +0,383 = 3,19</span>
<span id="cb90-171"><a href="#cb90-171" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-172"><a href="#cb90-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-173"><a href="#cb90-173" aria-hidden="true" tabindex="-1"></a>A correção de Yates reduz o valor do qui-quadrado (sem a correção o valor do qui-quadrado seria 4,17) e torna o teste mais conservador, reduzindo a probabilidade de rejeitar a hipótese nula quando ela é verdadeira.</span>
<span id="cb90-174"><a href="#cb90-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-175"><a href="#cb90-175" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb90-176"><a href="#cb90-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Indicação da correção de Yates</span></span>
<span id="cb90-177"><a href="#cb90-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-178"><a href="#cb90-178" aria-hidden="true" tabindex="-1"></a>A correção é recomendada em tabelas de contingência $2\times2$ ou quando o tamanho da amostra é pequeno (menor que 40) ou quando há pelo menos uma célula com frequência esperada menor que 5.</span>
<span id="cb90-179"><a href="#cb90-179" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-180"><a href="#cb90-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-181"><a href="#cb90-181" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Restrições ao qui-quadrado</span></span>
<span id="cb90-182"><a href="#cb90-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-183"><a href="#cb90-183" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="co">[</span><span class="ot">Regra Geral</span><span class="co">]</span>{.underline}</span>
<span id="cb90-184"><a href="#cb90-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-185"><a href="#cb90-185" aria-hidden="true" tabindex="-1"></a>O teste pode ser usado, se a frequência observada em cada célula for maior ou igual a 5 e a frequência esperada for maior ou igual a 5.</span>
<span id="cb90-186"><a href="#cb90-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-187"><a href="#cb90-187" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="co">[</span><span class="ot">Tabela 2 $\times$ 2 (gl = 1)</span><span class="co">]</span>{.underline}</span>
<span id="cb90-188"><a href="#cb90-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-189"><a href="#cb90-189" aria-hidden="true" tabindex="-1"></a>Como mostrado no exemplo acima, neste caso, é recomendada a *Correção de Continuidade de Yates*, mesmo quando o n for grande.</span>
<span id="cb90-190"><a href="#cb90-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-191"><a href="#cb90-191" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span><span class="co">[</span><span class="ot">Tabela l $\times$ c</span><span class="co">]</span>{.underline}</span>
<span id="cb90-192"><a href="#cb90-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-193"><a href="#cb90-193" aria-hidden="true" tabindex="-1"></a>O teste pode ser usado se o número de células com frequência esperada inferior a 5 for menor do que 20% do total das células e nenhuma frequência esperada é igual a zero.</span>
<span id="cb90-194"><a href="#cb90-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-195"><a href="#cb90-195" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span><span class="co">[</span><span class="ot">n pequeno</span><span class="co">]</span>{.underline}</span>
<span id="cb90-196"><a href="#cb90-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-197"><a href="#cb90-197" aria-hidden="true" tabindex="-1"></a>Neste caso, é preconizado o *Teste Exato de Fisher*.</span>
<span id="cb90-198"><a href="#cb90-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-199"><a href="#cb90-199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Valor crítico do qui-quadrado</span></span>
<span id="cb90-200"><a href="#cb90-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-201"><a href="#cb90-201" aria-hidden="true" tabindex="-1"></a>A estatística de teste (que em certo sentido é a diferença entre as frequências observadas e esperadas) deve ser comparada a um valor crítico para determinar se a diferença é grande ou pequena. Não se pode dizer se uma estatística de teste é grande ou pequena sem colocá-la em perspectiva com o valor crítico. Se a estatística de teste estiver acima do valor crítico, significa que a probabilidade de observar tal diferença entre as frequências observadas e esperadas é improvável.</span>
<span id="cb90-202"><a href="#cb90-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-203"><a href="#cb90-203" aria-hidden="true" tabindex="-1"></a>O valor crítico pode ser encontrado na tabela estatística da distribuição Qui-quadrado e depende do nível de significância, denotado $\alpha$, e dos graus de liberdade, denotado $gl$. O nível de significância geralmente é igual a 5%. Os graus de liberdade para um teste de Qui-quadrado de independência são encontrados da seguinte forma:</span>
<span id="cb90-204"><a href="#cb90-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-205"><a href="#cb90-205" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-206"><a href="#cb90-206" aria-hidden="true" tabindex="-1"></a>gl = (numero \ de \ linhas - 1) \ \times \ (numero \ de \ colunas - 1)</span>
<span id="cb90-207"><a href="#cb90-207" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-208"><a href="#cb90-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-209"><a href="#cb90-209" aria-hidden="true" tabindex="-1"></a>Em uma tabela de contingência 2 $\times$ 2, como a @tbl-tab2x2, tem $gl = (2 - 1) \times (2 - 1) = 1$. Basta agora obter o valor crítico com a função <span class="in">`qchisq()`</span>:</span>
<span id="cb90-210"><a href="#cb90-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-213"><a href="#cb90-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-214"><a href="#cb90-214" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span>  <span class="fl">0.05</span></span>
<span id="cb90-215"><a href="#cb90-215" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb90-216"><a href="#cb90-216" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span> (<span class="dv">1</span><span class="sc">-</span>alpha, gl)</span>
<span id="cb90-217"><a href="#cb90-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-218"><a href="#cb90-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-219"><a href="#cb90-219" aria-hidden="true" tabindex="-1"></a>Esse valor é comparado com o $\chi^{2}_{calculado}$ para um nível de significância de 5%. Se ele é maior, rejeita-se se a $H_{0}$; caso contrário, não se rejeita. Para obter o valor *P*, pode-se usar a função `pchisq()`, onde, como argumento, coloca-se o valor do $\chi^{2}_{calculado}$, os graus de liberdade e acrescenta-se <span class="in">`lower.tail = FALSE`</span> para obter a probabilidade da cauda superior, uma vez que a distribuição do qui-quadrado é positiva.</span>
<span id="cb90-220"><a href="#cb90-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-221"><a href="#cb90-221" aria-hidden="true" tabindex="-1"></a>O valor crítico é igual a 3,84 e, no exemplo, o $\chi^{2}_{calculado}$ é igual a 3,19, logo a valor *p* é igual a:</span>
<span id="cb90-222"><a href="#cb90-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-225"><a href="#cb90-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-226"><a href="#cb90-226" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span> (<span class="fl">3.19</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-227"><a href="#cb90-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-228"><a href="#cb90-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-229"><a href="#cb90-229" aria-hidden="true" tabindex="-1"></a>Dessa forma, conclui-se ,com uma confiança de 95%, que não se rejeita $H_{0}$, ou seja, a proporção acidentes nos homens é igual a proporção de acidentes nas mulheres ($\chi^{2} (1) = 3,19;P=0,074$). Observe na @fig-chi384 que o $\chi^{2}_{calculado}$ localiza-se a esquerda da linha vertical, da área vermelha de rejeição da $H_{0}$. Atente, que se não fosse feita a correção de Yates, a conclusão seria diferente, pois o $\chi^{2}_{calculado}$ seria igual a 4,17 e estaria um pouco cima do $\chi^{2}_{crítico}$, na área de rejeição da $H_{0}$. Com a correção de Yates o valor *P* é igual a 0,074, sem a correção de continuidade igual a 0,041, isto configura o que se chama de *valor P marginal* e, nesses casos, deve-se ter muito cuidado na conclusão, pois existe risco de erro tipo II, não rejeitar uma $H_{0}$ quando ela é falsa.</span>
<span id="cb90-230"><a href="#cb90-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-233"><a href="#cb90-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-234"><a href="#cb90-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-chi384</span></span>
<span id="cb90-235"><a href="#cb90-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb90-236"><a href="#cb90-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-237"><a href="#cb90-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-238"><a href="#cb90-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-239"><a href="#cb90-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-240"><a href="#cb90-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-241"><a href="#cb90-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribuição do qui-quadrado, gl = 1, alpha = 0,05"</span></span>
<span id="cb90-242"><a href="#cb90-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-243"><a href="#cb90-243" aria-hidden="true" tabindex="-1"></a><span class="fu">plotchisqtest</span>(<span class="at">chisq =</span> <span class="fl">3.84</span>, </span>
<span id="cb90-244"><a href="#cb90-244" aria-hidden="true" tabindex="-1"></a>              <span class="at">df =</span> <span class="dv">1</span>,</span>
<span id="cb90-245"><a href="#cb90-245" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorleft =</span> <span class="st">"aliceblue"</span>,</span>
<span id="cb90-246"><a href="#cb90-246" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorright =</span> <span class="st">"red"</span>,</span>
<span id="cb90-247"><a href="#cb90-247" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylabel =</span> <span class="st">"Densidade de probabilidade"</span>)</span>
<span id="cb90-248"><a href="#cb90-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-249"><a href="#cb90-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-250"><a href="#cb90-250" aria-hidden="true" tabindex="-1"></a>O gráfico foi criado com a função <span class="in">`plotchisqteste()`</span> do pacote <span class="in">`nhstplot`</span>, pacote simples e conveniente para representar graficamente os testes de significância de hipótese nula mais comuns, como testes *F*, testes *t* e testes *z* @myszkowski2020nhstplot.</span>
<span id="cb90-251"><a href="#cb90-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-252"><a href="#cb90-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Qui-quadrado de independência ou associação</span></span>
<span id="cb90-253"><a href="#cb90-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-254"><a href="#cb90-254" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dados usados no exemplo</span></span>
<span id="cb90-255"><a href="#cb90-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-256"><a href="#cb90-256" aria-hidden="true" tabindex="-1"></a>O exemplo da @tbl-tab2x2, usado para mostrar a lógica do qui-quadrado, é um teste de independência ou associação. Ali, foi mostrado que não existe uma associação estatisticamente significativa (*p* <span class="sc">\&gt;</span> 0,05) entre acidentes automobilísticos e o sexo.\</span>
<span id="cb90-257"><a href="#cb90-257" aria-hidden="true" tabindex="-1"></a>Como exercício, serão usados outros dados que necessitam mais manipulação, como treinamento do qui-quadrado de associação e do próprio R. Estes dados servirão para testar a hipótese de associação entre tabagismo e baixo peso ao nascer (<span class="sc">\&lt;</span> 2500g).</span>
<span id="cb90-258"><a href="#cb90-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-259"><a href="#cb90-259" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Leitura e transformação dos dados</span></span>
<span id="cb90-260"><a href="#cb90-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-261"><a href="#cb90-261" aria-hidden="true" tabindex="-1"></a>Os dados serão provenientes do banco de dados <span class="in">`dadosMater.xlsx`</span>. bastante usado neste livro <span class="ot">[^19-dadoscategoricos-1]</span> . A partir do diretório, será feita a leitura da seguinte maneira:</span>
<span id="cb90-262"><a href="#cb90-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-263"><a href="#cb90-263" aria-hidden="true" tabindex="-1"></a><span class="ot">[^19-dadoscategoricos-1]: </span>Ver @sec-dadosMater.</span>
<span id="cb90-264"><a href="#cb90-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-267"><a href="#cb90-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-268"><a href="#cb90-268" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>)</span>
<span id="cb90-269"><a href="#cb90-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-270"><a href="#cb90-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-271"><a href="#cb90-271" aria-hidden="true" tabindex="-1"></a>Adicione a este arquivo uma variável denominada <span class="in">`baixoPeso`</span>, usando a função <span class="in">`mutate()`</span> do pacote <span class="in">`dplyr`</span> e a função <span class="in">`ifelse ()`</span>, da base do R:</span>
<span id="cb90-272"><a href="#cb90-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-275"><a href="#cb90-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-276"><a href="#cb90-276" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">baixoPeso =</span> <span class="fu">ifelse</span>(pesoRN <span class="sc">&lt;</span> <span class="dv">2500</span>, <span class="st">"1"</span>, <span class="st">"2"</span>))</span>
<span id="cb90-277"><a href="#cb90-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-278"><a href="#cb90-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-279"><a href="#cb90-279" aria-hidden="true" tabindex="-1"></a>Onde <span class="in">`1 = sim`</span> e <span class="in">`2 = não`</span>, ou seja, com peso de nascimento <span class="sc">\&lt;</span> 2500g e $\ge$ 2500g.</span>
<span id="cb90-280"><a href="#cb90-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-281"><a href="#cb90-281" aria-hidden="true" tabindex="-1"></a>O próximo passo é selecionar, deste arquivo, apenas esta variável criada e a variável <span class="in">`fumo`</span>, porque o objetivo da análise será verificar se existe associação entre tabagismo na gestação e baixo peso ao nascer (<span class="sc">\&lt;</span> 2500g). Para isso, usa-se a função <span class="in">`select()`</span> do pacote <span class="in">`dplyr`</span>:</span>
<span id="cb90-282"><a href="#cb90-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-285"><a href="#cb90-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-286"><a href="#cb90-286" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">select</span> (fumo, baixoPeso)</span>
<span id="cb90-287"><a href="#cb90-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-288"><a href="#cb90-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-289"><a href="#cb90-289" aria-hidden="true" tabindex="-1"></a>A seguir, será extraída uma amostra deste banco de dados com n = 300, usando a função <span class="in">`slice_sample()`</span> do pacote <span class="in">`dplyr`</span>. A função <span class="in">`set.seed()`</span> apenas garante que os dados selecionados aleatoriamente se mantenham os mesmos em outros sorteios (veja @sec-dnp):</span>
<span id="cb90-290"><a href="#cb90-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-293"><a href="#cb90-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-294"><a href="#cb90-294" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb90-295"><a href="#cb90-295" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(dados, <span class="at">n=</span><span class="dv">300</span>)</span>
<span id="cb90-296"><a href="#cb90-296" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span>
<span id="cb90-297"><a href="#cb90-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-298"><a href="#cb90-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-299"><a href="#cb90-299" aria-hidden="true" tabindex="-1"></a>Todos esses passos poderiam ser feitos em um só comando, precedido pela semente (<span class="in">`set.seed(123)`</span>), usando o operador pipe %<span class="sc">\&gt;</span>%:</span>
<span id="cb90-300"><a href="#cb90-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-303"><a href="#cb90-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-304"><a href="#cb90-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb90-305"><a href="#cb90-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb90-306"><a href="#cb90-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-307"><a href="#cb90-307" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb90-308"><a href="#cb90-308" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-309"><a href="#cb90-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">baixoPeso =</span> <span class="fu">ifelse</span>(pesoRN <span class="sc">&lt;</span> <span class="dv">2500</span>, <span class="st">"1"</span>, <span class="st">"2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-310"><a href="#cb90-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (fumo, baixoPeso) <span class="sc">%&gt;%</span> </span>
<span id="cb90-311"><a href="#cb90-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">300</span>)</span>
<span id="cb90-312"><a href="#cb90-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-313"><a href="#cb90-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-314"><a href="#cb90-314" aria-hidden="true" tabindex="-1"></a>Tem-se, agora, um conjunto de dados com duas colunas: <span class="in">`fumo`</span>, como uma variável numérica e <span class="in">`baixoPeso`</span>, como caractere. Ambas devem ser transformadas em fator e, onde os rótulos são 1 e 2, passam para "sim" e "não" e mantendo a ordem "sim" e "não".</span>
<span id="cb90-315"><a href="#cb90-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-318"><a href="#cb90-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-319"><a href="#cb90-319" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>fumo <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>fumo,</span>
<span id="cb90-320"><a href="#cb90-320" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb90-321"><a href="#cb90-321" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb90-322"><a href="#cb90-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-323"><a href="#cb90-323" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>baixoPeso <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>baixoPeso,</span>
<span id="cb90-324"><a href="#cb90-324" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb90-325"><a href="#cb90-325" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb90-326"><a href="#cb90-326" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados)</span>
<span id="cb90-327"><a href="#cb90-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-328"><a href="#cb90-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-329"><a href="#cb90-329" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Construção da Tabela</span></span>
<span id="cb90-330"><a href="#cb90-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-331"><a href="#cb90-331" aria-hidden="true" tabindex="-1"></a>Antes de construir a @tbl-tab2x2fumo, será verificado a distribuição de baixo peso de acordo com o tabagismo materno, usando a função <span class="in">`with()`</span> e, dentro dela, a função <span class="in">`table()`</span>, seguida da função <span class="in">`addmargins()`</span>:</span>
<span id="cb90-332"><a href="#cb90-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-335"><a href="#cb90-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-336"><a href="#cb90-336" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> dados, <span class="fu">table</span>(fumo, baixoPeso))</span>
<span id="cb90-337"><a href="#cb90-337" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab)</span>
<span id="cb90-338"><a href="#cb90-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-339"><a href="#cb90-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-340"><a href="#cb90-340" aria-hidden="true" tabindex="-1"></a>Assim, tem-se</span>
<span id="cb90-341"><a href="#cb90-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-344"><a href="#cb90-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-345"><a href="#cb90-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tab2x2fumo</span></span>
<span id="cb90-346"><a href="#cb90-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-347"><a href="#cb90-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-348"><a href="#cb90-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-349"><a href="#cb90-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Baixo peso* ao nascer e tabagismo"</span></span>
<span id="cb90-350"><a href="#cb90-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-351"><a href="#cb90-351" aria-hidden="true" tabindex="-1"></a>fumo <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Sim"</span>, <span class="st">"Não"</span>, <span class="st">"Total"</span>)</span>
<span id="cb90-352"><a href="#cb90-352" aria-hidden="true" tabindex="-1"></a>baixoPeso <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">40</span>)</span>
<span id="cb90-353"><a href="#cb90-353" aria-hidden="true" tabindex="-1"></a>sem_bp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">209</span>, <span class="dv">260</span>)</span>
<span id="cb90-354"><a href="#cb90-354" aria-hidden="true" tabindex="-1"></a>Total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">69</span>, <span class="dv">260</span>, <span class="dv">300</span>)</span>
<span id="cb90-355"><a href="#cb90-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-356"><a href="#cb90-356" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fumo, baixoPeso, sem_bp, Total)</span>
<span id="cb90-357"><a href="#cb90-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-358"><a href="#cb90-358" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-359"><a href="#cb90-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb90-360"><a href="#cb90-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">fumo =</span> <span class="st">"Tabagismo"</span>,</span>
<span id="cb90-361"><a href="#cb90-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">baixoPeso =</span> <span class="st">"Baixo Peso"</span>,</span>
<span id="cb90-362"><a href="#cb90-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">sem_bp =</span> <span class="st">"Sem Baixo Peso"</span>,</span>
<span id="cb90-363"><a href="#cb90-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-364"><a href="#cb90-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-365"><a href="#cb90-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">value =</span> <span class="st">"* Baixo Peso = peso ao nascer &lt; 2500g"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-366"><a href="#cb90-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-367"><a href="#cb90-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-368"><a href="#cb90-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-369"><a href="#cb90-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-370"><a href="#cb90-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb90-371"><a href="#cb90-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-372"><a href="#cb90-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="sc">~</span> fumo <span class="sc">==</span> <span class="st">"Total"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-373"><a href="#cb90-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">part =</span> <span class="st">"body"</span>, </span>
<span id="cb90-374"><a href="#cb90-374" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.3</span>))</span>
<span id="cb90-375"><a href="#cb90-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-376"><a href="#cb90-376" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb90-377"><a href="#cb90-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-378"><a href="#cb90-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-379"><a href="#cb90-379" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb90-380"><a href="#cb90-380" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observação</span></span>
<span id="cb90-381"><a href="#cb90-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-382"><a href="#cb90-382" aria-hidden="true" tabindex="-1"></a>Uma tabela é constituída por linhas e colunas. Para se extrair valores da tabela, usa-se os colchetes, após o nome da tabela. O primeiro valor dentro dos colchetes é referente ao **número da linha**; o segundo, separado pela virgula, é referente ao **número da coluna**. Então, <span class="in">`tab[1,1]`</span> se refere ao valor que está na primeira linha e primeira coluna:</span>
<span id="cb90-383"><a href="#cb90-383" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-384"><a href="#cb90-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-387"><a href="#cb90-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-388"><a href="#cb90-388" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb90-389"><a href="#cb90-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-390"><a href="#cb90-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-391"><a href="#cb90-391" aria-hidden="true" tabindex="-1"></a>A proporção de baixo peso por categoria de tabagismo (nº de casos/total da linha):</span>
<span id="cb90-392"><a href="#cb90-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-395"><a href="#cb90-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-396"><a href="#cb90-396" aria-hidden="true" tabindex="-1"></a>fumantes <span class="ot">&lt;-</span>  tab[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span>(tab[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> tab[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb90-397"><a href="#cb90-397" aria-hidden="true" tabindex="-1"></a>fumantes</span>
<span id="cb90-398"><a href="#cb90-398" aria-hidden="true" tabindex="-1"></a>não.fumantes <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span>(tab[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">+</span> tab[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb90-399"><a href="#cb90-399" aria-hidden="true" tabindex="-1"></a>não.fumantes</span>
<span id="cb90-400"><a href="#cb90-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-401"><a href="#cb90-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-402"><a href="#cb90-402" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualização gráfica</span></span>
<span id="cb90-403"><a href="#cb90-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-404"><a href="#cb90-404" aria-hidden="true" tabindex="-1"></a>Um gráfico de barras empilhadas, construído com o <span class="in">`ggplot()`</span> do pacote <span class="in">`ggplot2`</span> (ver @sec-ggplot2), será usado para visualizar os dados:</span>
<span id="cb90-405"><a href="#cb90-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-408"><a href="#cb90-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-409"><a href="#cb90-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fumobp</span></span>
<span id="cb90-410"><a href="#cb90-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb90-411"><a href="#cb90-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-412"><a href="#cb90-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-413"><a href="#cb90-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-414"><a href="#cb90-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-415"><a href="#cb90-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-416"><a href="#cb90-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Gráfico de barras empilhadas: tabagismo vs baixo peso ao nascer"</span></span>
<span id="cb90-417"><a href="#cb90-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-418"><a href="#cb90-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dados) <span class="sc">+</span></span>
<span id="cb90-419"><a href="#cb90-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span> (<span class="at">x =</span> fumo, <span class="at">fill =</span> baixoPeso) <span class="sc">+</span></span>
<span id="cb90-420"><a href="#cb90-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span> (<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb90-421"><a href="#cb90-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"aliceblue"</span>)) <span class="sc">+</span></span>
<span id="cb90-422"><a href="#cb90-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="cn">NULL</span>,  </span>
<span id="cb90-423"><a href="#cb90-423" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Tabagismo"</span>,</span>
<span id="cb90-424"><a href="#cb90-424" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb90-425"><a href="#cb90-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="st">"sim"</span>, <span class="at">y=</span><span class="dv">62</span>, <span class="at">label=</span> <span class="st">"26,1%"</span>) <span class="sc">+</span> </span>
<span id="cb90-426"><a href="#cb90-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"não"</span>, <span class="at">y=</span><span class="dv">223</span>, <span class="at">label =</span> <span class="st">"9,5%"</span>) <span class="sc">+</span></span>
<span id="cb90-427"><a href="#cb90-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span> () <span class="sc">+</span></span>
<span id="cb90-428"><a href="#cb90-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb90-429"><a href="#cb90-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Peso ao nascer &lt; 2500g"</span>)</span>
<span id="cb90-430"><a href="#cb90-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-431"><a href="#cb90-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-432"><a href="#cb90-432" aria-hidden="true" tabindex="-1"></a>Observa-se, @fig-fumobp, que 24,6% das gestantes fumantes geram bebês com baixo peso, enquanto que entre as não fumantes este percentual cai três vezes, indo para 9,5%. É uma diferença grande! Aqui, quase se tem certeza que ela é significativa, mesmo sem cálculos!</span>
<span id="cb90-433"><a href="#cb90-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-434"><a href="#cb90-434" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hipóteses estatísticas</span></span>
<span id="cb90-435"><a href="#cb90-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-436"><a href="#cb90-436" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: a proporção de baixo peso é igual nos dois grupo (fumantes e não fumantes); não há associação entre as variáveis.</span></span>
<span id="cb90-437"><a href="#cb90-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-438"><a href="#cb90-438" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: a proporção de baixo peso é diferente nos dois grupo (fumantes e não fumantes); existe associação entre as variáveis.</span></span>
<span id="cb90-439"><a href="#cb90-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-440"><a href="#cb90-440" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo do Qui-quadrado de Pearson no R</span></span>
<span id="cb90-441"><a href="#cb90-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-442"><a href="#cb90-442" aria-hidden="true" tabindex="-1"></a>Para este exemplo, o $\chi^{2}$ irá verificar se existe uma associação entre as variáveis <span class="in">`fumo`</span> e <span class="in">`baixoPeso`</span>, assumindo um $\alpha = 0,05$ que equivale a um valor crítico de 3,84 com um grau de liberdade, em uma tabela $2 \times 2$. A função <span class="in">`chisq_test()`</span> do pacote <span class="in">`rstatix`</span> libera o qui-quadrado, usando os seguintes argumentos:</span>
<span id="cb90-443"><a href="#cb90-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-444"><a href="#cb90-444" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**x** $\to$ vetor numérico ou matriz. Tanto x como y podem ser fatores;</span>
<span id="cb90-445"><a href="#cb90-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**y** $\to$ vetor numérico. Ignorado quando se x é uma matriz;</span>
<span id="cb90-446"><a href="#cb90-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>correct $\to$ TRUE é o padrão. Indica se deve ser aplicada a correção de continuidade ao calcular a estatística de teste para tabelas 2 por 2 <span class="ot">[^19-dadoscategoricos-2]</span>;</span>
<span id="cb90-447"><a href="#cb90-447" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**...** $\to$ para outros argumentos consulte a ajuda do *RStudio*.</span>
<span id="cb90-448"><a href="#cb90-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-449"><a href="#cb90-449" aria-hidden="true" tabindex="-1"></a><span class="ot">[^19-dadoscategoricos-2]: </span>Quando não se está trabalhando com uma tabela $2 \times 2$ e a regra geral for obedecida e o n for grande, pode-se usar o qui-quadrado de Pearson sem correção.</span>
<span id="cb90-450"><a href="#cb90-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-451"><a href="#cb90-451" aria-hidden="true" tabindex="-1"></a>Para executar a função <span class="in">`chisq_test()`</span>, basta colocar como argumento as variáveis <span class="in">`fumo`</span> e <span class="in">`baixoPeso`</span> ou construir antes uma tabela de contingência com a função <span class="in">`table()`</span> e depois colocá-la como argumento. Como tabela <span class="in">`tab`</span> já existe:</span>
<span id="cb90-452"><a href="#cb90-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-455"><a href="#cb90-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-456"><a href="#cb90-456" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">chisq_test</span>(tab)</span>
<span id="cb90-457"><a href="#cb90-457" aria-hidden="true" tabindex="-1"></a>teste</span>
<span id="cb90-458"><a href="#cb90-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-459"><a href="#cb90-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-460"><a href="#cb90-460" aria-hidden="true" tabindex="-1"></a>A saída do teste exibe tudo que é necessário. O $\chi^{2}$ = <span class="in">`r round(teste$statistic,1)`</span> com um valor muito maior que o valor crítico de 3,84, mostrando que a diferença é estatisticamente significativa (*P* = `r teste$p`). Essas e outras estatísticas podem ser obtidas, usando o objeto `teste` seguido do sinal `$`. Por exemplo, para o valor *p*:</span>
<span id="cb90-461"><a href="#cb90-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-464"><a href="#cb90-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-465"><a href="#cb90-465" aria-hidden="true" tabindex="-1"></a>teste<span class="sc">$</span>p</span>
<span id="cb90-466"><a href="#cb90-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-467"><a href="#cb90-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-468"><a href="#cb90-468" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb90-469"><a href="#cb90-469" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nota</span></span>
<span id="cb90-470"><a href="#cb90-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-471"><a href="#cb90-471" aria-hidden="true" tabindex="-1"></a>Se um aviso como <span class="co">[</span><span class="ot">Chi-squared approximation may be incorrect</span><span class="co">]</span>{style="color:red"} (*Aproximação qui-quadrado pode estar incorreta*) aparecer, significa que as menores frequências esperadas são inferiores a 5. Para evitar esse problema, é possível usar uma das seguintes opções:</span>
<span id="cb90-472"><a href="#cb90-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-473"><a href="#cb90-473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>reunir alguns níveis (especialmente aqueles com um pequeno número de observações) para aumentar o número de observações nos subgrupos, ou</span>
<span id="cb90-474"><a href="#cb90-474" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>usar o teste exato de Fisher.</span>
<span id="cb90-475"><a href="#cb90-475" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-476"><a href="#cb90-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-477"><a href="#cb90-477" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Outras maneiras de calcular o qui-quadrado no R</span></span>
<span id="cb90-478"><a href="#cb90-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-479"><a href="#cb90-479" aria-hidden="true" tabindex="-1"></a>No pacote <span class="in">`gmodels`</span> @warnes2022gmodels, existe uma função muito interessante, a função <span class="in">`CrossTable()`</span> que que imprime, além de uma tabela de frequência com as proporções, exibe vários testes, como o teste $\chi^2$, o teste exato de Fisher e o teste de McNemar com e sem correção de continuidade. Consulte a ajuda para melhor estudar esta elegante função! Neste momento, será explorado apenas o qui-quadrado e os valores esperados com três dígitos:</span>
<span id="cb90-480"><a href="#cb90-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-483"><a href="#cb90-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-484"><a href="#cb90-484" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span> (tab,</span>
<span id="cb90-485"><a href="#cb90-485" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb90-486"><a href="#cb90-486" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop.chisq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-487"><a href="#cb90-487" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop.t =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-488"><a href="#cb90-488" aria-hidden="true" tabindex="-1"></a>            <span class="at">chisq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-489"><a href="#cb90-489" aria-hidden="true" tabindex="-1"></a>            <span class="at">expected =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-490"><a href="#cb90-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-491"><a href="#cb90-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-492"><a href="#cb90-492" aria-hidden="true" tabindex="-1"></a>Observe que a saída mostra em cada célula da tabela, o número de casos, o número esperado, a percentagem por linha (nº de casos/total da linha) e a percentagem por coluna (nº de casos/total da coluna). Por último, exibe o qui-quadrado de Pearson com e sem coreção de continuidade de Yates.</span>
<span id="cb90-493"><a href="#cb90-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-494"><a href="#cb90-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conclusão e relato dos resultados</span></span>
<span id="cb90-495"><a href="#cb90-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-496"><a href="#cb90-496" aria-hidden="true" tabindex="-1"></a>Usando a correção de continuidade de Yates, pois é uma tabela $2\times2$, vê-se que o valor *p* é menor que o nível de significância de 5% e, consequentemente, rejeita-se a hipótese nula e conclui-se que existe uma associação significativa entre tabagismo na gestação e o baixo peso ao nascimento ($\chi^{2}_{com \ correção \ de \ Yates} (1)$ = 11.2; *P* = 0,00081).</span>
<span id="cb90-497"><a href="#cb90-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-498"><a href="#cb90-498" aria-hidden="true" tabindex="-1"></a>Além disso, no relato dos resultados pode-se apresentar uma tabela ou em um gráfico.</span>
<span id="cb90-499"><a href="#cb90-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-500"><a href="#cb90-500" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tabela</span></span>
<span id="cb90-501"><a href="#cb90-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-502"><a href="#cb90-502" aria-hidden="true" tabindex="-1"></a>Para a construção da tabela, pode-se usar a função <span class="in">`ctable()`</span> do pacote <span class="in">`summarytools`</span>@comtois2022summarytools para obter uma tabela com todos os dados a serem exibidos. O argumento <span class="in">`prop = "r"`</span> exibe os percentuais das linhas ("c", nas colunas). Na realidade, são maneiras diferente de se obter o mesmo resultado.</span>
<span id="cb90-503"><a href="#cb90-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-506"><a href="#cb90-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-507"><a href="#cb90-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-508"><a href="#cb90-508" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-509"><a href="#cb90-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-510"><a href="#cb90-510" aria-hidden="true" tabindex="-1"></a><span class="fu">ctable</span>(dados<span class="sc">$</span>fumo, dados<span class="sc">$</span>baixoPeso,</span>
<span id="cb90-511"><a href="#cb90-511" aria-hidden="true" tabindex="-1"></a>       <span class="at">prop =</span> <span class="st">"r"</span>, </span>
<span id="cb90-512"><a href="#cb90-512" aria-hidden="true" tabindex="-1"></a>       <span class="at">chisq =</span> <span class="cn">TRUE</span>, </span>
<span id="cb90-513"><a href="#cb90-513" aria-hidden="true" tabindex="-1"></a>       <span class="at">headings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-514"><a href="#cb90-514" aria-hidden="true" tabindex="-1"></a>       <span class="at">OR =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-515"><a href="#cb90-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-516"><a href="#cb90-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-517"><a href="#cb90-517" aria-hidden="true" tabindex="-1"></a>Ou seja, os bebês que se expuseram ao fator de risco (fumo) têm uma chance 3,35 (IC95% : 1,67-6,71) vezes maior de apresentar peso <span class="sc">\&lt;</span> 2500g ao nascer, nessa amostra.</span>
<span id="cb90-518"><a href="#cb90-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-519"><a href="#cb90-519" aria-hidden="true" tabindex="-1"></a>Além desses resultados, a tabela final pode conter (e isto é recomendado!) os intervalos de confiança para cada uma das proporções de fumantes e não fumantes. Para isso a função <span class="in">`BinomCI()`</span> cumpre um papel suficiente (veja @sec-ICproporcao).</span>
<span id="cb90-520"><a href="#cb90-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-521"><a href="#cb90-521" aria-hidden="true" tabindex="-1"></a>Então, a proporção de baixo peso entre as fumantes é:</span>
<span id="cb90-522"><a href="#cb90-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-525"><a href="#cb90-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-526"><a href="#cb90-526" aria-hidden="true" tabindex="-1"></a><span class="fu">BinomCI</span>(<span class="dv">18</span>, <span class="dv">69</span>,</span>
<span id="cb90-527"><a href="#cb90-527" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb90-528"><a href="#cb90-528" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"clopper-pearson"</span>)</span>
<span id="cb90-529"><a href="#cb90-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-530"><a href="#cb90-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-531"><a href="#cb90-531" aria-hidden="true" tabindex="-1"></a>E, entre as não fumantes é:</span>
<span id="cb90-532"><a href="#cb90-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-535"><a href="#cb90-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-536"><a href="#cb90-536" aria-hidden="true" tabindex="-1"></a><span class="fu">BinomCI</span>(<span class="dv">22</span>, <span class="dv">231</span>,</span>
<span id="cb90-537"><a href="#cb90-537" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb90-538"><a href="#cb90-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"clopper-pearson"</span>)</span>
<span id="cb90-539"><a href="#cb90-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-540"><a href="#cb90-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-541"><a href="#cb90-541" aria-hidden="true" tabindex="-1"></a>Finalmente, esses dados podem ser colocados em uma tabela, como a @tbl-tabres:</span>
<span id="cb90-542"><a href="#cb90-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-545"><a href="#cb90-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-546"><a href="#cb90-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tabres</span></span>
<span id="cb90-547"><a href="#cb90-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-548"><a href="#cb90-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-549"><a href="#cb90-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-550"><a href="#cb90-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Efeito do tabagismo materno no peso ao nascer"</span></span>
<span id="cb90-551"><a href="#cb90-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-552"><a href="#cb90-552" aria-hidden="true" tabindex="-1"></a>  Peso_nasc <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Baixo Peso"</span>, <span class="st">"IC95%"</span>)</span>
<span id="cb90-553"><a href="#cb90-553" aria-hidden="true" tabindex="-1"></a>  Fumantes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"18/69"</span>, <span class="st">"16,3-38,1"</span>)</span>
<span id="cb90-554"><a href="#cb90-554" aria-hidden="true" tabindex="-1"></a>  Nao_fumantes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"22/231"</span>, <span class="st">"6,1-14,1"</span>)</span>
<span id="cb90-555"><a href="#cb90-555" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00081</span>, <span class="st">""</span>)</span>
<span id="cb90-556"><a href="#cb90-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-557"><a href="#cb90-557" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Peso_nasc, Fumantes, Nao_fumantes, P)</span>
<span id="cb90-558"><a href="#cb90-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-559"><a href="#cb90-559" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-560"><a href="#cb90-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb90-561"><a href="#cb90-561" aria-hidden="true" tabindex="-1"></a>    <span class="at">Peso_nasc =</span> <span class="st">"Peso ao nascer"</span>,</span>
<span id="cb90-562"><a href="#cb90-562" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fumantes =</span> <span class="st">"Fumantes"</span>,</span>
<span id="cb90-563"><a href="#cb90-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nao_fumantes =</span> <span class="st">"Não fumantes"</span>,</span>
<span id="cb90-564"><a href="#cb90-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">P =</span> <span class="st">"Valor P*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-565"><a href="#cb90-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-566"><a href="#cb90-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">value =</span> <span class="st">"* Qui-quadrado de Pearson com correção"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-567"><a href="#cb90-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-568"><a href="#cb90-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-569"><a href="#cb90-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-570"><a href="#cb90-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-571"><a href="#cb90-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb90-572"><a href="#cb90-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) </span>
<span id="cb90-573"><a href="#cb90-573" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb90-574"><a href="#cb90-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-575"><a href="#cb90-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-576"><a href="#cb90-576" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gráfico</span></span>
<span id="cb90-577"><a href="#cb90-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-578"><a href="#cb90-578" aria-hidden="true" tabindex="-1"></a>Uma boa apresentação gráfica complementa o relatório dos resultados. Pode-se fazer isso com gráfico de barras empilhadas (), acompanhado dos percentuais e do tipo de teste realizado, usando a função <span class="in">`get_test_label()`</span> que necessita do teste calculado com a função <span class="in">`chisq_test()`</span> do pacote <span class="in">`rstatix`</span>, apresentado antes. O gráfico assume o aspecto da @fig-fumobp1):</span>
<span id="cb90-579"><a href="#cb90-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-582"><a href="#cb90-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-583"><a href="#cb90-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fumobp1</span></span>
<span id="cb90-584"><a href="#cb90-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb90-585"><a href="#cb90-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-586"><a href="#cb90-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-587"><a href="#cb90-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-588"><a href="#cb90-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-589"><a href="#cb90-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-590"><a href="#cb90-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Gráfico de barras empilhadas: tabagismo vs baixo peso ao nascer"</span></span>
<span id="cb90-591"><a href="#cb90-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-592"><a href="#cb90-592" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados) <span class="sc">+</span></span>
<span id="cb90-593"><a href="#cb90-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span> (<span class="at">x =</span> fumo, <span class="at">fill =</span> baixoPeso) <span class="sc">+</span></span>
<span id="cb90-594"><a href="#cb90-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span> (<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb90-595"><a href="#cb90-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"gray95"</span>)) <span class="sc">+</span></span>
<span id="cb90-596"><a href="#cb90-596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span> (<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb90-597"><a href="#cb90-597" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-598"><a href="#cb90-598" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Tabagismo"</span>,</span>
<span id="cb90-599"><a href="#cb90-599" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb90-600"><a href="#cb90-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="st">"sim"</span>, <span class="at">y=</span><span class="dv">62</span>, <span class="at">label=</span> <span class="st">"24,6% (15,0-36,5)"</span>) <span class="sc">+</span> </span>
<span id="cb90-601"><a href="#cb90-601" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"não"</span>, <span class="at">y=</span><span class="dv">223</span>, <span class="at">label =</span> <span class="st">"8,2% (5,0-12,5)"</span>) <span class="sc">+</span></span>
<span id="cb90-602"><a href="#cb90-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span> () <span class="sc">+</span></span>
<span id="cb90-603"><a href="#cb90-603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb90-604"><a href="#cb90-604" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Peso ao nascer &lt; 2500g"</span>)</span>
<span id="cb90-605"><a href="#cb90-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-606"><a href="#cb90-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-607"><a href="#cb90-607" aria-hidden="true" tabindex="-1"></a><span class="fu">### Teste Aderência ou do Melhor Ajuste</span></span>
<span id="cb90-608"><a href="#cb90-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-609"><a href="#cb90-609" aria-hidden="true" tabindex="-1"></a>O teste de qualidade de ajuste do qui-quadrado (*chi-square goodness of fit*) é usado para comparar a distribuição observada com uma distribuição esperada, em uma situação em que se tem duas ou mais categorias em dados discretos. Em outras palavras, ele compara várias proporções observadas com as probabilidades esperadas @daniel2013chisquare.</span>
<span id="cb90-610"><a href="#cb90-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-611"><a href="#cb90-611" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dados usados no exemplo</span></span>
<span id="cb90-612"><a href="#cb90-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-613"><a href="#cb90-613" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb90-614"><a href="#cb90-614" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb90-615"><a href="#cb90-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-616"><a href="#cb90-616" aria-hidden="true" tabindex="-1"></a>Há uma dúvida se o número de pacientes que procura uma determinada Unidade de Pronto Atendimento (UPA) é aproximadamente o mesmo em todos os dias da semana. Esta é uma informação importante sob o ponto de vista administrativo. Para se atingir este objetivo registrou-se o número de pacientes que procurou a UPA por dia da semana.</span>
<span id="cb90-617"><a href="#cb90-617" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-618"><a href="#cb90-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-619"><a href="#cb90-619" aria-hidden="true" tabindex="-1"></a>O número de atendimentos nos sete dias (de segunda-feira à domingo) da semana está representada pela *frequência observada*, <span class="in">`freq_obs`</span>:</span>
<span id="cb90-620"><a href="#cb90-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-623"><a href="#cb90-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-624"><a href="#cb90-624" aria-hidden="true" tabindex="-1"></a>freq_obs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">33</span>, <span class="dv">36</span>)</span>
<span id="cb90-625"><a href="#cb90-625" aria-hidden="true" tabindex="-1"></a>freq_obs</span>
<span id="cb90-626"><a href="#cb90-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-627"><a href="#cb90-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-628"><a href="#cb90-628" aria-hidden="true" tabindex="-1"></a>O total de atendimentos durante uma semana é igual a:</span>
<span id="cb90-629"><a href="#cb90-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-632"><a href="#cb90-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-633"><a href="#cb90-633" aria-hidden="true" tabindex="-1"></a>soma <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_obs)</span>
<span id="cb90-634"><a href="#cb90-634" aria-hidden="true" tabindex="-1"></a>soma</span>
<span id="cb90-635"><a href="#cb90-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-636"><a href="#cb90-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-637"><a href="#cb90-637" aria-hidden="true" tabindex="-1"></a>Assim, a frequência esperada diária é igual a soma total dos atendimentos dividido pelo número observações (no caso, dias da semana), representada por <span class="in">`k`</span>:</span>
<span id="cb90-638"><a href="#cb90-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-641"><a href="#cb90-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-642"><a href="#cb90-642" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb90-643"><a href="#cb90-643" aria-hidden="true" tabindex="-1"></a>freq_esp <span class="ot">&lt;-</span> soma<span class="sc">/</span>k</span>
<span id="cb90-644"><a href="#cb90-644" aria-hidden="true" tabindex="-1"></a>freq_esp</span>
<span id="cb90-645"><a href="#cb90-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-646"><a href="#cb90-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-647"><a href="#cb90-647" aria-hidden="true" tabindex="-1"></a>Com esses valores , pode-se criar um vetor, <span class="in">`p`</span>, com as proporções dos atendimentos diários esperados:</span>
<span id="cb90-648"><a href="#cb90-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-651"><a href="#cb90-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-652"><a href="#cb90-652" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rep</span>(freq_esp<span class="sc">/</span>soma, <span class="dv">7</span>)</span>
<span id="cb90-653"><a href="#cb90-653" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb90-654"><a href="#cb90-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-655"><a href="#cb90-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-656"><a href="#cb90-656" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hipóteses estatísticas</span></span>
<span id="cb90-657"><a href="#cb90-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-658"><a href="#cb90-658" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: a distribuição das frequências observadas (O) é igual a distribuição de frequências esperadas (E).</span></span>
<span id="cb90-659"><a href="#cb90-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-660"><a href="#cb90-660" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: a distribuição das frequências observadas (O) não é igual a distribuição de frequências esperadas (E)</span></span>
<span id="cb90-661"><a href="#cb90-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-662"><a href="#cb90-662" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo da estatística do teste</span></span>
<span id="cb90-663"><a href="#cb90-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-664"><a href="#cb90-664" aria-hidden="true" tabindex="-1"></a>Assumindo um $\alpha = 0,05$. Os graus de liberdade são calculados como o número de células (*k*) menos 1: $gl = (k - 1)$. O $\chi^{2}_{crítico}$ pode ser encontrado usando:</span>
<span id="cb90-665"><a href="#cb90-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-668"><a href="#cb90-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-669"><a href="#cb90-669" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb90-670"><a href="#cb90-670" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb90-671"><a href="#cb90-671" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb90-672"><a href="#cb90-672" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span> (<span class="dv">1</span> <span class="sc">-</span> alpha, gl)</span>
<span id="cb90-673"><a href="#cb90-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-674"><a href="#cb90-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-675"><a href="#cb90-675" aria-hidden="true" tabindex="-1"></a>Em outras palavras, se o $\chi^{2}_{calculado}$ \&gt; $\chi^{2}_{crítico}$, rejeita-se a $H_{0}$. Na @fig-chi126), o resultado tem que ficar à direita da linha vertical vermelha para que a hipótese nula seja rejeitada. Se cair fora da área de rejeição, à esquerda da linha vertical vermelha, aceita-se a hipóteses nula.</span>
<span id="cb90-676"><a href="#cb90-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-679"><a href="#cb90-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-680"><a href="#cb90-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-chi126</span></span>
<span id="cb90-681"><a href="#cb90-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb90-682"><a href="#cb90-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-683"><a href="#cb90-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-684"><a href="#cb90-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-685"><a href="#cb90-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-686"><a href="#cb90-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-687"><a href="#cb90-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribuição do qui-quadrado, gl = 6, alpha = 0,05"</span></span>
<span id="cb90-688"><a href="#cb90-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-689"><a href="#cb90-689" aria-hidden="true" tabindex="-1"></a><span class="fu">plotchisqtest</span>(<span class="at">chisq =</span> <span class="fl">12.6</span>, </span>
<span id="cb90-690"><a href="#cb90-690" aria-hidden="true" tabindex="-1"></a>              <span class="at">df =</span> <span class="dv">6</span>,</span>
<span id="cb90-691"><a href="#cb90-691" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorleft =</span> <span class="st">"aliceblue"</span>,</span>
<span id="cb90-692"><a href="#cb90-692" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorright =</span> <span class="st">"red"</span>,</span>
<span id="cb90-693"><a href="#cb90-693" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylabel =</span> <span class="st">"Densidade de probabilidade"</span>,</span>
<span id="cb90-694"><a href="#cb90-694" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorcut =</span> <span class="st">"red"</span>)</span>
<span id="cb90-695"><a href="#cb90-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-696"><a href="#cb90-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-697"><a href="#cb90-697" aria-hidden="true" tabindex="-1"></a>A estatística do teste pode ser encontrada, usando a função <span class="in">`chisq.test()`</span>:</span>
<span id="cb90-698"><a href="#cb90-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-701"><a href="#cb90-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-702"><a href="#cb90-702" aria-hidden="true" tabindex="-1"></a>teste1 <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">chisq_test</span> (<span class="at">x =</span> freq_obs, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">p =</span> p)</span>
<span id="cb90-703"><a href="#cb90-703" aria-hidden="true" tabindex="-1"></a>teste1</span>
<span id="cb90-704"><a href="#cb90-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-705"><a href="#cb90-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-706"><a href="#cb90-706" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conclusão</span></span>
<span id="cb90-707"><a href="#cb90-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-708"><a href="#cb90-708" aria-hidden="true" tabindex="-1"></a>Observando-se a saída do teste do qui-quadrado, verifica-se que o $\chi^{2}_{calculado}$ \&lt; $\chi^{2}_{crítico}$, portanto, não se rejeita a $H_{0}$ e conclui-se que, nesta amostra, com uma confiança de 95%, que a frequência observada de pacientes à UPA é igual a esperada (*P* = `r teste1$p`). Lembrando que, neste caso, como se tem um valor *P* limitrofe, marginal, existe a possibilidade de se estar aceitando uma $H_{0}$ falsa e cometendo um erro tipo II. Seria recomendado, aumentar o tamanho amostral em uma nova coleta, usando estes dados como um piloto para o cálculo amostral.</span>
<span id="cb90-709"><a href="#cb90-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-710"><a href="#cb90-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Qui-quadrado de Pearson para tabelas extensas {#sec-tabextensas}</span></span>
<span id="cb90-711"><a href="#cb90-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-712"><a href="#cb90-712" aria-hidden="true" tabindex="-1"></a>Este teste é utilizado quando o número de grupos, k, é superior a 2.</span>
<span id="cb90-713"><a href="#cb90-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-714"><a href="#cb90-714" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dados usados como exemplo {#sec-dadosCirurgia}</span></span>
<span id="cb90-715"><a href="#cb90-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-716"><a href="#cb90-716" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb90-717"><a href="#cb90-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb90-718"><a href="#cb90-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-719"><a href="#cb90-719" aria-hidden="true" tabindex="-1"></a>Em um hospital pediátrico, 144 recém-nascidos foram submetidos a diferentes procedimentos cirúrgicos (abdominal, cardíaco ou outro). Os cirurgiões estavam preocupados em saber se há uma tendência de maior taxa de indecção entreos neonatos que permanecem mais tempo hospitalizados.</span>
<span id="cb90-720"><a href="#cb90-720" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-721"><a href="#cb90-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-722"><a href="#cb90-722" aria-hidden="true" tabindex="-1"></a>O banco de dados <span class="in">`dadosCirurgia.xlsx`</span> que pode ser encontrado <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosCirurgia.xlsx)</span>. Salve o mesmo no seu diretório de trabalho. As variáveis disponíveis no banco de dados são:</span>
<span id="cb90-723"><a href="#cb90-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-724"><a href="#cb90-724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**id** $\to$ identificação do neonato;</span>
<span id="cb90-725"><a href="#cb90-725" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**sexo** $\to$ sexo do recém-nascido, <span class="in">`fem`</span> e <span class="in">`masc`</span>;</span>
<span id="cb90-726"><a href="#cb90-726" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**peso** $\to$ peso do neonato em gramas;</span>
<span id="cb90-727"><a href="#cb90-727" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**tempohosp** $\to$ tempo de hospitalização em dias;</span>
<span id="cb90-728"><a href="#cb90-728" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**infec** $\to$ presença de infecção secundária: sim e não;</span>
<span id="cb90-729"><a href="#cb90-729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**cirurgia** $\to$ tipo de cirurgia: abdominal, cardíaca, outra.</span>
<span id="cb90-730"><a href="#cb90-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-731"><a href="#cb90-731" aria-hidden="true" tabindex="-1"></a>A variável tempo de hospitalização (<span class="in">`tempohosp`</span>) é contínua e assimétrica. Para ser usada aqui, será categorizada por quartis. A variável <span class="in">`infec`</span> (presença de infecção) é uma variável dicotômica (<span class="in">`sim`</span>, <span class="in">`não`</span>).</span>
<span id="cb90-732"><a href="#cb90-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-733"><a href="#cb90-733" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Leitura e transformação dos dados</span></span>
<span id="cb90-734"><a href="#cb90-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-735"><a href="#cb90-735" aria-hidden="true" tabindex="-1"></a>A leitura dos dados pode ser feita com:</span>
<span id="cb90-736"><a href="#cb90-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-739"><a href="#cb90-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-740"><a href="#cb90-740" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosCirurgia.xlsx"</span>)</span>
<span id="cb90-741"><a href="#cb90-741" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cirurgia)</span>
<span id="cb90-742"><a href="#cb90-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-743"><a href="#cb90-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-744"><a href="#cb90-744" aria-hidden="true" tabindex="-1"></a>Os dados foram atribuídos a um objeto denominado de <span class="in">`cirurgia`</span>. Característicamente, a variável <span class="in">`tempohosp`</span> (tempo de hospitalização) é assimétrica (@fig-tempohosp):</span>
<span id="cb90-745"><a href="#cb90-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-748"><a href="#cb90-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-749"><a href="#cb90-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tempohosp</span></span>
<span id="cb90-750"><a href="#cb90-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-751"><a href="#cb90-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-752"><a href="#cb90-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb90-753"><a href="#cb90-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "70%"</span></span>
<span id="cb90-754"><a href="#cb90-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "70%"</span></span>
<span id="cb90-755"><a href="#cb90-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Distribuição da variável tempo de hospitalização"</span></span>
<span id="cb90-756"><a href="#cb90-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-757"><a href="#cb90-757" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb90-758"><a href="#cb90-758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> tempohosp,</span>
<span id="cb90-759"><a href="#cb90-759" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb90-760"><a href="#cb90-760" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"tomato"</span>,</span>
<span id="cb90-761"><a href="#cb90-761" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb90-762"><a href="#cb90-762" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"gray40"</span>,<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb90-763"><a href="#cb90-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun=</span>dnorm,</span>
<span id="cb90-764"><a href="#cb90-764" aria-hidden="true" tabindex="-1"></a>                <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">na.rm =</span> T),</span>
<span id="cb90-765"><a href="#cb90-765" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd=</span> <span class="fu">sd</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">na.rm =</span> T)), </span>
<span id="cb90-766"><a href="#cb90-766" aria-hidden="true" tabindex="-1"></a>                <span class="at">col=</span><span class="st">'dodgerblue4'</span>,</span>
<span id="cb90-767"><a href="#cb90-767" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd=</span><span class="dv">1</span>,</span>
<span id="cb90-768"><a href="#cb90-768" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb90-769"><a href="#cb90-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Tempo de hospitalização (dias)'</span>,    </span>
<span id="cb90-770"><a href="#cb90-770" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">'Densidade de probabilidade'</span>) <span class="sc">+</span></span>
<span id="cb90-771"><a href="#cb90-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb90-772"><a href="#cb90-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-773"><a href="#cb90-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-774"><a href="#cb90-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-775"><a href="#cb90-775" aria-hidden="true" tabindex="-1"></a>A variável <span class="in">`tempohosp`</span> será categorizada em quartis. O resumo da mesma, usando a função <span class="in">`summary()`</span>, fornece orientação para esse procedimento com o retorno do 1º quartil, mediana e 3º quartil:</span>
<span id="cb90-776"><a href="#cb90-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-779"><a href="#cb90-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-780"><a href="#cb90-780" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (cirurgia<span class="sc">$</span>tempohosp)</span>
<span id="cb90-781"><a href="#cb90-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-782"><a href="#cb90-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-783"><a href="#cb90-783" aria-hidden="true" tabindex="-1"></a>A categorização da variável <span class="in">`tempohosp`</span>, que será realizada, usando a função <span class="in">`cut()`</span>, consulte a @sec-freq para detalhes de construção de uma tabela de frequência:</span>
<span id="cb90-784"><a href="#cb90-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-787"><a href="#cb90-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-788"><a href="#cb90-788" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>tempo <span class="ot">&lt;-</span> <span class="fu">cut</span>(cirurgia<span class="sc">$</span>tempohosp, </span>
<span id="cb90-789"><a href="#cb90-789" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">20.75</span>, <span class="fl">27.50</span>, <span class="fl">42.00</span>, <span class="dv">245</span>),</span>
<span id="cb90-790"><a href="#cb90-790" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;= 21"</span>,<span class="st">"22-28"</span>, <span class="st">"29-42"</span>,<span class="st">"&gt;42"</span>),</span>
<span id="cb90-791"><a href="#cb90-791" aria-hidden="true" tabindex="-1"></a>                      <span class="at">right =</span> <span class="cn">FALSE</span>, </span>
<span id="cb90-792"><a href="#cb90-792" aria-hidden="true" tabindex="-1"></a>                      <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-793"><a href="#cb90-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-794"><a href="#cb90-794" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span> (cirurgia<span class="sc">$</span>tempo)</span>
<span id="cb90-795"><a href="#cb90-795" aria-hidden="true" tabindex="-1"></a>tab1</span>
<span id="cb90-796"><a href="#cb90-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-797"><a href="#cb90-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-798"><a href="#cb90-798" aria-hidden="true" tabindex="-1"></a>Por exemplo, 36 recém-nascidos premaneceram 21 dias ou menos no pós-operatório e 37 recém-nascidos ficarm internados mais do que 42 dias.</span>
<span id="cb90-799"><a href="#cb90-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-800"><a href="#cb90-800" aria-hidden="true" tabindex="-1"></a>Agora, a variável <span class="in">`cirurgia$infec`</span> será colocada como um fator:</span>
<span id="cb90-801"><a href="#cb90-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-804"><a href="#cb90-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-805"><a href="#cb90-805" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>infec <span class="ot">&lt;-</span> <span class="fu">factor</span>(cirurgia<span class="sc">$</span>infec, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb90-806"><a href="#cb90-806" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cirurgia<span class="sc">$</span>infec)</span>
<span id="cb90-807"><a href="#cb90-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-808"><a href="#cb90-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-809"><a href="#cb90-809" aria-hidden="true" tabindex="-1"></a>A nova variável <span class="in">`tempo`</span> será cruzada com a variável <span class="in">`infec`</span> em uma tabela:</span>
<span id="cb90-810"><a href="#cb90-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-813"><a href="#cb90-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-814"><a href="#cb90-814" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> cirurgia, <span class="fu">table</span>(tempo, infec))</span>
<span id="cb90-815"><a href="#cb90-815" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab2)</span>
<span id="cb90-816"><a href="#cb90-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-817"><a href="#cb90-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-818"><a href="#cb90-818" aria-hidden="true" tabindex="-1"></a>Ou seja, a proporção de recém-nascidos que se infectaram no pós-operatório foi 56/144 = 0,39 ou 39%. Se for calculada a proporção para cada um dos quartis do tempo de hospitalização, através da função <span class="in">`ctable()`</span> do pacote <span class="in">`summarytools`</span>, observa-se que a proporção de neonatos infectados no pós-operatório aumenta com o tempo de hospitalização:</span>
<span id="cb90-819"><a href="#cb90-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-820"><a href="#cb90-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tabext, echo=FALSE, message=FALSE}</span></span>
<span id="cb90-821"><a href="#cb90-821" aria-hidden="true" tabindex="-1"></a> tab3 <span class="ot">&lt;-</span> summarytools<span class="sc">::</span><span class="fu">ctable</span>(cirurgia<span class="sc">$</span>tempo, cirurgia<span class="sc">$</span>infec,</span>
<span id="cb90-822"><a href="#cb90-822" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prop =</span> <span class="st">"r"</span>,</span>
<span id="cb90-823"><a href="#cb90-823" aria-hidden="true" tabindex="-1"></a>                      <span class="at">headings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-824"><a href="#cb90-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-825"><a href="#cb90-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-826"><a href="#cb90-826" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hipóteses estatísticas</span></span>
<span id="cb90-827"><a href="#cb90-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-828"><a href="#cb90-828" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: A presença de infecção não altera o tempo de hospitalização.</span></span>
<span id="cb90-829"><a href="#cb90-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-830"><a href="#cb90-830" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: A presença de infecção altera o tempo de hospitalização.</span></span>
<span id="cb90-831"><a href="#cb90-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-832"><a href="#cb90-832" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cálculo da estatística do teste</span></span>
<span id="cb90-833"><a href="#cb90-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-834"><a href="#cb90-834" aria-hidden="true" tabindex="-1"></a>O teste estatístico pode ser calculado, usando o argumento <span class="in">`chisq = TRUE`</span> na função <span class="in">`ctable()`</span>:</span>
<span id="cb90-835"><a href="#cb90-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-838"><a href="#cb90-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-839"><a href="#cb90-839" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">ctable</span>(cirurgia<span class="sc">$</span>tempo, cirurgia<span class="sc">$</span>infec,</span>
<span id="cb90-840"><a href="#cb90-840" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prop =</span> <span class="st">"r"</span>,</span>
<span id="cb90-841"><a href="#cb90-841" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chisq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-842"><a href="#cb90-842" aria-hidden="true" tabindex="-1"></a>                      <span class="at">headings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-843"><a href="#cb90-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-844"><a href="#cb90-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-845"><a href="#cb90-845" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conclusão</span></span>
<span id="cb90-846"><a href="#cb90-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-847"><a href="#cb90-847" aria-hidden="true" tabindex="-1"></a>A partir desses resultados, pode-se inferir que a menor taxa de infecção ocorre no grupo do primeiro quartil e é significativamente diferente em relação a taxa de infecção do maior quartil, mas sem indicação para os grupos intermediários. É útil fazer o teste de tendência linear (*Linear-by-linear Association*). Para isso, pode-se usar a função <span class="in">`lbl_test ()`</span> do pacote <span class="in">`coin`</span>.</span>
<span id="cb90-848"><a href="#cb90-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-851"><a href="#cb90-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-852"><a href="#cb90-852" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">lbl_test</span> (cirurgia<span class="sc">$</span>tempo <span class="sc">~</span> cirurgia<span class="sc">$</span>infec)</span>
<span id="cb90-853"><a href="#cb90-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-854"><a href="#cb90-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-855"><a href="#cb90-855" aria-hidden="true" tabindex="-1"></a>Este teste indica uma tendência significativa para a presença de infecção à medida que aumenta o tempo de hospitalização (*P* = 0,0018).</span>
<span id="cb90-856"><a href="#cb90-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-857"><a href="#cb90-857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teste exato de Fisher</span></span>
<span id="cb90-858"><a href="#cb90-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-859"><a href="#cb90-859" aria-hidden="true" tabindex="-1"></a>O teste do qui-quadrado não é um método apropriado de análise se a amostra é pequena. Por exemplo, se *n* for menor que 20 ou se *n* estiver entre 20 e 40 e uma das frequências esperadas for menor que 5, o teste do qui-quadrado deve ser evitado. Nesta situação, é recomendado o **teste exato de Fisher**.</span>
<span id="cb90-860"><a href="#cb90-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-861"><a href="#cb90-861" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados como exemplo</span></span>
<span id="cb90-862"><a href="#cb90-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-863"><a href="#cb90-863" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb90-864"><a href="#cb90-864" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb90-865"><a href="#cb90-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-866"><a href="#cb90-866" aria-hidden="true" tabindex="-1"></a>Um estudo estabeleceu como objetivo verificar se a asma não controlada é um fator de risco para a procura da emergência. Foram acompanhados 16 escolares asmáticos durante um ano com relação ao número de visitas à emergência de acordo com o controle da sua asma.</span>
<span id="cb90-867"><a href="#cb90-867" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-868"><a href="#cb90-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-869"><a href="#cb90-869" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Entrando com os dados</span></span>
<span id="cb90-870"><a href="#cb90-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-871"><a href="#cb90-871" aria-hidden="true" tabindex="-1"></a>Em primeiro lugar, serão criadas duas variáveis:</span>
<span id="cb90-872"><a href="#cb90-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-875"><a href="#cb90-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-876"><a href="#cb90-876" aria-hidden="true" tabindex="-1"></a>emerg <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb90-877"><a href="#cb90-877" aria-hidden="true" tabindex="-1"></a>controle <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb90-878"><a href="#cb90-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-879"><a href="#cb90-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-880"><a href="#cb90-880" aria-hidden="true" tabindex="-1"></a>A seguir, usando essas variáveis, será construído um dataframe que será atribuído ao objeto <span class="in">`dadosAsma`</span>:</span>
<span id="cb90-881"><a href="#cb90-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-884"><a href="#cb90-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-885"><a href="#cb90-885" aria-hidden="true" tabindex="-1"></a>dadosAsma <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(emerg, controle)</span>
<span id="cb90-886"><a href="#cb90-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-887"><a href="#cb90-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-888"><a href="#cb90-888" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Transformação dos dados</span></span>
<span id="cb90-889"><a href="#cb90-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-890"><a href="#cb90-890" aria-hidden="true" tabindex="-1"></a>Ambas as variáveis são numéricas e serão transformadas em fatores, considerando para a variável <span class="in">`emerg`</span>, 1 = "consultou" e 2 = "não consultou", e, para a variável controle, 1 = "asma controlada" e 2 = "asma não controlada". É importante mater a ordem:</span>
<span id="cb90-891"><a href="#cb90-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-894"><a href="#cb90-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-895"><a href="#cb90-895" aria-hidden="true" tabindex="-1"></a>dadosAsma<span class="sc">$</span>emerg <span class="ot">&lt;-</span> <span class="fu">factor</span> (dadosAsma<span class="sc">$</span>emerg,</span>
<span id="cb90-896"><a href="#cb90-896" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb90-897"><a href="#cb90-897" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span> (<span class="st">'consultou'</span>, <span class="st">'não consultou'</span>))</span>
<span id="cb90-898"><a href="#cb90-898" aria-hidden="true" tabindex="-1"></a>dadosAsma<span class="sc">$</span>controle <span class="ot">&lt;-</span> <span class="fu">factor</span> (dadosAsma<span class="sc">$</span>controle, </span>
<span id="cb90-899"><a href="#cb90-899" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb90-900"><a href="#cb90-900" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span> (<span class="st">'asma controlada'</span>, <span class="st">'não controlada'</span>))</span>
<span id="cb90-901"><a href="#cb90-901" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosAsma)</span>
<span id="cb90-902"><a href="#cb90-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-903"><a href="#cb90-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-904"><a href="#cb90-904" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Construção da tabela</span></span>
<span id="cb90-905"><a href="#cb90-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-906"><a href="#cb90-906" aria-hidden="true" tabindex="-1"></a>Para o cálculo da estatística do teste, é necessário uma tabela $2\times2$ (@tbl-rafisher), obtida com os dados acima:</span>
<span id="cb90-907"><a href="#cb90-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-910"><a href="#cb90-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-911"><a href="#cb90-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb90-912"><a href="#cb90-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: "hide"</span></span>
<span id="cb90-913"><a href="#cb90-913" aria-hidden="true" tabindex="-1"></a>tab3 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> dadosAsma, <span class="fu">table</span>(controle, emerg))</span>
<span id="cb90-914"><a href="#cb90-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-915"><a href="#cb90-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-918"><a href="#cb90-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-919"><a href="#cb90-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-rafisher</span></span>
<span id="cb90-920"><a href="#cb90-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-921"><a href="#cb90-921" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-922"><a href="#cb90-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb90-923"><a href="#cb90-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Consulta à emergência e controle da asma (tab3)"</span></span>
<span id="cb90-924"><a href="#cb90-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-925"><a href="#cb90-925" aria-hidden="true" tabindex="-1"></a>Controle <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Asma controlada"</span>, <span class="st">"Não controlada"</span>, <span class="st">"Total"</span>)</span>
<span id="cb90-926"><a href="#cb90-926" aria-hidden="true" tabindex="-1"></a>Emerg_sim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb90-927"><a href="#cb90-927" aria-hidden="true" tabindex="-1"></a>Emerg_nao <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb90-928"><a href="#cb90-928" aria-hidden="true" tabindex="-1"></a>Total <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">16</span>)</span>
<span id="cb90-929"><a href="#cb90-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-930"><a href="#cb90-930" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Controle, Emerg_sim, Emerg_nao, Total)</span>
<span id="cb90-931"><a href="#cb90-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-932"><a href="#cb90-932" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-933"><a href="#cb90-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb90-934"><a href="#cb90-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">Controle =</span> <span class="st">"Controle"</span>,</span>
<span id="cb90-935"><a href="#cb90-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">Emerg_sim =</span> <span class="st">"Sim"</span>,</span>
<span id="cb90-936"><a href="#cb90-936" aria-hidden="true" tabindex="-1"></a>    <span class="at">Emerg_nao =</span> <span class="st">"Não"</span>,</span>
<span id="cb90-937"><a href="#cb90-937" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-938"><a href="#cb90-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-939"><a href="#cb90-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Visita à Emergência"</span>, <span class="st">""</span>),</span>
<span id="cb90-940"><a href="#cb90-940" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-941"><a href="#cb90-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-942"><a href="#cb90-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-943"><a href="#cb90-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-944"><a href="#cb90-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-945"><a href="#cb90-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-946"><a href="#cb90-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-947"><a href="#cb90-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-948"><a href="#cb90-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-949"><a href="#cb90-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">part =</span> <span class="st">"body"</span>, </span>
<span id="cb90-950"><a href="#cb90-950" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.3</span>)) </span>
<span id="cb90-951"><a href="#cb90-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-952"><a href="#cb90-952" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb90-953"><a href="#cb90-953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-954"><a href="#cb90-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-955"><a href="#cb90-955" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hipóteses estatísticas</span></span>
<span id="cb90-956"><a href="#cb90-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-957"><a href="#cb90-957" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_0$: as variáveis são independentes, não há relação entre as duas variáveis categóricas.</span></span>
<span id="cb90-958"><a href="#cb90-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-959"><a href="#cb90-959" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_1$: as variáveis são dependentes, existe uma relação entre as duas variáveis categóricas. </span><span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span></span>
<span id="cb90-960"><a href="#cb90-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-961"><a href="#cb90-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cálculo da estatística do teste</span></span>
<span id="cb90-962"><a href="#cb90-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-963"><a href="#cb90-963" aria-hidden="true" tabindex="-1"></a>O teste exato de Fisher é usado quando há pelo menos uma célula na tabela de contingência das frequências esperadas abaixo de 5. Para recuperar as frequências esperadas, use a função <span class="in">`chisq.test()`</span>, do *R* base, junto com <span class="in">`$expected`</span>:</span>
<span id="cb90-964"><a href="#cb90-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-967"><a href="#cb90-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-968"><a href="#cb90-968" aria-hidden="true" tabindex="-1"></a>teste2 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tab3)</span>
<span id="cb90-969"><a href="#cb90-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-970"><a href="#cb90-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-971"><a href="#cb90-971" aria-hidden="true" tabindex="-1"></a>A saída do teste imprime um aviso de que o qui-quadrado pode estar incorreto. Há necessidade, devido a presença de três células com valores abaixo de 5, de se usar o teste de Fisher. este pode ser obtido através da função <span class="in">`fisher_test()`</span>, do pacote <span class="in">`rstatix`</span>, colocando uma tabela $2\times2$ como argumento, <span class="in">`tab3`</span>:</span>
<span id="cb90-972"><a href="#cb90-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-975"><a href="#cb90-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-976"><a href="#cb90-976" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">fisher_test</span> (tab3, <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-977"><a href="#cb90-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-978"><a href="#cb90-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-979"><a href="#cb90-979" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb90-980"><a href="#cb90-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-981"><a href="#cb90-981" aria-hidden="true" tabindex="-1"></a>O valor $P=0,035$ é menor que o nível de significância de 5%, previamente estabelecido, e, portanto, deve-se rejeitar a hipótese nula. No contexto, rejeitar a hipótese nula para o teste exato de independência de Fisher significa que há uma associação significativa entre as duas variáveis categóricas (controle da asma e visitas à emergência).</span>
<span id="cb90-982"><a href="#cb90-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-983"><a href="#cb90-983" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teste de McNemar</span></span>
<span id="cb90-984"><a href="#cb90-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-985"><a href="#cb90-985" aria-hidden="true" tabindex="-1"></a>É um teste estatístico não paramétrico aplicável nos estudos tipo “antes-e-depois” em que cada indivíduo é utilizado como seu próprio controle e a medida é efetuada em escala nominal. O *teste de McNemar* é usado para determinar se há uma diferença estatisticamente significativa nas proporções entre os dados emparelhados.</span>
<span id="cb90-986"><a href="#cb90-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-987"><a href="#cb90-987" aria-hidden="true" tabindex="-1"></a>As medidas coletadas nesses tipos de projetos de estudo não são independentes e, portanto, os testes do Qui-quadrado não podem ser usados porque os pressupostos serão violados.</span>
<span id="cb90-988"><a href="#cb90-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-989"><a href="#cb90-989" aria-hidden="true" tabindex="-1"></a>O teste de McNemar é usado para avaliar se há uma mudança significativa nas proporções ao longo do tempo para dados emparelhados ou se há uma diferença significativa nas proporções entre casos e controles. O resultado de interesse é a mudança dentro da pessoa (ou diferenças dentro do par) e não há variáveis explicativas.</span>
<span id="cb90-990"><a href="#cb90-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-991"><a href="#cb90-991" aria-hidden="true" tabindex="-1"></a>O teste é calculado examinando o número de respostas que são *concordantes* para positivo (sim em ambas as ocasiões) e negativo (não em ambas as ocasiões) e o número de pares *disconcordantes* (sim e não, ou não e sim). Os pares concordantes não fornecem informações sobre as diferenças e não são usados na avaliação. Em vez disso, deve-se concentrar nos pares discordantes, que podem ser divididos em dois tipos: um par discordante do tipo *sim – não* e um par discordante tipo *não – sim* @eliasziw1991application.</span>
<span id="cb90-992"><a href="#cb90-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-993"><a href="#cb90-993" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pressupostos do teste de McNemar</span></span>
<span id="cb90-994"><a href="#cb90-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-995"><a href="#cb90-995" aria-hidden="true" tabindex="-1"></a>Os pressupostos para o teste de McNemar são:</span>
<span id="cb90-996"><a href="#cb90-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-997"><a href="#cb90-997" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A variável desfecho é binária, dicotômica;</span>
<span id="cb90-998"><a href="#cb90-998" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Cada participante é representado na tabela apenas uma vez;</span>
<span id="cb90-999"><a href="#cb90-999" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>A diferença entre as proporções emparelhadas é o resultado de interesse;</span>
<span id="cb90-1000"><a href="#cb90-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>O teste de McNemar pode não ser confiável se houver contagens baixas nas células "discordantes". Existe recomendação de que a soma dessas células seja $\ge 20$ @rosner2011mcnemar.</span>
<span id="cb90-1001"><a href="#cb90-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1002"><a href="#cb90-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dados usados como exemplo</span></span>
<span id="cb90-1003"><a href="#cb90-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1004"><a href="#cb90-1004" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb90-1005"><a href="#cb90-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cenário</span></span>
<span id="cb90-1006"><a href="#cb90-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1007"><a href="#cb90-1007" aria-hidden="true" tabindex="-1"></a>Em uma universidade, um professor de bioestatística comparou as atitudes de 200 estudantes de Medicina em relação à confiança que eles depositam na análise estatística antes e depois da conclusão da disciplina. A pergunta feita foi: Confiam na análise estatística utilizada nos periódicos médicos?</span>
<span id="cb90-1008"><a href="#cb90-1008" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb90-1009"><a href="#cb90-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1010"><a href="#cb90-1010" aria-hidden="true" tabindex="-1"></a>As respostas obtidas estão na @tbl-tabmcnemar:</span>
<span id="cb90-1011"><a href="#cb90-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1014"><a href="#cb90-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1015"><a href="#cb90-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tabmcnemar</span></span>
<span id="cb90-1016"><a href="#cb90-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb90-1017"><a href="#cb90-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: FALSE</span></span>
<span id="cb90-1018"><a href="#cb90-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb90-1019"><a href="#cb90-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Confiança na análise estatística após término da disciplina"</span></span>
<span id="cb90-1020"><a href="#cb90-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1021"><a href="#cb90-1021" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Sim"</span>, <span class="st">"Não"</span>, <span class="st">"Total"</span>)</span>
<span id="cb90-1022"><a href="#cb90-1022" aria-hidden="true" tabindex="-1"></a>pos_sim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"20 (a)"</span>, <span class="st">"22 (c)"</span>, <span class="st">"42"</span>)</span>
<span id="cb90-1023"><a href="#cb90-1023" aria-hidden="true" tabindex="-1"></a>pos_nao <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"8 (b)"</span>, <span class="st">"150 (d)"</span>, <span class="st">"158"</span>)</span>
<span id="cb90-1024"><a href="#cb90-1024" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">172</span>, <span class="dv">200</span>)</span>
<span id="cb90-1025"><a href="#cb90-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1026"><a href="#cb90-1026" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pre, pos_sim, pos_nao, total)</span>
<span id="cb90-1027"><a href="#cb90-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1028"><a href="#cb90-1028" aria-hidden="true" tabindex="-1"></a>minha_tab <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-1029"><a href="#cb90-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-1030"><a href="#cb90-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb90-1031"><a href="#cb90-1031" aria-hidden="true" tabindex="-1"></a>    <span class="at">pre =</span> <span class="st">"Pré-Teste"</span>,</span>
<span id="cb90-1032"><a href="#cb90-1032" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos_sim =</span> <span class="st">"Sim"</span>,</span>
<span id="cb90-1033"><a href="#cb90-1033" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos_nao =</span> <span class="st">"Não"</span>,</span>
<span id="cb90-1034"><a href="#cb90-1034" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="st">"Total"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-1035"><a href="#cb90-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-1036"><a href="#cb90-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Pós-teste"</span>, <span class="st">""</span>),</span>
<span id="cb90-1037"><a href="#cb90-1037" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-1038"><a href="#cb90-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-1039"><a href="#cb90-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-1040"><a href="#cb90-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-1041"><a href="#cb90-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-1042"><a href="#cb90-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb90-1043"><a href="#cb90-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-1044"><a href="#cb90-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-1045"><a href="#cb90-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">part =</span> <span class="st">"body"</span>, </span>
<span id="cb90-1046"><a href="#cb90-1046" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.5</span>))</span>
<span id="cb90-1047"><a href="#cb90-1047" aria-hidden="true" tabindex="-1"></a>minha_tab</span>
<span id="cb90-1048"><a href="#cb90-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1049"><a href="#cb90-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1050"><a href="#cb90-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1051"><a href="#cb90-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hipóteses estatísticas</span></span>
<span id="cb90-1052"><a href="#cb90-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1053"><a href="#cb90-1053" aria-hidden="true" tabindex="-1"></a>Considerando as caselas *a*, *b*, *c* e *d* da @tbl-tabmcnemar, a hipótese nula de homogeneidade marginal indica que as duas probabilidades marginais para cada resultado são as mesmas, isto é,</span>
<span id="cb90-1054"><a href="#cb90-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1055"><a href="#cb90-1055" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-1056"><a href="#cb90-1056" aria-hidden="true" tabindex="-1"></a>p_{a} + p_{b} = p_{a} + p_{c}</span>
<span id="cb90-1057"><a href="#cb90-1057" aria-hidden="true" tabindex="-1"></a>$$ e</span>
<span id="cb90-1058"><a href="#cb90-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1059"><a href="#cb90-1059" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-1060"><a href="#cb90-1060" aria-hidden="true" tabindex="-1"></a>p_{c} + p_{d} = p_{b} + p_{d}</span>
<span id="cb90-1061"><a href="#cb90-1061" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-1062"><a href="#cb90-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1063"><a href="#cb90-1063" aria-hidden="true" tabindex="-1"></a>Assim, a hipótese nula e a hipótese alternativa são:</span>
<span id="cb90-1064"><a href="#cb90-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1065"><a href="#cb90-1065" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{0}$: a proporção de alunos que respondem </span><span class="in">`sim`</span><span class="at"> no pré-teste e no pós-teste é a mesma.</span></span>
<span id="cb90-1066"><a href="#cb90-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1067"><a href="#cb90-1067" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_{1}$: a proporção de alunos que respondem </span><span class="in">`sim`</span><span class="at"> no pré-teste e no pós-teste não é a mesma. </span><span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span></span>
<span id="cb90-1068"><a href="#cb90-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1069"><a href="#cb90-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lógica do teste</span></span>
<span id="cb90-1070"><a href="#cb90-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1071"><a href="#cb90-1071" aria-hidden="true" tabindex="-1"></a>O teste estatístico de McNemar, com correção de continuidade, é obtido utilizando a equação:</span>
<span id="cb90-1072"><a href="#cb90-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1073"><a href="#cb90-1073" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-1074"><a href="#cb90-1074" aria-hidden="true" tabindex="-1"></a>\chi^{2} = \frac {\left (\left |b - c  \right |- 1  \right )^{2}}{b + c}</span>
<span id="cb90-1075"><a href="#cb90-1075" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-1076"><a href="#cb90-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1077"><a href="#cb90-1077" aria-hidden="true" tabindex="-1"></a>Sob a hipótese nula, com um número suficientemente grande de discordantes (células *b* e *c*), o $\chi^{2}$ tem uma distribuição qui-quadrado com um grau de liberdade. Se o resultado é significativo, isto é, fornece evidências suficientes para rejeitar a hipótese nula, significa que as proporções marginais são significativamente diferentes umas das outras.</span>
<span id="cb90-1078"><a href="#cb90-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1079"><a href="#cb90-1079" aria-hidden="true" tabindex="-1"></a>Substituindo os dados da Tabela na Equação, tem-se:</span>
<span id="cb90-1080"><a href="#cb90-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1083"><a href="#cb90-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1084"><a href="#cb90-1084" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb90-1085"><a href="#cb90-1085" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb90-1086"><a href="#cb90-1086" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb90-1087"><a href="#cb90-1087" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb90-1088"><a href="#cb90-1088" aria-hidden="true" tabindex="-1"></a>chi <span class="ot">&lt;-</span> ((<span class="fu">abs</span>(b <span class="sc">-</span> c) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(b <span class="sc">+</span> c)</span>
<span id="cb90-1089"><a href="#cb90-1089" aria-hidden="true" tabindex="-1"></a>chi</span>
<span id="cb90-1090"><a href="#cb90-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1091"><a href="#cb90-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1092"><a href="#cb90-1092" aria-hidden="true" tabindex="-1"></a>Assumindo um $\alpha = 0,05$, pode-se obter valor crítico para o $\chi^{2}$ para gl = 1, usando a função <span class="in">`qchisq()`</span>, do pacote <span class="in">`stats`</span>:</span>
<span id="cb90-1093"><a href="#cb90-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1096"><a href="#cb90-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1097"><a href="#cb90-1097" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb90-1098"><a href="#cb90-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="dv">1</span>)</span>
<span id="cb90-1099"><a href="#cb90-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1100"><a href="#cb90-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1101"><a href="#cb90-1101" aria-hidden="true" tabindex="-1"></a>Desta maneira, rejeita-se a $H_{0}$, pois o $\chi_{calculado}^{2} &gt; \chi_{crítico}^{2}$. O valor *P* pode ser conseguido com a função <span class="in">`pchisq()`</span>:</span>
<span id="cb90-1102"><a href="#cb90-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1105"><a href="#cb90-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1106"><a href="#cb90-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span> (<span class="fl">5.633</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-1107"><a href="#cb90-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1108"><a href="#cb90-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1109"><a href="#cb90-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cálculo do teste de McNemar</span></span>
<span id="cb90-1110"><a href="#cb90-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1111"><a href="#cb90-1111" aria-hidden="true" tabindex="-1"></a>Carregar o arquivo <span class="in">`dadosBioestatistica.xlsx`</span>, que pode ser encontrado <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://github.com/petronioliveira/Arquivos/blob/main/dadosBioestatistica.xlsx)</span>. Este conjunto de dados contem os dados da @tbl-tabmcnemar.</span>
<span id="cb90-1112"><a href="#cb90-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1115"><a href="#cb90-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1116"><a href="#cb90-1116" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosBioestatistica.xlsx"</span>)</span>
<span id="cb90-1117"><a href="#cb90-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1118"><a href="#cb90-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1119"><a href="#cb90-1119" aria-hidden="true" tabindex="-1"></a>Construir uma tabela de contingência</span>
<span id="cb90-1120"><a href="#cb90-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1123"><a href="#cb90-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1124"><a href="#cb90-1124" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>preteste <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>preteste, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb90-1125"><a href="#cb90-1125" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>posteste <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>posteste, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb90-1126"><a href="#cb90-1126" aria-hidden="true" tabindex="-1"></a>tab4 <span class="ot">&lt;-</span> <span class="fu">table</span>(dados<span class="sc">$</span>preteste, dados<span class="sc">$</span>posteste, </span>
<span id="cb90-1127"><a href="#cb90-1127" aria-hidden="true" tabindex="-1"></a>            <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Pré-teste"</span>, <span class="st">"Pós-teste"</span>))</span>
<span id="cb90-1128"><a href="#cb90-1128" aria-hidden="true" tabindex="-1"></a>tab4</span>
<span id="cb90-1129"><a href="#cb90-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1130"><a href="#cb90-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1131"><a href="#cb90-1131" aria-hidden="true" tabindex="-1"></a>Agora, pode-se calcular o teste de McNemar<span class="ot">[^19-dadoscategoricos-3]</span> com a função <span class="in">`mcnemar_test()`</span> do pacote <span class="in">`rstatix`</span>:</span>
<span id="cb90-1132"><a href="#cb90-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1133"><a href="#cb90-1133" aria-hidden="true" tabindex="-1"></a><span class="ot">[^19-dadoscategoricos-3]: </span>É possível também obter o teste de McNemar de outras formas, como, por exemplo, usando a função <span class="in">`CrossTable()`</span> do pacote <span class="in">`gmodels`</span>.</span>
<span id="cb90-1134"><a href="#cb90-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1137"><a href="#cb90-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-1138"><a href="#cb90-1138" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">mcnemar_test</span> (tab4, </span>
<span id="cb90-1139"><a href="#cb90-1139" aria-hidden="true" tabindex="-1"></a>                       <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-1140"><a href="#cb90-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-1141"><a href="#cb90-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1142"><a href="#cb90-1142" aria-hidden="true" tabindex="-1"></a>O resultado do teste de McNemar com correção de continuidade é exatamente igual ao calculado manualmente.</span>
<span id="cb90-1143"><a href="#cb90-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1144"><a href="#cb90-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusão</span></span>
<span id="cb90-1145"><a href="#cb90-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-1146"><a href="#cb90-1146" aria-hidden="true" tabindex="-1"></a>Houve uma modificação estatisticamente significativa na opinião dos alunos após o curso de Bioestatística em relação à confiança nas análises estatísticas (86% no pré-teste de respostas <span class="in">`não`</span> x 79% no pós-teste, $\chi^{2} = 5,63, gl = 1, P = 0,018$). Alguns alunos (14) mudaram de opinião em relação a sua confiança nas análises estatísticas dos periódicos médicos.</span>
</code><button title="Copiar para a área de transferência" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>